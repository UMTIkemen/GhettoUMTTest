;==============================================================
; CNS File for Gohan Z2 by Team Z2
; Helper States
;==============================================================

;======================================================================
; POWER CHARGE AURA
[Statedef 905]
type = A
MoveType = I
physics = N
ctrl = 0
anim = 905
velset = 0,0
sprpriority = -1

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1902, BindToParent]
type = BindToParent
trigger1 = anim = 905
pos = -10,-2

[State 1902, Anim]
type = ChangeAnim
triggerall = anim = 905
trigger1 = root,stateno = 901
value = 906

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = anim = 905 && (Root,StateNo != 900)
trigger2 = anim = 906 && animTime = 0
trigger3 = Root,stateno = [5000,5090]


;======================================================================
; POWER CHARGE AURA (EMOTION DESTINY MODE)
[Statedef 907]
type = A
MoveType = I
physics = N
ctrl = 0
anim = 907
velset = 0,0
sprpriority = -1

[State 1902, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1902, BindToParent]
type = BindToParent
trigger1 = anim = 907
pos = -10,-2

[State 1902, Anim]
type = ChangeAnim
triggerall = anim = 907
trigger1 = root,stateno != 900
trigger1 = root,stateno != 901
trigger1 = root,stateno != 2800
trigger1 = root,stateno != 2810
value = 910

[State 1902, DestroySelf]
type = DestroySelf
trigger1 = anim = 907 && root,stateno != 2800 && root,stateno != 2810 && root,stateno != 900 && root,stateno != 901
;trigger1 = anim = 907 && (Root,StateNo != 2800) && (Root,StateNo != 2810)
trigger2 = anim = 910 && animTime = 0
trigger3 = Root,stateno = [5000,5090]

;======================================================================
; DUST Helper (normal aura charge)
[Statedef 908]
type	= A
MoveType	= I
physics	= N
ctrl	= 0
anim	= 908+(1)
velset	= 0,0
sprpriority = 4
[State 909, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
pos = -17,5

[State 908, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 908, NoShadow]
type	= Trans
trigger1	= 1
trans	= none
ignorehitpause = 1

[State 908, DestroySelf]
type	= DestroySelf
trigger1	= (Root,StateNo != 900)
trigger2	= Root,stateno = [5000,5090]

;======================================================================
; DUST Helper (Destiny mode charge)
[Statedef 909]
type	= A
MoveType	= I
physics	= N
ctrl	= 0
anim	= 908+(1)
velset	= 0,0
sprpriority = 4
[State 909, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
pos = -17,5


[State 908, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 908, NoShadow]
type	= Trans
trigger1	= 1
trans	= none
ignorehitpause = 1

[State 908, DestroySelf]
type	= DestroySelf
trigger1	= (Root,StateNo != 2810)
trigger2	= Root,stateno = [5000,5090]


;======================================================================
; Light Ki blast : 1010
; Medium Ki blast : 1011
; Strong Ki blast : 1012
; Ki blast Vanishes : 1013
;======================================================================

;Light Ki blast
[Statedef 1010]
type    = S
MoveType= A
physics = N
anim = 1007
sprpriority = 5
hitcountpersist = 1
MoveHitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !Time
var(14) = Root, Var(14)

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 4

[State 1061, Velocity]
type = VelSet
trigger1 = MoveHit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
Time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
Time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
Time = 1
stateno = 1013
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, HitDef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23)), 3
;Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23)), 3
;ceil(23*root,fvar(15)), ceil(3*root,fvar(15))
priority  = 4,Hit
guardflag = MA
hitflag = MAFP
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3
airguard.velocity = -2.9, -4
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = IfElse(p2MoveType=H,40,140), 10
givepower = 35,35

[State 1061, HitDef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23)), 3
;Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23)), 3
;ceil(23*root,fvar(15)), ceil(3*root,fvar(15))
priority  = 4,Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7010
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3
airguard.velocity = -2.9, -4
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = IfElse(p2MoveType=H,40,140), 10
givepower = 35,35

[State 3001, Guardshake]
type = EnvShake
trigger1 = moveguarded
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 1061, End]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
trigger2 = Time>180

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !MoveContact
trigger1 = Time >=14
value = 1007,1
;persistent = 0

[State 1061, Fade]
type = ChangeState
trigger1 = MoveContact
trigger2 = Time >=15
value = 1013
ignorehitpause=1

;----------------------------------------------------
;Medium Ki blast
[Statedef 1011]
type    = S
MoveType= A
physics = N
anim = 1007
sprpriority = 5
hitcountpersist = 1
MoveHitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !Time
var(14) = Root, Var(14)

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 5.5

[State 1061, Velocity]
type = VelSet
trigger1 = MoveHit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
Time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
Time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
Time = 1
stateno = 1013
;attr = SCA, NP, SP, HP
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, HitDef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 26 < 7, 7, root,fvar(11) * 26)), 5
;Ceil(IfElse(root,fvar(11) * 26 < 7, 7, root,fvar(11) * 26)), 5
;ceil(26*root,fvar(15)), ceil(5*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAFP
pausetime = 0,10
sparkno = s7020
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3
airguard.velocity = -2.9, -4
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= IfElse(p2MoveType=H,40,140), 10
givepower = 35,35

[State 1061, HitDef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 26 < 7, 7, root,fvar(11) * 26)), 5
;Ceil(IfElse(root,fvar(11) * 26 < 7, 7, root,fvar(11) * 26)), 5
;ceil(26*root,fvar(15)), ceil(5*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7020
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3
airguard.velocity = -2.9, -4
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= IfElse(p2MoveType=H,40,140), 10
givepower = 35,35

[State 3001, Guardshake]
type = EnvShake
trigger1 = moveguarded
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 1061, End]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
trigger2 = Time>180

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !MoveContact
trigger1 = Time >=19
value = 1007,1
persistent = 0

[State 1061, Fade]
type = ChangeState
trigger1 = MoveContact
trigger2 = Time >=20
value = 1013
ignorehitpause=1

;----------------------------------------------------
;Strong Ki blast
[Statedef 1012]
type    = S
MoveType= A
physics = N
anim = 1007
sprpriority = 5
hitcountpersist = 1
MoveHitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, gethit gut ?]
type = VarSet
trigger1 = !Time
var(14) = Root, Var(14)

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 7

[State 1061, Velocity]
type = VelSet
trigger1 = MoveHit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
Time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
Time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
Time = 1
stateno = 1013
;attr = SCA, NP, SP, HP
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, HitDef]
type = HitDef
trigger1 = var(14)=0
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 31 < 7, 7, root,fvar(11) * 31)), 7
;Ceil(IfElse(root,fvar(11) * 31 < 7, 7, root,fvar(11) * 31)), 7
;ceil(31*root,fvar(15)), ceil(7*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAFP
pausetime = 0,10
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3.5
airguard.velocity = -2.9, -3.2
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= IfElse(p2MoveType=H,40,140), 10
givepower = 35,35

[State 1061, HitDef]
type = HitDef
trigger1 = var(14)=1
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 31 < 7, 7, root,fvar(11) * 31)), 7
;Ceil(IfElse(root,fvar(11) * 31 < 7, 7, root,fvar(11) * 31)), 7
;ceil(31*root,fvar(15)), ceil(7*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,10
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3.5
airguard.velocity = -2.9, -3.2
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= IfElse(p2MoveType=H,40,140), 10
givepower = 35,35

[State 3001, Guardshake]
type = EnvShake
trigger1 = moveguarded
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 1061, End]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
trigger2 = Time>180

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !MoveContact
trigger1 = Time >=24
value = 1007,1
persistent = 0

[State 1061, Fade]
type = ChangeState
trigger1 = MoveContact
trigger2 = Time >=25
value = 1013
ignorehitpause=1

;----------------------------------------------------
;Ki blast vanishes
[Statedef 1013]
type    = A
MoveType= A
physics = N
anim = 1013
sprpriority = 5
velset = -2,0
MoveHitPersist = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
trigger1 = PrevStateNo = 1061
trigger1 = !MoveHit
value = 1009
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
trigger1 = PrevStateNo = 1061
trigger1 = MoveHit
value = 2512
ignorehitpause = 1

[State 0, Offset]
type = Offset
trigger1 = Anim = 2512
x = Cond(Facing = 1,50,-50)

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !Time
trigger1 = PrevStateNo = 1061
value = 1007,2

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, NoJuggle Safety]
type = ParentVarSet
trigger1 = !Time
v = 18
value = 0

[State 1002, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, End]
type = DestroySelf
trigger1 = Time >= 13
trigger1 = (!numtarget || root,movehit)

;----------------------------------------------------
;Ex ki blast 1
[Statedef 1060]
type    = S
MoveType= A
physics = N
anim = 1007
sprpriority = 5
hitcountpersist = 1
MoveHitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 9

[State 1061, Velocity]
type = VelSet
trigger1 = MoveHit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
Time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
Time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
Time = 1
stateno = 1013
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, HitDef]
type = HitDef
trigger1 = !Time
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 31	< 7, 7, root,fvar(11) * 31)), 7
;Ceil(IfElse(root,fvar(11) * 50 < 7, 7, root,fvar(11) * 50)), 7
;ceil(50*root,fvar(15)), ceil(7*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAFP
pausetime = 0,10
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4.8,0
guard.velocity = -4.5
air.velocity = -3,-3.5
airguard.velocity = -2.9, -3.2
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
air.fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35

[State 3001, Guardshake]
type = EnvShake
trigger1 = moveguarded
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 1061, End]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
trigger2 = Time>180

[State 1061, Fade]
type = ChangeState
trigger1 = MoveContact
trigger2 = time >= 16
value = 1013
ignorehitpause=1

;----------------------------------------------------
;Ex ki blast 2
[Statedef 1061]
type    = S
MoveType= A
physics = N
anim = 1008
sprpriority = 5
hitcountpersist = 1
MoveHitpersist = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[state 1061, limiter]
type = parentvarset
;triggerall = !target,ishelper
trigger1 = numtarget(1061)
fvar(5) = 1
ignorehitpause = 1

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time = 0
x = 6

[State 1061, Velocity]
type = VelSet
trigger1 = MoveHit
x = 0

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
Time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
Time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
Time = 1
stateno = 1013
attr = SCA, AA, AP, AT
ignorehitpause = 1

[State 1061, HitDef]
type = HitDef
trigger1 = !root,NumExplod(1061)
trigger1 = !Time
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 31 < 7, 7, root,fvar(11) * 31)), 7
;Ceil(IfElse(root,fvar(11) * 50 < 7, 7, root,fvar(11) * 50)), 7
;ceil(50*root,fvar(15)), ceil(7*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAFP
pausetime = 0,10
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -2.5,-11
guard.hittime = 17
guard.velocity = -7.8
air.velocity = -2.7,ifelse(root,fvar(5) = 1,-8,-11)
airguard.velocity = -5, -4
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
fall = 1
air.fall = 1
fall.recover = ifelse(root,fvar(5) = 1,1,0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35
id = 1061

[State 0, TargetState]
type = null;targetstate
triggerall = NumTarget(1061)
trigger1 = MoveHit =1
value = 699
persistent = 1
;ignorehitpause = 1

[State 6050, Explod]
type = Explod
trigger1 = NumTarget
trigger1 = !target,IsHelper
trigger1 = MoveContact
anim = 8601
ID = 8600
pos = 15,-50   
postype = p2
sprpriority = 2
bindtime = -1
ownpal = 1
facing = -1

[State 6050, Explod]
type = Explod
trigger1 = NumTarget
trigger1 = !target,IsHelper
trigger1 = MoveContact
anim = 8601
ID = 8600
pos = -15,-70   
postype = p2
sprpriority = 3
bindtime = -1
ownpal = 1
facing = -1

[State 1061, HitDef]
type = HitDef
trigger1 = root,NumExplod(1061)
trigger1 = !Time
attr = S, SP
animtype  = hard
damage = Ceil(IfElse(root,fvar(11) * 50 < 7, 7, root,fvar(11) * 50)), 7
;Ceil(IfElse(root,fvar(11) * 50 < 7, 7, root,fvar(11) * 50)), 7
;ceil(50*root,fvar(15)), ceil(7*root,fvar(15))
priority  = 4, Hit
guardflag = MA
hitflag = MAF
pausetime = 0,1
sparkno = s7030
guard.sparkno = -1
sparkxy = 0,0
hitsound   = s1000,0
guardsound = S6,1
ground.type = low
air.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -9.5,-1
guard.hittime = 17
guard.velocity = -7.8
air.velocity = -9.8,1
airguard.velocity = -5, -4
EnvShake.Time = 5
EnvShake.ampl = 4
EnvShake.freq = 176
fall.EnvShake.Time = 10
fall.EnvShake.ampl = 4
fall.EnvShake.freq = 176
yaccel = 0.5
fall = 1
air.fall = 1
fall.recover = ifelse(root,fvar(5) = 1,1,0)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35

[State 3001, Guardshake]
type = EnvShake
trigger1 = moveguarded
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 1061, End]
type = DestroySelf
trigger1 = (pos x!=[-240,240])
trigger2 = Time>180

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !MoveContact
trigger1 = Time >=16
value = 1007,1
persistent = 0

[State 1061, Fade]
type = ChangeState
trigger1 = movecontact
trigger2 = Time >=17
value = 1013
ignorehitpause=1


;======================================================================
; LIGHTNING (Destiny mode charge)
[Statedef 2805]
type	= A
MoveType	= I
physics	= N
ctrl	= 0
anim	= 2810+(random%12);2805+(random%4)
velset	= 0,0
sprpriority = 4

[State 2805, ChangeAnim]
type = ChangeAnim
trigger1	= gameTime%(4) = 0
value	= 2810+(random%12);2805+(random%4)
;elem	= 1
;ignorehitpause = 
persistent= 0


[State 2805, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 2805, Transparency]
type	= Trans
trigger1	= 1
trans	= none
ignorehitpause = 1

[State 2805, DestroySelf]
type	= DestroySelf
trigger1	= (Root,StateNo != 2810)
trigger2	= Root,stateno = [5000,5090]

[State 2805, DestroySelf]
type	= DestroySelf
trigger1	= AnimTime = 0


;======================================================================
;LAND FX
[Statedef 17100]
type=A
MoveType=I
physics=N
anim=15999
sprpriority=1
velset=0,0

[state 17100,bind]
type = bindtoparent
trigger1 = !Time
pos = -11,0

[state 17100, Landing Effect]
type=Explod
trigger1=!Time
anim=17100
id=17100
pos=0,0
postype=P1
sprpriority=-3
ownpal=1
supermoveTime=-1

[state 17100]
type=removeExplod
trigger1=Time>10

[State 17100]
type=DestroySelf
trigger1=Time>10

;======================================================================
; Repel Helper : 1305
; Destroyed : 1306
; Reflect with random projectile : 1308
; Reflected projectile : 1315
; Reflected projectile Explods : 1316
;======================================================================

; REPEL Helper FOR SLASH CHOP
[Statedef 1305]
type = S
physics = N
MoveType = A
ctrl = 0
sprpriority = 4

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1305, NotHitBy]
type = NotHitBy
trigger1 = 1
Time = -1
value = SCA
ignorehitpause = 1

[State 1305, HB]
type = hitby
trigger1 = 1
Time = 1
value = SCA, NP, SP, HP
ignorehitpause = 1

[State 1305, HitOverride]
type = hitoverride
trigger1 = 1
Time = -1
attr = SCA, AA, AP, AT
stateno = 1306
ignorehitpause = 1

[State 1305, HitOverride]
type = hitoverride
trigger1 = 1
Time = -1
attr = SCA, NP, SP,HP
stateno = 1308
ignorehitpause = 1

[State 1305, Anim]
type = ChangeAnim
trigger1 = anim != 1305
value = 1305

[State 1305, Timevar]
type = VarAdd
trigger1 = 1
var(4) = 1

[State 1305, Shadows]
type = AfterImage
trigger1 = !Time && !PrevStateNo
Time = 999
Timegap = 1
framegap = 4
length = 12
palcontrast = 30, 60, 120
trans = add

[State 1305, Type]
type = statetypeset
trigger1 = MoveContact
MoveType = I

[State 1305, End]
type = ChangeState
trigger1 = var(4) >= 13
value = 1306

;-----------------------------------------
; Destroyed
[Statedef 1306]
type = A
physics = N
MoveType = I
velset = 0, 0
ctrl = 0
sprpriority = 1
anim = 15998

[State 3000, nhb]
type = NotHitBy
trigger1 = 1
Time = 1
value = SCA
ignorehitpause = 1

[State 1306, End]
type = DestroySelf
trigger1 = !animTime

;-----------------------------------------
; Reflect with projectile
[Statedef 1308]
type = A
physics = N
MoveType = I
ctrl = 0
anim = 15998

[State 1308, NotHitBy]
type = NotHitBy
trigger1 = 1
Time = 1
value = SCA
ignorehitpause = 1

[State 1308, reflected]
type = Helper
trigger1 = !Time
Helpertype = normal
stateno = 1315
ID = 1315
name = "Reflected"
postype = p1
pos = 25, -20
ownpal = 1
size.xscale = 1
size.yscale = 1

[State 1308, End]
type = ChangeState
trigger1 = 1
value = 1306   ;1305

;-----------------------------------------
; Reflected projectile Kamehameha
[Statedef 1315]
type=S
physics=N
MoveType=A
ctrl=0
velset=0,0
sprpriority=4
poweradd = 150

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 200, Ki goes SFX]
type = PlaySnd
trigger1 = !Time
value = 10,0
channel = 1

[State -2, Explod];P1 Side.
type = Explod
trigger1 = !Time && numExplod(13300)=0 && teamside = 1
anim = 13300
pos = 10,80
postype = left  ;p2,front,back,left,right
removeTime = -2
supermove = 1
;scale = 0.5,0.5
sprpriority = 0
id = 13300
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = -1
persistent = 0

[State -2, Explod];P2 Side.
type = Explod
trigger1 = !Time && numExplod(13300)=0 && teamside = 2
anim = 13301
pos = -169,80
postype = right
removeTime = -2
supermove = 1
;scale = 0.5,0.5
sprpriority = 0
id = 13300
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = -1
persistent = 0

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1315, HitOverride]
type=hitoverride
trigger1= 1
Time=-1
attr=SCA,AA,AP,AT
stateno=1316
ignorehitpause=1

[State 1315, HB]
type=hitby
trigger1= 1
Time=-1
value=SCA,NP,SP,HP
ignorehitpause=1

[state 1315]
type = VarSet
triggerall = NumEnemy
triggerall = enemy,authorname = "Team Z2"
trigger1 = enemy,name = "Goku Z2"
trigger2 = enemy,name = "SSJ Goku Z2"
trigger3 = enemy,name = "Vegeta Z2"
trigger4 = enemy,name = "Gohan Z2"
var(11) = 1

[State 1315, Anim];normal kamehameha FX (yellow/blue)
type=ChangeAnim
trigger1= !Time && !PrevStateNo && var(11)=0 && Root, Var(44)=0
value=1311
[State 1315, Anim];normal kamehameha FX (old purple)
type=ChangeAnim
trigger1= !Time && !PrevStateNo && var(11)=0 && Root, Var(44)>=1
value=1310
[State 1315, Anim];Goku kamehameha FX
type=ChangeAnim
trigger1= !Time && !PrevStateNo && var(11)=1
value=1010

[State 1315, Vel]
type=velset
trigger1= 1
x = 8

[State 1315, image]
type=AfterImage
trigger1= !Time && !PrevStateNo
Time=999
Timegap=1
framegap=2
length=5
palcontrast=50,50,200
trans=add

[State 1315, Hit]
type=HitDef
trigger1= 1
priority=4,Hit
attr = S,SP
damage = Ceil(IfElse(root,fvar(11) * 61 < 7, 7, root,fvar(11) * 61)), 6
;Ceil(IfElse(root,fvar(11) * 61 < 7, 7, root,fvar(11) * 61)), 6
;ceil(61*root,fvar(15)), ceil(6*root,fvar(15))
animtype = Hard
hitflag = MAF
guardflag=MA
pausetime=0,10
sparkno = s7020
guard.sparkno = -1
sparkxy = -10,0
hitsound  = S1000,0
guardsound = S6,1
ground.type=High
ground.slidetime=16
ground.hittime=16
ground.velocity=-10,0
ground.cornerpush.veloff=0
air.velocity=-4,-2
getpower= IfElse(p2MoveType=H,40,140), 35
givepower = 35,35
EnvShake.Time=14
EnvShake.freq=120
EnvShake.ampl=4
air.fall=1
fall.recover=1
fall.recovertime=16
yaccel=.5
airguard.ctrlTime= 16
airguard.velocity= -8, -1.5
forcestand=1
p1sprpriority = 5


[State 1315, End]
type=ChangeState
trigger1= MoveContact
value=1316
ignorehitpause=1

[State 1315, End]
type=DestroySelf
trigger1=pos x!=[-200,200]

;-----------------------------------------
; Kamehameha Explod/vanish
[Statedef 1316]
type=A
physics=N
MoveType=I
velset=0,0
ctrl=0
sprpriority=4

[State 1308, NotHitBy]
type = NotHitBy
trigger1 = 1
Time = 1
value = SCA
ignorehitpause = 1

[State 3005, anim];VS Z2 chars
type = null;ChangeAnim
trigger1 = !Time && var(11)=1
value = 1013
[State 3005, anim];Repel (purple)
type = ChangeAnim
trigger1 = !Time ;&& var(11)=0 && PrevStateNo=1315 && Root, Var(44)>=1
value = 1317
[State 3005, anim];Repel (yellow/blue)
type = null;ChangeAnim
trigger1 = !Time && var(11)=0 && PrevStateNo=1315 && Root, Var(44)=0
value = 1311

[State 3005, anim];Chou Kmh
type = ChangeAnim
trigger1 = !Time && PrevStateNo=2402
trigger2 = !Time && PrevStateNo=2602
value = 15998

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1316, End]
type=DestroySelf
trigger1= !animTime

;==========================================================
; KAMEHAMEHA HELPER
[Statedef 1317]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 5

[State 0, Projectile]
type = Projectile
;trigger1 = 1
trigger1 = (P2BodyDist X = [-90,90]) && (P2BodyDist Y = [-90,90])
ProjID = 93999999999
projanim = 1
projremovetime = 2
offset = -400,0
postype = p1
attr = A,SP        ;change this to whatever your projectile is set
ignorehitpause = 1
guardflag = A
guard.dist = 1999
projedgebound = 1600
projstagebound = 1600

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
;trigger1 = MoveHit
;trigger1 = P2MoveType = H
trigger1 = var(2)=10
fvar(13) = 10;1
ignorehitpause = 1

[State 3005, anim]
type = changeanim
trigger1 = !time && !prevstateno
value = 1315

[State 3005, hitvar]
type=varadd
trigger1= !time
var(2)=1

[State 1055, movehitvar]
type=varset
trigger1= movecontact && numtarget
trigger1= !(target,ishelper)
var(3)=1
ignorehitpause=1

[State 13100, goes SND]
type = playsnd
trigger1 = !time && !prevstateno
value = 2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = ifelse(var(2)<10,2001,2002)  ;1316)
attr = SCA, NP, SP, HP,AA,AP,AT
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = ifelse((time<2 && var(2)>1),1,15)

[State 3005, hit]
type = hitdef
trigger1 = 1
attr = S,HP
hitflag = MAFP
guardflag = MA
priority = 7,Hit
;ceil(35*root,fvar(15)), 4
damage    = ceil(IfElse(root,fvar(11) * 10 < 9, 9, root,fvar(11) * 10)), 10
;damage    = ceil(IfElse(root,fvar(11) * 30 < 20, 20, root,fvar(11) * 30)), 10
getpower = 0,0
givepower = 35,35
pausetime = 3*(var(2)<10),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrltime = 16
ground.velocity= ifelse(var(2)<10, 0, -6), ifelse(var(2)<10, 0, -4)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=10)
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,0
envshake.time = 16
envshake.ampl = 6
envshake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.time=32
p1sprpriority = 5
ID=2001

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[State 3005, end]
type = changestate
trigger1 = movecontact
value = ifelse(var(2)<10,1317,1316)

[State 3001, Guardshake]
type = envshake
trigger1 = movecontact=1 && numtarget
time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = destroyself
trigger1 = pos x!=[-240,240]

;==========================================================
; SUPER BG - Street Fighter 3
[Statedef 19875]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 10500, snd]
type = PlaySnd
trigger1 = !Time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = Time <= 55
flag = noFG

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic

[State 10000, Explod]; White BG
type = Explod
trigger1 = Time = 0
anim = 19877
id = 19875
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindTime = -1
ownpal = 1
removeTime = 99999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
supermove = 1
scale = 1.20,1.20
ignorehitpause = 1
persistent = 0

[State 10000, Explod SF3]
type = Explod
trigger1 = Time = 0
anim = 19875
id = 10000
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindTime = -1
ownpal = 1
removeTime = 9999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
supermove = 1
scale = 1.20*0.9,1.20*1.05
ignorehitpause = 1
persistent = 0

[State 10000, pause]
type = Pause
trigger1 = Time = 0
Time = 40
moveTime = 40

[State 10000, RemoveExplod]
type = RemoveExplod
trigger1 = Time = 44
id = 10000

[State 10000, RemoveExplod]
type = RemoveExplod
trigger1 = Time = 55
id = 10500

[State 8020, End]
type = DestroySelf
trigger1 = !(roundstate>2)
trigger2 = Time=1000


;==========================================================
; SUPER BG - Super DBZ (Physics)
[Statedef 19885]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 1000, shake]
type = EnvShake
trigger1 = !(Time%4) && Time<150
Time=4
freq=80
ampl=7

[State 10500, snd]
type = PlaySnd
trigger1 = !Time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = nokoslow
ignorehitpause = 1

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = Time = 0
anim = 19884
id = 19884
pos =  160,120
postype = left
sprpriority = -4
facing = 1
bindTime = -1
ownpal = 1
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
scale = 1.20,1.20
ignorehitpause = 1
persistent = 0
removeTime = -2

[State 10000, Explod Krak]
type = Explod
trigger1 = Time = 0
anim = 19885
id = 19885
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindTime = -1
ownpal = 1
removeTime = 9999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
supermove = 1
scale = 1,1
ignorehitpause = 1
persistent = 0

[State 10000, Scale Explod]
type = ModifyExplod
trigger1 = Time>6
scale = 1+.01*Time, 1+.01*Time
id = 19885

[State 10000, RemoveExplod Krak]
type = RemoveExplod
trigger1 = Time = 44
id = 19885

[State 10000, Explod Space BG]
type = Explod
trigger1 = Time = 23
anim = 19886
id = 19886
pos =  160,120
postype = left
sprpriority = -7
facing = 1
bindTime = -1
ownpal = 1
removeTime = 9999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
scale = 1.3,1.3
ignorehitpause = 1
persistent = 0

[State 10000, Explod planet left]
type = Explod
trigger1 = Time = 23
anim = 19887
id = 19886
pos =  0,240
postype = left
sprpriority = -6
facing = 1
ownpal = 1
removeTime = 9999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
scale = 1.2,1.2
ignorehitpause = 1
persistent = 0
;vel = -.2,0
bindTime = -1

[State 10000, Explod planet right]
type = Explod
trigger1 = Time = 23
anim = 19888
id = 19886
pos =  320,240
postype = left
sprpriority = -6
facing = 1
ownpal = 1
removeTime = 9999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
scale = 1.2,1.2
ignorehitpause = 1
persistent = 0
;vel = .2,0
bindTime = -1

[State 1000, Helper]
type = Helper
trigger1 = Time>=23 && Time<70 && !(Time%5) && NumHelper(19890)<80 && NumHelper(19891)<80
Helpertype = Normal
name = "rocks"
id = 19890
pos = 160,20
postype = left
facing = 1
stateno = 19890
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999

[State 13300, black screen fade]
type = Explod
trigger1 = Time = 60
anim = 19883   ;2771
ID = 2771
postype = left
pos = 0,-50
bindTime = -1
removeTime = 91
pausemoveTime = 91
ontop = 1
scale = 2,3

[State 10000, RemoveExplod Krak]
type = RemoveExplod
trigger1 = Time = 150
id = 19886

[State 8020, End]
type = DestroySelf
trigger1 = !(roundstate>2)
trigger2 = Time=150  ;1000

;------------------------------------------------------
;Rocks going up
[Statedef 19890]
type = A
MoveType = I
physics = N
anim = 15999

[State 1003, Helper]
type = Helper
trigger1 = !Time
Helpertype = Normal
name = "rocks"
id = 19891
pos = ((random%320)),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, Helper]
type = Helper
trigger1 = !Time
Helpertype = Normal
name = "rocks"
id = 19891
pos = ((random%320)+320),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, Helper]
type = Helper
trigger1 = !Time
Helpertype = Normal
name = "rocks"
id = 19891
pos = ((random%320)-320),10*(random%13)
postype = left
facing = 1
stateno = 19891
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
size.xscale = .5
size.yscale = .5

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = Time=2

;-----------------
[Statedef 19891]
type = A
MoveType = I
physics = N
anim = 19890 + random%6
sprpriority = -5

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = NoShadow

[State 1004, vel]
type = velset
trigger1 = !Time
y = -3-random%7

[State 1004, vel]
type = VarSet
trigger1 = !Time
var(10) = random%2

[State 1004, assert]
type = angledraw
trigger1 = 1
value = IfElse(var(10)=0,5*Time,-5*Time)

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = Time > 300
trigger2 = pos Y < -340
trigger3 = root,stateno = 180

;==========================================================
; SUPER BG - Super DBZ (Ki attacks)
[Statedef 19892]
type = S
velset = 0,0
sprpriority = 0
anim = 15999
ctrl = 0

[State 3001, screen]
type = PosSet
trigger1 = !Time
x = 0
y = -ceil(screenpos Y)
ignorehitpause = 1

[State 3001, screen]
type = PosSet
trigger1 = 1
x = 0
ignorehitpause = 1

[State 1000, shake]
type = EnvShake
trigger1 = !(Time%4) && Time<150
Time=4
freq=80
ampl=7

[State 10500, snd]
type = PlaySnd
trigger1 = !Time
value = 9,0

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = nokoslow
ignorehitpause = 1

[State 10000, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nomusic
flag2 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = !Time
anim = 957
id = 11111
pos =  0,-30
postype = left
sprpriority = -7
facing = 1
bindTime = -1
ownpal = 1
removeTime = -1
supermoveTime = -1
pausemoveTime = -1
ignorehitpause = 1
scale = 2,2

[State 10000, Explod Zwang]
type = Explod
trigger1 = Time = 0
anim = 19896
id = 19896
pos =  160,120
postype = left
sprpriority = -5
facing = 1
bindTime = -1
ownpal = 1
removeTime = 9999999999999
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
ignorehitpause = 1
scale = .9,1.2

[State 10000, Scale Explod]
type = ModifyExplod
trigger1 = Time>50
scale = .9+.005*(Time-50), 1.2+.005*(Time-50)
id = 19896

[State 1003, Helper]
type = Helper
trigger1 = !Time
Helpertype = Normal
name = "yellow_BG"
id = 19897
pos = 0,0
postype = left
facing = 1
stateno = 19897
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
persistent = 0

[State 13300, white screen fade]
type = Explod
trigger1 = Time = 60
anim = 19883
ID = 2771
postype = left
pos = 0,-50
bindTime = -1
removeTime = 91
pausemoveTime = 91
ontop = 1
scale = 2,3
ignorehitpause = 1

[State 10000, RemoveExplod zwang]
type = RemoveExplod
trigger1 = Time = 140
id = 19896
[State 10000, RemoveExplod yellow BG]
type = RemoveExplod
trigger1 = Time = 140
id = 19897
[State 10000, RemoveExplod white BG]
type = RemoveExplod
trigger1 = Time = 140
id = 11111

[State 10000, pause]
type = Pause
trigger1 = !Time
Time = 20
moveTime = 20
ignorehitpause = 1

[State 10000, pause]
type = null;Pause
trigger1 = Time>20 && Time<100 && !(Time%3)
Time = 1
moveTime = 1
ignorehitpause = 1

[State 8020, End]
type = DestroySelf
trigger1 = !(roundstate>2)
trigger2 = Time=150

;--------------------------------------
;Yellow Super BG Helper
[Statedef 19897]
type = S
MoveType = I
physics = N
anim = 19897
sprpriority = -6

[State 1004, assert]
type = bindtoparent
trigger1 = 1
pos = 0,120
ignorehitpause = 1

[State 1004, assert]
type = assertspecial
trigger1 = 1
flag = NoShadow
flag2 = noFG
ignorehitpause = 1

[State 1004, assert]
type = angledraw
trigger1 = Time < 50
value = 10*Time
scale = .7,.7
ignorehitpause = 1

[State 1004, assert]
type = angledraw
trigger1 = Time >= 50
value = 10*Time
scale = .7+.01*(Time-50),.7+.01*(Time-50)
ignorehitpause = 1

[State 1004, DestroySelf]
type = DestroySelf
trigger1 = Time > 130

;==========================================================
; SUPER BG - Jojo's Bizarre Adventure
[Statedef 19900]
type    = A
MoveType= I
physics = N
ctrl = 0
anim = 15999
sprpriority = -21

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19910
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindTime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removeTime = -1
supermoveTime = -1
pausemoveTime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19911
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindTime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removeTime = -1
supermoveTime = -1
pausemoveTime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19912
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindTime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removeTime = -1
supermoveTime = -1
pausemoveTime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19913
id = 8001
pos = 0,-10
postype = back
sprpriority = -21
bindTime = -1
scale = 0.83333333333333333333333333333333,1.0810810810810810810810810810811
removeTime = -1
supermoveTime = -1
pausemoveTime = -1
ignorehitpause = 1

[State 1211, Exclamation]
type = Explod
trigger1 = Time = 0
anim = 19900
id = 19900
pos = 0,0
postype = back
sprpriority = 5
bindTime = -1
scale = .84, 1.07
supermoveTime = -1
pausemoveTime = -1
ignorehitpause = 1
persistent = 0
ontop = 1

[State 10500, snd]
type = PlaySnd
trigger1 = !Time
value = 9,0

[state haha]
type = VarSet
trigger1 = Time = 0
var(3) = 0

[state haha]
type = VarAdd
trigger1 = Time >= 5
trigger1 = var(3) < 220
var(3) = 5

[State that starts the inverted effect]
type           = PalFX
trigger1       = Time >= 5
add            = var(3),var(3),var(3)
Time           = 1
ignorehitpause = 1

[State 2030, 0]
type = AssertSpecial
Trigger1 = Time < IfElse(matchover, 120, 50)
flag = nofg
flag2 = nobardisplay
ignorehitpause = 1

[State haha]
type = RemoveExplod
trigger1 = Time = IfElse(matchover, 120, 50)
id = 8001

[State ChangeState!]
type = DestroySelf
trigger1 = RoundState = 0

;===================================================
;DASH COLLISION NOTIFICATION
[Statedef 13200]
type=A
physics=N
MoveType=I
anim = 15999
velset=0,0
sprpriority=6

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

;[State -2, Explod]; Notification
;type = Explod
;trigger1 = !Time
;anim = 13200
;removeTime = -2
;supermove = 1
;sprpriority = 1
;id = 13200
;bindTime = -1
;ontop = 1
;ownpal = 1
;ignorehitpause = 1
;pausemoveTime = -1
;facing = facing
;scale = 0.5,0.5
;
;[state 17100,scale FX]
;type = modifyExplod
;trigger1 = numExplod(13200)
;trigger1 = Time>=10
;scale = 0.5+0.02*(Time-10),0.5+0.02*(Time-10)
;id = 13200

[State 8000, End]
type=DestroySelf
trigger1= Time>=40

;===================================================
;BEAM COLLISION NOTIFICATION
[Statedef 13250]
type=A
physics=N
MoveType=I
anim = 15999
velset=0,0
sprpriority=6

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State -2, Explod]; Notification
type = Explod
trigger1 = !Time
anim = 13250
removeTime = -2
supermove = 1
sprpriority = 1
id = 13250
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = -1
pos = 160,120
postype = left
scale = 0.5,0.5

[state 17100,scale FX]
type = modifyExplod
trigger1 = numExplod(13250)
trigger1 = Time>=10
scale = 0.5+0.02*(Time-10),0.5+0.02*(Time-10)
id = 13250

[State 8000, End]
type=DestroySelf
trigger1= Time>=40

;===================================================
[StateDef 2771] ; Fade in/out effects BLACK
type = A
MoveType = I
physics = N
anim = 15999
velset = 0,0

[State 13300, Expl]
type = Explod
trigger1 = Time = 30
anim = 2771
ID = 2771
postype = left
pos = -30,-30
bindTime = -1
removeTime = 71
pausemoveTime = 71
ontop = 1
scale = 2,2

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [30,100]
Time = 1
add = 4*(Time-30),4*(Time-30),4*(Time-30)

[State 13001, End]
type = DestroySelf
trigger1 = Time=101


;===================================================
; Limit basics comboability
[Statedef 15999]
type    = S
MoveType= A
physics = N
anim = 15999
sprpriority = -5

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = NumEnemy
trigger1 = enemynear, MoveType != H || (enemynear, stateno = [120,155]) || enemynear, ctrl
trigger2 = Time = 24

;===================================================
;Pulse Effect during fall recovery (taken from Possessed Heita by The_None)
[Statedef 52100]
type    = S
MoveType = I
physics = S
sprpriority = 4
anim = 15999
ctrl = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 0, PlaySnd]
type = PlaySnd
triggerall = Root, Var(55)=0		;Voice=Japan
trigger1 = Time = 0
value = 3,3
channel = 0

[State 0, PlaySnd]
type = PlaySnd
triggerall = Root, Var(55)=1		;Voice=English
trigger1 = Time = 0
value = 3,100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
triggerall = Root, Var(55)=2		;Voice=Corey
trigger1 = Time = 0
value = 3,201
channel = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,AA,AP,AT

[State 0, PosAdd]
type = PosAdd
trigger1 = 1
x = IfElse(root,stateno=5201,ceil(parentdist x/3.0),parentdist x)
y = parentdist y

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(0) = parent,anim

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(1) = parent,animelemno(0)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Time
value = var(0)
elem = var(1)

[State 0, VarSet]
type = VarAdd
trigger1 = Time
fvar(0) = 11.2

[State 0, VarSet]
type = VarAdd
trigger1 = Time
fvar(1) = 0.015

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 1+fvar(1),1+fvar(1)

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, PalFX]
type = PalFX
trigger1 = 1
Time = 1
add = floor(0-fvar(0)),floor(0-fvar(0)),floor(0-fvar(0))

[State 0, ]
type = DestroySelf
trigger1 = root,stateno != 5201
trigger1 = root,stateno != 5210


;===================================================
; LVL 1 MASENKO
[Statedef 2011]
type = A
physics	= N
MoveType = A
ctrl = 0
sprpriority = 5

[state 1215, rocks FX]
type = null;explod
trigger1 = time%3 = 0 ;&& time > 50 && time < 90
anim = 4209
id = 4209
pos = 0,70
postype = P1
sprpriority = 3
bindtime = 2
vel = 3,0
ownpal = 1
removetime = 20
ignorehitpause = 1

[state 1215, rocks FX]
type = null;explod
trigger1 = time%3 = 0 ;&& time > 50 && time < 90
anim = 1025
id = 4209
pos = 0,70
postype = P1
sprpriority = 3
bindtime = 1
;vel = 3,0
ownpal = 1
removetime = -2
ignorehitpause = 1

[state 1215, real Smoke FX]
type = null;explod
trigger1 = anim = 2012
anim = 4209
id = 1207
pos = -10,70  ;30,0
postype = P1
Facing=1
bindtime = -1
;velocity = 2,0
sprpriority = -5
ownpal = 1
removetime = -2
persistent = 10
ignorehitpause = 1

[state 1215, Smoke FX]
type = null;explod
trigger1 = anim = 2012
anim = 1032
id = 1032
pos = -20,65 ;30,0
postype = P1
Facing=-1
bindtime = 1
;velocity = 2,0
sprpriority = -5
ownpal = 1
removetime = -2
persistent = 4
ignorehitpause = 1

[state 1215, Smoke FX]
type = null;explod
trigger1 = anim = 2011
anim = 1032
id = 1032
pos = -10,70 ;30,0
postype = P1
Facing=-1
bindtime = 1
;velocity = 2,0
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 4
ignorehitpause = 1

[state 1215, Smoke FX]
type = null;explod
trigger1 = anim = 2011
anim = 1032
id = 1032
pos = 0,70 ;30,0
postype = P1
Facing=-1
bindtime = 1
;velocity = 2,0
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 4
ignorehitpause = 1

[state 1215, Smoke FX]
type = null;explod
trigger1 = anim = 2011
anim = 1032
id = 1032
pos = -10,75 ;30,0
postype = P1
Facing=-1
bindtime = 1
;velocity = 2,0
sprpriority = 4
ownpal = 1
removetime = -2
persistent = 4
ignorehitpause = 1

[state 1215, Smoke FX]
type = null;explod
trigger1 = anim = 2011
anim = 1032
id = 1032
pos = -20,85 ;30,0
postype = P1
Facing=-1
bindtime = 1
;velocity = 2,0
sprpriority = 5
ownpal = 1
removetime = -2
persistent = 4
ignorehitpause = 1



[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.1
ignorehitpause = 1

[State 2011, anim]
type		= ChangeAnim
trigger1	= !Time && !PrevStateNo
value		= 2011

[State 2011, NoJuggle]
type		= ParentVarSet
trigger1	= Time = 0
v		= 18
value		= 1

[State 2011, hitvar]
type		= VarAdd
trigger1	= !Time
var(2)		= 1

[State 2011, MoveHitvar]
type		= VarSet
trigger1	= MoveContact && NumTarget
trigger1	= !(Target,IsHelper)
var(3)		= 1
ignorehitpause	= 1

[state 2011, lightning FX]
type = explod
trigger1 = !time && !numexplod(20110)
anim = 20110
sprpriority = 6
ID = 20110
postype = P1
pos = 0,0
ownpal = 1
bindtime = -1
removetime = -2

[State 2011, ShootingSND]
type		= PlaySnd
trigger1	= !Time && !PrevStateNo
value		= 2000,2

[State 2011, NoShadow]
type		= AssertSpecial
trigger1		= 1
flag		= NoShadow
ignorehitpause	= 1
[State 2011, UnGuardable]
type		= null;AssertSpecial
trigger1		= Root, Var(26) >= 152
flag		= UnGuardable
ignorehitpause	= 1


[State 2011, NotHitBy]
type		= NotHitBy
trigger1	= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1
[State 2011, HitBy]
type		= HitBy
trigger1	= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1	= Time >= 0
slot		= 1
Time		= 1
stateno		= IfElse(var(2)<3+floor(Root, Var(26)/70),2011,2012)
attr		= SCA,AA,AP
ignorehitpause	= 1

[State 2011, Velocity]	;first number: velocity while it hits; second number: travelling speed (maybe?)
type		= VelSet
trigger1		= 1
x		= IfElse((Time<2 && var(2)>1),7,15) ;1,10
;ignorehitpause	= 0

[State 2011, AfterImage]
type		= AfterImage
trigger1		= !Time
Time		= 999
Timegap		= 1
framegap		= 2
length		= 5
palcontrast	= 50,50,200
trans		= Add

[State 2011, hit]
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= var(2) <=3;Root, Var(26) < 152
attr		= S,HP
hitflag		= MAFDP
guardflag		= MA
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 40 < 20, 20, root,fvar(11) * 40)), 4
;Ceil(IfElse(root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)))), 4
getpower		= 0,0
givepower		= 35,35
pausetime		= 5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-3.9
airguard.velocity	= -5.5, -1.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2011, hit]
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= var(2) >3;Root, Var(26) >= 152
attr		= S,HP
hitflag		= MAFDP
guardflag		= MA	;if it's charged at max, it's unguardable (see assertspecial, scroll up)
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 60 < 18, 18, root,fvar(11) * 60)), 4
;Ceil(IfElse(root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)))), 4
;40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)), 4
getpower		= 0,0
givepower		= 35,35
pausetime		= 5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-3.9
airguard.velocity	= -5.5, -1.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[State 2011, NoJuggle]
type		= ParentVarSet
trigger1		= MoveContact 
v		= 18
value		= 0

[State 2011, VarSet];Masenko limiter
type		= ParentVarSet
trigger1		= MoveHit
var(28)		= 1
ignorehitpause	= 1

[State 2011, p2state - Dizzy]
type		= Targetstate
triggerall	= root, var(26) >= 1
triggerall      = root,fVar(30)=0
trigger1	= MoveHit && NumTarget(2011)
trigger1	= (Target(2011), stateno = 5000) || (Target(2011), stateno = 5010) || (Target(2011), stateno = 5020)
value		= 7696
ID		= 2011
ignorehitpause	= 1

[State 2011, end]
type		= ChangeState
trigger1		= MoveContact = 1
value		= IfElse(var(2)<3+floor(Root, Var(26)/70),2011,2012)

[State 2011, Guardshake]
type		= EnvShake
trigger1		= MoveContact = 1 && NumTarget
Time		= 4
ampl		= 6
freq		= 176
ignorehitpause	= 1


[State 2011, End]
type		= ChangeState
trigger1		= pos x!=[-240,240]
value		= 2012

[State 2011, End]
type		= DestroySelf
triggerall	= !MoveContact
trigger1		= pos x!=[-240,240]

;-----------------------------------------
; Masenko vanishes
[Statedef 2012]
type		= A
physics		= N
MoveType	= I
velset		= 0,0
ctrl		= 0
sprpriority	= 4
MoveHitPersist	= 1
anim		= 2013		;2513 ;Empty anim, Masenko only

[State 2012, NotHitBy]
type		= NotHitBy
trigger1		= 1
Time		= 1
value		= SCA
ignorehitpause	= 1

;[State 2012, anim];explosion
;type		= ChangeAnim
;trigger1		= !Time
;value		= 2512

[State 2012, Explod];Explosion
type		= Explod
trigger1		= !Time
anim		= 2512
ID		= 2012
pos		= 0,0
postype		= p1  ;p2,front,back,left,right
removetime	= -2
pausemovetime	= 0
scale		= 1,1
sprpriority	= 5
ownpal		= 1
ignorehitpause	= 1


[State 2012, NoShadow]
type		= AssertSpecial
trigger1		= 1
flag		= NoShadow
ignorehitpause	= 1

[State 2012, NoTransparency]
type		= Trans
trigger1		= 1
trans		= none
ignorehitpause	= 1

[State 2012, End];this allows for the combo counter to not be reset.
type		= DestroySelf
trigger1		= Enemy, MoveType != H
[State 2012, End]
type		= DestroySelf
trigger1		= Root, winKO


;===================================================
; lvl 1 MASENKO UP
[Statedef 2021]
type		= A
physics		= N
MoveType	= A
ctrl		= 0
sprpriority	= 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.1
ignorehitpause = 1

[State 2021, Anim]
type		= ChangeAnim
trigger1	= !Time && !PrevStateNo
value		= 2014 ;2011

[State 1061, NoJuggle]
type		= ParentVarSet
trigger1	= Time = 0
v		= 18
value		= 1

[State 2021, hitvar]
type		= VarAdd
trigger1	= !Time
var(2)		= 1

[State 2021, MoveHitvar]
type		= VarSet
trigger1	= MoveContact && NumTarget
trigger1	= !(Target,IsHelper)
var(3)		= 1
ignorehitpause	= 1

[state 2011, lightning FX]
type = explod
trigger1 = !time && !numexplod(20110)
anim = 20140
sprpriority = 6
ID = 20110
postype = P1
pos = 0,0
ownpal = 1
bindtime = -1
removetime = -2

[State 2021, ShootingSND]
type		= PlaySnd
trigger1	= !Time && !PrevStateNo
value		= 2000,2

[State 2021, NoShadow]
type		= AssertSpecial
trigger1	= 1
flag		= NoShadow
ignorehitpause	= 1
[State 2011, UnGuardable]
type		= null;AssertSpecial
trigger1	= Root, Var(26) >= 152
flag		= UnGuardable
ignorehitpause	= 1

[State 2021, NoTransparency]
type		= Trans
trigger1	= 1
trans		= None
ignorehitpause	= 1

[State 2021, NotHitBy]
type		= NotHitBy
trigger1	= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2021, HitBy]
type		= HitBy
trigger1	= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2021, HitOverride]
type		= HitOverride
trigger1	= Time >= 0
slot		= 1
Time		= 1
stateno		= IfElse(var(2)<3+floor(Root, Var(26)/70),2021,2022)
attr		= SCA,AA,AP ;SCA, NP, SP, HP
ignorehitpause	= 1

[State 2021, Velocity]
type		= VelSet
trigger1	= 1
x		= IfElse((Time<2 && var(2)>1), 6, 12) ;1,10
y		= IfElse((Time<2 && var(2)>1),-6,-12)

[State 2021, AfterImage]
type		= AfterImage
trigger1		= !Time
Time		= 999
Timegap		= 1
framegap		= 2
length		= 5
palcontrast	= 50,50,200
trans		= Add

[State 2021, hit]
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= var(2) <=3;Root, Var(26) < 152
attr		= S,HP
hitflag		= MAFP
guardflag		= MA
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 40 < 20, 20, root,fvar(11) * 40)), 4
;Ceil(IfElse(root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)))), 4
;40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)), 4
getpower		= 0,0
givepower		= 35,35
pausetime		= 5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-5.9
airguard.velocity	= -5.5, -6.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2021, hit];MAX POWER!
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= var(2) >3;Root, Var(26) >= 152
attr		= S,HP
hitflag		= MAF
guardflag		= MA	;at max power it's unguardable anyway (assertspecial, scroll up)
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 60 < 18, 18, root,fvar(11) * 60)), 4
;Ceil(IfElse(root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)))), 4
;40-5*floor(Root, Var(26)/70)+15*(Root, Var(19)), 4
getpower		= 0,0
givepower		= 35,35
pausetime		= 5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-5.9
airguard.velocity	= -5.5, -6.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[State 2021, NoJuggle]
type		= ParentVarSet
trigger1		= MoveContact 
v		= 18
value		= 0


[State 2021, VarSet];Masenko limiter
type		= ParentVarSet
trigger1		= MoveHit
var(28)		= 1
ignorehitpause	= 1

[State 2011, p2state - Dizzy]
type		= Targetstate
triggerall	= root, var(26) >= 1
triggerall          = root,fVar(30)=0
trigger1		= MoveHit && NumTarget(2011)
trigger1		= (Target(2011), stateno = 5000) || (Target(2011), stateno = 5010) || (Target(2011), stateno = 5020)
value		= 7696
ID		= 2011
ignorehitpause	= 1

[State 2011, Dizzy effects]
type		= null;Helper
trigger1		= MoveHit && NumTarget && NumHelper(2015) < 1
trigger1		= !(Target, Time) && (Target, MoveType = H)
Helpertype	= normal
stateno		= 2015
ID		= 2015
name		= "Dizzy FX"
postype		= p2
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
ownpal		= 1
facing		= -1
size.ground.front	= 0
size.ground.back	= 0
ignorehitpause	= 1
persistent	= 0

[State 2021, end]
type		= ChangeState
trigger1		= MoveContact = 1
value		= IfElse(var(2)<3+floor(Root, Var(26)/70),2021,2022)

[State 2021, Guardshake]
type		= EnvShake
trigger1		= MoveContact = 1 && NumTarget
Time		= 4
ampl		= 6
freq		= 176
ignorehitpause	= 1

[State 2021, End]
type		= ChangeState
trigger1		= pos x!=[-240,240]
value		= 2022

[State 2021, End]
type		= DestroySelf
triggerall	= !MoveContact
trigger1		= pos x!=[-240,240]

;-----------------------------------------
; Masenko vanishes
[Statedef 2022]
type		= A
physics		= N
MoveType		= I
velset		= 0,0
ctrl		= 0
sprpriority	= 4
MoveHitPersist	= 1
anim		= 2013		;2513 ;Empty anim, Masenko only

[State 2022, NotHitBy]
type		= NotHitBy
trigger1		= 1
Time		= 1
value		= SCA
ignorehitpause	= 1

;[State 2022, anim];explosion
;type		= ChangeAnim
;trigger1		= !Time
;value		= 2512

[State 2022, Explod];Explosion
type		= Explod
trigger1		= !Time
anim		= 2512
ID		= 2012
pos		= 0,0
postype		= p1  ;p2,front,back,left,right
removetime	= -2
pausemovetime	= 0
scale		= 1,1
sprpriority	= 5
ownpal		= 1
ignorehitpause	= 1

[State 2022, NoShadow]
type		= AssertSpecial
trigger1		= 1
flag		= NoShadow
ignorehitpause	= 1

[State 2022, NoTransparency]
type		= Trans
trigger1		= 1
trans		= none
ignorehitpause	= 1

[State 2022, End];this allows for the combo counter to not be reset.
type		= DestroySelf
trigger1		= Enemy, MoveType != H
[State 2022, End]
type		= DestroySelf
trigger1		= Root, winKO

[State 2022, Angle Tilt]
type		= AngleDraw
trigger1		= 1
value		= 45
ignorehitpause	= 1

;==========================================================
; Dizzy FX - MASENKO Helper 
[Statedef 2015]
physics = N
velset = 0, 0
anim = 15999
sprpriority = 4

[State 3033, Assert]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State 3033, Pos]
type = posadd
trigger1 = 1
x = ceil(p2dist x)
y = ceil(p2dist y)

[State 1315, Dizzy Stars]
type=Explod
trigger1 = enemynear, stateno = 5300
anim = 2534
ID = 2534
sprpriority = 7
postype = p2
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
removeTime = -1
ownpal=1
ignorehitpause=1
persistent = 0
pausemoveTime = 100
supermoveTime = 100
bindTime = -1
scale = .8,.8

[State 3033, Snd]
type = PlaySnd
trigger1 = enemynear, stateno = 5300
value = 2522, IfElse(random < 500, 0, 1)
persistent = 0

[State 3033, End]
type = removeExplod
trigger1 = enemynear, ctrl
trigger2 = (enemynear, MoveType != H)
trigger3 = (enemynear, stateno != 5300)
ID = 2534

[State 3033, End]
type = DestroySelf
trigger1 = enemynear, ctrl
trigger1 = (enemynear, MoveType != H)
trigger1 = (enemynear, stateno != 5300)

;===================================================
; Lvl 2 MASENKO
[Statedef 2031]
type		= A
physics		= N
MoveType		= A
ctrl		= 0
sprpriority	= 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.3
ignorehitpause = 1

[State 2031, Anim]
type		= ChangeAnim
trigger1		= !Time && !PrevStateNo
value		= 2012

[State 2031, NoJuggle]
type		= ParentVarSet
trigger1		= Time = 0
v		= 18
value		= 1

[State 2031, HitVar]
type		= VarAdd
trigger1		= !Time
var(2)		= 1
[State 2031, MoveHitVar]
type		= VarSet
trigger1	= MoveContact && NumTarget
trigger1	= !(Target,IsHelper)
var(3)		= 1
ignorehitpause	= 1

[state 1215, rocks FX]
type = null;explod
trigger1 = time%3 = 0 ;&& time > 50 && time < 90
anim = 4209
id = 4209
pos = 0,70
postype = P1
sprpriority = 3
bindtime = 2
vel = 3,0
ownpal = 1
removetime = 20
ignorehitpause = 1

[state 2031, lightning fx]
type = explod
trigger1 = !time && !numexplod(20110)
anim = 20130
sprpriority = 6
ID = 20110
postype = P1
pos = 0,0
ownpal = 1
bindtime = -1
removetime = -2

[State 2031, Shooting SND]
type		= PlaySnd
trigger1	= !Time && !PrevStateNo
value		= 2000,6 ;5

[State 2011, NoShadow]
type		= AssertSpecial
trigger1	= 1
flag		= NoShadow
ignorehitpause	= 1
[State 2011, UnGuardable]
type		= null;AssertSpecial
trigger1	= Root, Var(26) >= 152
flag		= UnGuardable
ignorehitpause	= 1

[State 2031, Transparency]
type		= Trans
trigger1		= Root, Var(2) = 0
trans		= None
ignorehitpause	= 1

[State 2031, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2031, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2031, HitOverride];if anything happens, check this and the hitdef
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= IfElse(var(2)<3+floor(Root, Var(26)/20),2031,2032)
attr		= SCA,AA,AP ;SCA, NP, SP, HP
ignorehitpause	= 1

[State 2031, Velocity]
type		= VelSet
trigger1	= 1
x		= IfElse((Time<2 && var(2)>1),5,15)
ignorehitpause  = 0

[State 2031, AfterImage]
type		= AfterImage
trigger1		= !Time
Time		= 999
Timegap		= 1
framegap		= 2
length		= 5
palcontrast	= 50,50,200
trans		= Add

[State 2031, hit]
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= Root, Var(26) < 100
attr		= S,HP
hitflag		= MAFDP
guardflag		= MA
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 40 < 20, 20, root,fvar(11) * 40)), 4
;Ceil(IfElse(root,fvar(11) * 20-5*floor(Root, Var(26)/21)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 20-5*floor(Root, Var(26)/21)+15*(Root, Var(19)))), 3
;20-5*floor(Root, Var(26)/21)+15*(Root, Var(19)), 3
getpower		= 0,0
givepower		= 35,35
pausetime		= 4,10;5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-3.9
airguard.velocity	= -5.5, -1.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2031, hit]
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= Root, Var(26) >= 100
attr		= S,HP
hitflag		= MAFDP
guardflag		= MA
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 40 < 12, 12, root,fvar(11) * 40)), 4
getpower		= 0,0
givepower		= 35,35
pausetime		= 4,10;5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-3.9
airguard.velocity	= -5.5, -1.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[State 2031, NoJuggle]
type		= ParentVarSet
trigger1	= MoveContact 
v		= 18
value		= 0


[State 2031, VarSet];Masenko limiter
type		= ParentVarSet
trigger1		= MoveHit
var(28)		= 1
ignorehitpause	= 1

[State 2011, p2state - Dizzy]
type		= Targetstate
triggerall	= root, var(26) >= 1
triggerall          = root,fVar(30)=0
trigger1		= MoveHit && NumTarget(2011)
trigger1		= (Target(2011), stateno = 5000) || (Target(2011), stateno = 5010) || (Target(2011), stateno = 5020)
value		= 7696
ID		= 2011
ignorehitpause	= 1

[State 2011, Dizzy effects]
type		= null;Helper
trigger1		= MoveHit && NumTarget && NumHelper(2015) < 1
trigger1		= !(Target, Time) && (Target, MoveType = H)
Helpertype	= normal
stateno		= 2015
ID		= 2015
name		= "Dizzy FX"
postype		= p2
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
ownpal		= 1
facing		= -1
size.ground.front	= 0
size.ground.back	= 0
ignorehitpause	= 1
persistent	= 0


[State 2031, Change to vanish state]
type		= ChangeState
trigger1		= MoveContact = 1
value		= IfElse(var(2)<8+floor(Root, Var(26)/21),2031,2032)
;the number after the '<' determines the numbers of hits if not charged.
;var(26) tells you how much you've charged the move.
;EG if you charged it at 100, it would be:
;8 + floor (100/21) = 8 + floor (4.76) = 8 + 4 = 12 which is the max number of hits
;
;Old code:
;IfElse(var(2)<3+floor(Root, Var(26)/70),2011,2012)

[State 2031, EnvShake]
type		= EnvShake
trigger1		= MoveContact = 1 && NumTarget
Time		= 4
ampl		= 6
freq		= 176
ignorehitpause	= 1

[State 2031, End]
type		= DestroySelf
trigger1		= pos x!=[-240,240]

;-----------------------------------------
; Masenko vanishes
[Statedef 2032]
type		= A
physics		= N
MoveType		= I
velset		= 0,0
ctrl		= 0
sprpriority	= 4
MoveHitPersist	= 1
anim		= 2513 ;Empty anim, Masenko only

[State 2032, NotHitBy]
type		= NotHitBy
trigger1		= 1
Time		= 1
value		= SCA
ignorehitpause	= 1

;[State 2032, anim];explosion
;type		= ChangeAnim
;trigger1		= !Time
;value		= 2512

[State 2032, Explod];Explosion
type		= Explod
trigger1		= !Time
anim		= 2512
ID		= 2012
pos		= 0,0
postype		= p1  ;p2,front,back,left,right
removetime	= -2
pausemovetime	= 0
scale		= 1,1
sprpriority	= 5
ownpal		= 1
ignorehitpause	= 1

[State 2032, NoShadow]
type		= AssertSpecial
trigger1		= 1
flag		= NoShadow
ignorehitpause	= 1

[State 2032, NoTransparency]
type		= Trans
trigger1		= 1
trans		= none
ignorehitpause	= 1

[State 2032, End]
type		= DestroySelf
trigger1		= Enemy, MoveType != H
[State 2032, End]
type		= DestroySelf
trigger1		= Root, winKO

[State 2032, Angle Tilt]
type		= AngleDraw
trigger1		= 1
value		= 45
ignorehitpause	= 1

;===================================================
; Lvl 2 MASENKO up
[Statedef 2041]
type		= A
physics		= N
MoveType		= A
ctrl		= 0
sprpriority	= 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.3
ignorehitpause = 1

[State 2041, Anim]
type		= ChangeAnim
trigger1	= !Time && !PrevStateNo
value		= 2017 ;2012

[State 2041, NoJuggle]
type		= ParentVarSet
trigger1		= Time = 0
v		= 18
value		= 1

[State 2041, HitVar]
type		= VarAdd
trigger1		= !Time
var(2)		= 1
[State 2041, MoveHitVar]
type		= VarSet
trigger1		= MoveContact && NumTarget
trigger1		= !(Target,IsHelper)
var(3)		= 1
ignorehitpause	= 1

[state 2011, lightning FX]
type = explod
trigger1 = !time && !numexplod(20110)
anim = 20170
sprpriority = 6
ID = 20110
postype = P1
pos = 0,0
ownpal = 1
bindtime = -1
removetime = -2

[State 2041, Shooting SND]
type		= PlaySnd
trigger1		= !Time && !PrevStateNo
value		= 2000,6 ;5

[State 2041, NoShadow]
type		= AssertSpecial
trigger1		= 1
flag		= NoShadow
;flag2		= unguardable
ignorehitpause	= 1

[State 2041, Transparency]
type		= Trans
trigger1		= Root, Var(2) = 0
trans		= None
ignorehitpause	= 1

[State 2041, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2041, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2041, HitOverride];if anything happens, check this and the hitdef
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= IfElse(var(2)<3+floor(Root, Var(26)/20),2041,2042)
attr		= SCA,AA,AP ;SCA, NP, SP, HP
ignorehitpause	= 1
;stateno		= IfElse(var(2)<8+floor(Root, Var(26)/21),2031,2032)

[State 2041, Velocity]
type		= VelSet
trigger1		= 1
x		= IfElse((Time<2 && var(26)<33), 5,IfElse(var(26)<66, 9, 16));9,13
y		= IfElse((Time<2 && var(26)<33),-5,IfElse(var(26)<66,-9,-16));9,13

[State 2041, AfterImage]
type		= AfterImage
trigger1		= !Time
Time		= 999
Timegap		= 1
framegap		= 2
length		= 5
palcontrast	= 50,50,200
trans		= Add

[State 2041, hit]
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= Root, Var(26) < 100
attr		= S,HP
hitflag		= MAFP
guardflag		= MA
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 40 < 20, 20, root,fvar(11) * 40)), 4
;Ceil(IfElse(root,fvar(11) * 20-5*floor(Root, Var(26)/21)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 20-5*floor(Root, Var(26)/21)+15*(Root, Var(19)))), 3
;20-5*floor(Root, Var(26)/21)+15*(Root, Var(19)), 3
getpower		= 0,0
givepower		= 35,35
pausetime		= 4,10;5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-5.9
airguard.velocity	= -5.5, -6.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2041, hit];MAX CHARGE!
type		= HitDef
triggerall = !root,NumExplod(801)
trigger1		= Root, Var(26) >= 100
attr		= S,HP
hitflag		= MAF
guardflag		= 
priority		= 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 40 < 15, 15, root,fvar(11) * 40)), 4
;Ceil(IfElse(root,fvar(11) * 40-5*floor(Root, Var(26)/21)+15*(Root, Var(19)) < 7, 7, root,fvar(11) * 40-5*floor(Root, Var(26)/21)+15*(Root, Var(19)))), 4
;40-5*floor(Root, Var(26)/21)+15*(Root, Var(19)), 4
getpower		= 0,0
givepower		= 35,35
pausetime		= 4,10;5,13 
animtype		= Back
air.animtype	= Back
fall.animtype	= Back
ground.type	= High
air.type		= Low
ground.hittime	= 16
ground.slidetime	= 16
guard.hittime	= 16
air.hittime	= 13
airguard.ctrlTime	= 16
ground.velocity	= -5,0
guard.velocity	= -9
air.velocity	= -5.5,-5.9
airguard.velocity	= -5.5, -6.5 
ground.cornerpush.veloff	= 0
guard.cornerpush.veloff	= 0
air.cornerpush.veloff	= 0
airguard.cornerpush.veloff	= 0
yaccel		= .5
fall		= 0
air.fall		= 1
fall.recover	= 0
fall.recovertime	= 13
sparkno		= s7020
hitsound		= s1000,0
guardsound	= S6,0
EnvShake.Time	= 16
EnvShake.ampl	= 6
EnvShake.freq	= 100
forcestand	= 1
palfx.sinadd	= 64, 64, 64, 4
palfx.mul		= 128, 128, 128
palfx.Time	= 32
p1sprpriority	= 5
ID		= 2011

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[State 2041, NoJuggle]
type		= ParentVarSet
trigger1		= MoveContact 
v		= 18
value		= 0


[State 2041, VarSet];Masenko limiter
type		= ParentVarSet
trigger1		= MoveHit
var(28)		= 1
ignorehitpause	= 1

[State 2011, p2state - Dizzy]
type		= Targetstate
triggerall	= root, var(26) >= 1
triggerall          = root,fVar(30)=0
trigger1		= MoveHit && NumTarget(2011)
trigger1		= (Target(2011), stateno = 5000) || (Target(2011), stateno = 5010) || (Target(2011), stateno = 5020)
value		= 7696
ID		= 2011
ignorehitpause	= 1

[State 2011, Dizzy effects]
type		= null;Helper
trigger1		= MoveHit && NumTarget && NumHelper(2015) < 1
trigger1		= !(Target, Time) && (Target, MoveType = H)
Helpertype	= normal
stateno		= 2015
ID		= 2015
name		= "Dizzy FX"
postype		= p2
pos = -2, (enemynear,const(size.head.pos.y))-20-40*(enemynear,name="Piccolo Z2")
ownpal		= 1
facing		= -1
size.ground.front	= 0
size.ground.back	= 0
ignorehitpause	= 1
persistent	= 0

[State 2041, Change to vanish state]
type		= ChangeState
trigger1		= MoveContact = 1
value		= IfElse(var(2)<8+floor(Root, Var(26)/21),2041,2042)
;the number after the '<' determines the numbers of hits if not charged.
;var(26) tells you how much you've charged the move.
;EG if you charged it at 100, it would be:
;8 + floor (100/21) = 8 + floor (4.76) = 8 + 4 = 12 which is the max number of hits

[State 2041, EnvShake]
type		= EnvShake
trigger1		= MoveContact = 1 && NumTarget
Time		= 4
ampl		= 6
freq		= 176
ignorehitpause	= 1

[State 2041, End]
type		= ChangeState
trigger1	= pos x!=[-240,240]
value		= 2042

[State 2041, End]
type		= DestroySelf
triggerall	= !MoveContact
trigger1	= pos x!=[-240,240]

;-----------------------------------------
; Masenko vanishes (up)
[Statedef 2042]
type		= A
physics		= N
MoveType		= I
velset		= 0,0
ctrl		= 0
sprpriority	= 4
MoveHitPersist	= 1
anim		= 2513 ;Empty anim, Masenko only

[State 2042, NotHitBy]
type		= NotHitBy
trigger1		= 1
Time		= 1
value		= SCA
ignorehitpause	= 1

;[State 2042, anim];explosion
;type		= ChangeAnim
;trigger1		= !Time
;value		= 2512

[State 2042, Explod];Explosion
type		= Explod
trigger1		= !Time
anim		= 2512
ID		= 2012
pos		= 0,0
postype		= p1  ;p2,front,back,left,right
removetime	= -2
pausemovetime	= 0
scale		= 1,1
sprpriority	= 5
ownpal		= 1
ignorehitpause	= 1

[State 2042, NoShadow]
type		= AssertSpecial
trigger1		= 1
flag		= NoShadow
ignorehitpause	= 1

[State 2042, NoTransparency];why is it here then?
type		= Trans
trigger1		= 1
trans		= none
ignorehitpause	= 1

[State 2042, End]
type		= DestroySelf
trigger1		= Enemy, MoveType != H
[State 2042, End]
type		= DestroySelf
trigger1		= Root, winKO

[State 2042, Angle Tilt]
type		= AngleDraw
trigger1		= 1
value		= 45
ignorehitpause	= 1

;===================================================
; CHOU KAMEHAMEHA
[Statedef 2402]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 2100, HitCount add (only for supermoves)]
type		= ParentVarAdd
trigger1		= MoveHit
var(39)		= 1
persistent	= 0
ignorehitpause	= 1

[State -2, Explod];var for scaling CLSNs
type = VarSet
trigger1 = !PrevStateNo && !Time
var(1) = 0
[State -2, Explod];var for scaling CLSNs
type = VarAdd
trigger1 = !PrevStateNo
var(1) = 1

[State -2, Explod];Tip of Kmh FX
type = Explod
trigger1 = !numExplod(2404) && !Time
anim = 2404
removeTime = -1
sprpriority = 5
id = 2404
ownpal = 1
pos = 10,0
ignorehitpause = 1
pausemoveTime = 99999
supermoveTime = 99999
bindTime = -1
;scale = 1,1+.3*(root,stateno = 3015)

[State -2, Explod];On hands Explod
type = ModifyExplod
trigger1 = WinKO && MatchOver
scale = 1.5,1.5
ID = 2404

[State -2, Explod];Tip of Kmh FX
type = RemoveExplod
trigger1 = root,stateno != 2401
id = 2404

[State 800, VarSet];Charging Time
type = VarSet
trigger1 = !Time
var(25) = Root, Var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 3005, hitvar]
type=VarAdd
trigger1= !Time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 2011, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2011, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= 2402
attr		= SCA,AA,AP ;SCA, NP, SP, HP
ignorehitpause	= 1

[State 3005, anim]
type = ChangeAnim
trigger1 = !Time && !PrevStateNo && !MoveContact
value = 2405

[State 3005, anim]
type = ChangeAnim
trigger1 = MoveContact
value = 2405
elem = var(1)
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = 1
x = IfElse((Time<2 && var(2)>1),1,16)

[state 2402, hitadd]
type = hitadd
triggerall = numtarget
triggerall = var(2) > 1
triggerall = root,var(9) > 1
trigger1 = movehit
value = ifelse(root,var(9)=2,1,2)

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)=0
triggerall = var(25)<20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAFP
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 8, 8, root,fvar(11) * 23))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
guard.dist = 10000
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),20-(random%40)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
id = 2402

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)=0
triggerall = var(25)>=20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 8, 8, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),20-(random%40)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
id = 2402

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)>0
triggerall = var(25)<20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
guard.dist = 10000
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 19 < 8, 8, root,fvar(11) * 19))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),20-(random%40)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
id = 2402

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)>0
triggerall = var(25)>=20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 19 < 8, 8, root,fvar(11) * 19))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),20-(random%40)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
id = 2402

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 3025, p2state - killed]
type = Targetstate
triggerall = NumEnemy < 2
trigger1 = MoveHit && NumTarget
trigger1 = MatchOver
trigger1 = WinKO
value = IfElse((Target, SelfAnimExist(5941)), 5941, 5943)
ignorehitpause = 1

[State 3005, end]
type = ChangeState
trigger1 = MoveContact = 1 ;this, remember this "= 1" part to make the hitsparks work.
value = IfElse(var(2)<20+var(25),2402,1316)

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 2401

;===================================================
; CHOU KAMEHAMEHA FX Helper - SCALED BEAM
[Statedef 2464]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 3
anim = 2464

[State 1061, End]
type = VarAdd
trigger1 = root,stateno = 2401
trigger2 = root,stateno = 2461
var(0) = 1
ignorehitpause = 1

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2401
trigger2 = root,stateno = 2403
pos = 72,-58
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2401
trigger1 = !MatchOver
scale = (50.0 + abs(pos X - (Helper(2402),pos X)))/58.0 , 1    ;60+...
value = 0
ignorehitpause = 1

;Scale Up when Killing the Opponent
[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2401
trigger1 = WinKO && MatchOver
scale = (70.0 + abs(pos X - (Helper(2402),pos X)))/60.0 , 1.5
value = 0
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2403
scale = 10 , IfElse(1-0.05*(Time-var(0))<0, 0, 1-0.05*(Time-var(0)))
value = 0
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 2401
trigger1 = root,stateno != 2403

;------------------------------------------------
; Big Ball Beam Collision
[Statedef 2483]
type    = S
MoveType= A
physics = N
anim = 15999
sprpriority = 7

[state 17100,move ball FX]
type = Posset
trigger1 = 1
X = floor(160.0*((root,fvar(20))-.5))*(root,facing)
Y = -47

[State -2, Explod];Big Ball at center
type = Explod
trigger1 = !numExplod(2483) && !Time
anim = 2483
removeTime = -1
sprpriority = 6
id = 2483
bindTime = -1
ownpal = 1
postype = p1
pos = 0,0
scale = .45,.45
ignorehitpause = 1
pausemoveTime = 99999
supermoveTime = 99999
facing = root,facing

[State 1305, Timevar]
type = VarAdd
trigger1 = root,stateno != 2489
var(4) = 1

[State 1305, Scale Explod]
type = ModifyExplod
trigger1 = root,stateno = 2489
scale = 0.7+.1*(Time-var(4)),0.7+.1*(Time-var(4))
ID = 2483

[State 13100, explosion SND]
type = PlaySnd
trigger1 = root,stateno = 2489
trigger1 = Time-var(4) = 0
value = 2483,0
volume = 255

[State 2260, destroy]
type = RemoveExplod
trigger1 = root,stateno != 2481
trigger1 = root,stateno != 2489

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno != 2481
trigger1 = root,stateno != 2489


;====================================
; Broken Back - BG Arms + legs
[Statedef 245947]
type = S
MoveType = H
physics = N
velset = 0,0
anim = 5947

[State 2260, bind]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, destroy]
type = DestroySelf
trigger1 = Time = 126


;===================================================
; SDU AftImg
[StateDef 2207]; SOARING DRAGON UNLEASHED DASH TRAINEE 
type = S
MoveType = I
physics = N
ctrl = 0
anim = 2105

[State 13001, Anim]
type = ChangeAnim
trigger1 = anim!= (root,anim)
value = root, anim

[State 13001, Pos]
type = BindToRoot
trigger1 = Time = 0
Time = -1
facing = 1

[State 13001, Pos];No push
type = PlayerPush
trigger1 = 1
value = 0

[State 13001, NoVis]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 13001, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA

[State 13001, Aftimg]
type = AfterImage
trigger1 = Time = 0
Time = 900
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 13001, EndImg]
type = AfterImageTime
trigger1 = Root, Stateno != [2200,2220]
Time = 1

[State 13001, End]
type = DestroySelf
trigger1 = Root, Stateno != [2200,2220]


;===================================================
; Lvl 2 CHOU MASENKO 
[Statedef 2311]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2353;2311

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 2356
attr = SCA, NP, SP, HP,AA,AP,AT
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
trigger1 = Time >8
fvar(13) = 0.85
ignorehitpause = 1



[State 13100, bind]
type = bindtoroot
trigger1 = 1
pos = 35,-60

[State 13100, goes SND]
type = PlaySnd
trigger1 = !Time
value = 2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time < 24;AnimElemTime(21) < 0   ;25
attr = S,HP
hitflag = MAFDP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 26 < 10, 10, root,fvar(11) * 26)), 1
;Ceil(IfElse(root,fvar(11) * (21+4*(Root, Var(19))) < 7, 7, root,fvar(11) * (21+4*(Root, Var(19))))), 1
;ceil((21+4*(Root, Var(19)))*root,fvar(15)), 1
getpower = 0,0
givepower = 10,10
pausetime = 3,3
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.hittime = 10
ground.slidetime = 10
guard.hittime = 10
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= 1.5,0
guard.velocity = -2
air.velocity = -2,-1
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
sparkxy =-35-(random%10),5-(random%10)
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 10
EnvShake.ampl = 6
EnvShake.freq = 70
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time = 24;AnimElemTime(21) >= 0
attr = S,HP
hitflag = MAFDP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 20 < 10, 10, root,fvar(11) * 20)), 2
;Ceil(IfElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) * 20)), 2
;20,2
getpower = 0,0
givepower = 35,35
pausetime = 9,10
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -12,-4
guard.velocity = -6
air.velocity= -10,-5
airguard.velocity = -6.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
sparkxy =-35-(random%10),5-(random%10)
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[state 2311, dissipate]
type = changeanim
trigger1 = time = 25
value = 2356

[State 3001, Guardshake]
type = EnvShake
trigger1 = MoveContact=1 && NumTarget
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = anim = 2356 && !animTime
trigger2 = root,stateno != 2310

;===================================================
; Lvl 2 CHOU MASENKO DEATH
[Statedef 2356]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2356

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = !animtime||time>16
;===================================================
; Lvl 2 CHOU MASENKO DEATH UP
[Statedef 2357]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2357

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = !animtime||time>16

;===================================================
; Lvl 2 CHOU MASENKO UP
[Statedef 2321]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2355;2321

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 2357
attr = SCA, NP, SP, HP,AA,AP,AT
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
trigger1 = Time >8
fvar(13) = 0.85
ignorehitpause = 1

[State 13100, bind]
type = bindtoroot
trigger1 = 1
pos = 7,-96

[State 13100, goes SND]
type = PlaySnd
trigger1 = !Time
value = s2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time < 24;AnimElemTime(21) < 0
attr = S,HP
hitflag = MAFP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 25 < 10, 10, root,fvar(11) * 25)), 1
;Ceil(IfElse(root,fvar(11) * (21+4*(Root, Var(19))) < 7, 7, root,fvar(11) * (21+4*(Root, Var(19))))), 1
;ceil((21+4*(Root, Var(19)))*root,fvar(15)), 1
getpower = 0,0
givepower = 10,10
pausetime = 3,3
animtype = Back
air.animtype = Back
fall.animtype = Back
;animtype = DiagUp
;air.animtype = DiagUp
;fall.animtype = DiagUp
ground.type = High
air.type = High
ground.hittime = 10
ground.slidetime = 10
guard.hittime = 10
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= 1.5,0
guard.velocity = -2
air.velocity = .5,.5  ;1.2,1.2
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall = 0
air.fall = 0
fall.recover = 0
sparkno = s7020
sparkxy = 35-(random%10),-20-(random%10)
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 10
EnvShake.ampl = 6
EnvShake.freq = 70
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time = 24;AnimElemTime(21) >= 0
attr = S,HP
hitflag = MAFP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 20 < 10, 10, root,fvar(11) * 20)), 2
;Ceil(IfElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) * 20)), 2
;20,2
getpower = 0,0
givepower = 35,35
pausetime = 9,10
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -12,-4
guard.velocity = -6
air.velocity= -12,-5
airguard.velocity = -6.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
sparkxy = 0,-50
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[state 2311, dissipate]
type = changeanim
trigger1 = time = 25
value = 2357

[State 3001, Guardshake]
type = EnvShake
trigger1 = MoveContact=1 && NumTarget
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = anim = 2357 && !animTime
trigger2 = root,stateno != 2320

;===================================================
; Lvl 1 CHOU MASENKO 
[Statedef 2341]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2352 ;2341

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 2356
attr = SCA, NP, SP, HP,AA,AP,AT
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.85
ignorehitpause = 1

[State 13100, bind]
type = bindtoroot
trigger1 = 1
pos = 35,-60

[State 13100, goes SND]
type = PlaySnd
trigger1 = !Time
value = s2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time < 17;AnimElemTime(15) < 0
attr = S,HP
hitflag = MAFDP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 19 < 7, 7, root,fvar(11) * 19)), 1
;Ceil(IfElse(root,fvar(11) * (21+4*(Root, Var(19))) < 7, 7, root,fvar(11) * (21+4*(Root, Var(19))))), 1
;ceil((21+4*(Root, Var(19)))*root,fvar(15)), 1
getpower = 0,0
givepower = 10,10
pausetime = 3,3
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.hittime = 10
ground.slidetime = 10
guard.hittime = 10
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= 1.5,0
guard.velocity = -2
air.velocity = -2,-1
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
sparkxy =-35-(random%10),5-(random%10)
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 10
EnvShake.ampl = 6
EnvShake.freq = 70
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time = 17
attr = S,HP
hitflag = MAFDP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) * 20)), 2
;Ceil(IfElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) * 20)), 2
;20,2
getpower = 0,0
givepower = 35,35
pausetime = 9,10
animtype = Low
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -12,-4
guard.velocity = -6
air.velocity= -10,-5
airguard.velocity = -6.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
sparkxy =-35-(random%10),5-(random%10)
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[state 2311, dissipate]
type = changeanim
trigger1 = time = 24
value = 2356
elem = 3

[State 3001, Guardshake]
type = EnvShake
trigger1 = MoveContact=1 && NumTarget
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = anim = 2356 && time = 31
trigger2 = root,stateno != 2340

;===================================================
; Lvl 1 CHOU MASENKO UP
[Statedef 2351]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2354;2351

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = 2357
attr = SCA, NP, SP, HP,AA,AP,AT
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
value = SCA,NA,SA,HA,NT,ST,HT
time = 1
ignorehitpause = 1

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 0.85
ignorehitpause = 1

[State 13100, bind]
type = bindtoroot
trigger1 = 1
pos = 7,-96

[State 13100, goes SND]
type = PlaySnd
trigger1 = !Time
value = s2000,3

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time < 17;AnimElemTime(15) < 0
attr = S,HP
hitflag = MAFP
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 19 < 7, 7, root,fvar(11) * 19)), 1
;Ceil(IfElse(root,fvar(11) * (21+4*(Root, Var(19))) < 7, 7, root,fvar(11) * (21+4*(Root, Var(19))))), 1
;ceil((21+4*(Root, Var(19)))*root,fvar(15)), 1
getpower = 0,0
givepower = 10,10
pausetime = 3,3
animtype = Back
air.animtype = Back
fall.animtype = Back
;animtype = DiagUp
;air.animtype = DiagUp
;fall.animtype = DiagUp
ground.type = High
air.type = High
ground.hittime = 10
ground.slidetime = 10
guard.hittime = 10
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= 1.5,0
guard.velocity = -2
air.velocity = .5,.5  ;1.2,1.2
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall = 0
air.fall = 0
fall.recover = 0
sparkno = s7020
sparkxy = 2-(random%4),-50-(random%10)
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 10
EnvShake.ampl = 6
EnvShake.freq = 70
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
trigger1 = time = 17;AnimElemTime(15) >= 0
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) * 20)), 2
;Ceil(IfElse(root,fvar(11) * 20 < 7, 7, root,fvar(11) * 20)), 2
;20,2
getpower = 0,0
givepower = 35,35
pausetime = 9,10
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -12,-4
guard.velocity = -6
air.velocity= -12,-5
airguard.velocity = -6.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
sparkxy = 0,-50
guard.sparkno = s7000
hitsound   = s1000,0
guardsound = S6,0
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 2103, Super BG Proj]
type = Projectile
triggerall = RoundState = 2
trigger1 = MoveHit = 1
ProjID = 3000    ;Ki attack
projAnim = 15999
projremoveTime = 1
ignorehitpause = 1

[state 2311, dissipate]
type = changeanim
trigger1 = time = 24
value = 2357
elem = 3

[State 3001, Guardshake]
type = EnvShake
trigger1 = MoveContact=1 && NumTarget
Time = 4
ampl = 6
freq = 176
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = anim = 2357 && !animTime
trigger2 = root,stateno != 2350

;===================================================
; AIR CHOU KAME Helper DOWN
[Statedef 2602]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = Time = 0
v = 18
value = 1

[State 2100, HitCount add (only for supermoves)]
type		= ParentVarAdd
trigger1		= MoveHit
var(39)		= 1
persistent	= 0
ignorehitpause	= 1


[State -2, Explod];var for scaling CLSNs
type = VarSet
trigger1 = !PrevStateNo && !Time
var(1) = 0
[State -2, Explod];var for scaling CLSNs
type = VarAdd
trigger1 = !PrevStateNo
var(1) = 1

[State 2011, NotHitBy]
type		= NotHitBy
trigger1		= Time >= 0
Time		= 1
value		= SCA, NA, SA, HA, NT, ST, HT
ignorehitpause	= 1

[State 2011, HitBy]
type		= HitBy
trigger1		= Time >= 0
value		= SCA, NP, SP, HP
Time		= 1
ignorehitpause	= 1

[State 2011, HitOverride]
type		= HitOverride
trigger1		= Time >= 0
slot		= 1
Time		= 1
stateno		= 2602
attr		= SCA, NP, SP, HP
ignorehitpause	= 1

[State 3000, Kamehameha FX beam]
type = Helper
trigger1 = !NumHelper(2606) && !Time
Helpertype = normal
stateno = 2606
ID = 2606
name = "tip-chouKmh"
postype = p1
pos = 0,0
ownpal = 1

[State -2, Explod];Tip of Kmh FX
type = RemoveExplod
trigger1 = root,stateno != 2601
id = 2404

[State 800, VarSet];Charging Time
type = VarSet
trigger1 = !Time
var(25) = Root, Var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 3005, hitvar]
type=VarAdd
trigger1= !Time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 3005, anim]
type = ChangeAnim
trigger1 = !Time && !PrevStateNo && !MoveContact
value = 2602

[State 3005, anim]
type = ChangeAnim
trigger1 = MoveContact && AnimElemTime(12)<0
value = 2602
elem = var(1)+1
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = Time<45 && pos Y < -80
x = IfElse((Time<2 && var(2)>1),1,10)
y = IfElse((Time<2 && var(2)>1),1,7)

[State 1061, Velocity]
type = VelSet
trigger1 = Time >= 45
trigger2 = pos Y >= -80
x = 0
y = 0

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)=0
triggerall = var(25)<20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = A,HP
hitflag = MAFP
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 12, 12, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),ceil(enemynear, const(size.mid.pos.y))+80 ;IfElse(p2bodydist y <0,0-(random%20),80-(random%20))
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)=0
triggerall = var(25)>=20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = A,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 12, 12, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 8, 8, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),80-(random%20)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)>0
triggerall = var(25)<20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = A,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 19 < 8, 8, root,fvar(11) * 19))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 7, 7, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),ceil(enemynear, const(size.mid.pos.y))+80 ;IfElse(p2bodydist y <0,0-(random%20),80-(random%20))
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)>0
triggerall = var(25)>=20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = A,HP
hitflag = MAF
guardflag = 
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 19 < 8, 8, root,fvar(11) * 19))), 2
;IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 23 < 8, 8, root,fvar(11) * 23))), 2
;IfElse(var(2)>=20,8,ceil(23*root,fvar(15))), 2
getpower = 0,0
givepower = 20,20
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),80-(random%20)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 1061, NoJuggle]
type = ParentVarSet
trigger1 = MoveContact 
v = 18
value = 0

[State 3025, p2state - killed]
type = Targetstate
triggerall = NumEnemy < 2
trigger1 = MoveHit && NumTarget
trigger1 = MatchOver
trigger1 = WinKO
value = 5946
ignorehitpause = 1

[State 3005, end]
type = ChangeState
trigger1 = MoveContact
value = IfElse(var(2)<20+var(25),2602,1316)

[State 1000, hit ground]
type = Helper
Helpertype = normal
triggerall = !NumHelper(2615)
trigger1 = pos y>=-80 && !MoveContact
name = "air_chou_kmh_hit_ground"
ownpal = 1
stateno = 2615
id = 2615

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 2601
trigger1 = root,stateno != 2610

;===================================================
; AIR CHOU KAME DOWN FX Helper - ON HANDS
[Statedef 2603]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 4
anim = 2403

[State 1061, End]
type = VarAdd
trigger1 = root,stateno = 2601
var(0) = 1
ignorehitpause = 1

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2601
pos = 25,-51
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = !MatchOver
trigger1 = root,stateno = 2601
value = -35
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 2601
value = -35
scale = 1,1.5
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2610
scale = 1 , 1-0.05*(Time-var(0))
value = -35
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 2601
trigger1 = root,stateno != 2610

;===================================================
; AIR CHOU KAME FX Helper - SCALED BEAM
[Statedef 2604]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 3
anim = 2464

[State 1061, End]
type = VarAdd
trigger1 = root,stateno = 2601
var(0) = 1
ignorehitpause = 1

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1


[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2601
pos = 48,-36
ignorehitpause = 1
[State 1061, End]
type = bindtoroot
trigger1 = root,stateno = 2610
pos = 43,-25
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = !MatchOver
trigger1 = root,stateno = 2601
scale = (40.0 + abs(pos X - (Helper(2602),pos X)))/60.0 , 1
value = -35
ignorehitpause = 1

[State 1061, save var]
type = VarSet
trigger1 = NumHelper(2602)
fvar(1) = Helper(2602),pos X
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = root,stateno = 2610
scale = (40.0 + abs(pos X - fvar(1)))/60.0, 1-0.05*(Time-var(0))
value = -35
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 2601
scale = 50,1.5
value = -35
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 2601
trigger1 = root,stateno != 2610

;===================================================
; AIR CHOU KAME DOWN FX Helper - TIP OF BEAM
[Statedef 2606]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 2404

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 1061, End]
type = bindtoParent
trigger1 = root,stateno = 2601
pos = -34,76
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = !MatchOver
trigger1 = root,stateno = 2601
trigger2 = root,stateno = 2610
value = -35
scale = 1,1
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
triggerall = WinKO && MatchOver
trigger1 = root,stateno = 2601
trigger2 = root,stateno = 2610
value = -35
scale = 1.5,1.5
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 2601
trigger1 = root,stateno != 2610
trigger2 = MatchOver

;==========================================================
; AIR CHOU KAME Helper - Hitting ground
[Statedef 2615]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 9
velset = 0,0

[State 1010, ParentVarAdd - for 'dmg dampening']
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

;[State 2100, HitCount add (only for supermoves)]
;type		= ParentVarAdd
;trigger1		= MoveHit
;var(39)		= 1
;persistent	= 0
;ignorehitpause	= 1

[State 1061, bind]
type = bindtoparent
trigger1 = !Time
pos = 60,85


[State 3005, anim]
type = ChangeAnim
trigger1 = !Time
value = 2615

[State 1061, NoShadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
Time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
Time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
Time = 1
stateno = 1316
attr = SCA,AA,AP ;SCA, NP, SP, HP
ignorehitpause = 1

[State 1315, image]
type = AfterImage
trigger1 = !Time
Time = 999
Timegap = 1
framegap = 2
length = 5
palcontrast = 50,50,200
trans = add

[State 3005, hit]
type = HitDef
triggerall = enemy, Pos Y >= root,Pos Y -10
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)=0
trigger1 = animelem=1 && !MoveHit
trigger2 = animelem=2 && !MoveHit
trigger3 = animelem=3 && !MoveHit
trigger4 = animelem=4 && !MoveHit
attr = A,HP
hitflag = MAFDP
guardflag = MA;HA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 35 < 7, 7, root,fvar(11) * 35)), 4
;Ceil(IfElse(root,fvar(11) * 35 < 7, 7, root,fvar(11) * 35)), 4
;ceil(35*root,fvar(15)), 4
getpower = 0,0
givepower = 35,35
pausetime = 1,6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -6, -7
guard.velocity = -8
air.velocity = -4,-9
airguard.velocity = -4, -1.5 
down.velocity = 0,0
down.hittime = 20
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 3005, hit]
type = HitDef
triggerall = enemy, Pos Y >= root,Pos Y -10
triggerall = !root,NumExplod(801)
triggerall = root,fVar(27)>0
trigger1 = animelem=1 && !MoveHit
trigger2 = animelem=2 && !MoveHit
trigger3 = animelem=3 && !MoveHit
trigger4 = animelem=4 && !MoveHit
attr = A,HP
hitflag = MAFDP
guardflag = MA;HA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 30 < 7, 7, root,fvar(11) * 30)), 4
;Ceil(IfElse(root,fvar(11) * 35 < 7, 7, root,fvar(11) * 35)), 4
;ceil(35*root,fvar(15)), 4
getpower = 0,0
givepower = 35,35
pausetime = 1,6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -6, -7
guard.velocity = -8
air.velocity = -4,-9
airguard.velocity = -4, -1.5 
down.velocity = 0,0
down.hittime = 20
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=1
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7020
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[state 17100, Hit Ground Effect]
type=Explod
trigger1 = Time = 10
trigger2 = Time = 20
anim=17100
id=17100
pos= -10,-5
postype=P1
sprpriority=8
ownpal=1
supermoveTime=-1
removeTime = -2
scale = 1.3,1.1

[state 17100, Wave Effect]
type=Explod
trigger1 = Time = 10
trigger2 = Time = 20
anim=2205+(Root, Var(2)=1)
id=2205
pos= 0,0
postype=P1
sprpriority=9
ownpal=1
supermoveTime=-1
removeTime = -2
scale = 1.3,1.1

[State 3055, end]
type = PlaySnd
trigger1 = Time = 5
trigger2 = Time = 10
trigger3 = Time = 15
trigger4 = Time = 20
value = s1000,0

[State 3055, end]
type = DestroySelf
trigger1 = !animTime
trigger2 = Enemy, StateNo = 5946



;======================================================================
; Air Chou Kamehameha - No Push Dummy
[Statedef 2650]
ctrl	= 0

[State 2650, ChangeAnim]
type = ChangeAnim
trigger1	= 1
value	= Parent, Anim
elem	= Parent, AnimElemNo(0)

[State 2650, PlayerPush]
type	= PlayerPush
trigger1	= 1
value	= 1

[State 2650, BindToParent]
type	= BindToParent
trigger1	= !Time
time	= -1
facing	= 1

[State 2650, AssertSpecial]
type	= AssertSpecial
trigger1	= 1
flag	= NoShadow
flag2	= Invisible

[State 2650, NotHitBy]
type	= NotHitBy
trigger1	= !Time
value	= SCA
time	= -1

[State 2650, Remove]
type	= DestroySelf
trigger1	= Parent, StateNo != [2600,2610]

;======================================================================




;------------------------------------------------
; Diagonal white foreground Chou Kamehameha fatality Up
[Statedef 5945]
type    = S
MoveType= I
physics = N
anim = 5944
sprpriority = 8

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, rotate]
type = AngleDraw
trigger1 = 1
value = 150

[State 2260, destroy]
type = DestroySelf
trigger1 = !animTime

;------------------------------------------------
; Diagonal white foreground Chou Kamehameha fatality Down
[Statedef 5947]
type    = S
MoveType= I
physics = N
anim = 5944
sprpriority = 8

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, rotate]
type = AngleDraw
trigger1 = 1
value = -150

[State 2260, destroy]
type = DestroySelf
trigger1 = !animTime

;===================================================
; Kinton Cloud intro
[Statedef 19300]
type    = S
MoveType= A
physics = N
anim = 19300
sprpriority = 2

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, BindToRoot]
type = BindToRoot
trigger1 = root,anim = 193
Time = 1
pos = -5,3
ignorehitpause =  1

[State 0, velset]
type = SprPriority
trigger1 = Time = 270
value = -4

[State 181, cloud leaves]
type = PlaySnd
trigger1 = root,anim = 0
value = 193, 2
channel = 8
persistent = 0

[State 0, velset]
type = VelAdd
trigger1 = root,anim = 0
X = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = Time = 500
trigger2 = Ishelper
trigger2 = Parent,Stateno = 740

;===================================================
; Kinton Cloud intro (for Goten)
[Statedef 702]
type    = S
MoveType= A
physics = N
anim = 19300
sprpriority = 2

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, BindToRoot]
type = BindToRoot
trigger1 = root,anim = 193
Time = 1
pos = -5,3
ignorehitpause =  1

[State 0, velset]
type = SprPriority
trigger1 = Time = 310
value = -4

[State 181, cloud leaves]
type = PlaySnd
trigger1 = root,anim = 0
value = 193, 2
channel = 8
persistent = 0

[State 0, velset]
type = VelAdd
trigger1 = root,anim = 0
X = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = Time = 500
trigger2 = Ishelper
trigger2 = Parent,Stateno = 740
;===================================================
; Goten on Kinton Cloud intro
[Statedef 701]
type    = S
MoveType= A
physics = N
anim = 701
sprpriority = 1

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, BindToRoot]
type = BindToRoot
trigger1 = anim = [701,703]
Time = 1
pos = 0,0
ignorehitpause = 1

[State 0, to jump]
type = ChangeAnim
trigger1 = Time = 230
trigger2 = anim=702 && !animTime
trigger3 = anim=703 && !animTime
value = anim+1

[State 100, jump SND]
type = PlaySnd
trigger1 = Time=235
value = 40,1

[State 4003, velset fly]
type = velset
trigger1 = anim=704
x = 12

[State 181, Goten yell 1]
type = PlaySnd
trigger1 = anim = 702
trigger1 = AnimElemTime(1) = 0
value = 700, 2*(Root, Var(55)>=1)

[State 181, Goten yell 2]
type = PlaySnd
trigger1 = anim = 704
trigger1 = AnimElemTime(1) = 0
value = 700, 1+2*(Root, Var(55)>=1)

[State 115, dash Sound]
type = PlaySnd
trigger1 = anim = 704
trigger1 = AnimElemTime(1) = 0
value = 100,0

[State 2260, destroy]
type = DestroySelf
trigger1 = pos X != [-500,500]
trigger2 = Ishelper
trigger2 = Parent,Stateno = 740

;==========================================================
; FACEBOOK MAIN SCREEN Helper
[Statedef 18100]
physics = N
velset = 0, 0
anim = 15999
sprpriority = 4

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = NoShadow

[state 17100, main screen]
type=Explod
trigger1 = !Time && !numExplod(18105)
anim=18100
id=18100
pos= 0,0
postype=P1
sprpriority=6
ownpal=1
supermoveTime=-1
removeTime = -1
scale = 0.5,0.5

[State 1415, fade in]
type = modifyExplod
trigger1 = Time<52
trans = addalpha
alpha = 5*(Time), 256-5*(Time)
ID = 18100

[state 17100, new post]
type=Explod
triggerall = Root, Var(34) = 1
trigger1 = Time = 350;230
anim=18101
id=18101
pos= 0,0
postype=P1
sprpriority=9
ownpal=1
supermoveTime=-1
removeTime = -1
scale = 0.5,0.5

[state 17100, new post]	;Profile Pic
type=Explod
triggerall = Root, Var(34) = 1
trigger1 = Time = 350;230
anim=18103
id=18101
pos= 0,0
postype=P1
sprpriority=9
ontop = 1
ownpal=1
supermoveTime=-1
removeTime = -1
scale = 0.5,0.5

[state 17100, people like]
type=Explod
triggerall = Root, Var(34) = 1
trigger1 = Time = 380;260
anim=18102
id=18102
pos= 0,0
postype=P1
sprpriority=9
ownpal=1
supermoveTime=-1
removeTime = -1
scale = 0.5,0.5

[State 17100, Like Sound]
type = PlaySnd
triggerall = Root, Var(34) = 1
trigger1 = Time = 380;260
trigger2 = Time = 440;300
trigger3 = Time = 490;350
value = 181, 6
persistent = 1

;==========================================================
; FACEBOOK MOVING SCREEN Helper
[Statedef 18120]
physics = N
velset = 0, 0
anim = 15999
sprpriority = 5

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = NoShadow

[State 17100, choose anim]
type = VarSet
trigger1 = !Time
var(1) = random%18

[state 17100, moving screen]
type=Explod
trigger1 = !Time && !numExplod(18120)
anim = 18120+var(1)
id=18120
pos= 0,0
postype=P1
sprpriority=7
ownpal=1
supermoveTime=-1
removeTime = -1
scale = 0.5,0.5

[State 1415, fade in]
type = modifyExplod
trigger1 = Time<52
trans = addalpha
alpha = 5*(Time), 256-5*(Time)
ID = 18120

[State 17100, new post Sound]
type = PlaySnd
triggerall = Root, Var(34) = 1
trigger1 = Time = 320;200
value = 181, 5

[State 1415, fade in]
type = removeExplod
trigger1 = Time=320 && Root, Var(34)=1;200
ID = 18120

[state 17100, moving screen]
type=Explod
triggerall = Root, Var(34) = 1
trigger1 = Time = 320;200
anim = 18120+var(1)
id=18121
pos= 0,0
postype=P1
sprpriority=7
ownpal=1
supermoveTime=-1
removeTime = 27
scale = 0.5,0.5
vel = 0,3

[state 17100, moving screen]
type=Explod
triggerall = Root, Var(34) = 1
trigger1 = Time = 347;227
anim = 18120+var(1)
id=18122
pos= 0,81
postype=P1
sprpriority=8
ownpal=1
supermoveTime=-1
removeTime = -1
scale = 0.5,0.5
vel = 0,0

;==========================================================
; Saiyaman Fade In Helper
[Statedef 18210]
physics = N
velset = 0, 0
anim = 18210 + Root, Var(16)
sprpriority = 2

[State 181, 1]
type = Offset
trigger1 = 1
Y = 2

[state 17100, face]
type = Explod
trigger1 = !Time
anim = 18205 + Root, Var(16)
id = 18205
pos = 0,0
bindTime = -1
postype = P1
sprpriority = 3
ownpal = 1
supermoveTime = -1
removeTime = 29
persistent = 0
scale = 1,1
ownpal = 0

[State 1415, fade in]
type = modifyExplod
trigger1 = Time>0
trans = addalpha
alpha = ceil(9.14*Time), ceil(9.14*Time)
ID = 18205

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
pos = 0,0
ignorehitpause =  1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = NoShadow

[State 1415, fade in]
type = trans
trigger1 = Time>0
trans = addalpha
alpha = ceil(9.14*Time), ceil(9.14*Time)

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = Time=29

;==========================================================
; Diagonal Lines BG - Gekiretsu Ranbu
[Statedef 2774]
type = A
MoveType = A
physics = N
anim = 2774
velset = 0,0
sprpriority = -1

[State 2260, rotate]
type = Angledraw
trigger1 = 1
value = 45

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash] ;eh? I could remove this. It's strange to see.
type = null;PalFX	;I mean, why was this a thing?
trigger1 = TimeMod = 4,0
trigger1 = 1
Time = 1
invertall = 1
ignorehitpause = 0

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno != [2770,2773]
trigger2 = NumHelper(19875)

;==========================================================
; Diagonal Lines BG - Gekiretsu Ranbu - FINISHER 1
[Statedef 3022]
type = A
MoveType = A
physics = N
anim = 2774
velset = 0,0
sprpriority = -1

[State 2260, rotate]
type = Angledraw
trigger1 = 1
value = 45

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = Null;PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
Time = 1
invertall = 1
ignorehitpause = 0

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno != 3020
trigger2 = NumHelper(19875)

;==========================================================
; Kibito
[Statedef 711]
physics = N
velset = 0, 0
anim = 711
sprpriority = -1

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
pos = 65,0
ignorehitpause =  1

[state 17100, eye blink]
type=Explod
trigger1 = Time = 70
trigger2 = Time = 170
trigger3 = Time = 270
anim = 713
id = 713
pos = -1,0
postype=P1
sprpriority=0
ownpal=1
supermoveTime=-1
removeTime = -2

[State 10230, eye blink Sound]
type = PlaySnd
trigger1 = Time = 70
trigger2 = Time = 170
trigger3 = Time = 270
value = 710,0

[state 17100, smile]
type=Explod
trigger1 = Time = 300
anim = 714
id = 714
pos = -1,0
postype=P1
sprpriority=0
ownpal=1
supermoveTime=-1
removeTime = -1

[State 0, remove smile]
type = removeExplod
trigger1 = Time = 350
ID = 714

[State 0, teleport]
type = ChangeAnim
trigger1 = Time = 350
value = 712

[State 17100, Teleport Sound]
type = PlaySnd
triggerall = anim=712
trigger1 = animelem=2
value = 2302, 0

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = anim=712 && !animTime
trigger2 = Ishelper
trigger2 = Parent,Stateno = 740

;==========================================================
; Superman Intro - clothes flying
[Statedef 725]
physics = N
velset = 0, -4
anim = 724
sprpriority = 2

[State 0, BindToRoot]
type = BindToRoot
trigger1 = !Time
pos = -10,70
ignorehitpause =  1

[State 0, VelMul]
type = VelMul
trigger1 = anim = 724
Y = 0.95

[State 0, caught]
type = ChangeAnim
trigger1 = Time = 48
value = 727

[State 0, caught]
type = velset
trigger1 = Time = 48
X = -15
Y = 0

;==========================================================
; Icarus
[Statedef 18600]
physics = N
velset = 2, 10
anim = 18600
sprpriority = -1

[State 0, BindToRoot]
type = BindToRoot
trigger1 = !Time
pos = 0,-200
ignorehitpause =  1

[State 0, to shadow land]
type = ChangeAnim
trigger1 = Time = 15
value = 18601

[State 0, BindToRoot]
type = BindToRoot
trigger1 = anim >= 18601
pos = 20,0
ignorehitpause =  1

[State 0, to shadow land]
type = ChangeAnim
trigger1 = anim=18601 && !animTime
trigger2 = anim=18602 && !animTime
trigger3 = anim=18603 && !animTime
value = anim+1

[state 1215, Smoke FX]
type = Explod
trigger1 = anim=18601 && AnimElemTime(1)=0
anim = 1206+(1)
pos = -30,0
postype = P1
sprpriority = 0
removeTime = -2
persistent = 0
ignorehitpause = 0

[state 1215, Smoke FX reversed]
type = Explod
trigger1 = anim=18601 && AnimElemTime(1)=0
anim = 1206+(1)
pos = 30,0
postype = P1
sprpriority = 0
removeTime = -2
persistent = 0
ignorehitpause = 0
facing = -1

[State 100, Icarus sound]
type = PlaySnd
trigger1 = anim=18604 && (Time-169)%49=0
value = 186,1
persistent = 1

;==========================================================
; UNLEASHED GAUGE Helper P1
[Statedef 2850]
physics = N
velset = 0, 0
sprpriority = 7
anim = 15999

[State 3033, Assert]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State -2, Blue Bar]
type = Explod
triggerall = !NumExplod(2851)
trigger1 = root,fvar(27)!=0
trigger1 = root,fvar(28)<300
anim = 2851
pos = 50+(Root, Var(45)),234-(Root, Var(46)) 
postype = left
removeTime = -1
supermove = 1
sprpriority = 8
id = 2851
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999

[State -2, scale blue bar]
type = ModifyExplod
triggerall= root,fvar(28) < 300
trigger1 = NumExplod(2851)
scale = ifelse(root,fvar(28)<=100, (root,fvar(28))/100.0, ifelse(root,fvar(28)>100 && root,fvar(28)<=200, (root,fvar(28)-100)/100.0, (root,fvar(28)-200)/100.0)),1
id = 2851

[State -2, remove blue bar]
type = RemoveExplod
trigger1 = root,fvar(28) >= 300
trigger2 = root,fvar(27) = 0
id = 2851

[State -2, Flashing Bar]
type = Explod
triggerall = !NumExplod(2852)
trigger1 = root,fvar(27)!=0
trigger1 = root,fvar(28)>=300
anim = 2852
pos = 50+(Root, Var(45)),234-(Root, Var(46)) 
postype = left
removeTime = -1
supermove = 1
sprpriority = 8
id = 2852
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999

[State -2, remove flashing bar]
type = RemoveExplod
trigger1 = root,fvar(28)<300
trigger2 = root,fvar(27)=0
id = 2852

[State -2, Unleashed Gauge]
type = Explod
trigger1 = !NumExplod(2850) && root,fvar(27)!=0
anim = 2850
pos = 50+(Root, Var(45)),234-(Root, Var(46)) 
;pos = 30+(Root, Var(45)),228-(Root, Var(46))
postype = left
removeTime = -1
supermove = 1
sprpriority = 9
id = 2850
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999

[state 17100, remove unleashed gauge]
type = removeExplod
trigger1 = root,fvar(27) != 1
id = 2850
;---------------------------
[State -2, LVL 0]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) < 100 
trigger1 = !NumExplod(2780) 
anim = 3780
pos = 131+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3780
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 0]
type = removeexplod
trigger1 = root,fvar(28) >= 100
trigger2 = root,fvar(27) = 0
id = 3780
ignorehitpause = 1

[State -2, LVL 1]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 100 && root,fvar(28) < 200 
trigger1 = !NumExplod(3781) 
anim = 3781
pos = 131+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3781
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 1]
type = removeexplod
trigger1 = root,fvar(28) >= 200 
trigger2 = root, fvar(28) < 100
trigger3 = root,fvar(27) = 0
id = 3781
ignorehitpause = 1

[State -2, LVL 2]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 200 && root,fvar(28) < 300 
trigger1 = !NumExplod(3782) 
anim = 3782
pos = 131+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3782
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 2]
type = removeexplod
trigger1 = root,fvar(28) >= 300 
trigger2 = root, fvar(28) < 200
trigger3 = root,fvar(27) = 0
id = 3782
ignorehitpause = 1

[State -2, MAX]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 300
trigger1 = !NumExplod(3783) 
anim = 3783
pos = 133+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3783
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove MAX]
type = removeexplod
trigger1 = root,fvar(27) = 0 
trigger2 = root,fvar(28) < 300
id = 3783
ignorehitpause = 1
;--------------------------

[State -2, LVL 0]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) < 100 
trigger1 = !NumExplod(2780) 
anim = 2880
pos = 19+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2780
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 0]
type = removeexplod
trigger1 = root,fvar(28) >= 100
trigger2 = root,fvar(27) = 0
id = 2780
ignorehitpause = 1

[State -2, LVL 1]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 100 && root,fvar(28) < 200 
trigger1 = !NumExplod(2781) 
anim = 2881
pos = 19+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2781
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 1]
type = removeexplod
trigger1 = root,fvar(28) >= 200 
trigger2 = root, fvar(28) < 100
trigger3 = root,fvar(27) = 0
id = 2781
ignorehitpause = 1

[State -2, LVL 2]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 200 && root,fvar(28) < 300 
trigger1 = !NumExplod(2782) 
anim = 2882
pos = 19+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2782
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 2]
type = removeexplod
trigger1 = root,fvar(28) >= 300 
trigger2 = root, fvar(28) < 200
trigger3 = root,fvar(27) = 0
id = 2782
ignorehitpause = 1

[State -2, MAX]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 300
trigger1 = !NumExplod(2783) 
anim = 2883
pos = 19+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2783
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove MAX]
type = removeexplod
trigger1 = root,fvar(27) = 0 
trigger2 = root,fvar(28) < 300
id = 2783
ignorehitpause = 1

[State -2, Unleashed Gauge Fading]
type = Explod
trigger1 = !NumExplod(2853) && root,fvar(27)=0
anim = 2853
pos = 40+(Root, Var(45)),234-(Root, Var(46)) 
postype = left
removeTime = 14
supermove = 1
scale = 0.5,0.5
sprpriority = 7
id = 2853
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999
persistent = 0

[State 3033, End]
type = DestroySelf
trigger1 = root,fvar(27) != 1 && !numExplod(2853)

;==========================================================
; UNLEASHED GAUGE Helper P2
[Statedef 2860]
physics = N
velset = 0, 0
sprpriority = 7
anim = 15999

[State 3033, Assert]
type = assertspecial
trigger1 = 1
flag = invisible
ignorehitpause = 1

[State -2, blue bar]
type = Explod
trigger1 = !NumExplod(2861) && root,fvar(27)!=0 && root,fvar(28)<300
anim = 2861
pos = 262-(Root, Var(45)),234-(Root, Var(46))
postype = left
removeTime = -1
supermove = 1
sprpriority = 8
id = 2861
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999

[State -2, scale blue bar]
type = ModifyExplod
triggerall = root,fvar(28) < 300
trigger1 = NumExplod(2861)
scale = ifelse(root,fvar(28)<=100, (root,fvar(28))/100.0, ifelse(root,fvar(28)>100 && root,fvar(28)<=200, (root,fvar(28)-100)/100.0, (root,fvar(28)-200)/100.0)),1
id = 2861

[State -2, Explod];Flashing white or not Blue bar
type = RemoveExplod
trigger1 = root,fvar(28)>=300
trigger2 = root,fvar(27) = 0
id = 2861

[State -2, flashing bar]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = !NumExplod(2862)
trigger1 = root,fvar(28)>=300
anim = 2862
pos = 262-(Root, Var(45)),234-(Root, Var(46))
postype = left
removeTime = -1
supermove = 1
sprpriority = 8
id = 2862
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999

[State -2, remove flashing bar]
type = RemoveExplod
trigger1 = root,fvar(28)<300
trigger2 = root,fvar(27) = 0
id = 2862

;------------------------------
[State -2, LVL 0]
type = Explod
triggerall = root,fvar(28) < 100
trigger1 = !NumExplod(3780) 
anim = 3780
pos = 182+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3780
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 0]
type = removeexplod
trigger1 = root,fvar(28) >= 100 
trigger2 = root,fvar(27) = 0
id = 3780
ignorehitpause = 1

[State -2, LVL 1]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 100 && root,fvar(28) < 200 
trigger1 = !NumExplod(3781) 
anim = 3781
pos = 182+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3781
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVl 1]
type = removeexplod
trigger1 = root,fvar(28) >= 200 
trigger2 = root, fvar(28) < 100
trigger3 = root,fvar(27) = 0
id = 3781
ignorehitpause = 1

[State -2, LVL 2]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 200 && root,fvar(28) < 300 
trigger1 = !NumExplod(2782) 
anim = 3782
pos = 182+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3782
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 2]
type = removeexplod
trigger1 = root,fvar(28) >= 300 
trigger2 = root, fvar(28) < 200
trigger3 = root,fvar(27) = 0
id = 3782
ignorehitpause = 1

[State -2, MAX]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 300
trigger1 = !NumExplod(2783) 
anim = 3783
pos = 181+(root,var(45)),233-(root,var(46))
postype = left
removetime = -1
scale = 0.6,0.6
sprpriority = 5
id = 3783
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove MAX]
type = removeexplod
trigger1 = root,fvar(28) < 300
trigger2 = root,fvar(27) = 0
id = 3783
ignorehitpause = 1
;------------------------------

[State -2, unleashed gauge]
type = Explod
trigger1 = !NumExplod(2860) && root,fvar(27)!=0
anim = 2860
pos = 262-(Root, Var(45)),234-(Root, Var(46))
postype = left
removeTime = -1
supermove = 1
sprpriority = 9
id = 2860
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999

[state 17100, remove unleashed gauge]
type = removeExplod
trigger1 = root,fvar(27)=0
id = 2860

[State -2, LVL 0]
type = Explod
triggerall = root,fvar(28) < 100
trigger1 = !NumExplod(2780) 
anim = 2880
pos = 282+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2780
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 0]
type = removeexplod
trigger1 = root,fvar(28) >= 100 
trigger2 = root,fvar(27) = 0
id = 2780
ignorehitpause = 1

[State -2, LVL 1]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 100 && root,fvar(28) < 200 
trigger1 = !NumExplod(2781) 
anim = 2881
pos = 282+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2781
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVl 1]
type = removeexplod
trigger1 = root,fvar(28) != [100,199]
trigger2 = root,fvar(27) = 0
id = 2781
ignorehitpause = 1

[State -2, LVL 2]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) = [200,299]
trigger1 = !NumExplod(2782) 
anim = 2882
pos = 282+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2782
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove LVL 2]
type = removeexplod
trigger1 = root,fvar(28) != [200,299]
trigger2 = root,fvar(27) = 0
id = 2782
ignorehitpause = 1

[State -2, MAX]
type = Explod
triggerall = root,fvar(27) = 1
triggerall = root,fvar(28) >= 300
trigger1 = !NumExplod(2783) 
anim = 2883
pos = 282+(root,var(45)),225-(root,var(46))
postype = left
removetime = -1
scale = 1,1
sprpriority = 5
id = 2783
bindtime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 195, remove MAX]
type = removeexplod
trigger1 = root,fvar(28) < 300
trigger2 = root,fvar(27) = 0
id = 2783
ignorehitpause = 1

[State -2, unleashed gauge fading]
type = Explod
trigger1 = !NumExplod(2863) && root,fvar(27)=0
anim = 2863
pos = 280-(Root, Var(45)),234-(Root, Var(46))
postype = left
removeTime = 14
supermove = 1
sprpriority = 7
id = 2863
bindTime = -1
ontop = 1
ownpal = 1
ignorehitpause = 1
pausemoveTime = 999999
supermoveTime = 999999
persistent = 0

[State 3033, End]
type = DestroySelf
trigger1 = root,fvar(27) != 1 && !numExplod(2863)


;===================================================
; MEGA MASENKO TRAVELLING
[Statedef 3025]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5

[State 1010, ParentVarAdd - for 'dmg dampening']
type = null;ParentVarAdd
trigger1 = MoveHit
trigger1 = P2MoveType = H
fvar(13) = 1
ignorehitpause = 1

[State 3005, anim]
type = ChangeAnim
trigger1 = !Time && !PrevStateNo
value = 3025

[State 3005, POS]
type = posset
trigger1 = !Time && !PrevStateNo
X = ifelse(root,facing = 1,-270,270) ;IfElse(root,facing=1,-620,620)
Y = 200 ;540

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 3005, hitvar]
type=null;VarAdd
trigger1= !Time
var(2)=1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 1061, Velocity]
type = VelSet
trigger1 = !prevstateno
trigger1 = time = 2
x = 10 
y = -10

[state 1061, vel]
type = velset
trigger1 = time = 30 ;26
x = 0.45 ;1
y = -0.45 ;-1

[state 3025, hit sound]
type = playsnd
trigger1 = time = [30,117]
value = s1000,0
persistent = 3

[state 3025, final hit sound]
type = playsnd
trigger1 = time = 118
value = s1000,1

[state 0, hitadd]
type = hitadd
trigger1 = time = [30,118]
value = 1
persistent = 3

[state 3025, hit spark]
type = explod
trigger1 = time = [30,118]
anim = 7010+10*(random%3) ;7030
sprpriority = 6
postype = P2
pos = 5-random%20,-35-random%30
persistent = 3

[State 3005, hit];not last hit
type = null;HitDef
triggerall = !root,NumExplod(801)
triggerall = var(2)<32
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 5 < 5, 5, root,fvar(11) * 5)), 1
;Ceil(IfElse(root,fvar(11) * 3 < 3, 3, root,fvar(11) * 3)), 1
;ceil(3*root,fvar(15)),1
getpower = 0,0
givepower = 20,20
pausetime = 2,6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -1,-1
guard.velocity = -8
air.velocity = -5.5,-7.9
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-random%40,-20+random%40
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
kill = var(2)>=24
ID = 3025

[State 3005, hit];last hit
type = null;HitDef
triggerall = !root,NumExplod(801)
triggerall = var(2)=32
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = Ceil(IfElse(root,fvar(11) * 7 < 7, 7, root,fvar(11) * 7)), 3
;Ceil(IfElse(root,fvar(11) * 5 < 5, 5, root,fvar(11) * 5)), 3
;5,3
getpower = 0,0
givepower = 20,20
pausetime = 9,10
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
airguard.ctrlTime = 16
ground.velocity= -1,-1
guard.velocity = -8
air.velocity = -5.5,-15
airguard.velocity = -3.5, -3.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=0
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 10-random%20,-20+random%20
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
ID = 3025

[State 3005, go back to same state]
type = null;ChangeState
trigger1 = root,stateno = 3020
trigger1 = !animtime ;MoveContact
value = 3025

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno = 3030


;======================================================================
;EXPLODING PUNCH DEBRIS Helper
[Statedef 3125]
type    = S
MoveType= I
physics = N
anim = 15999

[State 200, debris falling]
type = PlaySnd
trigger1 = Time=50
value = 3125,0
volume = 300
persistent = 0

[State 1000, Helper]
type = Helper
trigger1 = Time>60 && NumHelper(3126)<10 && NumHelper(3127)<10
Helpertype = Normal
name = "debris_generator"
id = 3126
pos = 0,0
postype = p2
facing = 1
stateno = 3126
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = Time > 70
;-------------------------------
;Debris Generator
[Statedef 3126]
type = A
MoveType = I
physics = N
anim = 15999

[State 800, size]
type = VarSet
trigger1 = !Time
fvar(0) = 0.1*(random%6)

[State 1003, Helper]
type = Helper
trigger1 = !Time
Helpertype = Normal
name = "debris2"
id = 3127
pos = -60+12*(random%15),-300+10*(random%10)
postype = p2
facing = 1
stateno = 3127
keyctrl = 0
ownpal = 1
supermoveTime = 9999
pausemoveTime = 9999
ignorehitpause = 1
size.xscale = 0.3+fvar(0)
size.yscale = 0.3+fvar(0)

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = Time=2
;-----------
;debris2
[Statedef 3127]
type = A
MoveType = I
physics = N
anim = 3127
velset = 0, 0.5 + 0.2*(random%6)
sprpriority = 3

[state 17100, smoke]
type = null;Explod
trigger1 = !Time
anim = 5930+random%2
id = 5930
pos = 0,10
postype = P1
sprpriority = 3
ownpal = 0
removeTime = -1
bindTime = -1

[State 1406, No Shadow]
type = AssertSpecial
trigger1 = 1
flag = NoShadow

[State 1415, Hit Floor]
type = trans
trigger1 = Time>190 && Time<216
trans = addalpha
alpha = 256-9*(Time-190), 9*(Time-190)

[State 1415, trans]
type = modifyExplod
trigger1 = Time>190 && Time<216
trans = addalpha
alpha = 256-9*(Time-190), 9*(Time-190)
ID = 5930

[State 1406, No Shadow]
type = RemoveExplod
trigger1 = Time >=216
ID = 5930

[State 1003, DestroySelf]
type = DestroySelf
trigger1 = Time >=216




;===================================================
; Goten for Finisher 3 : Team Kamehameha

; Goten appears
[Statedef 3210]
type    = A
MoveType= A
physics = N
anim = 3210
sprpriority = 4

[State 0, VarSet]
type = VarSet
trigger1 = root,StateNo = 2400
trigger1 = root, Var(9) != 0
var(9) = 1

[State 250, teleport sound]
type = PlaySnd
trigger1 = !Time
value = 2302, 0

[State 3005, POS]
type = posset
trigger1 = root, Var(9) = 0
trigger1 = !Time
X = -20*facing
Y = -60

[State 1100, 2]
type = VelSet
trigger1 = AnimElemTime(2) = 0
x = -2
[State 1100, 2]
type = VelMul
trigger1 = AnimElemTime(2) >= 0
x = 0.95

[State 280, go]
type = VelAdd
trigger1 = AnimElemTime(2) >= 0
Y = 0.4

[State 1000, land]
type = ChangeState
;Triggerall = AnimElemTime(4) > 0 
trigger1 = Vel Y + Pos Y >= 0
value = 3211
ctrl = 0

;------------------------------------
; Goten for Finisher 3 : lands

[Statedef 3211]
type    = S
MoveType= A
physics = N
anim = 3211
sprpriority = 3
velset = 0,0

[State -3, Pos]
type = PosSet
trigger1 = !Time
Y = 0

[State -3, Landing Sound]
type = PlaySnd
trigger1 = !Time
value = 40, 0

[state 17100, Landing Effect]
type = Explod
trigger1 = !Time
anim = 17100
id = 17100
pos = 0,0
postype = P1
sprpriority = -3
ownpal = 1
supermoveTime = -1
scale = 0.6, 0.6

[State 0, Explod]
type = Explod
trigger1 = root, fvar(28) = 300
trigger1 = Time = 5
anim = 4004
ID = 4004
pos = 0,0
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = -1
sprpriority = 5
persistent = 0
supermovetime = 99999


[State 1000, to charge]
type = ChangeState
trigger1 = !animTime
value = 3212
ctrl = 0

;------------------------------------
; Goten for Finisher 3 : charges

[Statedef 3212]
type    = S
MoveType= A
physics = S
anim = 3212
sprpriority = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = root, fvar(28) = 300
trigger1 = !Time
value = 4007

[State 0, Explod]
type = Explod
trigger1 = root, fvar(28) = 300
trigger1 = !Time
anim = 4009
ID = 4009
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
sprpriority = 4
supermovetime = 99999


[State 200, Superpause sound]
type = PlaySnd
trigger1 = Time=5
value = 2350,0   ;or 2400,1 for Kmh charge long

[State 0, Charge Ball FX]
type = Explod
trigger1 = Time = 5
anim = 2420+10000*(var(2)=0)
id = 3212
pos = -18,-35
postype = p1
supermoveTime = 9999
pausemoveTime = 9999
supermove = 1
removeTime = -1
sprpriority = 5
ownpal = 1
bindTime = -1
scale = 0.6,0.6
persistent = 0

[state 17100, scale charge FX]
type = null;modifyExplod
trigger1 = numExplod(3212)
scale = 0.6+0.002*(Time-20),0.6+0.002*(Time-20)
id = 3212

[State 0, Charge lightning FX]
type = Explod
trigger1 = Time = 5
anim = 2430
id = 2430
pos = -18,-32
postype = p1
supermoveTime = 9999
pausemoveTime = 9999
supermove = 1
removeTime = -1
sprpriority = 5
ownpal = 1
bindTime = -1
scale = 1,1
persistent = 0

[State 1000, to launch]
type = ChangeState
trigger1 = Cond(root, Var(9) != 0, Time >= 160,Time >= 180)
value = 3213
ctrl = 0

;------------------------------------
; Goten for Finisher 3 : launches

[Statedef 3213]
type    = S
MoveType= A
physics = S
anim = 3213
sprpriority = 4

[state -2, remove charge ball FX Chou Kmh]
type = removeExplod
trigger1 = !Time
id = 3212
[state -2, remove lightning FX]
type = removeExplod
trigger1 = !Time
id = 2430
[state -2, remove ssj hair]
type = removeExplod
trigger1 = !Time
id = 4009

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = root, fvar(28) = 300
trigger1 = !Time
value = 4008

[State 0, Explod]
type = Explod
trigger1 = root, fvar(28) = 300
trigger1 = !Time
anim = 4010
ID = 4010
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
sprpriority = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = root, Anim = 4017
value = 4019
persistent = 0

[state -2, remove ssj hair]
type = removeExplod
trigger1 = root, Anim = 4017
id = 4010

[state 3213] ;Goten leaves if Gohan is hit
type = changestate
trigger1 = root,movetype = H
value = 3214
ignorehitpause = 1

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = Time=4
value = 2401,1

[state 1215, Smoke FX]
type = Explod
trigger1 = animelem=3
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 9
ownpal = 1
removeTime = -2
persistent = 0
ignorehitpause = 1

[State 3000, Kamehameha]
type = Helper
trigger1 = animelem=3
Helpertype = normal
stateno = 3221
ID = 3221
name = "ckameha"
postype = p1
pos = 30,-34
ownpal = 1
;size.yscale = 0.7
persistent = 0

[State -2, Explod];On hands Explod
type = Explod
triggerall = !numExplod(3213)
trigger1 = animelem=3
anim = 2403
removeTime = 250
sprpriority = 7
id = 3213
ownpal = 1
pos = 38,-34
ignorehitpause = 1
bindTime = -1
;scale = 0.7, 0.7
persistent = 0
[State 0, dissipate]
type = ModifyExplod
trigger1 = root, Var(9) != 0
trigger1 = root,stateno = 2403
;trigger1 = Time > 55
scale = 1, IfElse(1-0.05*(Time-47)<0, 0, 1-0.05*(Time-47))
ID = 3213
pos = 38,-34
postype = p1  ;p2,front,back,left,right
removetime = 100

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = root, Anim = 4017
id = 3213

[State 3000, Kamehameha FX beam]
type = Helper
trigger1 = animelem=3
Helpertype = normal
stateno = 3222  ;2464
ID = 3222       ;2464
name = "ckamehaFX_scale_beam"
postype = p1
pos = 41,-34
ownpal = 1
;size.yscale = 0.7
persistent = 0

;jump away!
[State 901, ChangeAnim]
type = ChangeState
triggerall = root,var(9)!=0
;triggerall = Time = 60
;trigger1 = root, StateNo != [3200,3300]
trigger1 = root, stateno = 2403 && root,time = 21
value = 3214
ctrl = 0

;move out of screen
[State 901, ChangeAnim]
type = ChangeState
trigger1 = root, StateNo = [3200,3300]
trigger1 = Time = 100
value = 3226
ctrl = 0

;-----------------------------
;Goten Moving out of screen while throwing Team Chou Kamehameha

[Statedef 3226]
type = S
physics = S
MoveType = A
ctrl = 0
velset = -7,0
sprpriority = 6

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 1061, Velocity]
type = VelSet
trigger1 = Time < 100
x = -12
[State 1061, Velocity]
type = VelSet
trigger1 = Time = 100
x = 0

[state -2, remove ssj hair]
type = removeExplod
trigger1 = root,stateno = 3240
id = 4010

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno = 3240


;===================================================
; CHOU KAMEHAMEHA Helper [FINISHER 3]

[Statedef 3221]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5+3*((parent,stateno = 3213) || (parent,stateno = 3226))

[State 0, SprPriority]
type = SprPriority
trigger1 = root, Anim = 4017
value = -5

[State 0, BindToRoot]
type = BindToRoot
triggerall = Anim = 4015
trigger1 = root, StateNo = 3220
trigger2 = root, StateNo = 3225
trigger2 = root, Time < 34
pos = 0,-70

[State 0, VelSet]
type = VelSet
trigger1 = Anim = 4015
trigger1 = root, StateNo = 3225
trigger1 = root, Time >= 34
x = -12

[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4015
trigger1 = root, StateNo = 3225
trigger1 = root, Time = [14,34]
scale = 1.5,1
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4015
trigger1 = root, StateNo = 3225
trigger1 = root, Time >= 35
scale = 2,1

[State -2, Explod];Tip of Kmh FX
type = Explod
trigger1 = !numExplod(2404) && !Time
trigger1 = root, Anim != 4017
anim = 2404
removeTime = -1
sprpriority = 5+3*((parent,stateno = 3213) || (parent,stateno = 3226))
id = 2404
ownpal = 1
pos = 10, 0
ignorehitpause = 1
bindTime = -1
scale = 1-0.1*((parent,stateno = 3213) || (parent,stateno = 3226)),1-0.2*((parent,stateno = 3213) || (parent,stateno = 3226))

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = root, Anim = 4017
id = 3204

[State 800, VarSet];Charging Time
type = VarSet
trigger1 = !Time
var(25) = Root, Var(25)

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 3005, hitvar]
type=VarAdd
trigger1= !Time
var(2)=1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[State 1061, NoShadow]
type = Trans
trigger1 = 1
trans = none
ignorehitpause = 1

[State 3005, anim]
type = ChangeAnim
trigger1 = !Time
value = 2405

[State 3005, anim]
type = ChangeAnim
trigger1 = root, Anim = 4017
trigger1 = Anim != 4015
value = 4015
persistent = 0

[State 3005, anim]
type = ChangeAnim
trigger1 = Anim = 4015
trigger1 = root, StateNo = 3225
trigger1 = root, Time = 70
value = 4020

[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time < 410
scale = 2,1

[State 0, PosAdd]
type = PosAdd
trigger1 = Anim = 4020
x = 200
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = Anim = 4020
trigger1 = (pos x!=[-640,640])
x = 0

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "pos x = %f  vel x = %f"
params = pos x,vel x
;ignorehitpause = 
;persistent = 


[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [410,419]
scale = 2,1.1
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [420,429]
scale = 2,1.2
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [430,439]
scale = 2,1.3
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [440,449]
scale = 2,1.4
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [450,459]
scale = 2,1.5
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [460,469]
scale = 2,1.6
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [470,479]
scale = 2,1.7
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [480,489]
scale = 2,1.8
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [490,499]
scale = 2,1.9
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [500,509]
scale = 2,2
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [510,519]
scale = 2.1,2.1
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [520,529]
scale = 2.2,2.2
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [530,539]
scale = 2.3,2.3
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [540,549]
scale = 2.4,2.4
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [550,559]
scale = 2.5,2.5
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [560,569]
scale = 2.6,2.6
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [570,579]
scale = 2.7,2.7
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [580,589]
scale = 2.8,2.8
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time = [590,599]
scale = 2.9,2.9
[State 0, AngleDraw]
type = AngleDraw
trigger1 = Anim = 4020
trigger1 = Time >= 600;,609]
scale = 3.4,3.4

[State 0, Explod]
type = Explod
trigger1 = !NumExplod(4015)
trigger1 = Anim = 4015
anim = 4016
ID = 4015
pos = 0,30
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
sprpriority = 5
persistent = 0



[state 1061, vel] ;cinematic version
type = velset
trigger1 = !numhelper(2402)
trigger1 = root, Anim != 4017
x = 16
[state 1061, vel] ;non-cinematic version
type = velset
trigger1 = numhelper(2402)
x = ifelse(helper(2402),var(2) > 1,1,16)

[State 3005, hit]
type = null;HitDef
triggerall = !root,NumExplod(801)
triggerall = var(25)<20
trigger1 = facing=1 && (root,pos X - enemy,pos X)<0 
trigger2 = facing=-1 && (root,pos X - enemy,pos X)>0 
attr = S,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
damage = IfElse(var(2)>=20,8,Ceil(IfElse(root,fvar(11) * 8 < 1, 1, root,fvar(11) * 8))), 2
getpower = 0,0
givepower = 1,1
pausetime = 1*(var(2)<20+var(25)),6
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.hittime = 16
ground.slidetime = 16
guard.hittime = 16
air.hittime = 13
guard.dist = 10000
airguard.ctrlTime = 16
ground.velocity= IfElse(var(2)<20+var(25), -2, -10), IfElse(var(2)<20+var(25), 0, -3)
guard.velocity = -9
air.velocity = -5.5,-3.9
airguard.velocity = -5.5, -1.5 
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
yaccel = .5
fall=(var(2)>=20+var(25))
air.fall = 1
fall.recover = 0
fall.recovertime = 13
sparkno = s7030
sparkxy = 20-(random%40),20-(random%40)
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
forcestand = 1
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
id = 2402

[State 1061, End]
type = RemoveExplod
trigger1 = root,stateno != 3220 && root,Var(9)=0
trigger1 = root,stateno != 3225 && root,Var(9)=0
trigger2 = NumHelper(3227)
trigger3 = root, Var(9) != 0 && Time >30
trigger4 = parent, StateNo = 3327
trigger5 = root, Anim = 4017
ID = 2404

[State 1061, End]
type = RemoveExplod
trigger1 = root,stateno != 3220 && root,Var(9)=0
trigger1 = root,stateno != 3225 && root,Var(9)=0
trigger2 = NumHelper(3227)
trigger3 = root, Var(9) != 0 &&  Time >30
trigger4 = parent, StateNo = 3327
trigger5 = root, Anim = 4017
ID = 3213

[State 1061, End]
type = RemoveExplod
trigger1 = root,stateno != 3220 && root,Var(9)=0
trigger1 = root,stateno != 3225 && root,Var(9)=0
trigger2 = NumHelper(3227)
trigger3 = root, Var(9) != 0 &&  Time >30
trigger4 = parent, StateNo = 3327
trigger5 = Anim = 4020
ID = 4015

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 3220 && root,Var(9)=0
trigger1 = root,stateno != 3225 && root,Var(9)=0
trigger2 = NumHelper(3227)
trigger3 = root, Var(9) != 0 && Time >30
trigger4 = parent, StateNo = 3327
;trigger5 = root, Anim = 4017

;===================================================
; CHOU KAMEHAMEHA FX Helper - SCALED BEAM [FINISHER 3]

[Statedef 3222]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 3+3*((parent,stateno = 3213) || (parent,stateno = 3226))-1*(parent,stateno = 4001)
anim = 2464

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 1061, bind Gohan]
type = bindtoroot
trigger1 = parent,stateno = 3220
trigger2 = parent,stateno = 3225
pos = 72,-54
ignorehitpause = 1

[State 1061, bind Goten]
type = bindtoparent
trigger1 = parent,stateno = 3213
trigger2 = parent,stateno = 3226
pos = 60,-34
ignorehitpause = 1

[state 1061, bind Goku]
type = null;bindtoparent
trigger1 = parent,stateno = 4001
;trigger2 = parent,stateno = 
pos = 72,-64
ignorehitpause = 1

[State 1061, End]
type = AngleDraw
trigger1 = NumHelper(3221)
;scale = (60.0 + abs(pos X - (Helper(3221),pos X)))/75.0 , 1
scale = (80.0 + abs(pos X - (Helper(3221),pos X)))/85.0 , 1
value = 0
ignorehitpause = 1

[State 1061, End] ;dissipate
type = AngleDraw
trigger1 = root, Var(9) != 0
trigger1 = root,stateno = 2403
;scale = 80, IfElse(0.7-0.035*(Time-43)<0, 0, 0.7-0.035*(Time-43))
scale = 80, IfElse(1-0.05*(Time-43)<0, 0, 1-0.05*(Time-43)) ;ifelse(1-0.035*(time-43)<0, 0, 1-0.035*(time-43))
value = 0
ignorehitpause = 1

[State 1061, End]
type = DestroySelf
trigger1 = root,stateno != 3220 && root,Var(9)=0
trigger1 = root,stateno != 3225 && Var(9)=0
trigger2 = NumHelper(3227)
trigger3 = root, Var(9) != 0 && Time >90
trigger4 = parent, StateNo = 3327
trigger5 = parent,stateno = 3214
trigger6 = root, Anim = 4017




;------------------------------------------------
; Team Kamehameha Horizontal Lines BG
[Statedef 3224]
type = A
MoveType = A
physics = N
anim = 15999
velset = 0,0

[State 2260, push]
type = PlayerPush
trigger1 = Time >= 0
value = 0

[State 2260, muteki]
type = NotHitBy
trigger1 = 1
value = SCA

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, flash]
type = PalFX
trigger1 = TimeMod = 4,0
trigger1 = 1
Time = 1
invertall = 1
ignorehitpause = 0

[state 3250, speedlines]
type = Explod
trigger1 = Time = 0
anim = 2923
ID = 2923
postype = back
pos = 0,10
bindTime = -1
supermove = 0
sprpriority = 1
ontop = 0
ownpal = 1
ignorehitpause = 1
removeTime = -1

[state 3250, speedlines2]
type = Explod
trigger1 = Time = 0
anim = 2923
ID = 2923
postype = back
pos = 0,240
bindTime = -1
supermove = 0
sprpriority = 1
ontop = 0
ownpal = 1
ignorehitpause = 1
removeTime = -1

[State 2260, destroy]
type = RemoveExplod
trigger1 = root,stateno=3241
ID = 2923

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno = 3241

;===================================================
; GOHAN FIXED BEAM [FINISHER 3]

[Statedef 3227]
type = A
physics = N
MoveType = A
ctrl = 0
anim = 2464

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 8000, pos]
type = PosSet
trigger1 = !Time
X = -200*facing

[State 1061, End]
type = AngleDraw
trigger1 = 1
scale = 5
value = 0
ignorehitpause = 1

[State 8000, pos]
type = VelSet
trigger1 = Time=20
X = -5

[State 8000, pos]
type = VelSet
;trigger1 = Time=96
trigger1 = abs(abs(pos X)-445) <= 5
X = 0

[State 8000, Speed-up Timer]
type = VarAdd
trigger1 = Time > 130
fvar(1) = 0.005

[State -2, Explod];Tip of Kmh FX
type = Explod
trigger1 = !Time
anim = 2404
removeTime = -1
id = 2404
ownpal = 1
pos = 335, 0
ignorehitpause = 1
bindTime = -1
scale = 1,1

[State 1061, rise up]
type = posadd
trigger1 = Time>108 && Time%2
Y = -1
persistent = 1

[State 1061, floats]
type = posadd
trigger1 = Time%floor(1+3.0/(1.0+fvar(1)))=0 
Y = 15*sin((1.0+fvar(1))*Time*pi/16)
persistent = 1

[State 1061, sprpriority]
type = sprpriority
trigger1 = sin((1.0+fvar(1))*Time*pi/16) >= 0
value = 3
[State 1061, sprpriority]
type = sprpriority
trigger1 = sin((1.0+fvar(1))*Time*pi/16) < 0
value = 8

[State 1061, sprpriority tip of beam]
type = ModifyExplod
trigger1 = sin((1.0+fvar(1))*Time*pi/16) >= 0
sprpriority = 4
ID = 2404
[State 1061, sprpriority tip of beam]
type = ModifyExplod
trigger1 = sin((1.0+fvar(1))*Time*pi/16) < 0
sprpriority = 9
ID = 2404

[State 3000, Twirl FX]
type = Helper
trigger1 = Time = 150
Helpertype = normal
stateno = 3229
ID = 3229
name = "twirl"
postype = p1
pos = 405,0
ownpal = 1

[State 10000, Explod]; White FG - flash and fade
type = Explod
trigger1 = Time = 232-28
anim = 18230
id = 18230
pos =  160,120
postype = left
sprpriority = 7
ontop = 1
facing = 1
bindTime = -1
ownpal = 1
removeTime = -2
pausemoveTime = 99999999999999
supermoveTime = 99999999999999
supermove = 1
scale = 1.20,1.20
ignorehitpause = 1
persistent = 0

[State 3000, Twirl + Beam FX]
type = Helper
trigger1 = Time = 232
Helpertype = normal
stateno = 3231
ID = 3231
name = "beam_twirl"
postype = p1
pos = 450,0
ownpal = 1

[State -2, Explod];Twirl front
type = RemoveExplod
trigger1 = NumHelper(3231)
ID = 2404

[State 2260, destroy]
type = DestroySelf
trigger1 = NumHelper(3231) && !numExplod(2404)

;===================================================
; GOTEN FIXED BEAM [FINISHER 3]

[Statedef 3228]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 6
anim = 2464

[State 8000, Assert]
type=assertspecial
trigger1= 1
flag=NoShadow
ignorehitpause = 1

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 8000, pos]
type = PosSet
trigger1 = !Time
X = -200*facing

[State 1061, End]
type = AngleDraw
trigger1 = 1
scale = 5
value = 0
ignorehitpause = 1

[State 8000, pos]
type = VelSet
trigger1 = Time=18
X = -5

[State 8000, pos]
type = VelSet
;trigger1 = Time=96
trigger1 = abs(abs(pos X)-445) <= 5
X = 0

[State 8000, Speed-up Timer]
type = VarAdd
trigger1 = Time > 130
fvar(1) = 0.005

[State -2, Explod];Tip of Kmh FX
type = Explod
trigger1 = !Time
anim = 2404
removeTime = -1
sprpriority = 7
id = 2405
ownpal = 1
pos = 335, 0
ignorehitpause = 1
bindTime = -1
scale = 0.9, 0.8

[State -2, Explod]; Remove tip of beam
type = RemoveExplod
trigger1 = NumHelper(3231)
ID = 2405

[State 1061, rise up]
type = posadd
trigger1 = Time>108 && Time%2
Y = -1
persistent = 1

[State 1061, floats]
type = posadd
trigger1 = Time%floor(1+3.0/(1.0+fvar(1)))=0 
Y = 15*sin((1.0+fvar(1))*Time*pi/16 + pi)
persistent = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = NumHelper(3231) && !numExplod(2405)

;===================================================
; Twirl FX

[Statedef 3229]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 2
anim = 3229

[State 8000, Assert]
type = assertspecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State 1061, rise up]
type = posadd
;trigger1 = Time > 20
trigger1 = Time%2
Y = -1
persistent = 1

[State 1415, fade in]
type = trans
trigger1 = Time < 52
trans = addalpha
alpha = 5*(Time), 256-5*(Time)

[State -2, Explod];Twirl front
type = Explod
trigger1 = !Time
anim = 3230
removeTime = -1
sprpriority = 9
id = 3230
ownpal = 1
pos = 0, 0
ignorehitpause = 1
bindTime = -1

[State -2, Explod];Twirl front
type = ModifyExplod
trigger1 = Time < 52
ID = 3230
trans = addalpha
alpha = 5*(Time), 256-5*(Time)

[State -2, Explod];Twirl front
type = RemoveExplod
trigger1 = NumHelper(3231)
ID = 3230

[State 2260, destroy]
type = DestroySelf
trigger1 = NumHelper(3231) && !numExplod(3230)

;===================================================
; Beam + Twirl FX

[Statedef 3231]
type = A
physics = N
MoveType = A
ctrl = 0
sprpriority = 5
anim = 3231


[State -2, Explod]
type = RemoveExplod
trigger1 = !Time
ID = 2404

[State -2, Pos]
type = PosSet
trigger1 = !Time
Y = -(root,screenpos Y) + 120

[State 8000, Assert]
type = assertspecial
trigger1 = 1
flag = NoShadow
ignorehitpause = 1

[State -2, Vel]
type = Velset
trigger1 = Root, Var(36)>0
X = 10
persistent = 0

[State -2, Vel]
type = Velset
trigger1 = Root, Var(36)>9
X = 0
persistent = 0

[State 800, count]
type = VarAdd
trigger1= Root, Var(36)=80
var(1) = 1
[State 800, var = Time when ends hitting]
type = VarSet
trigger1 = Root, Var(36)=80
var(2) = Time

[State 1061, Scale up]
type = null ;AngleDraw
trigger1= Root, Var(36)=80
scale = 10 , 1+0.05*var(1)
value = 0
ignorehitpause = 1

[State 2260, destroy]
type = DestroySelf
trigger1 = root,stateno = 3241

;===================================================
; Goten Moving out at end of finisher 3

[Statedef 3214]
type = S
physics = N
MoveType = I
ctrl = 0
velset = 0,0
sprpriority = 6
anim = 3214

[state 3214] ;if non-cinematic bros KHH is used, Goten will immediately leave
type = changeanim
trigger1 = root, StateNo != [3200,3300]
trigger1 = time = 2
value = 3214
elem = 2

[state 3214, removeexplod]
type = removeexplod
trigger1 = !time
ID = 3213

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 1,1
value = 1

[State 1061, Velocity]
type = VelSet
trigger1 = AnimElemTime(2)=0
x = -1
y = -4
[State 1061, Velocity]
type = VelSet
trigger1 = AnimElemTime(3)=0
x = 0
y = 0

[State 100, jump SND]
type = PlaySnd
trigger1 = AnimElem = 2
value = 40,1

[State 250, teleport sound]
type = PlaySnd
trigger1 = AnimElem = 3
value = 2302, 0

[State 2260, destroy]
type = DestroySelf
trigger1 = !animTime

;===================================================
; Camera
[Statedef 3307]
type = S
physics = N
MoveType = I
ctrl = 0
velset = 0,0
sprpriority = 6
anim = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,1

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = Time > 5
;ignorehitpause = 
;persistent = 




;===================================================
; Vacuum (not used)
[Statedef 2503]
physics		= N
velset		= 0, 0
anim		= 2503
; Codes taken from PotS Ryu and adapted for Gohan Z2.
; This Helper gets called in state 2500 in supers.cns

[State 2503, NotHitBy]	;it won't get hit
type		= NotHitBy
trigger1		= 1
Time		= -1
value		= SCA

[State 2503, HitOverride]	;in case it happens, it returns to its original state
type		= HitOverride
trigger1		= 1
Time		= -1
attr		= SCA, AA, AP, AT
stateno		= 2503
ignorehitpause	= 1

[State 2503, ScreenBound]	;it's bound to the camera
type		= ScreenBound
trigger1		= 1
value		= 0

[State 2503, Turn]		;it turns in case the root (Gohan Z2) is distant less than 5 pixels
type		= Turn
trigger1		= RootDist x < 5

[State 2503, PlayerPush]	;it pushes the enemy if the body distance on the x axis is between -10 and 10
type		= PlayerPush
trigger1		= P2BodyDist x = [ -10, 10]
value		= 1

[State 2503, Position Set]	;it's always on ground
type		= PosSet
trigger1		= 1
y		= 0

[State 2503, Velocity Set]	;self explanatory
type		= VelSet
triggerall	= Enemy, StateType = A
trigger1		= 1
x		= 750.0 / 50;(RootDist x + 50.0)
;IfElse((rootdist x = [0, 100]), 2, IfElse((rootdist x = [100, 200]), 1.5, 1))


;[State 2503, Dust]		;I kept this in case I need to code a dust Explod
;type = Explod
;trigger1 = (p2bodydist x = [ -5, 5]) && (enemynear, statetype != A) && !(Time % 12)
;anim = 7103
;ID = 7103
;sprpriority = 2
;postype = p1
;pos = 0, 0
;scale = 1, 1
;removeTime = -2
;ownpal = 1

[State 2503, Position Add]	;this tells the Helper to stay behind the enemy
type		= PosAdd
trigger1		= P2BodyDist x != [ -5, 5]
x		= Ceil(p2dist x) - EnemyNear, Const(size.ground.back) -5

[State 2503, Vacuum effect finishes]
type		= DestroySelf
trigger1		= Root, StateNo != 2500 || Root, Anim != 2501 || Root, MoveContact
;If the root (Gohan Z2) either exits the Hurricane Kick or hits the enemy while doing the Hurricane Kick,
;it disappears.


;----------------------------------------------------------------------------------
;Goku Appears
[statedef 4000]
type = A
movetype = A
physics = N
sprpriority = 1
anim = 4000
ctrl = 0

[State 250, teleport sound]
type = PlaySnd
trigger1 = !Time
value = 2302, 0

[state 4000, hair]
type = explod
trigger1 = animelemtime(3) = 0
anim = 4001
ID = 4001
sprpriority = 1
postype = P1
pos = 0,0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
bindtime = -1
removetime = -1

[State 0, Charge Ball FX]
type = Explod
trigger1 = Time = 7
anim = 2420+10000*(var(2)=0)
id = 4005
pos = -12,-93
postype = p1
supermoveTime = 9999
pausemoveTime = 9999
removeTime = -1
sprpriority = 2
ownpal = 1
bindTime = -1
scale = 0.7,0.7
persistent = 0

[State 0, Charge lightning FX]
type = Explod
trigger1 = Time = 7
anim = 2430
id = 4006
pos = -12,-93
postype = p1
supermoveTime = 9999
pausemoveTime = 9999
removeTime = -1
sprpriority = 2
ownpal = 1
bindTime = -1
persistent = 0

 [State 1000, to launch]
type = ChangeState
trigger1 = time = 167
value = 4001

;----------------------------------------------------------------------------------
; Goku Fires
[statedef 4001]
type = A
movetype = A
physics = N
sprpriority = 3
anim = 4005

[state -2, remove hair]
type = removeexplod
trigger1 = !time
ID = 4001
[state -2, remove charge ball FX Chou Kmh]
type = removeExplod
trigger1 = !Time
id = 4005
[state -2, remove lightning FX]
type = removeExplod
trigger1 = !Time
id = 4006

[state 3213] ;Goku leaves if Gohan is hit
type = changestate
trigger1 = root,movetype = H
value = 3214
ignorehitpause = 1

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = Time=4
value = 2401,1

[state 4001, hair]
type = explod
trigger1 = !time
anim = 4006
ID = 4008
sprpriority = 3
postype = P1
pos = 0,0
supermovetime = 9999
pausemovetime = 9999
bindtime = -1
removetime = -1
[state 4001, removeexplod]
type = removeexplod
trigger1 = root,stateno != [2400,2403]
ID = 4008

[State 3000, Kamehameha]
type = null;Helper
trigger1 = animelem=3
stateno = 3221
ID = 4001
name = "goku_ckameha"
postype = p1
pos = 50,-96
ownpal = 1
size.xscale = 1
size.yscale = 0.7
persistent = 0

[State -2, Explod];On hands explod
type = Explod
triggerall = !numexplod(4005)
trigger1 = !time
anim = 2403
removetime = -1
sprpriority = 3
id = 4007
ownpal = 1
pos = 55,-83
ignorehitpause = 1
scale = 1,0.7
pausemovetime = 99999
supermovetime = 99999
bindtime = -1
[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = root,anim=2401
trigger1 = WinKO && MatchOver
scale = 0.6 , IfElse(0.7-0.04*(Time-55)<0, 0, 0.7-0.04*(Time-55))
ID = 4007
pos = 55,-83
postype = p1  ;p2,front,back,left,right
removetime = 100
[state 4001]
type = removeexplod
trigger1 = root,stateno = 2403
ID = 4007

[State 3000, Kamehameha FX beam]
type = null;Helper
trigger1 = animelem=3
stateno = 3222
ID = 4002
name = "goku_ckamehaFX_scale_beam"
postype = p1
pos = 45,-94
ownpal = 1
size.xscale = 1
size.yscale = 0.7
persistent = 0

[state 4001]
type = destroyself
trigger1 = root,stateno != [2400,2403]

;----------------------------------------------------------------------------------
;Goku Appears
[statedef 4002]
type = A
movetype = A
physics = N
sprpriority = 1
anim = 4000
ctrl = 0

[State 250, teleport sound]
type = PlaySnd
trigger1 = !Time
value = 2302, 0

[state 4000, hair]
type = explod
trigger1 = animelemtime(3) = 0
anim = 4001
ID = 4001
sprpriority = 1
postype = P1
pos = 0,0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
bindtime = -1
removetime = -1

[State 0, Charge Ball FX]
type = Explod
trigger1 = AnimElem = 3
anim = 2420+10000*(var(2)=0)
id = 4005
pos = -12,-93
postype = p1
supermoveTime = 9999
pausemoveTime = 9999
removeTime = -1
sprpriority = 2
ownpal = 1
bindTime = -1
scale = 0.7,0.7
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Time=10
value = 3,306
volumescale = 50


 [State 1000, to launch]
type = ChangeState
trigger1 = root, StateNo = 3220
value = 4003

;----------------------------------------------------------------------------------
; Goku Fires
[statedef 4003]
type = A
movetype = A
physics = N
sprpriority = 1
anim = 4018

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !Time
value = 3,320
volumescale = 100

[State 0, BindToRoot]
type = BindToRoot
trigger1 = 1
time = 1
pos = -40,-30

[state -2, remove hair]
type = removeexplod
trigger1 = !time
ID = 4001
[state -2, remove charge ball FX Chou Kmh]
type = removeExplod
trigger1 = !Time
id = 4005
[state -2, remove lightning FX]
type = removeExplod
trigger1 = !Time
id = 4006

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = Time=4
value = 2401,1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 4011
ID = 4011
pos = 0,0
postype = left  ;p2,front,back,left,right
facing = 1
bindtime = -1
ontop = 1
ownpal = 1

[state 4001]
type = destroyself
trigger1 = root,stateno = 3240

;KHH BEAM HEAD
;-----------------------------------------------
[StateDef 92602]
Type=U
Physics=N
MoveType=A
Anim=240499
Ctrl=0
SprPriority=4
VelSet = 16,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoShadow

[State 0, VelSet]
type = VelSet
trigger1 = Parent,Anim=2403&&Parent,Var(1) = [1,19]
x = 0.2
y = 0

[State 0, Destroy]
Type=DestroySelf
Trigger1=Parent,IsHelper
Trigger1 = Parent,Anim != 2403
Trigger2 = Root,MoveType = H
Trigger3 = MoveType = I && Time > 70
;KHH BEAM VISUALS
;-----------------------------------------------
[StateDef 92600]
Type=U
Physics=N
MoveType=A
Anim=2403
Ctrl=0
SprPriority=3
VelSet = 0,0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoShadow

[State 0, HitCount Set]
Type=VarSet
Trigger1=!Time
V=1
Value=0

[State 0, Hitboxes]
;sends out hitboxes during the fire animation
;adjust the number on trigger2 for faster or slower rate
;i set mine to start just a tad back so you wont miss point blank if your hitboxes are small enough
type = helper
triggerAll = Anim = 2403
Trigger1 = !Time
Trigger2 = Time % 4 = 0
helpertype = normal
stateno = 92601
ID = StateNo
name = "hitbox"
postype = p1
pos = -20,0
ownpal = 1

[State 0, Hitboxes]
;sends out hitboxes during the fire animation
;adjust the number on trigger2 for faster or slower rate
;i set mine to start just a tad back so you wont miss point blank if your hitboxes are small enough
type = helper
Trigger1=!Time && !NumHelper(92602)
helpertype = normal
stateno = 92602
ID = StateNo
name = "head"
postype = p1
pos = 130,0
ownpal = 1

;--BEAM FIRE----
[State 0, Beam Tail]
Type=NULL;Explod
Trigger1=!Time && !NumExplod(2404)
Anim=240499
Id=2404
RemoveTime=-1
Pos = 130,0
PosType=P1
SprPriority=4
;x velocity for how fast the tail goes forward. this will probably need to be tweak per your use
;Vel=16,0

[State 0, Beam Tail On P2]
;modify explod used to have the beam tail travel across the screen, sticking to p2
;the trigger1 is the hitcount from 1 to max number of hits - 1 (example max hits is 20 so 20-1=19)
;which means that during this time the beam is going to stick to the defined pos below
;and so on every hit the beam tail is going to change its pos to be on p2 with some small x velocity in between
;combine that with the hitboxes pushing p2 back and we got an illusion of movement
;pos and postype have to be defined for a modifyexplod to work
Type=NULL;ModifyExplod
Trigger1=Anim=2403&&Var(1) = [1,19]
Anim=240499
ID=2404
Vel=2,0
Pos = floor(Cond(P2Dist X + 20 > 150, P2Dist X + 20, 150)),0
PosType=P1


[State 0, Beam Body]
;why is the scale so small on the x? for the case of having p2 being really close up when the beam is fired
;it will start small and be stretched as time goes by
Type=Explod
Trigger1=!Time&&!NumExplod(2402)
Anim=2464
Id=2464
RemoveTime=-1
Pos = 88,0
PosType=P1
SprPriority=3
Scale = 0.3,1


[State 0, Scale Beam Body]
;ok so we're scaling the beam by time bcuz imagine we had a longer screen, the beam would naturally get longer as it goes
;and trigger1 says only get longer if we havent had any hits yet. so when we make contact we are gonna stop stretching
Type=ModifyExplod
Trigger1=!Var(1)
Id=2464
Pos = 88,0
PosType=P1
Scale = 0.4 + (Time * 0.13), 1


[State 1010, ParentVarAdd - for 'dmg dampening']
type = null;ParentVarAdd
TriggerAll = Parent,IsHelper = 0
Trigger1 = NumHelper(StateNo)
trigger1 = Helper,MoveHit = 1
trigger1 = P2MoveType = H
trigger1 = Time >8
fvar(13) = 0.95
ignorehitpause = 1

;---BEAM FADE-----------------------------------
[State 0, Fade Away Anim]
;trigger2 is where you set the max number of hits, change this and the other pieces will respond accordingly
Type=ChangeAnim
TriggerAll=Anim!= 92401			;<Beam Fade Away Anim
Trigger1=Parent,Anim != 2401	;<Beam Throwing State
Trigger2 = Var(1)>=20
Trigger3 = Parent,Movetype = H
Value=92401

[State 0, gotenend]
type = helper
triggerall = !numhelper(3217)
Trigger1 = Parent,Movetype = H
helpertype = normal
stateno = 3217
ID = 3217
name = "gotenend"
postype = p1
pos = rootdist x+40,0
ownpal = 1
[State 0, gokunend]
type = helper
triggerall = !numhelper(3218)
Trigger1 = Parent,Movetype = H
helpertype = normal
stateno = 3217
ID = 3218
name = "gokuend"
postype = p1
pos = rootdist x+-40,0
ownpal = 1

[State 0, Beam Tail Moving At Max Hits]
;so another modifyexplod. this one is used to have the beam fly off after the hits are done
;the title of this is a lie bcuz the beam flies off at max - 1 hits
;did it this way so there isnt a pause. if you put it at the max then you'll know what i mean
;the x pos for this is almost the same as the tail moving sctrl above, but no need for a Cond just set it
;the x vel on this is real high so the tail can get off screen fast enough to be deleted
Type=ModifyExplod
Trigger1=Anim=92401&&AnimElem=1
Anim=2404
ID=2404
Vel=25,0
Pos = floor(P2BodyDist X + 40), 0
PosType=P1

[State 0, Remove Beam Tail]
Type=RemoveExplod
Trigger1= Anim = 92401 && !AnimTime
Trigger2 = Parent,MoveType = H
Id=2404

[State 0, Remove Beam Body]
Type=RemoveExplod
Trigger1= Anim = 92401
Trigger2 = Parent,MoveType = H
Id=2464

[State 0, Beam Thinning]
Type=Explod
Trigger1=Anim=92401&&AnimElem=1
Anim=92403
Id=92403
Pos=0,0
PosType=P1
BindTime=1
RemoveTime=-2
SprPriority=3
Vel=0.4,0

[State 0, Destroy]
Type=DestroySelf
Trigger1= Anim = 92401 && !AnimTime
;Trigger2 = Parent,MoveType = H


;KHH BEAM HITBOXES
[StateDef 92601]
Type=U
Physics=N
MoveType=A
Anim=92402
Ctrl=0
VelSet = 35,0

[State 0, Projectile]
type = Projectile
;trigger1 = 1
trigger1 = (P2BodyDist X = [-90,90]) && (P2BodyDist Y = [-90,90])
ProjID = 93999999999
projanim = 1
projremovetime = 2
offset = -400,0
postype = p1
attr = A,HP        ;change this to whatever your projectile is set
ignorehitpause = 1
guardflag = A
guard.dist = 1999
projedgebound = 1600
projstagebound = 1600

;--ReversalDef 5.1 fix---
[State 1061, NotHitBy]
type = NotHitBy
trigger1 = Time >= 0
time = 1
value = SCA, NA, SA, HA, NT, ST, HT
ignorehitpause = 1

[State 1061, HitBy]
type = HitBy
trigger1 = Time >= 0
value = SCA, NP, SP, HP
time = 1
ignorehitpause = 1

[State 1061, HitOverride]
type = HitOverride
trigger1 = Time >= 0
slot = 1
time = 1
stateno = StateNo
attr = SCA, AA, AP, AT
ignorehitpause = 1
;--ReversalDef 5.1 fix---


[State 0, Add HitCount]
type = ParentVarAdd
trigger1 = MoveContact=1
v = 1
value = 1
IgnoreHitPause=1

[State 0, Projectile]
type = Projectile
trigger1 = MoveContact=1
ProjID = 92603
projanim = 1
projremovetime = 5

;-----------HITDEFS-----------
;LVL1------------------
[State 0, Hitdef]
type = HitDef
Trigger1 = Root,NumHelper(3401) = 1
trigger1 = !MoveContact
attr = A,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;damage = Ceil(IfElse(root,fvar(11) * 15 < 12, 12, root,fvar(11) * 15 )), 8
damage = Ceil(IfElse(root,fvar(11) * 10 < 8, 8, root,fvar(11) * 10 )), 5
getpower = 0,0
givepower = 20,20
pausetime = 0,2
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.velocity= -1, -2
guard.velocity = -2
air.velocity = -1, 0
airguard.velocity = -1.5, -1.5 
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
guard.sparkno = -1;s7000
sparkxy = 20-(random%40),0 ;IfElse(p2bodydist y <0,0-(random%20),80-(random%20))
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
;LVL2------------------
[State 0, Hitdef]
type = HitDef
Trigger1 = Root,NumHelper(3401) = 2
trigger1 = !MoveContact
attr = A,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;damage = Ceil(IfElse(root,fvar(11) * 15 < 9, 9, root,fvar(11) * 9 )), 8
damage = Ceil(IfElse(root,fvar(11) * 8 < 6, 6, root,fvar(11) * 8 )), 3
getpower = 0,0
givepower = 20,20
pausetime = 0,2
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.velocity= -1, -2
guard.velocity = -2
air.velocity = -1, 0
airguard.velocity = -1.5, -1.5 
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
guard.sparkno = -1;s7000
sparkxy = 20-(random%40),0 ;IfElse(p2bodydist y <0,0-(random%20),80-(random%20))
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5
;LVL3------------------
[State 0, Hitdef]
type = HitDef
Trigger1 = Root,NumHelper(3401) = 3
trigger1 = !MoveContact
attr = A,HP
hitflag = MAF
guardflag = MA
priority = 7,Hit
;damage = Ceil(IfElse(root,fvar(11) * 15 < 12, 12, root,fvar(11) * 15 )), 8
damage = Ceil(IfElse(root,fvar(11) * 7 < 6, 6, root,fvar(11) * 7 )), 2
getpower = 0,0
givepower = 20,20
pausetime = 0,2
animtype = Back
air.animtype = Back
fall.animtype = Back
ground.type = High
air.type = Low
ground.velocity= -1, -2
guard.velocity = -2
air.velocity = -1, 0
airguard.velocity = -1.5, -1.5 
fall=1
air.fall = 1
fall.recover = 0
sparkno = s7030
guard.sparkno = -1;s7000
sparkxy = 20-(random%40),0 ;IfElse(p2bodydist y <0,0-(random%20),80-(random%20))
hitsound   = s1000,0
guardsound = S6,1
EnvShake.Time = 16
EnvShake.ampl = 6
EnvShake.freq = 100
palfx.sinadd=64,64,64,4
palfx.mul=128,128,128
palfx.Time=32
p1sprpriority = 5

[State 0, Turn To Idle]
Type=StateTypeSet
Trigger1= Pos X != [-340, 340]
Trigger2 = Time > 20
MoveType=I

[State 0, Destroy]
Type=DestroySelf
Trigger1=Parent,IsHelper
Trigger1 = Parent,Anim != 2403
Trigger2 = Root,MoveType = H
Trigger3 = MoveType = I && Time > 70

;========================<EXPLODSIVE BUFFERING HELPER>=============================
[StateDef 90000005]
type = A
physics = N
moveType = I
anim = 1
velSet = 0,0
ctrl = 0

;Guard Check 1
[State 0, VarAdd]
type = VarAdd
trigger1 = NumEnemy
trigger1 = enemynear, StateNo = [130,155]
trigger1 = enemynear, MoveType = H
var(1) = 1
;Guard Check 2
[State 0, VarSet]
type = VarSet
trigger1 = Var(1) >=300
var(2) = 3
     
;Guard window counter
[State 0, VarAdd]
type = VarAdd
triggerall = NumEnemy
triggerall = Var(2) >=1
trigger1 = enemynear, StateNo != [130,155]
var(2) = -1
;no guard
[State 0, VarSet]
type = VarSet
triggerall = NumEnemy
trigger1 = enemynear, StateNo != [130,155]
var(1) = 0

[State 90000005, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "by JustMorphPointman"
ignoreHitPause = 1
