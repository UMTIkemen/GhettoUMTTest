;---------------------------------------------------------------------------
; Mind's Eye {V-Skill I}
[Statedef 4000]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4000
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4000, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4000, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
[State 4000, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

[State 4000, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

[State 4000, remove special counter hittable]
type = varset
trigger1 = time = 2
fvar(30) = 0

[State 4000, special counter hittable]
type = varset
trigger1 = time = 9
fvar(30) = 1

[State 4000, remove special counter hittable]
type = varset
trigger1 = time = 47
fvar(30) = 0

;------ juggle points -------
[State 4000, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = ifelse(var(10), 0, 1)
ignorehitpause = 1
persistent = 0

[State 4000, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4000, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4000, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4000, voice]
type = playsnd
trigger1 = time = 1
value = 1600, 0
channel = 0

[State 4000, voice]
type = playsnd
trigger1 = time = 1
value = 0, 5
volumescale = 75

;------ hit ------
[State 4000, reversal]
type = reversaldef
trigger1 = animelem = 3
reversal.attr = SCA, AA, AP
pausetime = 0, 18
hitsound = s1, 30
p1stateno = 4010

[State 4000, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4000, return ctrl]
type = ctrlset
trigger1 = time = 47 
value = 1

[State 4000, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Mind's Eye - Cancel {V-Skill I}
[Statedef 4005]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4005
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4005, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4005, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4005, hitby]
type = hitby
trigger1 = time = 0
value = SCA

;------ counter hit time ------
[State 4005, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

[State 4005, special counter hittable]
type = varset
trigger1 = time = 9
fvar(30) = 1

[State 4005, remove special counter hittable]
type = varset
trigger1 = time = 47
fvar(30) = 0

;------ juggle points -------
[State 4005, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = ifelse(var(10), 0, 1)
ignorehitpause = 1
persistent = 0

[State 4005, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4005, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4005, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4005, voice]
type = playsnd
trigger1 = time = 1
value = 1600, 0
channel = 0

[State 4005, voice]
type = playsnd
trigger1 = time = 1
value = 0, 5
volumescale = 75

;------ hit ------
[State 4005, reversal]
type = reversaldef
trigger1 = animelem = 1
reversal.attr = SCA, AA, AP
pausetime = 0, 18
hitsound = s1, 30
p1stateno = 4010

[State 4005, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4005, return ctrl]
type = ctrlset
trigger1 = time = 47 
value = 1

[State 4005, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Mind's Eye - Counter {V-Skill I}
[Statedef 4010]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4010
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 4010, air]
type = changeanim
triggerall = enemynear, statetype = A
trigger1 = time = 0
value = 4011

[State 4010, crouch]
type = changeanim
triggerall = enemynear, statetype = C
trigger1 = time = 0
value = 4012

[State 4010, invincible]
type = nothitby
trigger1 = time = 0
value = SCA

[State 4010, projectile invincible]
type = nothitby
trigger1 = time = [1, 14]
value = , AP

;------ Buffering ------
[State 4010, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4010, Mind's Eye (cancel version)]
type = varset
triggerall = var(38) <= 4005
triggerall = !isHelper(10371)
triggerall = var(1) = 1 || var(1) = 3
triggerall = statetype != a
triggerall = time = [2, 20]
trigger1 = command = "y3" && command = "b3"
var(38) = 4005

[State 4010, Ex Jodan Sokutou Geri]
type = varset
triggerall = var(38) <= 1330
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(44) ;HCF
trigger1 = command = "ab" || command = "bc" || command = "ac"
var(38) = 1330

[State 4010, Ex Tatsumaki Senpukyaku]
type = varset
triggerall = var(38) <= 1230
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(41) ;QCB
trigger1 = command = "ab" || command = "bc" || command = "ac"
var(38) = 1230

[State 4010, Ex Shoryuken]
type = varset
triggerall = var(38) <= 1130
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1130

[State 4010, Ex Hadouken]
type = varset
triggerall = var(38) <= 1030
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(40) ;QCF
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1030

[State 4010, transition]
type = changestate
triggerall = var(38) > 0
trigger1 = time = [15, 20]
value = var(38)

[State 4010, v meter]
type = varadd
trigger1 = time = 0
v = 3
value = 50

[State 4010, hit spark]
type = explod
trigger1 = time = 0
anim = 1135
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0 + pos x + camerapos x , -60 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4010, CtrlSet]
type = CtrlSet
trigger1 = animelem = 24
value = 1

[State 4010, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Thrust Strike {V-Skill II}
[Statedef 4100]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4100
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4100, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4100, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4100, reset 12]
type = varset
trigger1 = time = 0
var(12) = 0

;------ counter hit time ------
[State 4100, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4100, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4100, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4100, pos]
type = posadd
trigger1 = time =0
x = 23*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =1
x = 40*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =2
x = 27*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =3
x = 18*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =4
x = 20*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =5
x = 18*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =6
x = 13*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =7
x = 8*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =8
x = 6*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =9
x = 3*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =10
x = 2*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =11
x = 1*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =12
x = 1*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =17
x = 1*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =18
x = 2*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =19
x = 4*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =20
x = 5*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =21
x = 5*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =22
x = 6*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =23
x = 5*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =24
x = 3*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =51
x = -1*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =52
x = -3*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =53
x = -5*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =54
x = -6*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =55
x = -7*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =56
x = -8*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =57
x = -8*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =58
x = -9*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =59
x = -9*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =60
x = -8*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =61
x = -8*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =62
x = -7*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =63
x = -5*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =64
x = -4*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =65
x = -3*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =66
x = -2*const(size.xscale)

[State 4100, pos]
type = posadd
trigger1 = time =67
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4100, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4100, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4100, voice]
type = playsnd
trigger1 = time = 0
value = 1450,1
channel = 0

[State 4100, voice]
type = playsnd
trigger1 = time = 19
value = 1450,0
channel = 0

[State 4100, random voice]
type = playsnd
trigger1 = time =21
value = 1400, 8
volumescale = 75

;------ hit ------
[State 4100, reversal]
type = reversaldef
trigger1 = animelem = 10
reversal.attr = SCA, AA
pausetime = 0, 25
hitsound = s1450, 4
p1stateno = 4110

[State 1320, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 25
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(70 * cond(var(10), 1.2, 1)), 18
pausetime = 15, 15
guard.pausetime = 15, 15
hitsound = s1, 13
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 19
guard.slidetime = 18
ground.hittime = 19 + ifelse(var(10), 2, 0) 
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -4, -4
guard.velocity = -4.8
air.velocity = -4, -4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(12 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(6 * fvar(10))
guard.kill = 0

[State 4100, meter hit]
type = varadd
triggerall = var(15) <= 0
trigger1 = movehit = 1
v = 3
value = ceil(60 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4100, meter block]
type = varadd
triggerall = var(15) <= 0
trigger1 = moveguarded = 1
v = 3
value = ceil(30 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4101, spin dust]
type = explod
trigger1 = animelem = 24
anim = 4101
id = 4101
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 40, -5 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4100, retract]
type = StateTypeSet
trigger1 = animelem = 27
movetype = I

[State 4100, return ctrl]
type = ctrlset
trigger1 = time = 47
value = 1

[State 4100, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Thrust Strike - Counter
[Statedef 4110]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4110
poweradd = 0
juggle = 0
sprpriority = 2

[State 4110, invincible]
type = nothitby
trigger1 = time < 36
value = SCA

[State 4500, darken]
type = bgpalfx
trigger1 = time = 0
time = 26
add = 0, 0, 0
mul = 128, 128, 128

;------ juggle points -------
[State 4110, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4110, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4110, pos]
type = posadd
trigger1 = time =20
x = 2*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =21
x = 5*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =22
x = 13*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =23
x = 13*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =24
x = 13*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =25
x = 5*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =51
x = -1*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =52
x = -3*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =53
x = -5*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =54
x = -6*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =55
x = -7*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =56
x = -8*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =57
x = -8*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =58
x = -9*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =59
x = -9*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =60
x = -8*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =61
x = -8*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =62
x = -7*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =63
x = -5*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =64
x = -4*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =65
x = -3*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =66
x = -2*const(size.xscale)

[State 4110, pos]
type = posadd
trigger1 = time =67
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4110, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4110, 12]
type = varset
trigger1 = movehit = 1
var(12) = 1

;------ cancel potential ------
[State 4110, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4110, return]
type = changestate
triggerall = movehit
trigger1 = time = 35
value = 4120

;------ sounds ------
[State 4110, voice]
type = playsnd
trigger1 = time = 5
value = 1450,2
channel = 0

[State 4110, voice]
type = playsnd
trigger1 = time = 20
value = 1400,8
volumescale = 75

;------ hit ------
[State 4110, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 26
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(60 * cond(var(10), 1.2, 1)), 15
pausetime = 18, 18
guard.pausetime = 18, 18
hitsound = s1, 13
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = -5, -75
ground.type = Low
ground.slidetime = 29
guard.slidetime = 24
ground.hittime = 29 + ifelse(var(10), 2, 0) 
guard.hittime = 24
guard.ctrltime = 24
ground.velocity = -6
guard.velocity = -8.5
air.velocity = -3.5, -5
air.hittime = 100
air.fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(18 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(9* fvar(10))
guard.kill = 0

[State 4110, meter hit]
type = varadd
triggerall = var(15) <= 0
trigger1 = movehit = 1
v = 3
value = ceil(60 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4110, meter block]
type = varadd
triggerall = var(15) <= 0
trigger1 = moveguarded = 1
v = 3
value = ceil(30 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4110, spin dust]
type = explod
trigger1 = time = 25
anim = 4101
id = 4110
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 40, 0 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4110, spin dust]
type = explod
trigger1 = time = 0
anim = 4111
id = 4110
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0, -60 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4110, retract]
type = StateTypeSet
trigger1 = animelem = 28
movetype = I

[State 4110, return ctrl]
type = ctrlset
trigger1 = time = 48
value = 1

[State 4100, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Thrust Strike - 2nd Attack
[Statedef 4120]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4120
poweradd = 0
juggle = 0
sprpriority = 2

[State 4120, invincible]
type = nothitby
trigger1 = time < 14
value = SCA

;------ juggle points -------
[State 4120, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4120, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4102, pos]
type = posadd
trigger1 = time =3
x = 2*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =4
x = 7*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =5
x = 12*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =6
x = 15*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =7
x = 16*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =8
x = 16*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =9
x = 20*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =10
x = 35*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =11
x = 41*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =12
x = 27*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =13
x = 4*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =14
x = 4*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =15
x = 3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =16
x = 2*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =17
x = 1*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =18
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =19
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =20
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =21
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =22
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =23
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =24
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =25
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =26
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =27
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =28
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =29
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =30
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =31
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =32
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =33
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =34
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =35
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =36
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =37
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =38
x = 0*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =39
x = -1*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =40
x = -2*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =41
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =42
x = -4*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =43
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =44
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =45
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =46
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =47
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =48
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =49
x = -3*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =50
x = -4*const(size.xscale)

[State 4120, pos]
type = posadd
trigger1 = time =51
x = -2*const(size.xscale)

;------ combo scaling ------
[State 4120, increment combo count]
type = varadd
triggerall = !var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4120, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4120, v trigger cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 4
ignorehitpause = 1

;------ sounds ------
[State 4120, voice]
type = playsnd
trigger1 = time = 2
value = 1450,3
channel = 0

[State 4120, whoosh]
type = playsnd
trigger1 = time = 2
value = 1400,9
volumescale = 75

;------ hit ------
[State 4120, hit]
type = hitdef
trigger1 = animelem = 13
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = 60 * fvar(10), 15
pausetime = 20, 20
guard.pausetime = 20, 20
hitsound = s1, 13
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = -10, -80
ground.type = Low
ground.slidetime = 13
guard.slidetime = 22
ground.hittime = 13 + ifelse(var(10), 2, 0) 
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -5, -3.7
guard.velocity = -6
air.velocity = -5, -3.7
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(12 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(6 * fvar(10))
guard.kill = 0

[State 4100, meter hit]
type = varadd
triggerall = var(15) <= 0
trigger1 = movehit = 1
v = 3
value = ceil(40 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4100, meter block]
type = varadd
triggerall = var(15) <= 0
trigger1 = moveguarded = 1
v = 3
value = ceil(20 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4120, spin dust]
type = explod
trigger1 = animelem = 11
anim = 4121
id = 4120
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 15, -40 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4120, spin dust]
type = explod
trigger1 = animelem = 13
anim = 4122
id = 4120
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 40, -85 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4120, retract]
type = StateTypeSet
trigger1 = animelem = 15
movetype = I 

[State 4120, return ctrl]
type = ctrlset
trigger1 = time = 63
value = 1

[State 4120, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Thrust Strike TC {V-Skill II}
[Statedef 4130]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4130
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4130, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4130, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
[State 4130, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4130, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4130, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4130, pos]
type = posadd
trigger1 = time =0
x = 18*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =1
x = 20*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =2
x = 18*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =3
x = 13*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =4
x = 8*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =5
x = 6*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =6
x = 3*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =7
x = 2*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =8
x = 1*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =9
x = 1*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =14
x = 1*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =15
x = 2*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =16
x = 4*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =17
x = 5*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =18
x = 5*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =19
x = 6*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =20
x = 5*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =21
x = 3*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =48
x = -1*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =49
x = -3*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =50
x = -5*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =51
x = -6*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =52
x = -7*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =53
x = -8*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =54
x = -8*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =55
x = -9*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =56
x = -9*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =57
x = -8*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =58
x = -8*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =59
x = -7*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =60
x = -5*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =61
x = -4*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =62
x = -3*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =63
x = -2*const(size.xscale)

[State 4130, pos]
type = posadd
trigger1 = time =34
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4130, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4130, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4130, voice]
type = playsnd
trigger1 = time = 1
value = 1450, 5
channel = 0

[State 4130, fx]
type = playsnd
trigger1 = time =18
value = 1400, 8
volumescale = 75

;------ hit ------
[State 4130, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 22
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(70 * cond(var(10), 1.2, 1)), 18
pausetime = 15, 15
guard.pausetime = 15, 15
hitsound = s1, 13
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 19
guard.slidetime = 18
ground.hittime = 19 + ifelse(var(10), 2, 0) 
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -4, -4
guard.velocity = -4.8
air.velocity = -4, -4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(12 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(6 * fvar(10))
guard.kill = 0

[State 4130, meter hit]
type = varadd
triggerall = var(15) <= 0
trigger1 = movehit = 1
v = 3
value = ceil(75 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4130, meter block]
type = varadd
triggerall = var(15) <= 0
trigger1 = moveguarded = 1
v = 3
value = ceil(38 * fvar(10))
persistent = 0
ignorehitpause = 1

[State 4101, spin dust]
type = explod
trigger1 = animelem = 21
anim = 4101
id = 4101
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 40, -5 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4130, retract]
type = StateTypeSet
trigger1 = animelem = 24
movetype = I

[State 4130, return ctrl]
type = ctrlset
trigger1 = time = 47
value = 1

[State 4130, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Hashogeki {V-Reversal}
[Statedef 4300]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 1500
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4300, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4300, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4300, consume v meter]
type = varadd
trigger1 = time = 0
v = 3
value = -300

[State 4300, fx]
type = explod
trigger1 = time = 0
anim = 15016
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 10 + pos x + camerapos x , -90 + pos y
scale = 0.5, 0.5
sprpriority = 7
ownpal = 1
ignorehitpause = 1
persistent = 0
pausemovetime = 999

;------ counter hit time ------
[State 4300, strike and projectile invuln]
type = nothitby
trigger1 = time < 33
value = , AA, AP

[State 4300, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4300, pos]
type = posadd
trigger1 = time =2
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =3
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =4
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =5
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =6
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =7
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =8
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =9
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =10
x = 4*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =11
x = 10*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =12
x = 18*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =13
x = 31*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =14
x = 36*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =15
x = 23*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =16
x = 5*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =17
x = -8*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =18
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =19
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =20
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =21
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =23
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =24
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =25
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =26
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =27
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =28
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =29
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =30
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =31
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =32
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =33
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =34
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =35
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =36
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =37
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =38
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =39
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =40
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =41
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =42
x = 1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =43
x = 0*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =44
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =45
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =46
x = -3*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =47
x = -3*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =48
x = -4*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =49
x = -4*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =50
x = -4*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =51
x = -4*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =52
x = -3*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =53
x = -2*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =54
x = -1*const(size.xscale)

[State 4300, pos]
type = posadd
trigger1 = time =55
x = -1*const(size.xscale)


;------ combo scaling ------
[State 4300, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4300, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 99
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4300, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 26
last = 33
value = 0

[State 4300, pause]
type = pause
trigger1 = time = 0
time = 7
movetime = 7
endcmdbuftime = 7

;------ sounds ------
[State 4300, effect]
type = playsnd
trigger1 = time = 0
value = 4300, 0

[State 4300, voice]
type = playsnd
trigger1 = time = 12
value = 4300, 1
channel = 0

[State 4300, whoosh]
type = playsnd
trigger1 = time = 12
value = 0, 2
volumescale = 75

;----- effects -----
[State 4300, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 17
attr = S, SP
hitflag = MAF
guardflag = M
priority = 7, hit
hitsound = s1, 2
guardsound = s1, 22
damage = 0
sparkno = s16250
guard.sparkno = s16750
sparkxy = 0, -62
pausetime = 15, 15
guard.pausetime = 15, 15
animtype = hard
ground.type = low
ground.slidetime = 25
guard.slidetime = 23
ground.hittime = 25 + cond(fvar(10), 2, 0)
guard.hittime = 23
guard.ctrltime = 23
ground.velocity = -5, -4.1
guard.velocity = -8.3
air.velocity = -5, -4.1
fall = 1
fall.recover = 0
getpower = 0, 0
givepower = 0, 0
yaccel = 0.5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
guard.kill = 0

[State 220, hit spark]
type = explod
trigger1 = movehit = 1
anim = 4302
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50 + pos x + camerapos x , -62 + pos y
scale = 0.35, 0.35
sprpriority = 2
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4300, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(17) >= 0 
ID = 4301
pos = 60,-62
postype = p1  ;p2,front,back,left,right

[State 4300, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(15) = 0 
ID = 4301
pos = -3,-70
postype = p1  ;p2,front,back,left,right

[State 4300, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(16) = 0 
ID = 4301
pos = 30,-70
postype = p1  ;p2,front,back,left,right

[State 4300, hit spark]
type = explod
trigger1 = animelem = 14
anim = 4301
id = 4301
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * -20 + pos x + camerapos x , -72 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4300, retract]
type = statetypeset
trigger1 = animelem = 19
movetype = i

[State 4300, return ctrl]
type = ctrlset
trigger1 = time = 42  
value = 1

[State 4300, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Denjin Renki {V-Trigger I}
[Statedef 4500]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4500
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4500, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4500, V Timer]
type = varset
trigger1 = time = 51
var(15) = 1000

[State 4500, consume v meter]
type = varadd
trigger1 = time = 51
v = 3
value = cond(var(2) = 1, -600, -900)

[State 4500, 16]
type = varset
trigger1 = time = 51
var(14) = 1

[State 4500, vtrig explod]
type = explod
trigger1 = time = 7
anim = 15015
facing = facing
pos = cond(facing = 1, 1, -1) * 15 + pos x + camerapos x, 15 + pos y
scale = 0.7, 0.7
sprpriority = 3
ownpal = 1
pausemovetime = 999

[State 4500, invuln]
type = nothitby
trigger1 = time < 51
value = SCA

;------ super pause and effects ------
[State 4500, super pause]
type = pause
trigger1 = time = 0
endcmdbuftime = 30
movetime = 50
time = 50

[State 4500, darken]
type = bgpalfx
trigger1 = time = 1
time = 50
add = 0, 0, 0
mul = 128, 128, 128

;------ counter hit time ------
;------ juggle points -------
;------ width & positioning ------
[State 4500, pos]
type = posadd
trigger1 = time =3
x = -1*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =4
x = -2*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =5
x = -3*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =6
x = -3*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =7
x = -2*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =8
x = -1*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =9
x = 0*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =10
x = 0*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =11
x = 1*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =12
x = 2*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =13
x = 2*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =14
x = 3*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =15
x = -1*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =16
x = 8*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =17
x = 7*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =18
x = 11*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =19
x = 11*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =20
x = 5*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)


[State 4500, pos]
type = posadd
trigger1 = time =41
x = -1*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =42
x = -1*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =43
x = -3*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =44
x = -3*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =45
x = -4*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =46
x = -5*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =47
x = -6*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =48
x = -5*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =49
x = -4*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =50
x = -3*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =51
x = -2*const(size.xscale)

[State 4500, pos]
type = posadd
trigger1 = time =52
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4500, increment combo count]
type = varadd
trigger1 = time = 0
v = 40
value = 2
ignorehitpause = 1
persistent = 0

;------ juggle points -------
;------ cancel potential ------
[State 4500, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 26
last = 33
value = 0

;------ sounds ------
[State 4500, energy]
type = playsnd
trigger1 = time = 0
value = 4500, 0

[State 4500, voice]
type = playsnd
trigger1 = time = 3
value = 4500, 3
channel = 0

[State 4500, energy]
type = playsnd
trigger1 = time = 18
value = 4500, 1
volumescale = 75

[State 4500, energy]
type = playsnd
trigger1 = time = 18
value = 4500, 11
volumescale = 75

;------ effects ------
[State 4500, return ctrl]
type = ctrlset
trigger1 = time = 55
value = 1

[State 4500, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Denjin Renki (Cancel) {V-Trigger I}
[Statedef 4505]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4505
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4505, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4505, V Timer]
type = varset
trigger1 = time = 48
var(15) = 1000

[State 4505, consume v meter]
type = varadd
trigger1 = time = 48
v = 3
value = cond(var(2) = 1, -600, -900)

[State 4505, 16]
type = varset
trigger1 = time = 48
var(14) = 1

[State 4505, vtrig explod]
type = explod
trigger1 = time = 7
anim = 15015
facing = facing
pos = cond(facing = 1, 1, -1) * 15 + pos x + camerapos x, 15 + pos y
scale = 0.7, 0.7
sprpriority = 3
ownpal = 1
pausemovetime = 999

[State 4505, invuln]
type = nothitby
trigger1 = time < 48
value = SCA

;------ super pause and effects ------
[State 4505, super pause]
type = pause
trigger1 = time = 0
endcmdbuftime = 30
movetime = 47
time = 47

[State 4505, darken]
type = bgpalfx
trigger1 = time = 1
time = 47
add = 0, 0, 0
mul = 128, 128, 128

;------ counter hit time ------
;------ juggle points -------
;------ width & positioning ------
[State 4505, pos]
type = posadd
trigger1 = time =3
x = -1*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =4
x = -2*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =5
x = -3*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =6
x = -3*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =7
x = -2*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =8
x = -1*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =9
x = 0*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =10
x = 0*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =11
x = 1*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =12
x = 2*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =13
x = 2*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =14
x = 3*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =15
x = -1*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =16
x = 8*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =17
x = 7*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =18
x = 11*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =19
x = 11*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =20
x = 5*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)


[State 4505, pos]
type = posadd
trigger1 = time =41
x = -1*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =42
x = -1*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =43
x = -3*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =44
x = -3*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =45
x = -4*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =46
x = -5*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =47
x = -6*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =48
x = -5*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =49
x = -4*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =50
x = -3*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =51
x = -2*const(size.xscale)

[State 4505, pos]
type = posadd
trigger1 = time =52
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4505, increment combo count]
type = varadd
trigger1 = time = 0
v = 40
value = 2
ignorehitpause = 1
persistent = 0

;------ juggle points -------
;------ cancel potential ------
[State 4505, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 26
last = 33
value = 0

;------ sounds ------
[State 4505, energy]
type = playsnd
trigger1 = time = 0
value = 4500, 0

[State 4505, voice]
type = playsnd
trigger1 = time = 3
value = 4500, 3
channel = 0

[State 4505, energy]
type = playsnd
trigger1 = time = 18
value = 4500, 1
volumescale = 75

[State 4505, energy]
type = playsnd
trigger1 = time = 18
value = 4500, 11
volumescale = 75

[State 4505, return ctrl]
type = ctrlset
trigger1 = time = 55
value = 1

[State 4505, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Lp Hadouken (Charge)
[Statedef 4510]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4510
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4510, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4510, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
[State 4510, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4510, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4510, pos]
type = posadd
trigger1 = time =[0,1]
x = -7.5*const(size.xscale)

[State 4510, pos]
type = posadd
trigger1 = time =[2,4]
x = -5*const(size.xscale)

;------ combo scaling ------
;------ cancel potential ------
[State 4510, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4510, voice]
type = playsnd
trigger1 = time = 7
value = 4500, 4
channel = 0

[State 4510, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 13
channel = 1

;------ hitdef and sparks ------
[State 4510, wind]
type = explod
trigger1 = animelem = 5
anim = 4512
id = 4510
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * -20, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4510, uncharged]
type = changestate
triggerall = command !="hold_x"
trigger1 = time = [7,18]
value = 4511

[State 4510, level 2]
type = changestate
triggerall = command !="hold_x"
trigger1 = time = [19,58]
value = 4540

[State 4510, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(5) >= 0 
ID = 4508
pos = -10,-65
postype = p1

[State 4510, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(5) >= 0 
ID = 4509
pos = -15,-85
postype = p1

[State 4510, return]
type = changestate
trigger1 = animtime = 0
value = 4550

;--------------------------------------------------------------------
; VT1 Lp Hadouken (Level 1)
[Statedef 4511]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4511
poweradd = 0
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
;------ counter hit time ------
;------ juggle points -------
[State 4511, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4511, pos]
type = posadd
trigger1 = time =0
x = 3*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =1
x = 9*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =2
x = 13*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =3
x = 16*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =4
x = 19*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =5
x = 29*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =6
x = 4*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =7
x = -1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =8
x = -2*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =9
x = -3*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =10
x = -2*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =13
x = -1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =14
x = -1*const(size.xscale)


[State 4511, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =26
x = 1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =27
x = 1*const(size.xscale)


[State 4511, pos]
type = posadd
trigger1 = time =30
x = -1*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =31
x = -2*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =32
x = -4*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =33
x = -9*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =34
x = -15*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =35
x = -15*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =36
x = -9*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =37
x = -4*const(size.xscale)

[State 4511, pos]
type = posadd
trigger1 = time =38
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4511, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4511, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4511, voice]
type = playsnd
trigger1 = time = 0
value = 4500, 6
channel = 0

;------ hitdef and sparks ------
[State 4511, projectile]
type = helper
trigger1 = animelem = 7
id = 4511
stateno = 4515
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4511, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4511, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = -18, -75 
postype = p1

[State 4511, ModifyExplod]
type = ModifyExplod
trigger1 = time = 4
ID = 4510
pos = -15, -75 
postype = p1

[State 4511, ModifyExplod]
type = ModifyExplod
trigger1 = time = 5
ID = 4510
pos = 11, -75 
postype = p1

[State 4511, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 7
id = 4510

[State 4511, wind]
type = explod
trigger1 = animelem = 7
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4511, return ctrl]
type = ctrlset
trigger1 = time = 35
value = 1

[State 4511, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Lp Hadouken Projectile (Level 1)
;4516 collide
;4517 hit
;4518 block/reversed
[Statedef 4515]
type = A
movetype = A
physics = N
anim = 4515
ctrl = 0
juggle = 0
sprpriority = 3

;------ combo scaling ------
[State 4515, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4515, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 4, 3)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4515, vel L]
type = velset
trigger1 = time = 1
x = 12.6 * const(size.xscale)

[State 4515, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4515, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4515, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4515, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4515, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4515, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4515, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4515, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4515, hit]
type = hitdef
triggerall = parent, var(13) <= 0
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(80 * ifelse(var(10), 1.2, 1)), 13
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 8
animtype = hard
ground.type = low
ground.slidetime = 21
guard.slidetime = 18
ground.hittime = 21 + ifelse(parent, var(10), 2, 0)
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -3, -5
guard.velocity = -6.6
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(20 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(10 * root, fvar(10))
givepower = ceil(12 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(6 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4515, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4516
ignorehitpause = 1

[State 4515, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4517

[State 4515, projectile blocked]
type = changestate
trigger1 = moveguarded = 1 || movereversed = 1
value = 4518

[State 4515, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4515, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Lp Hadouken Projectile (Level 1) - Collide
[Statedef 4516]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4516, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4516, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4516, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4516, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4516, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4516, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Lp Hadouken Projectile (Level 1) - Hit
[Statedef 4517]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4517, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4517, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4517, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4517, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4517, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Lp Hadouken Projectile (Level 1) - Blocked/Reversed
[Statedef 4518]
type = A
movetype = I
physics = N
anim = 1005
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4518, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4518, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4518, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4518, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4518, destroy]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------------------------------------
; VT1 Mp Hadouken (Charge)
[Statedef 4520]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4510
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4520, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4520, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
[State 4520, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4520, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4520, pos]
type = posadd
trigger1 = time =[0,1]
x = -7.5*const(size.xscale)

[State 4520, pos]
type = posadd
trigger1 = time =[2,4]
x = -5*const(size.xscale)

;------ combo scaling ------
;------ cancel potential ------
[State 4520, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4520, voice]
type = playsnd
trigger1 = time = 7
value = 4500, 4
channel = 0

[State 4520, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 13
channel = 1

;------ hitdef and sparks ------
[State 4520, wind]
type = explod
trigger1 = animelem = 5
anim = 4512
id = 4510
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * -20, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4520, uncharged]
type = changestate
triggerall = command != "hold_y"
trigger1 = time = [7,18]
value = 4521

[State 4520, level 2]
type = changestate
triggerall = command != "hold_y"
trigger1 = time = [19,58]
value = 4540

[State 4520, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(5) >= 0 
ID = 4508
pos = -10,-65
postype = p1

[State 4520, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(5) >= 0 
ID = 4509
pos = -15,-85
postype = p1

[State 4520, return]
type = changestate
trigger1 = animtime = 0
value = 4550

;--------------------------------------------------------------------
; VT1 Mp Hadouken (Level 1)
[Statedef 4521]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4511
poweradd = 0
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
;------ counter hit time ------
;------ juggle points -------
[State 4521, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4521, pos]
type = posadd
trigger1 = time =0
x = 3*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =1
x = 9*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =2
x = 13*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =3
x = 16*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =4
x = 19*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =5
x = 29*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =6
x = 4*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =7
x = -1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =8
x = -2*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =9
x = -3*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =10
x = -2*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =13
x = -1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =14
x = -1*const(size.xscale)


[State 4521, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =26
x = 1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =27
x = 1*const(size.xscale)


[State 4521, pos]
type = posadd
trigger1 = time =30
x = -1*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =31
x = -2*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =32
x = -4*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =33
x = -9*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =34
x = -15*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =35
x = -15*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =36
x = -9*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =37
x = -4*const(size.xscale)

[State 4521, pos]
type = posadd
trigger1 = time =38
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4521, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4521, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4521, voice]
type = playsnd
trigger1 = time = 0
value = 4500, 6
channel = 0

;------ hitdef and sparks ------
[State 4521, projectile]
type = helper
trigger1 = animelem = 7
id = 4521
stateno = 4525
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4521, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4521, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = -18, -75 
postype = p1

[State 4521, ModifyExplod]
type = ModifyExplod
trigger1 = time = 4
ID = 4510
pos = -15, -75 
postype = p1

[State 4521, ModifyExplod]
type = ModifyExplod
trigger1 = time = 5
ID = 4510
pos = 11, -75 
postype = p1

[State 4521, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 7
id = 4510

[State 4521, wind]
type = explod
trigger1 = animelem = 7
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4521, return ctrl]
type = ctrlset
trigger1 = time = 35
value = 1

[State 4521, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Mp Hadouken Projectile (Level 1)
;4526 collide
;4527 hit
;4528 block/reversed
[Statedef 4525]
type = A
movetype = A
physics = N
anim = 4515
ctrl = 0
juggle = 0
sprpriority = 3

;------ combo scaling ------
[State 4515, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4515, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 4, 3)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4525, vel L]
type = velset
trigger1 = time = 1
x = 15 * const(size.xscale)

[State 4525, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4525, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4525, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4525, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4525, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4525, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4525, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4525, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4525, hit]
type = hitdef
triggerall = parent, var(13) <= 0
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(80 * ifelse(var(10), 1.2, 1)), 13
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 8
animtype = hard
ground.type = low
ground.slidetime = 21
guard.slidetime = 18
ground.hittime = 21 + ifelse(parent, var(10), 2, 0)
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -3, -5
guard.velocity = -6.6
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(20 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(10 * root, fvar(10))
givepower = ceil(12 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(6 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4525, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4526
ignorehitpause = 1

[State 4525, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4527

[State 4525, projectile blocked]
type = changestate
trigger1 = moveguarded = 1 || movereversed = 1
value = 4528

[State 4525, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4525, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Mp Hadouken Projectile (Level 1) - Collide
[Statedef 4526]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4526, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4526, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4526, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4526, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4526, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4526, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Mp Hadouken Projectile (Level 1) - Hit
[Statedef 4527]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4527, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4527, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4527, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4527, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4527, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Mp Hadouken Projectile (Level 1) - Blocked/Reversed
[Statedef 4528]
type = A
movetype = I
physics = N
anim = 1005
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4528, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4528, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4528, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4528, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4528, destroy]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------------------------------------
; VT1 Hp Hadouken (Charge)
[Statedef 4530]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4510
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4530, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4530, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
[State 4530, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4530, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4530, pos]
type = posadd
trigger1 = time =[0,1]
x = -7.5*const(size.xscale)

[State 4530, pos]
type = posadd
trigger1 = time =[2,4]
x = -5*const(size.xscale)

;------ combo scaling ------
;------ cancel potential ------
[State 4530, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4530, voice]
type = playsnd
trigger1 = time = 7
value = 4500, 4
channel = 0

[State 4530, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 13
channel = 1

;------ hitdef and sparks ------
[State 4530, wind]
type = explod
trigger1 = animelem = 5
anim = 4512
id = 4510
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * -20, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4530, uncharged]
type = changestate
triggerall = command !="hold_z"
trigger1 = time = [7,18]
value = 4531

[State 4530, level 2]
type = changestate
triggerall = command !="hold_z"
trigger1 = time = [19,58]
value = 4540

[State 4530, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(5) >= 0 
ID = 4508
pos = -10,-65
postype = p1

[State 4530, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(5) >= 0 
ID = 4509
pos = -15,-85
postype = p1

[State 4530, return]
type = changestate
trigger1 = animtime = 0
value = 4550

;--------------------------------------------------------------------
; VT1 Hp Hadouken (Level 1)
[Statedef 4531]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4511
poweradd = 0
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
;------ counter hit time ------
;------ juggle points -------
[State 4531, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4531, pos]
type = posadd
trigger1 = time =0
x = 3*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =1
x = 9*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =2
x = 13*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =3
x = 16*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =4
x = 19*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =5
x = 29*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =6
x = 4*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =7
x = -1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =8
x = -2*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =9
x = -3*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =10
x = -2*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =13
x = -1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =14
x = -1*const(size.xscale)


[State 4531, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =26
x = 1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =27
x = 1*const(size.xscale)


[State 4531, pos]
type = posadd
trigger1 = time =30
x = -1*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =31
x = -2*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =32
x = -4*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =33
x = -9*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =34
x = -15*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =35
x = -15*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =36
x = -9*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =37
x = -4*const(size.xscale)

[State 4531, pos]
type = posadd
trigger1 = time =38
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4531, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4531, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4531, voice]
type = playsnd
trigger1 = time = 0
value = 4500, 6
channel = 0

;------ hitdef and sparks ------
[State 4531, projectile]
type = helper
trigger1 = animelem = 7
id = 4531
stateno = 4535
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4531, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4521, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = -18, -75 
postype = p1

[State 4531, ModifyExplod]
type = ModifyExplod
trigger1 = time = 4
ID = 4510
pos = -15, -75 
postype = p1

[State 4531, ModifyExplod]
type = ModifyExplod
trigger1 = time = 5
ID = 4510
pos = 11, -75 
postype = p1

[State 4531, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 7
id = 4510

[State 4531, wind]
type = explod
trigger1 = animelem = 7
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4531, return ctrl]
type = ctrlset
trigger1 = time = 35
value = 1

[State 4531, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Hp Hadouken Projectile (Level 1)
;4536 collide
;4537 hit
;4538 block/reversed
[Statedef 4535]
type = A
movetype = A
physics = N
anim = 4515
ctrl = 0
juggle = 0
sprpriority = 3

;------ combo scaling ------
[State 4535, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4535, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 4, 3)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4535, vel L]
type = velset
trigger1 = time = 1
x = 17.4 * const(size.xscale)

[State 4535, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4535, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4535, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4535, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4535, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4535, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4535, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4535, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4535, hit]
type = hitdef
triggerall = parent, var(13) <= 0
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(80 * ifelse(var(10), 1.2, 1)), 13
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 8
animtype = hard
ground.type = low
ground.slidetime = 21
guard.slidetime = 18
ground.hittime = 21 + ifelse(parent, var(10), 2, 0)
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -3, -5
guard.velocity = -6.6
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(20 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(10 * root, fvar(10))
givepower = ceil(12 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(6 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4535, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4536
ignorehitpause = 1

[State 4535, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4537

[State 4535, projectile blocked]
type = changestate
trigger1 = moveguarded = 1 || movereversed = 1
value = 4538

[State 4535, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4535, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Hp Hadouken Projectile (Level 1) - Collide
[Statedef 4536]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4536, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4536, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4536, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4536, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4536, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4536, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hp Hadouken Projectile (Level 1) - Hit
[Statedef 4537]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4537, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4537, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4537, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4537, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4537, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hp Hadouken Projectile (Level 1) - Blocked/Reversed
[Statedef 4538]
type = A
movetype = I
physics = N
anim = 1005
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4538, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4538, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4538, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4538, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4538, destroy]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------------------------------------
; VT1 Hadouken (Level 2)
[Statedef 4540]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4540
poweradd = 0
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
[State 4540, reset 12]
type = varset
trigger1 = time = 0
var(12) = 0

;------ counter hit time ------
;------ juggle points -------
[State 4540, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4540, pos]
type = posadd
trigger1 = time =0
x = 13*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =1
x = 16*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =2
x = 19*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =3
x = 29*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =4
x = 4*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =5
x = -1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =6
x = -2*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =7
x = -3*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =8
x = -2*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =9
x = -1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =10
x = -1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)


[State 4540, pos]
type = posadd
trigger1 = time =17
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =18
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)


[State 4540, pos]
type = posadd
trigger1 = time =28
x = -1*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =29
x = -2*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =30
x = -4*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =31
x = -9*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =32
x = -15*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =33
x = -15*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =34
x = -9*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =35
x = -4*const(size.xscale)

[State 4540, pos]
type = posadd
trigger1 = time =36
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4540, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4540, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4540, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 5
channel = 0

;------ hitdef and sparks ------
[State 4540, projectile]
type = helper
trigger1 = animelem = 5
id = 4540
stateno = 4542
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4540, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4540, ModifyExplod]
type = ModifyExplod
trigger1 = time = 1
ID = 4510
pos = -18, -75 
postype = p1

[State 4540, ModifyExplod]
type = ModifyExplod
trigger1 = time = 2
ID = 4510
pos = -15, -75 
postype = p1

[State 4540, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = 11, -75 
postype = p1

[State 4540, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 5
id = 4510

[State 4540, wind]
type = explod
trigger1 = animelem = 5
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4540, return ctrl]
type = ctrlset
trigger1 = time = 36
value = 1

[State 4540, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 2)
;4543 1st collide
;4544 1st contact
;4545 2nd collide
;4546 2nd hit
;4547 2nd block/reversed
[Statedef 4542]
type = A
movetype = A
physics = N
anim = 4515
ctrl = 0
juggle = 0
sprpriority = 3

;------ combo scaling ------
[State 4542, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4542, set 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4542, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4542, vel L]
type = velset
trigger1 = time = 1
x = 19 * const(size.xscale)

[State 4542, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4542, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4542, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4542, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4542, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4542, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4542, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4542, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4542, hit]
type = hitdef
triggerall = parent, var(13) <= 2
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(10 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(5 * root, fvar(10))
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4542, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4543
ignorehitpause = 1

[State 4535, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4544

[State 4542, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4542, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 2) - 1st Collide
[Statedef 4543]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

;------ combo scaling ------
[State 4543, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4543, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 4
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4543, vel L]
type = velset
trigger1 = time = 1
x = 19 * const(size.xscale)

[State 4543, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4543, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4543, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4543, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4543, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4543, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4543, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4543, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4543, hit]
type = hitdef
triggerall = parent, var(13) <= 3
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(10 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(5 * root, fvar(10))
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4543, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4545
ignorehitpause = 1

[State 4543, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4546

[State 4543, projectile block]
type = changestate
trigger1 = moveguarded = 1 || movereversed = 1
value = 4547

[State 4543, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4543, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 2) - 1st Contact
[Statedef 4544]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

;------ combo scaling ------
[State 4544, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4544, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 4
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4544, vel L]
type = velset
trigger1 = time = 1
x = 19 * const(size.xscale)

[State 4544, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4544, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4544, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4544, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4544, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4544, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4544, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4544, hit]
type = hitdef
triggerall = parent, var(13) <= 3
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(10 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(5 * root, fvar(10))
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4544, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4545
ignorehitpause = 1

[State 4544, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4546

[State 4544, projectile block]
type = changestate
trigger1 = moveguarded = 1 || movereversed = 1
value = 4547

[State 4544, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4544, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 2) - 2nd Collide
[Statedef 4545]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4545, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4545, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4545, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4545, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4545, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4545, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 2) - 2nd Hit
[Statedef 4546]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4546, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4546, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4546, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4546, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4546, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 2) - 2nd Blocked/Reversed
[Statedef 4547]
type = A
movetype = I
physics = N
anim = 1005
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4547, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4547, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4547, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4547, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4547, destroy]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------------------------------------
; VT1 Hadouken (Level 3)
[Statedef 4550]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4550
poweradd = 0
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
;------ counter hit time ------
;------ juggle points -------
[State 4550, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4550, pos]
type = posadd
trigger1 = time =0
x = 9*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =1
x = 13*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =2
x = 16*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =3
x = 19*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =4
x = 29*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =5
x = 4*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =6
x = -1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =7
x = -2*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =8
x = -3*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =9
x = -2*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =10
x = -1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =13
x = -1*const(size.xscale)


[State 4550, pos]
type = posadd
trigger1 = time =18
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =26
x = 1*const(size.xscale)


[State 4550, pos]
type = posadd
trigger1 = time =29
x = -1*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =30
x = -2*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =31
x = -4*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =32
x = -9*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =33
x = -15*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =34
x = -15*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =35
x = -9*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =36
x = -4*const(size.xscale)

[State 4550, pos]
type = posadd
trigger1 = time =37
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4550, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4550, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4550, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 17
channel = 0

;------ hitdef and sparks ------
[State 4550, projectile]
type = helper
trigger1 = animelem = 6
id = 4550
stateno = 4551
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4550, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4550, ModifyExplod]
type = ModifyExplod
trigger1 = time = 2
ID = 4510
pos = -18, -75 
postype = p1

[State 4550, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = -15, -75 
postype = p1

[State 4550, ModifyExplod]
type = ModifyExplod
trigger1 = time = 4
ID = 4510
pos = 11, -75 
postype = p1

[State 4550, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 6
id = 4510

[State 4550, wind]
type = explod
trigger1 = animelem = 6
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4550, return ctrl]
type = ctrlset
trigger1 = time = 37
value = 1

[State 4550, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3)
;4552 1st collide
;4553 1st contact
;4554 2nd collide
;4555 2nd contact
;4556 3rd collide
;4557 3rd hit
;4558 3rd block
;4559 3rd reversed
[Statedef 4551]
type = A
movetype = A
physics = N
anim = 4515
ctrl = 0
juggle = 0
sprpriority = 3

;------ combo scaling ------
[State 4551, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4551, set 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4551, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4551, vel L]
type = velset
trigger1 = time = 1
x = 19.8 * const(size.xscale)

[State 4551, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4551, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4551, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4551, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4551, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4551, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4551, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4551, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4551, hit]
type = hitdef
triggerall = parent, var(13) <= 2
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(5 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4551, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4552
ignorehitpause = 1

[State 4551, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4553

[State 4551, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4551, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 1st Collide
[Statedef 4552]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

;------ combo scaling ------
[State 4552, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4552, 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4552, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4552, vel L]
type = velset
trigger1 = time = 1
x = 19.8 * const(size.xscale)

[State 4552, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4552, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4552, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4552, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4552, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4552, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4552, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4552, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4552, hit]
type = hitdef
triggerall = parent, var(13) <= 2
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(5 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4552, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4554
ignorehitpause = 1

[State 4552, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4555

[State 4552, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4552, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 1st Contact
[Statedef 4553]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

;------ combo scaling ------
[State 4553, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4553, 12]
type = parentvarset
trigger1 = movehit = 1
var(42) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4553, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4553, vel L]
type = velset
trigger1 = time = 1
x = 19.8 * const(size.xscale)

[State 4553, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4553, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4553, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4553, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4553, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4553, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4553, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4553, hit]
type = hitdef
triggerall = parent, var(13) <= 2
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(5 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4553, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4554
ignorehitpause = 1

[State 4553, projectile block]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4555

[State 4553, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4553, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 2nd Collide
[Statedef 4554]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

;------ combo scaling ------
[State 4554, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4554, increment combo count]
type = parentvaradd
trigger1 = moveguarded = 1
v = 40
value = 5
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4554, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 4
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4554, vel L]
type = velset
trigger1 = time = 1
x = 19.8 * const(size.xscale)

[State 4554, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4554, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4554, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4554, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4554, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4554, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4554, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4554, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4554, hit]
type = hitdef
triggerall = parent, var(13) <= 3
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = s15026
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(10 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(5 * root, fvar(10))
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4554, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4556
ignorehitpause = 1

[State 4554, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4557

[State 4554, projectile block]
type = changestate
trigger1 = moveguarded = 1
value = 4558

[State 4554, projectile reversed]
type = changestate
trigger1 = movereversed = 1
value = 4559

[State 4554, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4554, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 2nd Contact
[Statedef 4555]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

;------ combo scaling ------
[State 4555, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4555, increment combo count]
type = parentvaradd
trigger1 = moveguarded = 1
v = 40
value = 5
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4555, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 4
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4544, vel L]
type = velset
trigger1 = time = 1
x = 19.8 * const(size.xscale)

[State 4555, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4555, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4555, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4555, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4555, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4555, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4555, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4555, hit]
type = hitdef
triggerall = parent, var(13) <= 3
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = s15026
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(10 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(5 * root, fvar(10))
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4555, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4556
ignorehitpause = 1

[State 4555, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4557

[State 4555, projectile block]
type = changestate
trigger1 = moveguarded = 1
value = 4558

[State 4555, projectile reverse]
type = changestate
trigger1 =  movereversed = 1
value = 4559

[State 4555, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4555, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 3rd Collide
[Statedef 4556]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4556, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4556, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4556, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4556, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4556, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4556, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 3rd Hit
[Statedef 4557]
type = A
movetype = I
physics = N
anim = 1003
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4557, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4557, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4557, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4557, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4557, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 3rd Blocked
[Statedef 4558]
type = A
movetype = I
physics = N
anim = 1005
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4558, guard crush]
type = helper
trigger1 = time = 0
name = "guard crush"
id = 4558
stateno = 4560
postype = p2
pos = 0, 0
ignorehitpause = 1
persistent = 0

[State 4558, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4558, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4558, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4558, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4558, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - 3rd Reversed
[Statedef 4559]
type = A
movetype = I
physics = N
anim = 1005
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4559, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4559, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4559, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4559, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4559, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - Guard Crush
[Statedef 4560]
type = u
movetype = a
physics = n
anim = 4560

[State 4560, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[State 4560, hit]
type = hitdef
trigger1 = animelem = 1
attr = S, NA
sparkno = -1
guard.sparkno = -1
hitflag = MAF
guardflag = 
animtype = hard
priority = 6, hit
damage = ceil(25 * cond((parent, var(10)), 1.2, 1)), 0
pausetime = 1, 8
guard.pausetime = 1, 8
hitsound = s1, 23
guardsound = s1, -1
ground.type = low
ground.slidetime = 45
guard.slidetime = 25
ground.hittime = 45
guard.hittime = 25
guard.ctrltime = 25
ground.velocity = 6
guard.velocity = 6
air.hittime = 100
air.velocity = 2.4, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = 0, 0
givepower = 0, 0
kill = 0
guard.kill = 0
envshake.time = 9
envshake.ampl = -6
envshake.freq = 120

[State 4560, destroyself]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------------------------------------
; VT Ex Hadouken (Charge)
[Statedef 4570]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4570
poweradd = -300
juggle = 0
sprpriority = 2
facep2 = 1

;------ ex effects ------
[State 4570, ex sound effect]
type = playsnd
trigger1 = animelem = 1
value = 0, 20

[State 4570, Blink Yellow]
type = PalFX
trigger1 = Time = 0
time = 41
sinadd = 164,104,0,20
add = 200, 50, 0
mul = 250,224,0

;------ stop spec move buffer ------
[State 4570, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4570, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4570, 12]
type = varset
trigger1 = time = 0
var(12) = 0

;------ counter hit time ------
[State 4570, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4570, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4570, pos]
type = posadd
trigger1 = time =[0,1]
x = -7.5*const(size.xscale)

[State 4570, pos]
type = posadd
trigger1 = time = 2
x = -10*const(size.xscale)

[State 4570, pos]
type = posadd
trigger1 = time = 3
x = -5*const(size.xscale)

;------ combo scaling ------
;------ cancel potential ------
[State 4570, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4570, voice]
type = playsnd
trigger1 = time = 7
value = 4500, 4
channel = 0

[State 4570, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 13
channel = 1

;------ hitdef and sparks ------
[State 4570, wind]
type = explod
trigger1 = animelem = 5
anim = 4512
id = 4510
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * -20, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4570, uncharged]
type = changestate
triggerall = var(39) != 24 && var(39) != 40 && var(39) != 48
trigger1 = time = [6, 40]
value = 4571

[State 4570, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4508
pos = -10,-65
postype = p1

[State 4570, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4509
pos = -15,-85
postype = p1

[State 4570, return]
type = changestate
trigger1 = animtime = 0
value = 4580

;--------------------------------------------------------------------
; VT1 Ex Hadouken (Level 1)
[Statedef 4571]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4550
poweradd = 0
juggle = 0
sprpriority = 2

[State 4570, ex splat]
type = explod
trigger1 = animelem = 1
anim = 15030
id = 4570
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * -20,-80
scale = 0.35, 0.35
sprpriority = -1
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0

[State 4570, ex splat]
type = explod
trigger1 = animelem = 1
anim = 1031
id = 4570
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 30,-70
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0

;------ stop spec move buffer ------
;------ counter hit time ------
;------ juggle points -------
[State 4571, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4571, pos]
type = posadd
trigger1 = time =0
x = 9*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =1
x = 16*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =2
x = 19*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =3
x = 29*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =4
x = 4*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =5
x = -1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =6
x = -2*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =7
x = -3*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =8
x = -2*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =9
x = -1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =10
x = -1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)


[State 4571, pos]
type = posadd
trigger1 = time =17
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =18
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =28
x = -1*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =29
x = -2*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =30
x = -4*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =31
x = -9*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =32
x = -15*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =33
x = -15*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =34
x = -9*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =35
x = -4*const(size.xscale)

[State 4571, pos]
type = posadd
trigger1 = time =36
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4571, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4571, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4571, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 7
channel = 0

;------ hitdef and sparks ------
[State 4571, projectile]
type = helper
trigger1 = animelem = 6
id = 4571
stateno = 4572
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4571, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4571, ModifyExplod]
type = ModifyExplod
trigger1 = time = 2
ID = 4510
pos = -18, -75 
postype = p1

[State 4571, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = -15, -75 
postype = p1

[State 4571, ModifyExplod]
type = ModifyExplod
trigger1 = time = 4
ID = 4510
pos = 11, -75 
postype = p1

[State 4571, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 6
id = 4510

[State 4571, wind]
type = explod
trigger1 = animelem = 6
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4571, return ctrl]
type = ctrlset
trigger1 = time = 37
value = 1

[State 4571, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1)
;4573 1st collide
;4574 1st contact
;4575 2nd collide
;4576 2nd contact
;4577 3rd collide
;4578 3rd hit
;4579 3rd block/reversed
[Statedef 4572]
type = A
movetype = A
physics = N
anim = 4575
ctrl = 0
juggle = 0
sprpriority = 3

[State 4572, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4572, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4572, set 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4572, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4572, vel L]
type = velset
trigger1 = time = 1
x = 18.9 * const(size.xscale)

[State 4572, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4572, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4572, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4572, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4572, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4572, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4572, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4572, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4572, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4572, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4573
ignorehitpause = 1

[State 4572, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4574

[State 4572, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4572, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 1st Collide
[Statedef 4573]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4573, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4573, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4573, 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4573, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4573, vel L]
type = velset
trigger1 = time = 1
x = 18.9 * const(size.xscale)

[State 4573, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4573, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4573, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4573, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4573, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4573, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4573, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4573, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4573, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4573, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4575
ignorehitpause = 1

[State 4573, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4576

[State 4573, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4573, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 1st Contact
[Statedef 4574]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4574, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4574, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4574, 12]
type = parentvarset
trigger1 = movehit = 1
var(42) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4574, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4574, vel L]
type = velset
trigger1 = time = 1
x = 18.9 * const(size.xscale)

[State 4574, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4574, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4574, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4574, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4574, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4574, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4574, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4574, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4574, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4575
ignorehitpause = 1

[State 4574, projectile block]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4576

[State 4574, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4574, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 2nd Collide
[Statedef 4575]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4575, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4575, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4575, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 6, 2)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4575, vel L]
type = velset
trigger1 = time = 1
x = 18.9 * const(size.xscale)

[State 4575, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4575, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4575, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4575, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4575, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4575, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4575, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4575, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4575, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4575, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4577
ignorehitpause = 1

[State 4575, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4578

[State 4575, projectile block]
type = changestate
trigger1 = moveguarded = 1 || movereversed = 1
value = 4579

[State 4575, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4575, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 2nd Contact
[Statedef 4576]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4576, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4576, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4576, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 6, 2)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4544, vel L]
type = velset
trigger1 = time = 1
x = 18.9 * const(size.xscale)

[State 4576, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4576, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4576, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4576, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4576, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4576, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4576, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4576, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = -1
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4576, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4577
ignorehitpause = 1

[State 4576, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4578

[State 4576, projectile block/reversed]
type = changestate
trigger1 = moveguarded = 1 || movereversed  = 1
value = 4579

[State 4576, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4576, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 3rd Collide
[Statedef 4577]
type = A
movetype = I
physics = N
anim = 4577
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4577, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4577, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4577, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4577, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4577, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4577, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 3rd Hit
[Statedef 4578]
type = A
movetype = I
physics = N
anim = 4576
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4578, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4578, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4578, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4578, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4578, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 1) - 3rd Blocked/Reversed
[Statedef 4579]
type = A
movetype = I
physics = N
anim = 4577
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4579, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4579, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4579, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4579, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4579, destroy]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------------------------------------
; VT1 Ex Hadouken (Level 2)
[Statedef 4580]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4550
poweradd = 0
juggle = 0
sprpriority = 2

[State 4580, ex splat]
type = explod
trigger1 = animelem = 1
anim = 15030
id = 4580
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * -20,-80
scale = 0.35, 0.35
sprpriority = -1
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0

[State 4580, ex splat]
type = explod
trigger1 = animelem = 1
anim = 1031
id = 4570
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 30,-70
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0


;------ stop spec move buffer ------
;------ counter hit time ------
;------ juggle points -------
[State 4580, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4580, pos]
type = posadd
trigger1 = time =0
x = 9*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =1
x = 16*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =2
x = 19*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =3
x = 29*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =4
x = 4*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =5
x = -1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =6
x = -2*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =7
x = -3*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =8
x = -2*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =9
x = -1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =10
x = -1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)


[State 4580, pos]
type = posadd
trigger1 = time =17
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =18
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =19
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =21
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =22
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =23
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =25
x = 1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =28
x = -1*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =29
x = -2*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =30
x = -4*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =31
x = -9*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =32
x = -15*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =33
x = -15*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =34
x = -9*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =35
x = -4*const(size.xscale)

[State 4580, pos]
type = posadd
trigger1 = time =36
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4580, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4580, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4580, voice]
type = playsnd
trigger1 = time = 1
value = 4500, 17
channel = 0

;------ hitdef and sparks ------
[State 4580, projectile]
type = helper
trigger1 = animelem = 6
id = 4580
stateno = 4581
pos = 62, -73
ownpal = 1
size.xscale = 0.35
size.yscale = 0.35
keyctrl = 0

[State 4580, ModifyExplod]
type = ModifyExplod
trigger1 = time = 0
ID = 4510
pos = -19, -75 
postype = p1

[State 4580, ModifyExplod]
type = ModifyExplod
trigger1 = time = 2
ID = 4510
pos = -18, -75 
postype = p1

[State 4580, ModifyExplod]
type = ModifyExplod
trigger1 = time = 3
ID = 4510
pos = -15, -75 
postype = p1

[State 4580, ModifyExplod]
type = ModifyExplod
trigger1 = time = 4
ID = 4510
pos = 11, -75 
postype = p1

[State 4580, RemoveExplod]
type = RemoveExplod
trigger1 = animelem = 6
id = 4510

[State 4580, wind]
type = explod
trigger1 = animelem = 6
anim = 4513
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 50, -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 1

[State 4580, return ctrl]
type = ctrlset
trigger1 = time = 37
value = 1

[State 4580, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2)
;4582 1st collide
;4583 1st contact
;4584 2nd collide
;4585 2nd contact
;4586 3rd collide
;4587 3rd hit
;4588 3rd block
;4589 3rd reversed
[Statedef 4581]
type = A
movetype = A
physics = N
anim = 4575
ctrl = 0
juggle = 0
sprpriority = 3

[State 4581, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4581, increment combo count]
type = parentvaradd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4581, set 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4581, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4581, vel L]
type = velset
trigger1 = time = 1
x = 20.5 * const(size.xscale)

[State 4581, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4581, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4581, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4581, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4581, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4581, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4581, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
[State 4581, fx]
type = playsnd
trigger1 = time = 0
value = 4500, 14
channel = 1

;------ hitdef and sparks ------
[State 4581, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4581, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4582
ignorehitpause = 1

[State 4581, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4583

[State 4581, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4581, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 1st Collide
[Statedef 4582]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4582, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4582, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4582, 12]
type = parentvarset
trigger1 = movehit = 1
var(12) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4582, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4582, vel L]
type = velset
trigger1 = time = 1
x = 20.5 * const(size.xscale)

[State 4582, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4582, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4582, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4582, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4582, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4582, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4582, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4582, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4582, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4582, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4584
ignorehitpause = 1

[State 4582, projectile contact]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4585

[State 4582, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4582, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 1st Contact
[Statedef 4583]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4583, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4583, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4583, 12]
type = parentvarset
trigger1 = movehit = 1
var(42) = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4583, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4583, vel L]
type = velset
trigger1 = time = 1
x = 20.5 * const(size.xscale)

[State 4583, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4583, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4583, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4583, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4583, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4583, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4583, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4583, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(40 * ifelse(var(10), 1.2, 1)), 7
sparkno = -1
guard.sparkno = -1
pausetime = 5, 6
guard.pausetime = 3, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 13
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -5
guard.velocity = -4.8
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(3 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(2 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4583, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4584
ignorehitpause = 1

[State 4583, projectile block]
type = changestate
trigger1 = movecontact = 1 || movereversed = 1 || movereversed = 1
value = 4585

[State 4583, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4583, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 2nd Collide
[Statedef 4584]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4584, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4584, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4584, increment combo count]
type = parentvaradd
trigger1 = moveguarded = 1
v = 40
value = 5
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4584, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 6, 2)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4584, vel L]
type = velset
trigger1 = time = 1
x = 20.5 * const(size.xscale)

[State 4584, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4584, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4584, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4584, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4584, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4584, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4584, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4584, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4584, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = s15026
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4584, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4586
ignorehitpause = 1

[State 4584, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4587

[State 4584, projectile block]
type = changestate
trigger1 = moveguarded = 1 
value = 4588

[State 4584, projectile reversed]
type = changestate
trigger1 = movereversed = 1
value = 4589

[State 4584, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4584, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;--------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 2nd Contact
[Statedef 4585]
type = A
movetype = A
physics = N
ctrl = 0
juggle = 0
velset = 0, 0
sprpriority = 3

[State 4585, Ex KO var]
type = parentvarset
trigger1 = movehit = 1
var(16) = 3
ignorehitpause = 1

;------ combo scaling ------
[State 4585, increment combo count]
type = parentvaradd
triggerall = !parent,  var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4585, increment combo count]
type = parentvaradd
trigger1 = moveguarded = 1
v = 40
value = 5
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4585, juggle]
type = parentvaradd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = cond(parent, var(13), 6, 2)
ignorehitpause = 1
persistent = 0

;------ projectile properties ------
[State 4544, vel L]
type = velset
trigger1 = time = 1
x = 20.5 * const(size.xscale)

[State 4585, projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 1

[State 4585, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4585, push]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4585, screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0
ignorehitpause = 1

[State 4585, no hits]
type = nothitby
trigger1 = 1
value = , AA, AT
ignorehitpause = 1

;------ cancels ------
[State 4585, v-trigger cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 12
ignorehitpause = 1

[State 4585, super cancel]
type = parentvarset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 12
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4585, hit]
type = hitdef
triggerall = parent, var(13) <= 6
trigger1 = time = 0
attr = S, SP
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 10
guardsound = s1, 22
damage = ceil(50 * ifelse(var(10), 1.2, 1)), 8
sparkno = -1
guard.sparkno = s15026
pausetime = 1, 8
guard.pausetime = 1, 5
animtype = hard
ground.type = low
ground.slidetime = 20
guard.slidetime = 22
ground.hittime = 20 + ifelse(parent, var(10), 2, 0)
guard.hittime = 22
guard.ctrltime = 22
ground.velocity = -3, -5
guard.velocity = -7.2
air.velocity = -3, -5
fall = 1
fall.recover = 0
yaccel = 0.4
getpower = 0, 0
givepower = ceil(6 * root, fvar(10) * ifelse( var(10), 1.2, 1)), ceil(3 * root, fvar(10))
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4585, projectile collision]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 4586
ignorehitpause = 1

[State 4585, projectile hit]
type = changestate
trigger1 = movehit = 1
value = 4587

[State 4585, projectile block/reversed]
type = changestate
trigger1 = moveguarded = 1 || moveguarded = 1
value = 4588

[State 4585, reset projectile detection]
type = parentvarset
trigger1 = FrontEdgeDist < -60
var(17) = 0

[State 4585, end]
type = destroyself
trigger1 = FrontEdgeDist < -60

;---------------------------------------------------------------------------
; VT1 Ex Hadouken (Level 2) - 3rd Collide
[Statedef 4586]
type = A
movetype = I
physics = N
anim = 4577
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4586, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4586, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4586, cancel sound]
type = playsnd
trigger1 = time = 1
value = 1, 11
volumescale = 75

[State 4586, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4586, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4586, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 3rd Hit
[Statedef 4587]
type = A
movetype = I
physics = N
anim = 4576
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4587, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4587, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4587, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4587, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4587, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 3rd Blocked
[Statedef 4588]
type = A
movetype = I
physics = N
anim = 4577
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4558, guard crush]
type = helper
trigger1 = time = 0
name = "guard crush"
id = 4558
stateno = 4560
postype = p2
pos = 0, 0
ignorehitpause = 1
persistent = 0

[State 4558, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4558, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4558, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4558, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4558, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Ex Hadouken Projectile (Level 2) - 3rd Reversed
[Statedef 4589]
type = A
movetype = I
physics = N
anim = 4577
velset = 0, 0
ctrl = 0
sprpriority = 3

[State 4589, reset projectile detection]
type = parentvarset
trigger1 = time = 0
var(17) = 0

[State 4589, stop sound]
type = stopsnd
trigger1 = time = 1
channel = 1

[State 4589, shadow]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 4589, no hits]
type = nothitby
trigger1 = 1
value = SCA

[State 4589, destroy]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Hadouken Projectile (Level 3) - Guard Crush
[Statedef 4590]
type = u
movetype = a
physics = n
anim = 4560

[State 4590, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[State 4590, hit]
type = hitdef
trigger1 = animelem = 1
attr = S, NA
sparkno = -1
guard.sparkno = -1
hitflag = MAF
guardflag = 
animtype = hard
priority = 6, hit
damage = ceil(25 * cond((parent, var(10)), 1.2, 1)), 0
pausetime = 1, 8
guard.pausetime = 1, 8
hitsound = s1, 23
guardsound = s1, -1
ground.type = low
ground.slidetime = 45
guard.slidetime = 25
ground.hittime = 45
guard.hittime = 25
guard.ctrltime = 25
ground.velocity = 6
guard.velocity = 6
air.hittime = 100
air.velocity = 2.4, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = 0, 0
givepower = 0, 0
kill = 0
guard.kill = 0
envshake.time = 9
envshake.ampl = -6
envshake.freq = 120

[State 4590, destroyself]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
; VT1 Lp Shoryuken - Ground
[Statedef 4600]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 1100
poweradd = 20
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4600, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4600, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4600, throw invincible]
type = nothitby
trigger1 = 1
value = , AT

;------ counter hit time ------
[State 4600, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 2

[State 4600, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

;------ juggle points -------
[State 4600, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 5
ignorehitpause = 1
persistent = 0

[State 4600, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4600, pos]
type = posadd
trigger1 = time =1
x = 9*const(size.xscale)

[State 4600, pos]
type = posadd
trigger1 = time =2
x = 9*const(size.xscale)

;------ combo scaling ------
[State 4600, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4600, set 12]
type = varset
trigger1 = moveguarded = 1 || movereversed = 1
var(12) = 1

[State 4600, set 12]
type = varset
trigger1 = movehit = 1 
var(12) = 2

;------ cancel potential ------
[State 4600, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4600, vt2 cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(27) = 4
ignorehitpause = 1

[State 4600, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4600, voice]
type = playsnd
trigger1 = time = 1
value = 1100, 0
channel = 0

[State 4600, fx]
type = playsnd
trigger1 = time = 1
value = 1100, 3
volumescale = 75

;------ hitdef and sparks ------
[State 4600, hit]
type = hitdef
triggerall = var(13) <= 6
trigger1 = animelem = 3
attr = S, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(120 * cond(var(10), 1.2, 1)), 30
pausetime = 14, 14
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -60
ground.type = high
ground.slidetime = 39
guard.slidetime = 17
ground.hittime = 39 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -13.4
guard.velocity = -6
air.velocity = -2.6, -13.4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12 * fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4600, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = -12,-40
postype = p1  

[State 4600, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = 25,-40
postype = p1  

[State 4600, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 35,-40
postype = p1  

[State 4600, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4509
pos = 0,-35
postype = p1 
sprpriority = -1

[State 4600, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4508
pos = 45,-60
postype = p1 
 
[State 4600, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4509
pos = 0,-40
postype = p1 
sprpriority = -1

[State 4600, transition]
type = changestate
trigger1 = animtime = 0
value = 4601

;---------------------------------------------------------------------------
; VT1 Lp Shoryuken - Air
[Statedef 4601]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1101
juggle = 0
sprpriority = 2

;------ juggle points -------
[State 4601, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 4
ignorehitpause = 1
persistent = 0

;------ width & positioning ------
[State 4601, 0]
type = velmul
trigger1 = time > 5
x = 0.3

[State 4601, pos]
type = posadd
trigger1 = time =0
x = 9*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =1
x = 9*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =2
x = 8*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =3
x = 7*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =4
x = 6*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =5
x = 6*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =6
x = 5*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =7
x = 4*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =8
x = 3*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =9
x = 2*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =10
x = 2*const(size.xscale)

[State 4601, pos]
type = posadd
trigger1 = time =11
x = 1*const(size.xscale)

[State 4601, pos]
type = velset
trigger1 = time = 3
y = -6.7

[State 4601, VelAdd]
type = VelAdd
trigger1 = animelemtime(4) > 1
y = .55

;------ combo scaling ------
[State 4601, increment combo count]
type = varadd
triggerall = !var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4601, set 12]
type = varset
trigger1 = movehit = 1
var(12) = 2

;------ cancel potential ------
;------ hitdef and sparks ------
[State 4601, hit]
type = hitdef
triggerall = !var(12)
triggerall = var(13) <= 6
trigger1 = animelem = 6
attr = A, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(80 * cond(var(10), 1.2, 1)), 20
pausetime = 13, 13
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -88
ground.type = high
ground.slidetime = 43
guard.slidetime = 17
ground.hittime = 43 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -13.3
guard.velocity = -6
air.velocity = -1.8, -14.7
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12 * fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = 40,-90
postype = p1  

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = -5,-80
postype = p1 
sprpriority = -1

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 20,-130
postype = p1  

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 && animelemtime(14)<0 
ID = 4508
pos = 10,-140
postype = p1  

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) >= 0 && animelemtime(16)<0 
ID = 4509
pos = -30,-90
postype = p1  
sprpriority = 3

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(14) >= 0 && animelemtime(17)<0 
ID = 4508
pos = 0,-135
postype = p1  

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(16) >= 0 && animelemtime(21)<0 
ID = 4509
pos = -10,-87
postype = p1  

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(17) >= 0 
ID = 4508
pos = -20,-130
postype = p1  

[State 4601, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(21) >= 0 
ID = 4509
pos = 5,-85
postype = p1

[State 4601, retract]
type = StateTypeSet
trigger1 = animelem = 12
movetype = i

[State 4601, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value = 4602

;---------------------------------------------------------------------------
; VT1 Lp Shoryuken - Land
[Statedef 4602]
type    = S
movetype = I
physics = S
ctrl = 0
velset = 0, 0
anim = 1102

;------ Ex Hadouken ------
[State 4602, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4602, Hp Denjin Hadouken]
type = varset
triggerall = var(38) <= 7700
triggerall = !isHelper(10371)
triggerall = power >= 900
triggerall = var(15) > 0
triggerall = var(14) = 1
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(50) ;2QCF
trigger1 = command = "z3"
var(38) = 7700

[State 4602, Mp Denjin Hadouken]
type = varset
triggerall = var(38) <= 7600
triggerall = !isHelper(10371)
triggerall = power >= 900
triggerall = var(15) > 0
triggerall = var(14) = 1
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(50) ;2QCF
trigger1 = command = "y3"
var(38) = 7600

[State 4602, Lp Denjin Hadouken]
type = varset
triggerall = var(38) <= 7500
triggerall = !isHelper(10371)
triggerall = power >= 900
triggerall = var(15) > 0
triggerall = var(14) = 1
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(50) ;2QCF
trigger1 = command = "x3"
var(38) = 7500

[State 4602, Hp Shinkuu Hadouken]
type = varset
triggerall = var(38) <= 7200
triggerall = !isHelper(10371)
triggerall = power >= 900
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(50) ;2QCF
trigger1 = command = "z3"
var(38) = 7200

[State 4602, Mp Shinkuu Hadouken]
type = varset
triggerall = var(38) <= 7100
triggerall = !isHelper(10371)
triggerall = power >= 900
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(50) ;2QCF
trigger1 = command = "y3"
var(38) = 7100

[State 4602, Lp Shinkuu Hadouken]
type = varset
triggerall = var(38) <= 7000
triggerall = !isHelper(10371)
triggerall = power >= 900
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(50) ;2QCF
trigger1 = command = "x3"
var(38) = 7000

[State 4602, VT Ex Hadouken]
type = varset
triggerall = var(38) <= 4570
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = var(15)
triggerall = var(14) = 1
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(40) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 4570

[State 4602, Ex Hadouken]
type = varset
triggerall = var(38) <= 1030
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time < 12
triggerall = helper(10371), var(40) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1030

[State 4602, shoryuken transitions]
type = changestate
triggerall = var(12) = 2
triggerall = var(38)
trigger1 = time = [9, 12]
value = var(38)

;---
[State 4602, 1]
type = PlaySnd
trigger1 = Time = 0
value = 0, 14

[State 4602, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 4602, remove special counter hittable]
type = varset
trigger1 = time = 11
fvar(30) = 0

[State 4602, return ctrl]
type = ctrlset
trigger1 = time = 11
value = 1

[State 4602, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Mp Shoryuken - Ground
[Statedef 4610]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 1110
poweradd = 20
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4610, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4610, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4610, air invincible]
type = nothitby
triggerall = p2statetype = a
trigger1 = time < 7
value = , AA

;------ counter hit time ------
[State 4610, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 3

[State 4610, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

;------ juggle points -------
[State 4610, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 5
ignorehitpause = 1
persistent = 0

[State 4610, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4610, pos]
type = posadd
trigger1 = time =2
x = 13*const(size.xscale)

[State 4610, pos]
type = posadd
trigger1 = time =3
x = 13*const(size.xscale)

[State 4610, pos]
type = posadd
trigger1 = time =4
x = 13*const(size.xscale)

;------ combo scaling ------
[State 4610, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4610, set 12]
type = varset
trigger1 = moveguarded = 1 || movereversed = 1
var(12) = 1

[State 4610, set 12]
type = varset
trigger1 = movehit = 1 
var(12) = 2

;------ cancel potential ------
[State 4610, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4610, vt2 cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(27) = 4
ignorehitpause = 1

[State 4610, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4610, voice]
type = playsnd
trigger1 = time = 1
value = 1100, 0
channel = 0

[State 4610, fx]
type = playsnd
trigger1 = time = 1
value = 1100, 3
volumescale = 75

;------ hitdef and sparks ------
[State 4610, hit]
type = hitdef
triggerall = !var(12)
triggerall = var(13) <= 6
trigger1 = animelem = 4
attr = S, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(120 * cond(var(10), 1.2, 1)), 30
pausetime = 14, 14
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -60
ground.type = high
ground.slidetime = 39
guard.slidetime = 17
ground.hittime = 39 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -13.4
guard.velocity = -6
air.velocity = -2.6, -13.4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4610, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = -12,-40
postype = p1  

[State 4610, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = 25,-40
postype = p1  

[State 4610, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 35,-40
postype = p1  

[State 4610, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4509
pos = 0,-35
postype = p1 
sprpriority = -1

[State 4610, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4508
pos = 45,-60
postype = p1 
 
[State 4610, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4509
pos = 0,-40
postype = p1 
sprpriority = -1

[State 4610, transition]
type= changestate
trigger1 = animtime = 0
value = 4611

;---------------------------------------------------------------------------
; VT1 Mp Shoryuken - Air
[Statedef 4611]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1111
juggle = 0
sprpriority = 2

[State 4611, air invincible]
type = nothitby
triggerall = p2statetype = a
trigger1 = time < 1
value = , AA

;------ counter hit time ------
[State 4611, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 6

;------ juggle points -------
[State 4611, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 99
ignorehitpause = 1
persistent = 0

[State 4611, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4611, 0]
type = velmul
trigger1 = time > 5
x = 0.3

[State 4611, pos]
type = posadd
trigger1 = time =0
x = 13*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =1
x = 9*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =2
x = 9*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =3
x = 8*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =4
x = 7*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =5
x = 6*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =6
x = 6*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =7
x = 5*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =8
x = 4*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =9
x = 3*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =10
x = 2*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =11
x = 2*const(size.xscale)

[State 4611, pos]
type = posadd
trigger1 = time =12
x = 1*const(size.xscale)

[State 4611, pos]
type = velset
trigger1 = time = 2
y = -8.5

[State 4611, VelAdd]
type = VelAdd
trigger1 =  animelemtime(3) > 1
y = .55

;------ combo scaling ------
[State 4611, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4611, reset cancels]
type = varrangeset
trigger1 = time = 0
trigger2 = time = 2
first = 27
last = 33
value = 0

[State 4611, super cancel]
type = varset
triggerall = animelemtime(2) <= 0
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4611, hit]
type = hitdef
triggerall = var(13) <= 6
trigger1 = animelem = 1
attr = A, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(120 * cond(var(10), 1.2, 1)), 30
pausetime = 14, 14
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -60
ground.type = high
ground.slidetime = 39
guard.slidetime = 17
ground.hittime = 39 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -13.4
guard.velocity = -6
air.velocity = -2.6, -13.4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4611, hit]
type = hitdef
triggerall = !var(12)
triggerall = var(13) <= 6
trigger1 = time = 2
attr = S, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(80 * cond(var(10), 1.2, 1)), 20
pausetime = 13, 13
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -88
ground.type = high
ground.slidetime = 39
guard.slidetime = 17
ground.hittime = 39 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -13.4
guard.velocity = -6
air.velocity = -2.6, -13.4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12 * fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = 40,-90
postype = p1  

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = -5,-80
postype = p1 
sprpriority = -1

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 20,-130
postype = p1  

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 && animelemtime(14)<0 
ID = 4508
pos = 10,-140
postype = p1  

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) >= 0 && animelemtime(16)<0 
ID = 4509
pos = -30,-90
postype = p1  
sprpriority = 3

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(14) >= 0 && animelemtime(17)<0 
ID = 4508
pos = 0,-135
postype = p1  

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(16) >= 0 && animelemtime(21)<0 
ID = 4509
pos = -10,-87
postype = p1  

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(17) >= 0 
ID = 4508
pos = -20,-130
postype = p1  

[State 4611, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(21) >= 0 
ID = 4509
pos = 5,-85
postype = p1

[State 4611, retract]
type = statetypeset
trigger1 = animelem = 10
movetype = i

[State 4611, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value = 4612

;---------------------------------------------------------------------------
; VT1 Mp Shoryuken - Land
[Statedef 4612]
type    = S
movetype = I
physics = S
ctrl = 0
velset = 0, 0
anim = 1102

[State 4612, 1]
type = PlaySnd
trigger1 = Time = 0
value = 0, 14

[State 4612, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 4612, remove special counter hittable]
type = varset
trigger1 = time = 13
fvar(30) = 1

[State 4612, return ctrl]
type = ctrlset
trigger1 = time = 13
value = 1

[State 4612, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Hp Shoryuken - Ground
[Statedef 4620]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 1120
poweradd = 20
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4620, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4620, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4620, air invincible]
type = nothitby
trigger1 = time = [2, 5]
value = , AA, AP

;------ counter hit time ------
[State 4620, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 4

[State 4620, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

;------ juggle points -------
[State 4620, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 5
ignorehitpause = 1
persistent = 0

[State 4620, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4620, pos]
type = posadd
trigger1 = time =1
x = 0*const(size.xscale)

[State 4620, pos]
type = posadd
trigger1 = time =2
x = 16*const(size.xscale)

[State 4620, pos]
type = posadd
trigger1 = time =3
x = 16*const(size.xscale)

[State 4620, pos]
type = posadd
trigger1 = time =4
x = 16*const(size.xscale)

[State 4620, pos]
type = posadd
trigger1 = time =5
x = 16*const(size.xscale)

;------ combo scaling ------
[State 4620, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4620, set 12]
type = varset
trigger1 = moveguarded = 1 || movereversed = 1
var(12) = 1

[State 4620, set 12]
type = varset
trigger1 = movehit = 1 
var(12) = 2

;------ cancel potential ------
[State 4620, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4620, vt2 cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(27) = 4
ignorehitpause = 1

[State 4620, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4620, voice]
type = playsnd
trigger1 = time = 1
value = 1100, 0
channel = 0

[State 4620, fx]
type = playsnd
trigger1 = time = 1
value = 1100, 3
volumescale = 75

;------ hitdef and sparks ------
[State 4620, hit]
type = hitdef
triggerall = var(13) <= 6
trigger1 = animelem = 5
attr = S, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(140 * cond(var(10), 1.2, 1)), 35
pausetime = 16, 16
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -60
ground.type = high
ground.slidetime = 41
guard.slidetime = 17
ground.hittime = 41 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -14
guard.velocity = -7.2
air.velocity = -2.6, -14
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12* fvar(10))
envshake.time = 6
envshake.ampl = -4
envshake.freq = 120
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4620, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = -12,-40
postype = p1  

[State 4620, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = 25,-40
postype = p1  

[State 4620, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 35,-40
postype = p1  

[State 4620, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4509
pos = 0,-35
postype = p1 
sprpriority = -1

[State 4620, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4508
pos = 45,-60
postype = p1 
 
[State 4620, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4509
pos = 0,-40
postype = p1 
sprpriority = -1

[State 4620, wind]
type = explod
trigger1 = animelem = 2
anim = 1125
id = 1102
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * -10, 0 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = -1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4620, transition]
type = changestate
trigger1 = animtime = 0
value = 4621

;---------------------------------------------------------------------------
; VT1 Hp Shoryuken - Air
[Statedef 4621]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1121
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
[State 4621, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4621, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
;------ juggle points -------
[State 4621, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 99
ignorehitpause = 1
persistent = 0

[State 4621, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4621, 0]
type = velmul
trigger1 = time > 5
x = 0.3

[State 4621, pos]
type = posadd
trigger1 = time =0
x = 11*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =1
x = 11*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =2
x = 10*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =3
x = 9*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =4
x = 9*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =5
x = 8*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =6
x = 7*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =7
x = 6*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =8
x = 6*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =9
x = 5*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =10
x = 4*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =11
x = 3*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =12
x = 2*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =13
x = 2*const(size.xscale)

[State 4621, pos]
type = posadd
trigger1 = time =14
x = 1*const(size.xscale)

[State 4621, pos]
type = velset
trigger1 = time = 1
y = -9.2

[State 4621, VelAdd]
type = VelAdd
trigger1 =  animelemtime(2) > 1 ;&& animelemtime(40) <0
y = .55

;------ combo scaling ------
[State 4621, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4621, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
;------ hitdef and sparks ------
[State 4621, hit]
type = hitdef
triggerall = !var(12)
triggerall = var(13) <= 6
trigger1 = animelem = 1
attr = A, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(80 * cond(var(10), 1.2, 1)), 20
pausetime = 13, 13
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -88
ground.type = high
ground.slidetime = 39
guard.slidetime = 17
ground.hittime = 39 + cond(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.6, -13.4
guard.velocity = -6
air.velocity = -2.6, -13.4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * cond(var(10), 1.2, 1)), ceil(20 * fvar(10))
givepower = ceil(24 * fvar(10) * cond(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = 40,-90
postype = p1  

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = -5,-80
postype = p1 
sprpriority = -1

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 20,-130
postype = p1  

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 && animelemtime(14)<0 
ID = 4508
pos = 10,-140
postype = p1  

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) >= 0 && animelemtime(16)<0 
ID = 4509
pos = -30,-90
postype = p1  
sprpriority = 3

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(14) >= 0 && animelemtime(17)<0 
ID = 4508
pos = 0,-135
postype = p1  

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(16) >= 0 && animelemtime(21)<0 
ID = 4509
pos = -10,-87
postype = p1  

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(17) >= 0 
ID = 4508
pos = -20,-130
postype = p1  

[State 4621, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(21) >= 0 
ID = 4509
pos = 5,-85
postype = p1

[State 4621, retract]
type = statetypeset
trigger1 = animelem = 9
movetype = i

[State 4621, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value = 4622

;---------------------------------------------------------------------------
; VT1 Hp Shoryuken - Land
[Statedef 4622]
type    = S
movetype = I
physics = S
ctrl = 0
velset = 0, 0
anim = 1102

[State 4622, 1]
type = PlaySnd
trigger1 = Time = 0
value = 0, 14

[State 4622, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 4622, remove special counter hittable]
type = varset
trigger1 = time = 15
fvar(30) = 0

[State 4622, return ctrl]
type = ctrlset
trigger1 = time = 15
value = 1

[State 4622, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Ex Shoryuken - Ground
[Statedef 4630]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 1130
poweradd = -300
juggle = 0
sprpriority = 2
facep2 = 1

;------ ex effects ------
[State 4630, ex sound effect]
type = playsnd
trigger1 = animelem = 1
value = 0, 20

[State 4630, Blink Yellow]
type = PalFX
trigger1 = Time = 0
time = 41
sinadd = 164,104,0,20
add = 200, 50, 0
mul = 250,224,0

[State 4630, ex splat]
type = explod
trigger1 = animelem = 1
anim = 15030
id = 1130
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * -20,-50
scale = 0.32, 0.32
sprpriority = -1
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0

;------ stop spec move buffer ------
[State 4630, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4630, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4630, reset 12]
type = varset
trigger1 = time = 0
var(12) = 0

[State 4630, invincible]
type = nothitby
trigger1 = 1
value = SCA

;------ counter hit time ------
[State 4630, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 2

[State 4630, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

;------ juggle points -------
[State 4630, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4630, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4630, pos]
type = posadd
trigger1 = time =2
x = 16*const(size.xscale)

[State 4630, pos]
type = posadd
trigger1 = time =3
x = 15*const(size.xscale)

;------ combo scaling ------
[State 4630, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

[State 4630, 12]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(12) = 1

;------ cancel potential ------
[State 4630, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4630, voice]
type = playsnd
trigger1 = time = 1
value = 1100, 1
channel = 0

[State 4630, fx]
type = playsnd
trigger1 = time = 1
value = 1100, 3
volumescale = 75

;------ hitdef and sparks ------
[State 4630, hit]
type = hitdef
triggerall = var(13) <= 8
trigger1 = animelem = 3
attr = S, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(100 * cond(var(10), 1.2, 1)), 25
pausetime = 16, 18
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -60
ground.type = Low
ground.slidetime = 33
guard.slidetime = 18
ground.hittime = 33 + cond(var(10), 2, 0) 
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -0.7, -8
guard.velocity = -7.8
air.velocity = -0.7, -6.5
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.51
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(12 * fvar(10) * cond(var(10), 1.2, 1)), ceil(6* fvar(10))
envshake.time = 6
envshake.ampl = -4
envshake.freq = 120
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4630, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = -12,-40
postype = p1  

[State 4630, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = 25,-40
postype = p1  

[State 4630, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 35,-40
postype = p1  

[State 4630, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4509
pos = 0,-35
postype = p1 
sprpriority = -1

[State 4630, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4508
pos = 45,-60
postype = p1 
 
[State 4630, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 
ID = 4509
pos = 0,-40
postype = p1 
sprpriority = -1

[State 4630, hit spark]
type = explod
trigger1 = movehit = 1
anim = 1135
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 40 + pos x + camerapos x , -70 + pos y
scale = 0.35, 0.35
sprpriority = 2
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4630, wind]
type = explod
trigger1 = animelem = 1
anim = 1133
id = 1133
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 20, -35 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = -1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4630, hit]
type= changestate
trigger1 = movehit && hitshakeover
value = 4635

[State 4630, transition]
type= changestate
trigger1 = animtime = 0
value = 4631

;---------------------------------------------------------------------------
; VT1 Ex Shoryuken - Air
[Statedef 4631]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1131
juggle = 0
sprpriority = 2

[State 4631, air invincible]
type = nothitby
triggerall = p2statetype = a
trigger1 = time < 11
value = SCA

;------ counter hit time ------
;------ juggle points -------
[State 4631, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 99
ignorehitpause = 1
persistent = 0

[State 4631, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4631, 0]
type = velmul
trigger1 = time > 5
x = 0.3

[State 4631, pos]
type = posadd
trigger1 = time =0
x = 14*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =1
x = 13*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =2
x = 13*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =3
x = 12*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =4
x = 11*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =5
x = 10*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =6
x = 9*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =7
x = 9*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =8
x = 8*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =9
x = 7*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =10
x = 6*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =11
x = 6*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =12
x = 5*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =13
x = 6*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =14
x = 2*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =15
x = 2*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =16
x = 2*const(size.xscale)

[State 4631, pos]
type = posadd
trigger1 = time =17
x = 1*const(size.xscale)

[State 4631, pos]
type = velset
trigger1 = time = 2
y = -10

[State 4631, VelAdd]
type = VelAdd
trigger1 =  animelemtime(3) > 1 ;&& animelemtime(40) <0
y = .55

;------ combo scaling ------
[State 4631, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4631, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4631, vt2 cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(27) = 4
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4631, hit]
type = hitdef
triggerall = !var(12)
triggerall = var(13) <= 8
trigger1 = animelem = 5
attr = A, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(80 * cond(var(10), 1.2, 1)), 20
pausetime = 16, 16
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -88
ground.type = high
ground.slidetime = 39
guard.slidetime = 18
ground.hittime = 39 + cond(var(10), 2, 0) 
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -2.6, -13
guard.velocity = -7.8
air.velocity = -2.6, -13
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.65
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(18 * fvar(10) * cond(var(10), 1.2, 1)), ceil(9* fvar(10))
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = 40,-90
postype = p1  

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = -5,-80
postype = p1 
sprpriority = -1

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) = 0 
ID = 4508
pos = 20,-130
postype = p1  

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(3) >= 0 && animelemtime(14)<0 
ID = 4508
pos = 10,-140
postype = p1  

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) >= 0 && animelemtime(16)<0 
ID = 4509
pos = -30,-90
postype = p1  
sprpriority = 3

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(14) >= 0 && animelemtime(17)<0 
ID = 4508
pos = 0,-135
postype = p1  

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(16) >= 0 && animelemtime(21)<0 
ID = 4509
pos = -10,-87
postype = p1  

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(17) >= 0 
ID = 4508
pos = -20,-130
postype = p1  

[State 4631, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(21) >= 0 
ID = 4509
pos = 5,-85
postype = p1

[State 4631, retract]
type = statetypeset
trigger1 = animelem = 15
movetype = i

[State 4631, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value = 4632

;---------------------------------------------------------------------------
; VT1 Ex Shoryuken - Land
[Statedef 4632]
type    = S
movetype = I
physics = S
ctrl = 0
velset = 0, 0
anim = 1102

[State 4632, 1]
type = PlaySnd
trigger1 = Time = 0
value = 0, 14

[State 4632, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 4632, remove special counter hittable]
type = varset
trigger1 = time = 15
fvar(30) = 0

[State 4632, return ctrl]
type = ctrlset
trigger1 = time = 15
value = 1

[State 4632, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Ex Shoryuken  - Hit
[Statedef 4635]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 1140
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 4635, invincible]
type = nothitby
trigger1 = 1
value = SCA

[State 4635, RemoveExplod]
type = RemoveExplod
trigger1 = time = 0
id = 1133

[State 4635, wind]
type = explod
trigger1 = animelem = 1
anim = 1134
id = 1134
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 20, -35 + pos y
scale = 0.4, 0.2
sprpriority = 3
ownpal = 1
bindid = -1
bindtime = -1
ignorehitpause = 0
persistent = 0
removeongethit = 1

[State 4635, ex splat]
type = explod
trigger1 = animelem = 17
anim = 15030
id = 1030
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * -20,-50
scale = 0.35, 0.35
sprpriority = -1
ownpal = 1
bindid = -1
bindtime = 1
ignorehitpause = 0
persistent = 0

[State 4635, wind]
type = explod
trigger1 = animelem = 17
anim = 1133
id = 1133
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 5, -35 + pos y
scale = 0.35, 0.35
sprpriority = 1
ownpal = 1
bindid = -1
bindtime = -1
ignorehitpause = 0
persistent = 0
removeongethit = 1

;------ counter hit time ------
;------ juggle points -------
[State 4635, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 99
ignorehitpause = 1
persistent = 0

[State 4635, corner push]
type = varset
trigger1 = time = 0
var(25) = 0

;------ width & positioning ------
[State 4635, pos]
type = posadd
trigger1 = time =1
x = 36*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =2
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =3
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =4
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =5
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =6
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =7
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =8
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =9
x = -2*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =10
x = -2*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =11
x = 0*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =12
x = 1*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =13
x = 2*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =14
x = 1*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =15
x = 2*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =16
x = 3*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =17
x = 26*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =18
x = 31*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =19
x = -35*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =20
x = 18*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =21
x = 17*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =22
x = 15*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =23
x = 13*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =24
x = 12*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =25
x = 10*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =26
x = 9*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =27
x = 7*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =28
x = 6*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =29
x = 4*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =30
x = 2*const(size.xscale)

[State 4635, pos]
type = posadd
trigger1 = time =31
x = 1*const(size.xscale)

[State 4635, retract]
type = statetypeset
trigger1 = time = 19
statetype = A
physics = N

[State 4635, pos]
type = velset
trigger1 = time = 19
y = -10

[State 4635, VelAdd]
type = VelAdd
trigger1 =  animelemtime(20) > 1 ;&& animelemtime(40) <0
y = .43

;------ combo scaling ------
[State 4635, increment combo count]
type = varadd
triggerall = !var(12)
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4635, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4635, fx]
type = playsnd
trigger1 = time = 18
value = 1100, 3
volumescale = 75

;------ hitdef and sparks ------
[State 4635, hit]
type = hitdef
triggerall = var(13) <= 8
trigger1 = animelem = 20
attr = A, SA
hitflag = MAF
guardflag = M
animtype = up
priority = 6, hit
damage = ceil(80 * cond(var(10), 1.2, 1)), 20
pausetime = 17, 17
guard.pausetime = 12, 12
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16360
guard.sparkno = s16850
sparkxy = 0, -100
ground.type = high
ground.slidetime = 43
guard.slidetime = 18
ground.hittime = 43 + cond(var(10), 2, 0) 
guard.hittime = 18
guard.ctrltime = 18
ground.velocity = -2.4, -12.8
guard.velocity = -6
air.velocity = -2.4, -12.8
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.6
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = 0, 0
givepower = ceil(12 * fvar(10) * cond(var(10), 1.2, 1)), ceil(6* fvar(10))
envshake.time = 10
envshake.ampl = -4
envshake.freq = 120
guard.kill = 0
palfx.time = 60
palfx.color = 0
palfx.mul = 256, 256, 256
palfx.add = -64, -96, -160
palfx.sinadd = 64,96, 128, 10

[State 4635, hit spark]
type = explod
trigger1 = movehit = 1
anim = 1135
space = stage
facing = facing
pos = cond(facing = 1, 1, -1) * 40 + pos x + camerapos x , -100 + pos y
scale = 0.35, 0.35
sprpriority = 2
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4508
pos = 45,-80
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(1) = 0 
ID = 4509
pos = -5,-70
postype = p1 
sprpriority = -1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) >= 0 && animelemtime(9) <= 0 
ID = 4508
pos = 38,-70
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(2) >= 0 && animelemtime(9) <= 0 
ID = 4509
pos = -5,-60
postype = p1 
sprpriority = -1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(10) >= 0 && animelemtime(18) <= 0 
ID = 4508
pos = -10,-55
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(10) >= 0 && animelemtime(18) <= 0 
ID = 4509
pos = 15,-60
postype = p1 
sprpriority = -1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(18) =0
ID = 4508
pos = 25,-65
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(18) =0
ID = 4509
pos = 25,-50
postype = p1 
sprpriority = 3

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(19) =0
ID = 4508
pos = 38,-70
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(19) =0
ID = 4509
pos = -15,-60
postype = p1 
sprpriority = 3

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(20) >= 0 && animelemtime(34) <= 0 
ID = 4508
pos = 3,-140
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(20) >= 0 && animelemtime(37) <= 0 
ID = 4509
pos = -17,-72
postype = p1 
sprpriority = 3

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(35) >= 0 && animelemtime(60) <= 0 
ID = 4508
pos = -5,-130
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(60) >= 0 
ID = 4508
pos = 0,-120
postype = p1  

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(37) >= 0 && animelemtime(49) <= 0 
ID = 4509
pos = -5,-72
postype = p1 
sprpriority = -1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = animelemtime(49) >= 0 
ID = 4509
pos = 15,-72
postype = p1 
sprpriority = 3

[State 4635, StateTypeSet]
type = StateTypeSet
trigger1 = animelem =32
movetype = I       

[State 4635, Land]
type= changestate
trigger1= vel y > 0
trigger1= pos y > -vel y
value = 4636

;---------------------------------------------------------------------------
; VT1 Ex Shoryuken - Hit Land
[Statedef 4636]
type    = S
movetype = I
physics = S
ctrl = 0
velset = 0, 0
anim = 1102

[State 4636, 1]
type = PlaySnd
trigger1 = Time = 0
value = 0, 14

[State 4636, PosSet]
type = PosSet
trigger1 = time = 0
y = 0

[State 4636, return ctrl]
type = ctrlset
trigger1 = time = 15
value = 1

[State 4636, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 
ctrl = 1

;---------------------------------------------------------------------------
; VT1 St. Lp
[Statedef 4640]
type    = S
movetype= A
physics = S
juggle = 0
ctrl = 0
anim = 200
poweradd = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4640, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4640, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4640, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 2

;------ juggle points -------
[State 4640, reset]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4640, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4640, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4640, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4640, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4640, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4640, random voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 1
value = 200, 0 + (random % 3)
channel = 0

[State 4640, whoosh]
type = playsnd
trigger1 = time = 1
value = 0, 0
volumescale = 75

;------ hitdef and sparks ------
[State 4640, hit]
type = HitDef
triggerall = var(13) = 0
trigger1 = animelem = 3
attr = S, NA
damage = ceil(30 * cond(var(10), 1.2, 1)), 0
animtype = Light
guardflag = M
hitflag = MAF
priority = 3, Hit
sparkno = s16050
guard.sparkno = s16550
sparkxy = 0, -87
pausetime = 8, 8
hitsound = s1, 0
guardsound = s1, 20
ground.type = High
ground.slidetime = 14
guard.slidetime = 10
ground.hittime = 14 + cond(var(10), 2, 0)
guard.hittime = 10
guard.ctrltime = 10
ground.velocity = -5.3 ;0.385
guard.velocity = -5.4
air.velocity = -0.7, -5
air.hittime = 100
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(20 * fvar(10) * cond( var(10), 1.2, 1)), ceil(10 * fvar(10))
givepower = ceil(12 * fvar(10) * cond( var(10), 1.2, 1)), ceil(6 * fvar(10))

[State 4640, retract]
type = statetypeset
trigger1 = animelem = 5
movetype = i

[State 4640, return ctrl]
type = ctrlset
trigger1 = time = 11
value = 1

[State 4640, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------------------------------------------
; VT1 St. Mp
[Statedef 4642]
type    = S
movetype= A
physics = S
poweradd= 0
juggle = 0
ctrl = 0
anim = 210
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4642, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4642, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4642, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 4

;------ juggle points -------
[State 4642, reset]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4642, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4642, width 2]
type = width
trigger1 = time = [4, 7]
player = 15, -6
ignorehitpause = 1

;------ combo scaling ------
[State 4642, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4642, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4642, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4642, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ Jodan Sarengeki ------
[State 4642, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4642, VT1 Jodan Sarengeki (1)(Crouching)]
type = varset
triggerall = var(38) <= 4656
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [2,8]
trigger1 = command = "z3" && command = "holddown"
var(38) = 4656

[State VT1 4642, VT1 Jodan Sarengeki (1)(Standing)]
type = varset
triggerall = var(38) <= 4648
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [2,8]
trigger1 = command = "z3" && command != "holddown"
var(38) = 4648

[State 4642, Jodan Sarengeki (1)(Crouching)]
type = varset
triggerall = var(38) <= 500
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [2,8]
trigger1 = command = "z3" && command = "holddown"
var(38) = 500

[State 4642, Jodan Sarengeki (1)(Standing)]
type = varset
triggerall = var(38) <= 310
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [2,8]
trigger1 = command = "z3" && command != "holddown"
var(38) = 310

[State 4642, transition]
type = changestate
triggerall = var(38) > 0
triggerall = movecontact || movereversed
trigger1 = time = [7, 8]
value = var(38)

;------ sounds ------
[State 4642, voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 2
value = 210, 0 + (random % 3)
channel = 0

[State 4642, whoosh]
type = playsnd
trigger1 = time = 2
value = 0, 1
volumescale = 75

;------ hitdef and sparks ------
[State 4642, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 5
attr = S, NA
hitflag = MAF
guardflag = M
animtype = medium
priority = 4, hit
sparkno = s16150
guard.sparkno = s16650
sparkxy = 0, -75
damage = ceil(60 * cond(var(10), 1.2, 1)), 0
pausetime = 12, 12
guard.pausetime = 12, 12
hitsound = s1, 1
guardsound = s1, 21
ground.type = low
ground.slidetime = 20
guard.slidetime = 14
ground.hittime = 20 + cond(var(10), 2, 0)
guard.hittime = 14
guard.ctrltime = 14
ground.velocity = -5.4 ;0.45
guard.velocity = -5.4
air.hittime = 100
air.velocity = -1.2, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))
givepower = ceil(18 * fvar(10) * cond( var(10), 1.2, 1)), ceil(9 * fvar(10))

[State 4642, retract]
type = statetypeset
trigger1 = animelem = 8
movetype = i

[State 4642, return ctrl]
type = ctrlset
trigger1 = time = 17
value = 1

[State 4642, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------------------------------------------
; VT1 Collarbone Breaker (F + Mp)
[Statedef 4643]
type    = S
movetype= A
physics = S
poweradd= 0
juggle = 0
ctrl = 0
anim = 215
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4643, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4643, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4643, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 5

;------ juggle points -------
[State 4643, reset]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4643, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4643, pos]
type = posadd
trigger1 = time =4
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =5
x = 3*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =6
x = 3*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =7
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =8
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =9
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =10
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =11
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =12
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =13
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =14
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =15
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =16
x = 6*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =17
x = 6*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =18
x = 7*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =19
x = 10*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =20
x = 11*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =21
x = 12*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =22
x = 9*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =23
x = 4*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =24
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =25
x = 4*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =31
x = -1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =32
x = -7*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =33
x = -3*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =34
x = -4*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =35
x = -5*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =36
x = -6*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =37
x = -7*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =38
x = -8*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =39
x = -8*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =40
x = -7*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =41
x = -4*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =42
x = -2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =43
x = -1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =46
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =47
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =48
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =49
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =50
x = 2*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =51
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =52
x = 1*const(size.xscale)

[State 4643, pos]
type = posadd
trigger1 = time =53
x = 1*const(size.xscale)


;------ combo scaling ------
[State 4643, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4643, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4643, voice]
type = playsnd
trigger1 = time = 4
value = 225, 0
channel = 0

[State 4643, whoosh]
type = playsnd
trigger1 = time = 19
value = 0, 1
volumescale = 75

;------ hitdef and sparks ------
[State 4643, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 22
attr = S, NA
hitflag = MAF
guardflag = H
animtype = medium
priority = 4, hit
sparkno = s16125
guard.sparkno = s16650
sparkxy = 0, -55
damage = ceil(30 * cond(var(10), 1.2, 1)), 0
pausetime = 12, 12
guard.pausetime = 12, 12
hitsound = s1, 1
guardsound = s1, 21
ground.type = low
ground.slidetime = 18
guard.slidetime = 17
ground.hittime = 18 + cond(var(10), 2, 0)
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -2.4 ;0.45
guard.velocity = -2.4
air.hittime = 100
air.velocity = -1.2, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(10 * fvar(10) * cond( var(10), 1.2, 1)), ceil(5 * fvar(10))
givepower = ceil(6 * fvar(10) * cond( var(10), 1.2, 1)), ceil(3 * fvar(10))

[State 4643, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 23
attr = S, NA
hitflag = MAF
guardflag = H
animtype = medium
priority = 4, hit
sparkno = s16125
guard.sparkno = s16650
sparkxy = -5, -35
damage = ceil(30 * cond(var(10), 1.2, 1)), 0
pausetime = 12, 12
guard.pausetime = 12, 12
hitsound = s1, 1
guardsound = s1, 21
ground.type = low
ground.slidetime = 20
guard.slidetime = 12
ground.hittime = 20 + cond(var(10), 2, 0)
guard.hittime = 12
guard.ctrltime = 12
ground.velocity = -5.4 ;0.45
guard.velocity = -5.4
air.hittime = 100
air.velocity = -1.2, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))
givepower = ceil(18 * fvar(10) * cond( var(10), 1.2, 1)), ceil(9 * fvar(10))

[State 4643, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4643, return ctrl]
type = ctrlset
trigger1 = time = 42
value = 1

[State 4643, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; VT1 St. Hp
[Statedef 4644]
type    = S
movetype= A
physics = S
poweradd= 0
ctrl = 0
anim = 220
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4644, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4644, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4644, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 7

;------ juggle points -------
[State 4644, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
var(13) = cond(var(10), 0, 1000)
ignorehitpause = 1
persistent = 0

[State 4644, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4644, pos]
type = posadd
trigger1 = time =0
x = 3*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =1
x = 6*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =2
x = 9*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =3
x = 10*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =4
x = 7*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =5
x = 5*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =6
x = 3*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =7
x = 0*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =8
x = 0*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =9
x = 0*const(size.xscale)

[State 4644, pos]
type = posadd
trigger1 = time =10
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4644, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4644, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4644, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4644, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ TC HP > HK ------
[State 210, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 210, Buffer]
type = varset
triggerall = var(38) <= 300
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [6, 12]
trigger1 = command = "c3"
var(38) = 300

[State 210, transition]
type = changestate
triggerall = var(38) > 0
triggerall = movecontact || movereversed
trigger1 = time = [10, 12]
value = var(38)

;------ sounds ------
[State 4644, voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 4
value = 220, 0 + (random % 3)
channel = 0

[State 4644, whoosh]
type = playsnd
trigger1 = time = 5
value = 0, 2
volumescale = 75

;------ hitdef and sparks ------
[State 4644, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 8
attr = S, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
sparkno = scond(var(10), 16450, 16250) 
guard.sparkno = s16750
sparkxy = 0, -80
damage = ceil(90 * cond(var(10), 1.2, 1)), 0
pausetime = cond(var(10), 20, 15), cond(var(10), 20, 15)
guard.pausetime = 15, 15
hitsound = s1, cond(var(10), 7, 2)
guardsound = s1, 22
ground.type = high
ground.slidetime = 27 + cond(var(10), 2, 0)
guard.slidetime = 21
ground.hittime = 27 + cond(var(10), 2, 0)
guard.hittime = 21
guard.ctrltime = 21
ground.velocity = cond(var(10), -1.5, -7.9), cond(var(10), -7.4, 0)
guard.velocity = -7.2
air.hittime = 100
air.velocity = cond(var(10), -1.5, -2), cond(var(10), -7.4, -5)
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = cond(var(10), 1, 0)
fall.recover = cond(var(10), 1, 0)
forcenofall = cond(var(10), 0, 1)
yaccel = cond(var(10), 0.45, 0.4)
getpower = ceil(50 * fvar(10) * cond( var(10), 1.2, 1)), ceil(25 * fvar(10))
givepower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))

[State 4644, crush counter meter]
type = varadd
triggerall = var(15) <= 0
trigger1 = movehit = 1 && var(10)
v = 3
value = 150
persistent = 0
ignorehitpause = 1

[State 4644, retract]
type = statetypeset
trigger1 = animelem = 11
movetype = i

[State 4644, return ctrl]
type = ctrlset
trigger1 = time = 30
value = 1

[State 4644, ctrl]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Solar Plexus Strike (F + Hp)
[Statedef 4646]
type    = S
movetype= A
physics = S
poweradd= 0
ctrl = 0
anim = 225
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4646, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4646, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4646, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4646, juggle]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4646, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4646, pos]
type = posadd
trigger1 = time =5
x = 6*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =6
x = 13*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =7
x = 15*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =8
x = 15*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =9
x = 16*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =10
x = 16*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =11
x = 15*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =12
x = 14*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =13
x = 14*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =14
x = 7*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =15
x = 5*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =16
x = 5*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =17
x = 4*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =18
x = 2*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =19
x = 2*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =20
x = 1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =21
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =22
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =23
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =24
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =25
x = -2*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =26
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =27
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =28
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =29
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =30
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =31
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =32
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =33
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =34
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =35
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =36
x = -3*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =37
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =38
x = -5*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =39
x = -5*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =40
x = -3*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =41
x = -1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =42
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =43
x = 2*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =44
x = 2*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =45
x = 3*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =46
x = 3*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =47
x = 3*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =48
x = 2*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =49
x = 1*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =50
x = 0*const(size.xscale)

[State 4646, pos]
type = posadd
trigger1 = time =51
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4646, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4646, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ Cancels ------
[State 4646, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4646, VT1 Ex Shoryuken]
type = varset
triggerall = var(38) <= 4630
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 4630

[State 4646, VT1 Hp Shoryuken]
type = varset
triggerall = var(38) <= 4620
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "z3"
var(38) = 4620

[State 4646, VT1 Mp Shoryuken]
type = varset
triggerall = var(38) <= 4610
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "y3"
var(38) = 4610

[State 4646, VT1 Lp Shoryuken]
type = varset
triggerall = var(38) <= 4600
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "x3"
var(38) = 4600

[State 4646, Ex Shoryuken]
type = varset
triggerall = var(38) <= 1130
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1130

[State 4646, Hp Shoryuken]
type = varset
triggerall = var(38) <= 1120
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "z3"
var(38) = 1120

[State 4646, Mp Shoryuken]
type = varset
triggerall = var(38) <= 1110
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "y3"
var(38) = 1110

[State 4646, Lp Shoryuken]
type = varset
triggerall = var(38) <= 1100
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [3, 30]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "x3"
var(38) = 1100

[State 4646, shoryuken transitions]
type = changestate
triggerall = var(38) = [1100, 1199] 
triggerall = movecontact
trigger1 = time = [26, 30]
value = var(38)

;------ sounds ------
[State 4646, voice]
type = playsnd
trigger1 = time = 3
value = 225, 1
channel = 0

[State 4646, whoosh]
type = playsnd
trigger1 = time = 11
value = 0, 2
volumescale = 75

;------ hitdef and sparks ------
[State 4646, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 17
attr = S, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
sparkno = s16250
guard.sparkno = s16750
sparkxy = 0, -53
damage = ceil(45 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 13, 13
hitsound = s1, 2
guardsound = s1, 22
ground.type = Low
ground.slidetime = 27
guard.slidetime = 17
ground.hittime = 27 + cond(var(10), 2, 0)
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -1.8
guard.velocity = -3
air.hittime = 100
air.velocity = -2, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(25 * fvar(10) * cond( var(10), 1.2, 1)), ceil(13 * fvar(10))
givepower = ceil(15 * fvar(10) * cond( var(10), 1.2, 1)), ceil(8 * fvar(10))

;2
[State 4646, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 20
attr = S, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
sparkno = s16250
guard.sparkno = s16750
sparkxy = -5, -60
damage = ceil(45 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
hitsound = s1, 2
guardsound = s1, 22
ground.type = Low
ground.slidetime = 27
guard.slidetime = 17
ground.hittime = 27 + cond(var(10), 2, 0)
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -4.2
guard.velocity = -3
air.hittime = 100
air.velocity = -2, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(25 * fvar(10) * cond( var(10), 1.2, 1)), ceil(13 * fvar(10))
givepower = ceil(15 * fvar(10) * cond( var(10), 1.2, 1)), ceil(8 * fvar(10))

[State 4646, retract]
type = statetypeset
trigger1 = animelem = 22
movetype = i

[State 4646, return ctrl]
type = ctrlset
trigger1 = time = 39
value = 1

[State 4646, ctrl]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Jodan Sarengeki (1) (Standing) - St. Mp > [Hp]
[Statedef 4648]
type    = S
movetype= A
physics = S
poweradd= 0
ctrl = 0
anim = 310
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4648, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4648, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4648, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 8

;------ juggle points -------
[State 4648, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4648, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4648, pos]
type = posadd
trigger1 = time =0
x = 16*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =1
x = 18*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =2
x = 20*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =3
x = 9*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =4
x = 10*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =5
x = 9*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =6
x = 5*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =7
x = 3*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =8
x = 0*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =9
x = 0*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =10
x = -1*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =11
x = -1*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =12
x = 0*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =13
x = 0*const(size.xscale)

[State 4648, pos]
type = posadd
trigger1 = time =14
x = 0*const(size.xscale)

;------ combo scaling ------
[State 4648, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4648, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4648, v trigger cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 4
ignorehitpause = 1

;------ Jodan Sarengeki ------
[State 4648, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 46487, Buffer]
type = varset
triggerall = var(38) <= 320
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [6, 12]
trigger1 = command = "c3"
var(38) = 320

[State 4648, transition]
type = changestate
triggerall = var(38) > 0
triggerall = movecontact
trigger1 = time = [10, 12]
value = var(38)

;------ sounds ------
[State 4648, voice]
type = playsnd
trigger1 = time = 4
value = 225, 5
channel = 0

[State 4648, whoosh]
type = playsnd
trigger1 = time = 5
value = 0, 2
volumescale = 75

;------ hitdef and sparks ------
[State 4648, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 9
attr = S, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
sparkno = s16250
guard.sparkno = s16750
sparkxy = -5, -83
damage = ceil(80 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
hitsound = s1, 2
guardsound = s1, 22
ground.type = high
ground.slidetime = 26
guard.slidetime = 20
ground.hittime = 26 + cond(var(10), 2, 0)
guard.hittime = 20
guard.ctrltime = 20
ground.velocity = -6.3
guard.velocity = -3.6
air.hittime = 100
air.velocity = -2, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))
givepower = ceil(18 * fvar(10) * cond( var(10), 1.2, 1)), ceil(9 * fvar(10))

[State 4648, retract]
type = statetypeset
trigger1 = animelem = 11
movetype = i

[State 4648, return ctrl]
type = ctrlset
trigger1 = time = 38
value = 1

[State 4648, ctrl]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Cr. Lp
[Statedef 4650]
type    = C
movetype= A
physics = C
poweradd= 0
ctrl = 0
anim = 400
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4650, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4650, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4650, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 3

;------ juggle points -------
[State 4650, reset]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4650, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4650, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4650, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4650, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4650, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4650, random voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 1
value = 200, 0 + (random % 3)
channel = 0

[State 4650, whoosh]
type = playsnd
trigger1 = time = 1
value = 0, 0
volumescale = 75

;------ hitdef and sparks ------
[State 4650, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 4
attr = C, NA
hitflag = MAF
guardflag = M
animtype = light
priority = 3, hit
damage = ceil(30 * cond(var(10), 1.2, 1)), 0
pausetime = 8, 8
guard.pausetime = 8, 8
hitsound = s1, 0
guardsound = s1, 20
sparkno = s16050
guard.sparkno = s16550
sparkxy = 0, -63
ground.type = low
ground.slidetime = 12
guard.slidetime = 9
ground.hittime = 12 + cond(var(10), 2, 0)
guard.hittime = 9
guard.ctrltime = 9
ground.velocity = -5.7 ;0.41
guard.velocity = -5.7
air.velocity = -0.7, -5
air.hittime = 100
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower =  ceil(20 * fvar(10) * cond( var(10), 1.2, 1)), ceil(10 * fvar(10))
givepower = ceil(12 * fvar(10) * cond( var(10), 1.2, 1)), ceil(6 * fvar(10))

[State 4650, retract]
type = statetypeset
trigger1 = animelem = 7
movetype = i 

[State 4650, return ctrl]
type = ctrlset
trigger1 = time = 11
value = 1

[State 4650, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Cr. Mp
[Statedef 4652]
type    = C
movetype= A
physics = C
poweradd= 0
ctrl = 0
anim = 410
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4652, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4652, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4652, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 5

;------ juggle points -------
[State 4652, reset]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4652, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4652, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4652, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4652, v trigger cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 4
ignorehitpause = 1

[State 4652, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4652, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4652, voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 2
value = 210, 0 + (random % 3)
channel = 0

[State 4652, whoosh]
type = playsnd
trigger1 = time = 2
value = 0, 1
volumescale = 75

;------ hitdef and sparks ------
[State 4652, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 6
attr = C, NA
hitflag = MAF
guardflag = M
animtype = medium
priority = 4, hit
damage = ceil(60 * cond(var(10), 1.25, 1)), 0
pausetime = 12, 12
guard.pausetime = 12, 12
sparkno = s16150
guard.sparkno = s16650
sparkxy = 0, -63
hitsound = s1, 1
guardsound = s1, 21
ground.type = low
ground.slidetime = 20
guard.slidetime = 16
ground.hittime = 20 + cond(var(10), 2, 0)
guard.hittime = 16
guard.ctrltime = 16
ground.velocity = -6.6 ;0.4
guard.velocity = -5.4
air.velocity = -1.2, -5
air.hittime = 100
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower =  ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))
givepower = ceil(18 * fvar(10) * cond( var(10), 1.2, 1)), ceil(9 * fvar(10))

[State 4652, retract]
type = statetypeset
trigger1 = animelem = 9
movetype = i 

[State 4652, return ctrl]
type = ctrlset
trigger1 = time = 20
value = 1

[State 4652, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Cr. Hp
[Statedef 4654]
type    = C
movetype= A
physics = C
poweradd= 0
ctrl = 0
anim = 420
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4654, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4654, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4654, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 5

;------ juggle points -------
[State 4654, reset]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 1000
ignorehitpause = 1
persistent = 0

[State 4654, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4654, pos]
type = posadd
trigger1 = time =3
x = 5*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =4
x = 20*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =5
x = 19*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =6
x = 4*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =7
x = 4*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =8
x = 6*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =9
x = 3*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =10
x = 1*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =11
x = 0*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =12
x = 0*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =13
x = -2*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =14
x = -3*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =15
x = -4*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =16
x = -5*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =17
x = -4*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =18
x = -4*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =19
x = -4*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =20
x = -11*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =21
x = -13*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =22
x = -9*const(size.xscale)

[State 4654, pos]
type = posadd
trigger1 = time =23
x = -2*const(size.xscale)

;------ combo scaling ------
[State 4654, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4654, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4654, v trigger cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(29) = 4
ignorehitpause = 1

[State 4654, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4654, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4654, voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 4
value = 220, 0 + (random % 3)
channel = 0

[State 4654, whoosh]
type = playsnd
trigger1 = time = 3
value = 0, 2
volumescale = 75

;------ hitdef and sparks ------
[State 4654, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 6
attr = C, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
damage = ceil(90 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
sparkno = s16275
guard.sparkno = s16750
sparkxy = 0, -66
hitsound = s1, 2
guardsound = s1, 22
ground.type = high
ground.slidetime = 22
guard.slidetime = 17
ground.hittime = 22 + cond(var(10), 2, 0)
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -3.6
guard.velocity = -4.2
air.velocity = -2, -5
air.hittime = 100
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
forcestand = 1
yaccel = 0.4
getpower = ceil(50 * fvar(10) * cond( var(10), 1.2, 1)), ceil(25 * fvar(10))
givepower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))

[State 4654, hit]
type = hitdef
triggerall = !movecontact && !movereversed
triggerall = var(13) <= 0
trigger1 = animelem = 7
attr = C, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
damage = ceil(70 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
sparkno = s16290
guard.sparkno = s16750
sparkxy = 0, -95
hitsound = s1, 2
guardsound = s1, 22
ground.type = high
ground.slidetime = 27
guard.slidetime = 20
ground.hittime = 27 + cond(var(10), 2, 0)
guard.hittime = 20
guard.ctrltime = 20
ground.velocity = -4.8
guard.velocity = -4.2
air.velocity = -2, -5
air.hittime = 100
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
forcestand = 1
yaccel = 0.4
getpower = ceil(50 * fvar(10) * cond( var(10), 1.2, 1)), ceil(25 * fvar(10))
givepower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))

[State 4654, hit]
type = hitdef
triggerall = !movecontact && !movereversed
triggerall = var(13) <= 0
trigger1 = animelem = 9
attr = C, NA
hitflag = AF
guardflag = 
animtype = hard
priority = 5, hit
damage = ceil(70 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
sparkno = s16290
guard.sparkno = s16750
sparkxy = 0, -95
hitsound = s1, 2
guardsound = s1, 22
ground.type = high
ground.slidetime = 25
guard.slidetime = 20
ground.hittime = 25 + cond(var(10), 2, 0)
guard.hittime = 20
guard.ctrltime = 20
ground.velocity = -4.8
guard.velocity = -4.2
air.velocity = -2, -5
air.hittime = 100
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
forcestand = 1
yaccel = 0.4
getpower = ceil(50 * fvar(10) * cond( var(10), 1.2, 1)), ceil(25 * fvar(10))
givepower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))

[State 4654, push]
type = playerpush
triggerall = enemynear, pos y <= -50
trigger1 = movehit = 1 && animelemtime(10) < 0
value = 0
ignorehitpause = 1

[State 4654, contact]
type = ChangeState
trigger1 = movecontact && animelemtime(7) <= 0
value = 4655

[State 4654, retract]
type = statetypeset
trigger1 = animelem = 10
movetype = i 

[State 4654, return ctrl]
type = ctrlset
trigger1 = time = 33
value = 1

[State 4654, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Cr. Hp contact
[Statedef 4655]
type    = C
movetype= I
physics = C
poweradd= 0
ctrl = 0
anim = 421
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
;------ counter hit time -------
;------ juggle points -------
[State 4655, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4655, pos]
type = posadd
trigger1 = time =1
x = 1*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =2
x = 0*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =3
x = 0*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =4
x = 1*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =5
x = 0*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =6
x = -1*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =7
x = -3*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =8
x = -5*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =9
x = -5*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =10
x = -5*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =11
x = -4*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =12
x = -2*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =13
x = -5*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =14
x = -8*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =15
x = -5*const(size.xscale)

[State 4655, pos]
type = posadd
trigger1 = time =16
x = -1*const(size.xscale)

;------ combo scaling ------
;------ cancel potential ------
;------ sounds ------
;------ hitdef and sparks ------
[State 4655, return ctrl]
type = ctrlset
trigger1 = time = 27
value = 1

[State 4655, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Jodan Sarengeki (1) (Crouching) - St. Mp > [Hp]
[Statedef 4656]
type    = C
movetype= A
physics = C
poweradd= 0
ctrl = 0
anim = 500
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4656, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4656, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4656, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 8

;------ juggle points -------
[State 4656, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4656, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4656, pos]
type = posadd
trigger1 = time =0
x = 19*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =1
x = 12*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =2
x = 21*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =3
x = 4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =4
x = 5*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =5
x = 6*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =6
x = 8*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =7
x = 14*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =8
x = 12*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =9
x = 4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =10
x = 3*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =11
x = 4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =12
x = 4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =13
x = 4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =14
x = 4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =15
x = 1*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =16
x = -1*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =17
x = -1*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =18
x = -1*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =19
x = -1*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =20
x = -1*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =21
x = -2*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =22
x = -2*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =23
x = -2*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =24
x = -2*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =25
x = -4*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =26
x = -15*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =27
x = -28*const(size.xscale)

[State 4656, pos]
type = posadd
trigger1 = time =28
x = -5*const(size.xscale)

[State 501, pos]
type = posadd
trigger1 = time =29
x = -2*const(size.xscale)

;------ combo scaling ------
[State 4656, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4656, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4656, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

[State 4656, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4656, voice]
type = playsnd
trigger1 = time = 4
value = 225, 4
channel = 0

[State 4656, whoosh]
type = playsnd
trigger1 = time = 3
value = 0, 2
volumescale = 75

;------ hitdef and sparks ------
[State 4656, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 9
attr = C, NA
hitflag = MAF
guardflag = M
animtype = hard
priority = 5, hit
damage = ceil(80 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
sparkno = s16275
guard.sparkno = s16750
sparkxy = -3, -63
hitsound = s1, 2
guardsound = s1, 22
ground.type = low
ground.slidetime = 19
guard.slidetime = 13
ground.hittime = 19 + cond(var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -1.2, -6.3
guard.velocity = -3.6
air.velocity = -1.2, -6.3
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 1
fall.recover = 0
yaccel = 0.6
getpower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(18 * fvar(10))
givepower = ceil(18 * fvar(10) * cond( var(10), 1.2, 1)), ceil(9 * fvar(10))

[State 4656, retract]
type = statetypeset
trigger1 = animelem = 11
movetype = i 

[State 4656, return ctrl]
type = ctrlset
trigger1 = time = 31
value = 1

[State 4656, contact]
type = ChangeState
trigger1 = movecontact
value = 4657

[State 4656, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Jodan Sarengeki (1) (Crouching) - Contact
[Statedef 4657]
type    = C
movetype= I
physics = C
poweradd= 0
ctrl = 0
anim = 501
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
[State 4657, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

[State 4657, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time -------
[State 4657, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 6

;------ juggle points -------
[State 4657, reset]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 1000
ignorehitpause = 1
persistent = 0

[State 4657, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4657, pos]
type = posadd
trigger1 = time =12
x = -1*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =13
x = -2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =14
x = -3*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =15
x = -3*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =16
x = -5*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =17
x = -7*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =18
x = -8*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =19
x = -8*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =20
x = -8*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =21
x = -7*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =22
x = -5*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =23
x = -3*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =24
x = -2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =25
x = -1*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =26
x = 0*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =27
x = 1*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =28
x = 1*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =29
x = 2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =30
x = 2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =31
x = 2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =32
x = 2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =33
x = 3*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =34
x = 3*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =35
x = 2*const(size.xscale)

[State 4657, pos]
type = posadd
trigger1 = time =36
x = 1*const(size.xscale)

;------ combo scaling ------
[State 4657, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4657, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4657, special cancel]
type = varset
trigger1 = time = [0,2]
var(30) = 4
ignorehitpause = 1

[State 4657, super cancel]
type = varset
trigger1 = time = [0,2]
var(31) = 4
ignorehitpause = 1

;------ sounds ------
;------ hitdef and sparks ------
[State 4657, return ctrl]
type = ctrlset
trigger1 = time = 22
value = 1

[State 4657, return]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; VT1 J. Lp
[Statedef 4660]
type    = A
movetype= A
physics = A
poweradd= 0
ctrl = 0
anim = 600
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
[State 4660, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

;------ counter hit time -------
[State 4660, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 2

;------ juggle points -------
[State 4660, reset]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

;------ width & positioning ------
;------ combo scaling -----
[State 4660, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4660, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4660, random voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 1
value = 200, 0 + (random % 3)
channel = 0


[State 4660, whoosh]
type = playsnd
trigger1 = time = 1
value = 0, 0
volumescale = 75

;------ hitdef and sparks ------
[State 4660, hit]
type = hitdef
triggerall = var(13) <= 1
trigger1 = animelem = 3
attr = A, NA
hitflag = MAF
guardflag = H
animtype = light
priority = 3, hit
damage = ceil(40 * cond(var(10), 1.2, 1)), 0
pausetime = 8, 8
guard.pausetime = 8, 8
hitsound = s1, 0
guardsound = s1, 20
sparkno = s16025
guard.sparkno = s16550
sparkxy = 0, -75
ground.type = high
ground.slidetime = 15
guard.slidetime = 13
ground.hittime = 15 + cond(var(10), 2, 0)
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -2.4 ;0.2
guard.velocity = -2.4
air.hittime = 100
air.velocity = -0.7, -5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(20 * fvar(10) * cond( var(10), 1.2, 1)), ceil(10 * fvar(10))
givepower = ceil(12 * fvar(10) * cond( var(10), 1.2, 1)), ceil(6 * fvar(10))

[State 4660, retract]
type = statetypeset
trigger1 = animelem = 9
movetype = i 

[State 4660, set 51]
type = varset
trigger1 = time = 0
v = 51
value = 1

;---------------------------------------------------------------------------
; VT1 J. Mp
[Statedef 4662]
type    = A
movetype= A
physics = A
poweradd= 0
ctrl = 0
anim = 610
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
[State 4662, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

;------ counter hit time -------
[State 4662, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 3

;------ juggle points -------
[State 4662, reset]
type = varset
triggerall = animelemtime(11) > 0
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1
ignorehitpause = 1
persistent = 0

;------ width & positioning ------
;------ combo scaling ------
[State 4662, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4662, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4662, special cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(30) = 4
ignorehitpause = 1

;------ sounds ------
[State 210, voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 2
value = 210, 0 + (random % 3)
channel = 0

[State 4662, whoosh]
type = playsnd
trigger1 = time = 2
value = 0, 1
volumescale = 75

;------ hitdef and sparks ------
[State 4662, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 7
attr = A, NA
hitflag = MAF
guardflag = H
animtype = medium
priority = 4, hit
damage = ceil(30 * cond(var(10), 1.2, 1)), 0
pausetime = 12, 12
guard.pausetime = 12, 12
hitsound = s1, 1
guardsound = s1, 21
sparkno = s16175
guard.sparkno = s16650
sparkxy = 0, -92
ground.type = high
ground.slidetime = 18
guard.slidetime = 16
ground.hittime = 18 + cond(var(10), 2, 0)
guard.hittime = 16
guard.ctrltime = 16
ground.velocity = -3 ;0.5
guard.velocity = -3
air.hittime = 100
air.velocity = -3, -5.5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(50 * fvar(10) * cond( var(10), 1.2, 1)), ceil(6 * fvar(10))
givepower = ceil(6 * fvar(10) * cond( var(10), 1.2, 1)), ceil(3 * fvar(10))

[State 4662, hit]
type = hitdef
triggerall = var(13) <= 1
trigger1 = animelem = 12
attr = A, NA
hitflag = MAF
guardflag = H
animtype = medium
priority = 4, hit
damage = ceil(30 * cond(var(10), 1.2, 1)), 0
pausetime = 12, 12
guard.pausetime = 12, 12
hitsound = s1, 1
guardsound = s1, 21
sparkno = s16175
guard.sparkno = s16650
sparkxy = -5, -100
ground.type = high
ground.slidetime = 18
guard.slidetime = 16
ground.hittime = 18 + cond(var(10), 2, 0)
guard.hittime = 16
guard.ctrltime = 16
ground.velocity = -3 ;0.5
guard.velocity = -3
air.hittime = 100
air.velocity = -3, -4.5
air.animtype = back
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.fall = 1
fall.recover = 0
yaccel = 0.4
getpower = ceil(20 * fvar(10) * cond( var(10), 1.2, 1)), ceil(10 * fvar(10))
givepower = ceil(12 * fvar(10) * cond( var(10), 1.2, 1)), ceil(6 * fvar(10))

[State 4662, retract]
type = statetypeset
trigger1 = animelem = 15
movetype = i 

[State 4662, set 51]
type = varset
trigger1 = time = 0
v = 51
value = 1

;---------------------------------------------------------------------
; VT1 J. Hp
[Statedef 4664]
type    = A
movetype= A
physics = A
poweradd= 0
ctrl = 0
anim = 620
juggle = 0
sprpriority = 2

;------ stop spec move buffer ------
[State 4664, stop spec move]
type = varadd
triggerall = var(56)
trigger1 = time > 0
v = 56
value = -1

;------ counter hit time -------
[State 4664, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 6

;------ juggle points -------
[State 4664, juggle]
type = varset
trigger1 = movehit = 1 && p2statetype = a
var(13) = 1000
ignorehitpause = 1
persistent = 0

[State 4664, 25]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4664, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4664, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 220, voice]
type = playsnd
triggerall = random < 667
trigger1 = time = 3
value = 220, 0 + (random % 3)
channel = 0

[State 4664, whoosh]
type = playsnd
trigger1 = time = 3
value = 0, 2
volumescale = 75

;------ hitdef and sparks ------
[State 4664, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 7
attr = A, NA
hitflag = MAF
guardflag = H
animtype = hard
priority = 5, hit
damage = ceil(90 * cond(var(10), 1.2, 1)), 0
pausetime = 15, 15
guard.pausetime = 15, 15
hitsound = s1, 2
guardsound = s1, 22
sparkno = s16225
guard.sparkno = s16750
sparkxy = 0, -58
ground.type = high
ground.slidetime = 21
guard.slidetime = 19
ground.hittime = 21 + cond(var(10), 2, 0)
guard.hittime = 19
guard.ctrltime = 19
ground.velocity = -4.3 ;0.35
guard.velocity = -4.3
air.hittime = 100
air.velocity = -2, -5
air.animtype = back
ground.cornerpush.veloff =0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcenofall = 1
yaccel = 0.4
getpower = ceil(50 * fvar(10) * cond( var(10), 1.2, 1)), ceil(25 * fvar(10))
givepower = ceil(30 * fvar(10) * cond( var(10), 1.2, 1)), ceil(15 * fvar(10))

[State 4664, retract]
type = statetypeset
trigger1 = animelem = 12
movetype = i 

[State 4664, set 51]
type = varset
trigger1 = time = 0
v = 51
value = 1

;---------------------------------------------------------------------------
; VT1 Mind's Eye {V-Skill I}
[Statedef 4670]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4000
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4670, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4670, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

;------ counter hit time ------
[State 4670, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

[State 4000, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

[State 4000, remove special counter hittable]
type = varset
trigger1 = time = 2
fvar(30) = 0

[State 4000, special counter hittable]
type = varset
trigger1 = time = 9
fvar(30) = 1

[State 4000, remove special counter hittable]
type = varset
trigger1 = time = 47
fvar(30) = 0

;------ juggle points -------
[State 4670, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = ifelse(var(10), 0, 1)
ignorehitpause = 1
persistent = 0

[State 4670, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4670, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4670, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4670, voice]
type = playsnd
trigger1 = time = 1
value = 1600, 0
channel = 0

[State 4670, voice]
type = playsnd
trigger1 = time = 1
value = 0, 5
volumescale = 75

;------ hit ------
[State 4670, reversal]
type = reversaldef
trigger1 = animelem = 3
reversal.attr = SCA, AA, AP
pausetime = 0, 18
hitsound = s1, 30
p1stateno = 4675

[State 4670, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4670, return ctrl]
type = ctrlset
trigger1 = time = 47 
value = 1

[State 4670, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; VT1 Mind's Eye - Cancel {V-Skill I}
[Statedef 4672]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4005
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4672, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4672, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4005, hitby]
type = hitby
trigger1 = time = 0
value = SCA

;------ counter hit time ------
[State 4672, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

[State 4672, special counter hittable]
type = varset
trigger1 = time = 9
fvar(30) = 1

[State 4672, remove special counter hittable]
type = varset
trigger1 = time = 47
fvar(30) = 0

;------ juggle points -------
[State 4672, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = ifelse(var(10), 0, 1)
ignorehitpause = 1
persistent = 0

[State 4672, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
[State 4672, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4672, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4672, voice]
type = playsnd
trigger1 = time = 1
value = 1600, 0
channel = 0

[State 4672, voice]
type = playsnd
trigger1 = time = 1
value = 0, 5
volumescale = 75

;------ hit ------
[State 4672, reversal]
type = reversaldef
trigger1 = animelem = 1
reversal.attr = SCA, AA, AP
pausetime = 0, 18
hitsound = s1, 30
p1stateno = 4675

[State 4672, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4672, return ctrl]
type = ctrlset
trigger1 = time = 47 
value = 1

[State 4672, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; VT1 Mind's Eye - Counter {V-Skill I}
[Statedef 4675]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4010
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 4675, air]
type = changeanim
triggerall = enemynear, statetype = A
trigger1 = time = 0
value = 4011

[State 4675, crouch]
type = changeanim
triggerall = enemynear, statetype = C
trigger1 = time = 0
value = 4012

[State 4675, invincible]
type = nothitby
trigger1 = time = 0
value = SCA

[State 4675, projectile invincible]
type = nothitby
trigger1 = time = [1, 14]
value = , AP

;------ Buffering ------
[State 4675, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4720, Isshin (cancel version)]
type = varset
triggerall = var(38) <= 4715
triggerall = !isHelper(10371)
triggerall = var(15)
triggerall = var(14) = 2
triggerall = statetype != a
triggerall = time = [2, 20]
trigger1 = command = "z3" && command = "c3"
var(38) = 4715

[State 4675, VT Mind's Eye (cancel version)]
type = varset
triggerall = var(38) <= 4672
triggerall = !isHelper(10371)
triggerall = var(15)
triggerall = var(1) = 1 || var(1) = 3
triggerall = statetype != a
triggerall = time = [2, 20]
trigger1 = command = "y3" && command = "b3"
var(38) = 4672

[State 4675, VT1 Ex Shoryuken]
type = varset
triggerall = var(38) <= 4630
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 4630

[State 4675, VT1 Ex Hadouken]
type = varset
triggerall = var(38) <= 4570
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = var(15)
triggerall = var(14) = 1
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(40) ;QCF
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 4570

[State 4675, Mind's Eye (cancel version)]
type = varset
triggerall = var(38) <= 4005
triggerall = !isHelper(10371)
triggerall = var(1) = 1 || var(1) = 3
triggerall = statetype != a
triggerall = time = [2, 20]
trigger1 = command = "y3" && command = "b3"
var(38) = 4005

[State 4675, Ex Jodan Sokutou Geri]
type = varset
triggerall = var(38) <= 1330
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(44) ;HCF
trigger1 = command = "ab" || command = "bc" || command = "ac"
var(38) = 1330

[State 4675, Ex Tatsumaki Senpukyaku]
type = varset
triggerall = var(38) <= 1230
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(41) ;QCB
trigger1 = command = "ab" || command = "bc" || command = "ac"
var(38) = 1230

[State 4675, Ex Shoryuken]
type = varset
triggerall = var(38) <= 1130
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1130

[State 4675, Ex Hadouken]
type = varset
triggerall = var(38) <= 1030
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [2, 20]
triggerall = helper(10371), var(40) ;QCF
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1030

[State 4675, transition]
type = changestate
triggerall = var(38) > 0
trigger1 = time = [15, 20]
value = var(38)

[State 4675, v timer]
type = varadd
triggerall = var(15)
triggerall = var(14) = 1
trigger1 = time = 0
v = 15
value = cond(var(15) > 950, 1000 - var(15), 50 )

[State 4675, v timer]
type = varadd
triggerall = var(15)
triggerall = var(14) = 2
trigger1 = time = 0
v = 15
value = cond(var(15) > 2950, 3000 - var(15), 50 )

[State 4675, hit spark]
type = explod
trigger1 = time = 0
anim = 1135
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0 + pos x + camerapos x , -60 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4675, CtrlSet]
type = CtrlSet
trigger1 = animelem = 24
value = 1

[State 4675, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Kakko Fubatsui {V-Trigger II}
[Statedef 4700]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4700
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4700, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4700, V Timer]
type = varset
trigger1 = time = 52
var(15) = 3000

[State 4700, consume v meter]
type = varadd
trigger1 = time = 52
v = 3
value = cond(var(2) = 2, -600, -900)

[State 4700, 16]
type = varset
trigger1 = time = 52
var(14) = 2

[State 4700, vtrig explod]
type = explod
trigger1 = time = 7
anim = 15015
facing = facing
pos = cond(facing = 1, 1, -1) * 15 + pos x + camerapos x, 15 + pos y
scale = 0.7, 0.7
sprpriority = 3
ownpal = 1
pausemovetime = 999

[State 4700, invuln]
type = nothitby
trigger1 = time < 52
value = SCA

;------ super pause and effects ------
[State 4700, super pause]
type = pause
trigger1 = time = 0
endcmdbuftime = 30
movetime = 51
time = 51

[State 4700, darken]
type = bgpalfx
trigger1 = time = 1
time = 51
add = 0, 0, 0
mul = 128, 128, 128

;------ counter hit time ------
;------ juggle points -------
;------ width & positioning ------
;------ combo scaling ------
[State 4700, increment combo count]
type = varadd
trigger1 = time = 0
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
;------ cancel potential ------
[State 4700, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4700, energy]
type = playsnd
trigger1 = time = 0
value = 4500, 0

[State 4700, voice]
type = playsnd
trigger1 = time = 1
value = 4700, 0
channel = 0

[State 4700, energy]
type = playsnd
trigger1 = time = 18
value = 4500, 2
volumescale = 75

[State 4700, energy]
type = playsnd
trigger1 = time = 6
value = 4700, 3
volumescale = 75

;------ effects ------
[State 4700, return ctrl]
type = ctrlset
trigger1 = time = 56  
value = 1

[State 4700, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Kakko Fubatsui (Cancel) {V-Trigger II}
[Statedef 4705]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4700
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4705, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4705, V Timer]
type = varset
trigger1 = time = 49
var(15) = 3000

[State 4705, consume v meter]
type = varadd
trigger1 = time = 49
v = 3
value = cond(var(2) = 2, -600, -900)

[State 4705, 16]
type = varset
trigger1 = time = 49
var(14) = 2

[State 4705, vtrig explod]
type = explod
trigger1 = time = 7
anim = 15015
facing = facing
pos = cond(facing = 1, 1, -1) * 15 + pos x + camerapos x, 15 + pos y
scale = 0.7, 0.7
sprpriority = 3
ownpal = 1
pausemovetime = 999

[State 4705, invuln]
type = nothitby
trigger1 = time < 49
value = SCA

;------ super pause and effects ------
[State 4705, super pause]
type = pause
trigger1 = time = 0
endcmdbuftime = 30
movetime = 48
time = 48

[State 4705, darken]
type = bgpalfx
trigger1 = time = 1
time = 51
add = 0, 0, 0
mul = 128, 128, 128

;------ counter hit time ------
;------ juggle points -------
;------ width & positioning ------
;------ combo scaling ------
[State 4705, increment combo count]
type = varadd
trigger1 = time = 0
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
;------ cancel potential ------
[State 4705, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4700, energy]
type = playsnd
trigger1 = time = 0
value = 4500, 0

[State 4700, voice]
type = playsnd
trigger1 = time = 1
value = 4700, 0
channel = 0

[State 4700, energy]
type = playsnd
trigger1 = time = 18
value = 4500, 2
volumescale = 75

[State 4700, energy]
type = playsnd
trigger1 = time = 6
value = 4700, 3
volumescale = 75

;------ effects ------
[State 4705, return ctrl]
type = ctrlset
trigger1 = time = 56  
value = 1

[State 4705, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Stance) {V-Trigger II}
[Statedef 4710]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4710
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4710, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4710, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4710, Consume V Timer]
type = varadd
trigger1 = time = 0
var(15) = -1500

;------ counter hit time ------
[State 4710, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

[State 4710, special counter hittable]
type = varset
trigger1 = time = 0
fvar(30) = 1

[State 4710, remove special counter hittable]
type = varset
trigger1 = time = 1
fvar(30) = 0

[State 4710, special counter hittable]
type = varset
trigger1 = time = 11
fvar(30) = 1

[State 4710, remove special counter hittable]
type = varset
trigger1 = time = 47
fvar(30) = 0


;------ juggle points -------
[State 4000, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
;------ cancel potential ------
[State 4710, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4710, voice]
type = playsnd
trigger1 = time = 0
value = 4710, 0
channel = 0

[State 4710, voice]
type = playsnd
trigger1 = time = 0
value = 0, 5
volumescale = 75

;------ hit ------
[State 4710, reversal]
type = reversaldef
trigger1 = animelem = 2
reversal.attr = SCA, AA, AP
pausetime = 8, 26
hitsound = s1, 30
p1stateno = 4720

[State 4710, wind]
type = explod
trigger1 = animelem = 1
anim = 2052
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0, 0 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 0

[State 4710, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4710, return ctrl]
type = ctrlset
trigger1 = time = 47 
value = 1

[State 4710, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Stance) (Cancel) {V-Trigger II}
[Statedef 4715]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 4715
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4710, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4715, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4715, Consume V Timer]
type = varadd
trigger1 = time = 0
var(15) = -1500

;------ counter hit time ------
[State 4715, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

[State 4710, special counter hittable]
type = varset
trigger1 = time = 11
fvar(30) = 1

[State 4710, remove special counter hittable]
type = varset
trigger1 = time = 47
fvar(30) = 0


;------ juggle points -------
[State 4715, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
;------ combo scaling ------
;------ cancel potential ------
[State 4715, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4715, voice]
type = playsnd
trigger1 = time = 0
value = 4710, 0
channel = 0

[State 4715, voice]
type = playsnd
trigger1 = time = 0
value = 0, 5
volumescale = 75

;------ hit ------
[State 4715, reversal]
type = reversaldef
trigger1 = animelem = 1
reversal.attr = SCA, AA, AP
pausetime = 8, 26
hitsound = s1, 30
p1stateno = 4720

[State 4715, wind]
type = explod
trigger1 = animelem = 1
anim = 2052
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0, 0 + pos y
scale = 0.35, 0.35
sprpriority = 3
bindid = -1
bindtime = 11
ownpal = 1
ignorehitpause = 1
persistent = 0
removeongethit = 0

[State 4715, retract]
type = statetypeset
trigger1 = animelem = 26
movetype = i

[State 4715, return ctrl]
type = ctrlset
trigger1 = time = 47 
value = 1

[State 4715, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Isshin - Counter {V-Skill I}
[Statedef 4720]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4720
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 4010, air]
type = changeanim
triggerall = enemynear, statetype = A
trigger1 = time = 0
value = 4721

[State 4010, crouch]
type = changeanim
triggerall = enemynear, statetype = C
trigger1 = time = 0
value = 4722

[State 4720, invincible]
type = nothitby
trigger1 = time < 19
value = SCA

;------ Buffering ------
[State 4720, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4720, Isshin (cancel version)]
type = varset
triggerall = var(38) <= 4715
triggerall = !isHelper(10371)
triggerall = var(15)
triggerall = var(14) = 2
triggerall = statetype != a
triggerall = time = [2, 20]
trigger1 = command = "z3" && command = "c3"
var(38) = 4715

[State 4010, Mind's Eye (cancel version)]
type = varset
triggerall = var(38) <= 4005
triggerall = !isHelper(10371)
triggerall = var(1) = 1 || var(1) = 3
triggerall = statetype != a
triggerall = time = [2, 20]
trigger1 = command = "y3" && command = "b3"
var(38) = 4005

[State 4720, transition]
type = changestate
triggerall = var(38) > 0
trigger1 = time = [13, 14]
value = var(38)

;------ sounds ------
[State 4720, sfx]
type = playsnd
trigger1 = time = 0
value = 4720, 0
volumescale = 75

;------ hit ------
[State 4720, hit]
type = hitdef
trigger1 = animelem = 1
attr = S, SA
hitflag = MAF
guardflag =
priority = 6, hit
damage = 0, 0
sparkno = -1
hitsound = -1, 0
fall = 0
pausetime = 0, 0
ground.hittime = 20
air.hittime = 20
numhits = 0

[State 4720, target]
type = targetstate
triggerall = numtarget
trigger1 = movehit = 1
value = 4735

[State 4720, to attack]
type = changestate
triggerall = numtarget
trigger1 = target, stateno = 4735
value = 4730

[State 4720, hit spark]
type = explod
trigger1 = time = 0
anim = 2053
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0 + pos x + camerapos x , -60 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0 

[State 4720, CtrlSet]
type = CtrlSet
trigger1 = time = 17
value = 1

[State 4720, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Attack) {V-Trigger II}
[Statedef 4730]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4730
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4730, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4730, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4730, invincible]
type = nothitby
trigger1 = time < 92
value = SCA

;------ counter hit time ------
[State 4730, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4730, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 0
ignorehitpause = 1
persistent = 0

[State 4730, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4730, width]
type = width
trigger1 = animelemtime(25) <= 0
value = 18, 0

[State 4730, pos]
type = posadd
trigger1 = time =21
x = 16*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =22
x = 26*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =39
x = 1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =40
x = 2*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =41
x = 4*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =42
x = 4*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =43
x = 4*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =44
x = 3*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =45
x = 2*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =46
x = 2*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =47
x = 1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =48
x = 1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =49
x = 1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =50
x = 0*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =51
x = 0*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =52
x = 0*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =53
x = -1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =54
x = -1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =55
x = -1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =56
x = -1*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =57
x = -2*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =58
x = -2*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =59
x = -3*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =60
x = -4*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =61
x = -4*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =62
x = -5*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =63
x = -5*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =64
x = -5*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =65
x = -6*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =66
x = -4*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =67
x = -2*const(size.xscale)

[State 4730, pos]
type = posadd
trigger1 = time =68
x = -1*const(size.xscale)

[State 4730, target]
type = targetbind
trigger1 = time = 0
pos = 55, 0

;------ combo scaling ------
[State 4730, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4730, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ Buffering ------
[State 4730, reset]
type = varset
trigger1 = time = 0
var(38) = 0

[State 4730, Ex Jodan Sokutou Geri]
type = varset
triggerall = var(38) <= 1330
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [50, 90]
triggerall = helper(10371), var(44) ;HCF
trigger1 = command = "ab" || command = "bc" || command = "ac"
var(38) = 1330

[State 4730, Hp Shoryuken]
type = varset
triggerall = var(38) <= 1130
triggerall = !isHelper(10371)
triggerall = power >= 300
triggerall = statetype != a
triggerall = time = [50, 90]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "xy" || command = "yz" || command = "xz"
var(38) = 1130

[State 4730, Hp Shoryuken]
type = varset
triggerall = var(38) <= 1120
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [50, 90]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "z3"
var(38) = 1120

[State 4730, Mp Shoryuken]
type = varset
triggerall = var(38) <= 1110
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [50, 90]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "y3"
var(38) = 1110

[State 4730, Lp Shoryuken]
type = varset
triggerall = var(38) <= 1100
triggerall = !isHelper(10371)
triggerall = statetype != a
triggerall = time = [50, 90]
triggerall = helper(10371), var(42) ;DP
trigger1 = command = "x3"
var(38) = 1100

[State 4730, transition]
type = changestate
triggerall = var(38) > 0
triggerall = movecontact
trigger1 = time = [72, 90]
value = var(38)


;------ sounds ------
[State 4730, voice]
type = playsnd
trigger1 = time = 20
value = 4730, 0
channel = 0

[State 4730, whoosh]
type = playsnd
trigger1 = time = 20
value = 4730, 1
volumescale = 75

[State 4730, se]
type = playsnd
trigger1 = time = 20
value = 4730, 2
volumescale = 75

;------ hit ------
[State 4730, hit]
type = hitdef
trigger1 = animelem = 24
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(150 * cond(var(10), 1.2, 1)), 38
pausetime = 4, 22
guard.pausetime = 4, 22
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 37
guard.slidetime = 21
ground.hittime = 37 + ifelse(var(10), 2, 0) 
guard.hittime = 21
guard.ctrltime = 21
ground.velocity = -3.6
guard.velocity = -4.8
air.velocity = -2, -5
air.hittime = 100
air.fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(80 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(40* fvar(10))
givepower = ceil(48 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(24* fvar(10))
guard.kill = 0

[State 4730, crumple]
type = targetstate
triggerall = numtarget
trigger1 = movehit && target, hitshakeover
value = 6400
persistent = 0
ignorehitpause = 1

[State 4730, hit spark]
type = explod
trigger1 = movehit = 1
anim = 2054
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 60 + pos x + camerapos x , -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4730, retract]
type = StateTypeSet
trigger1 = animelem = 25
movetype = I    

[State 4730, return ctrl]
type = ctrlset
trigger1 = time = 91
value = 1

[State 4730, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Hadouken Cancel) {V-Trigger II}
[Statedef 4740]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4740
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4740, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4740, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4740, Consume V Timer]
type = varadd
trigger1 = time = 0
var(15) = -1500

[State 4740, invincible]
type = nothitby
trigger1 = time < 92
value = SCA

[State 4740, darken]
type = bgpalfx
trigger1 = time = 1
time = 16
add = 0, 0, 0
mul = 128, 128, 128

[State 4740, pause]
type = pause
trigger1 = time = 2
time = 8
endcmdbuftime = 4
movetime = 4


;------ counter hit time ------
[State 4740, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4740, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 1
ignorehitpause = 1
persistent = 0

[State 4740, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4740, pos]
type = posadd
trigger1 = time =20
x = 8*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =21
x = 8*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =22
x = 8*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =23
x = 8*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =24
x = 31*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =25
x = 47*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =26
x = 61*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =27
x = 77*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =43
x = 3*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =44
x = 2*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =45
x = 2*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =46
x = 1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =47
x = 1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =48
x = 1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =49
x = 0*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =50
x = 0*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =51
x = 0*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =52
x = -1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =53
x = -1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =54
x = -1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =55
x = -1*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =56
x = -2*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =57
x = -2*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =58
x = -3*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =59
x = -4*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =60
x = -4*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =61
x = -5*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =62
x = -5*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =63
x = -5*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =64
x = -6*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =65
x = -4*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =66
x = -2*const(size.xscale)

[State 4740, pos]
type = posadd
trigger1 = time =67
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4740, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4740, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4740, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4740, voice]
type = playsnd
trigger1 = time = 15
value = 4740, 0
channel = 0

[State 4740, whoosh]
type = playsnd
trigger1 = time = 23
value = 4730, 1
volumescale = 75

[State 4740, se]
type = playsnd
trigger1 = time = 23
value = 4730, 2
volumescale = 75

;------ hit ------
[State 4740, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 27
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(140 * cond(var(10), 1.2, 1)), 35
pausetime = 20, 20
guard.pausetime = 20, 20
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 17
guard.slidetime = 17
ground.hittime = 17 + ifelse(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -6, -4
guard.velocity = -11.8
air.velocity = -6, -4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(20* fvar(10))
givepower = ceil(24 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0

[State 4740, hit spark]
type = explod
trigger1 = movehit = 1
anim = 2054
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 60 + pos x + camerapos x , -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4740, retract]
type = StateTypeSet
trigger1 = animelem = 33
movetype = I    

[State 4740, return ctrl]
type = ctrlset
trigger1 = time = 67
value = 1

[State 4740, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Ex Hadouken Cancel) {V-Trigger II}
[Statedef 4750]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4740
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4750, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4750, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4750, Consume V Timer]
type = varadd
trigger1 = time = 0
var(15) = -1500

[State 4750, invincible]
type = nothitby
trigger1 = time < 92
value = SCA

[State 4750, darken]
type = bgpalfx
trigger1 = time = 1
time = 16
add = 0, 0, 0
mul = 128, 128, 128

[State 4740, pause]
type = pause
trigger1 = time = 2
time = 8
endcmdbuftime = 4
movetime = 4


;------ counter hit time ------
[State 4750, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4750, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 1
ignorehitpause = 1
persistent = 0

[State 4750, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4750, pos]
type = posadd
trigger1 = time =20
x = 8*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =21
x = 8*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =22
x = 8*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =23
x = 8*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =24
x = 31*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =25
x = 47*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =26
x = 61*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =27
x = 77*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =43
x = 3*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =44
x = 2*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =45
x = 2*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =46
x = 1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =47
x = 1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =48
x = 1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =49
x = 0*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =50
x = 0*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =51
x = 0*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =52
x = -1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =53
x = -1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =54
x = -1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =55
x = -1*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =56
x = -2*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =57
x = -2*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =58
x = -3*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =59
x = -4*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =60
x = -4*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =61
x = -5*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =62
x = -5*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =63
x = -5*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =64
x = -6*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =65
x = -4*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =66
x = -2*const(size.xscale)

[State 4750, pos]
type = posadd
trigger1 = time =67
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4750, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4750, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4750, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4750, voice]
type = playsnd
trigger1 = time = 5
value = 4750, 0
channel = 0

[State 4750, whoosh]
type = playsnd
trigger1 = time = 23
value = 4730, 1
volumescale = 75

[State 4750, se]
type = playsnd
trigger1 = time = 23
value = 4730, 2
volumescale = 75

;------ hit ------
[State 4750, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 27
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(140 * cond(var(10), 1.2, 1)), 35
pausetime = 20, 20
guard.pausetime = 20, 20
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 17
guard.slidetime = 17
ground.hittime = 17 + ifelse(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -6, -4
guard.velocity = -11.8
air.velocity = -6, -4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(20* fvar(10))
givepower = ceil(24 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0

[State 4750, hit spark]
type = explod
trigger1 = movehit = 1
anim = 2054
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 60 + pos x + camerapos x , -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4750, retract]
type = StateTypeSet
trigger1 = animelem = 33
movetype = I    

[State 4750, return ctrl]
type = ctrlset
trigger1 = time = 67
value = 1

[State 4750, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Shoryuken Cancel) {V-Trigger II}
[Statedef 4760]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4760
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4760, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4760, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4760, Consume V Timer]
type = varadd
trigger1 = time = 0
var(15) = -1500

[State 4760, invincible]
type = nothitby
trigger1 = time < 92
value = SCA

[State 4760, darken]
type = bgpalfx
trigger1 = time = 1
time = 26
add = 0, 0, 0
mul = 128, 128, 128

;------ counter hit time ------
[State 4740, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4760, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 1
ignorehitpause = 1
persistent = 0

[State 4760, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4760, pos]
type = posadd
trigger1 = time =31
x = 8*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =32
x = 8*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =33
x = 8*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =34
x = 8*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =35
x = 31*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =36
x = 47*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =37
x = 61*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =38
x = 77*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =54
x = 3*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =55
x = 2*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =56
x = 2*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =57
x = 1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =58
x = 1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =59
x = 1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =60
x = 0*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =61
x = 0*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =62
x = 0*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =63
x = -1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =64
x = -1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =65
x = -1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =66
x = -1*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =67
x = -2*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =68
x = -2*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =69
x = -3*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =70
x = -4*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =71
x = -4*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =72
x = -5*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =73
x = -5*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =74
x = -5*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =75
x = -6*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =76
x = -4*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =77
x = -2*const(size.xscale)

[State 4760, pos]
type = posadd
trigger1 = time =78
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4760, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4760, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4760, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4760, voice]
type = playsnd
trigger1 = time = 1
value = 4760, 0
channel = 0

[State 4760, voice]
type = playsnd
trigger1 = time = 35
value = 4760, 1
channel = 0

[State 4760, whoosh]
type = playsnd
trigger1 = time = 35
value = 4730, 1
volumescale = 75

[State 4760, se]
type = playsnd
trigger1 = time = 35
value = 4730, 2
volumescale = 75

;------ hit ------
[State 4760, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 39
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(140 * cond(var(10), 1.2, 1)), 35
pausetime = 20, 20
guard.pausetime = 20, 20
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 17
guard.slidetime = 17
ground.hittime = 17 + ifelse(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -6, -4
guard.velocity = -11.8
air.velocity = -6, -4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(20* fvar(10))
givepower = ceil(24 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0

[State 4760, hit spark]
type = explod
trigger1 = movehit = 1
anim = 2054
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 60 + pos x + camerapos x , -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4760, retract]
type = StateTypeSet
trigger1 = animelem = 44
movetype = I    

[State 4760, return ctrl]
type = ctrlset
trigger1 = time = 78
value = 1

[State 4760, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Isshin (Jodan Sokotou Geri Cancel) {V-Trigger II}
[Statedef 4770]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4770
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

;------ stop spec move buffer ------
[State 4770, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4770, vel reset]
type = velset
triggerall = prevstateno < 200
trigger1 = time = 0
x = 0

[State 4770, Consume V Timer]
type = varadd
trigger1 = time = 0
var(15) = -1500

[State 4770, invincible]
type = nothitby
trigger1 = time < 92
value = SCA

[State 4770, darken]
type = bgpalfx
trigger1 = time = 2
time = 13
add = 0, 0, 0
mul = 128, 128, 128

[State 4740, pause]
type = pause
trigger1 = time = 2
time = 4
endcmdbuftime = 2
movetime = 2

;------ counter hit time ------
[State 4770, counter hit variable]
type = varset
trigger1 = time = 0
var(9) = 10

;------ juggle points -------
[State 4770, juggle]
type = varadd
trigger1 = movehit = 1 && p2statetype = a
v = 13
value = 1
ignorehitpause = 1
persistent = 0

[State 4770, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ width & positioning ------
[State 4770, pos]
type = posadd
trigger1 = time =13
x = 8*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =14
x = 8*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =15
x = 8*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =16
x = 8*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =17
x = 31*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =18
x = 47*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =19
x = 61*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =20
x = 77*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =36
x = 3*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =37
x = 2*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =38
x = 2*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =39
x = 1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =40
x = 1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =41
x = 1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =42
x = 0*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =43
x = 0*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =44
x = 0*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =45
x = -1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =46
x = -1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =47
x = -1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =48
x = -1*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =49
x = -2*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =50
x = -2*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =51
x = -3*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =52
x = -4*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =53
x = -4*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =54
x = -5*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =55
x = -5*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =56
x = -5*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =57
x = -6*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =58
x = -4*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =59
x = -2*const(size.xscale)

[State 4770, pos]
type = posadd
trigger1 = time =60
x = -1*const(size.xscale)

;------ combo scaling ------
[State 4770, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4770, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

[State 4770, super cancel]
type = varset
trigger1 = movecontact = 1 || movereversed = 1
var(31) = 4
ignorehitpause = 1

;------ sounds ------
[State 4770, voice]
type = playsnd
trigger1 = time = 8
value = 4740, 0
channel = 0

[State 4770, whoosh]
type = playsnd
trigger1 = time = 16
value = 4730, 1
volumescale = 75

[State 4770, se]
type = playsnd
trigger1 = time = 16
value = 4730, 2
volumescale = 75

;------ hit ------
[State 4770, hit]
type = hitdef
triggerall = var(13) <= 10
trigger1 = animelem = 20
attr = S, SA
hitflag = MAF
guardflag = M
animtype = hard
priority = 6, hit
damage = ceil(140 * cond(var(10), 1.2, 1)), 35
pausetime = 20, 20
guard.pausetime = 20, 20
hitsound = s1, 14
guardsound = s1, 22
sparkno = s16350
guard.sparkno = s16850
sparkxy = 0, -75
ground.type = Low
ground.slidetime = 17
guard.slidetime = 17
ground.hittime = 17 + ifelse(var(10), 2, 0) 
guard.hittime = 17
guard.ctrltime = 17
ground.velocity = -6, -4
guard.velocity = -11.8
air.velocity = -6, -4
air.hittime = 100
fall = 1
fall.recover = 0
yaccel = 0.4
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
getpower = ceil(40 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(20* fvar(10))
givepower = ceil(24 * fvar(10) * ifelse(var(10), 1.2, 1)), ceil(12* fvar(10))
guard.kill = 0

[State 4770, hit spark]
type = explod
trigger1 = movehit = 1
anim = 2054
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 60 + pos x + camerapos x , -75 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4770, retract]
type = StateTypeSet
trigger1 = animelem = 26
movetype = I    

[State 4770, return ctrl]
type = ctrlset
trigger1 = time = 60
value = 1

[State 4770, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;Parry crouch
[Statedef 4854]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 1403
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 220, hit spark]
type = explod
trigger1 = time = 0
anim = 2053
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0 + pos x + camerapos x , -60 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4000, voice]
type = playsnd
trigger1 = time = 0
value = 2050, 2
channel = 0

[State 4000, sfx]
type = playsnd
trigger1 = time = 0
value = 1600, 3

;------ Parry cancel ------

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 17
value = 1

[State 4000, return]
type = changestate
trigger1 = time = 13
value = 4856

[State 4000, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;Parry air
[Statedef 4855]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 1401
poweradd = 0
juggle = 0
sprpriority = 2
facep2 = 1

[State 220, hit spark]
type = explod
trigger1 = time = 0
anim = 2053
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0 + pos x + camerapos x , -60 + pos y
scale = 0.35, 0.35
sprpriority = 3
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4000, voice]
type = playsnd
trigger1 = time = 0
value = 2050, 2
channel = 0

[State 4000, sfx]
type = playsnd
trigger1 = time = 0
value = 1600, 3

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 17
value = 1

[State 4000, return]
type = changestate
trigger1 = time = 13
value = 4856

[State 4000, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;V-Shift
[Statedef 4900]
type    = S
movetype = I
physics = S
ctrl = 0
anim = 4900
sprpriority = 1
velset = 0, 0

;------ stop spec move buffer ------
[State 4900, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4900, throw invincible]
type = nothitby
trigger1 = animelemtime(10) < 0
value = , AT, AP

[State 4900, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

[State 4900, V-Meter Cost]
type = varadd
trigger1 = time = 0
v = 3
value = -300

[State 4900, special counter hittable]
type = varset
trigger1 = time = 9
fvar(30) = 1

[State 4900, remove special counter hittable]
type = varset
trigger1 = time = 30
fvar(30) = 0

;------ width & positioning ------
[State 4900, pos]
type = posadd
trigger1 = time =2
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =2
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =3
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =4
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =5
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =6
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =7
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =8
x = -14.1*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =9
x = -12*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =10
x = -11.9*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =11
x = -12*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =12
x = -12*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =13
x = -11.9*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =14
x = -11.8*const(size.xscale)

[State 4900, pos]
type = posadd
trigger1 = time =15
x = -6.3*const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 16
x = -5.4 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 17
x = -5.2 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 18
x = -4.9 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 19
x = -4.5 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 20
x = -4 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 21
x = -3.6 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 22
x = -2.9 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 23
x = -1.8 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = time = 24
x = -0.5 * const(size.xscale)

;------ cancel potential ------
[State 4900, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------ 
[State 4900, sound]
type = playsnd
trigger1 = time = 0
value = 4900, 1
volumescale = 75

[State 4900, voice]
type = playsnd
trigger1 = time = 0
value = 4900, 4
channel = 0

;------ Override ------
[State 4900, Change to second state]
type = ReversalDef
trigger1 = 1
reversal.attr = SCA, NA, SA, HA, NP, SP, HP
pausetime = 0, 0
p1stateno = 4910
sparkno = -1

[State 4900, wind]
type = explod
trigger1 = time = 0
anim = 4905
id = 4900
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 0 , 35
scale = 0.56, 0.56
ownpal = 1
bindID = -1
bindtime = 10
sprpriority = 3
ignorehitpause = 0
removeongethit = 1

[State 4900, time counter reset]
type = varset
trigger1 = time = 0
var(57) = 0

[State 4900, time]
type = varadd
trigger1 = time > 0
v = 57
value = 1

[State 4900, ctrl]
type = ctrlset
trigger1 = time = 31
value = 1

[State 4900, 3]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;V-Shift Dodge
[Statedef 4910]
type    = S
movetype = I
physics = S
ctrl = 0
sprpriority = 1
velset = 0, 0

;------ stop spec move buffer ------
[State 4900, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

[State 4910, invincibility]
type = nothitby
trigger1 = var(57) < 23
value = SCA

[State 4910, to anim]
type = changeanim
trigger1 = time = 0
value = 4910
elem = var(57)

[State 4910, time]
type = varadd
trigger1 = 1
v = 57
value = 1

[State 4910, refund V-Meter]
type = varadd
trigger1 = var(57) = 11
v = 3
value = 150

;--- posadds --
[State 4910, pos]
type = posadd
trigger1 = var(57) =2
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =3
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =4
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =5
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =6
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =7
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =8
x = -14.1*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =9
x = -12*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =10
x = -11.9*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =11
x = -12*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =12
x = -12*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =13
x = -11.9*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =14
x = -11.8*const(size.xscale)

[State 4910, pos]
type = posadd
trigger1 = var(57) =15
x = -6.3*const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 16
x = -5.4 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 17
x = -5.2 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 18
x = -4.9 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 19
x = -4.5 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 20
x = -4 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 21
x = -3.6 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 22
x = -2.9 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 23
x = -1.8 * const(size.xscale)

[State 105, pos]
type = posadd
trigger1 = var(57) = 24
x = -0.5 * const(size.xscale)

;------ slowdown ------
[State 7000, darken]
type = bgpalfx
trigger1 = var(57) < 23
time = 4
add = 0, 0, 0
mul = 128, 128, 128

[State 4910, pause]
type = pause
trigger1 = var(57) = 1
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 2
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 3
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 4
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 5
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 6
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 7
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 8
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 9
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 10
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 11
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 12
time = 3
endcmdbuftime = 0
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 13
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 14
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 15
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 16
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 17
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 18
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 19
time = 3
endcmdbuftime = 2
movetime = 1

[State 4910, pause]
type = pause
trigger1 = var(57) = 20
time = 3
endcmdbuftime = 2
movetime = 1

;------ sounds ------
[State 4910, fx]
type = playsnd
trigger1 = time = 0
value = 4900, 2

;------ To Break ------
[State 4910, transition]
type = changestate
triggerall = var(57) = [18, 20]
trigger1 = command = "hold_z" && command ="hold_b"
value = 4920

[State 4000, replace if hit]
type = explod
trigger1 = time = 0
anim = 4915
id = 4910
space = stage
facing = facing
pos = 0, -85
scale = 0.56, 0.56
ownpal = 1
bindID = -1
bindtime = 999
sprpriority = 3
removeongethit = 1

[State 4910, ctrl]
type = ctrlset
trigger1 = var(57) = 23
value = 1

[State 4910, 3]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------
; Fumikomi Jodan Kagizuki {V-Shift Break}
[Statedef 4920]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 4920
poweradd = 0
juggle = 0
sprpriority = 2
velset = 0, 0

;------ stop spec move buffer ------
[State 4920, reset 56]
type = varset
trigger1 = time = 0
var(56) = 0

;------ counter hit time ------
[State 4920, invincible]
type = nothitby
trigger1 = animelemtime(24) < 0
value = SCA

;------ juggle points -------
[State 4920, corner push]
type = varset
trigger1 = time = 0
var(25) = 1

;------ slow mo ------
[State 4920, pause]
type = pause
trigger1 = time = 0
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 2
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 4
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 6
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 8
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 10
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 12
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 14
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 16
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 18
time = 1
endcmdbuftime = 1
movetime = 1

[State 4920, pause]
type = pause
trigger1 = time = 20
time = 1
endcmdbuftime = 1
movetime = 1

;------ width & positioning ------
[State 4920, pos]
type = posadd
trigger1 = time =4
x = 1*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =5
x = 15*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =6
x = 15*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =7
x = 14*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =8
x = 15*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =9
x = 16*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =10
x = 16*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =11
x = 17*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =12
x = 19*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =13
x = 20*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =14
x = 21*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =15
x = 22*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =16
x = 23*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =17
x = 22*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =18
x = 21*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =19
x = 21*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =20
x = 20*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =21
x = -4*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =22
x = -6*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =23
x = -1*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =24
x = 11*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =25
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =26
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =27
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =28
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =29
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =30
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =31
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =32
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =33
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =34
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =35
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =36
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =37
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =38
x = 0*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =39
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =40
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =41
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =42
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =43
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =44
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =45
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =46
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =47
x = 7*const(size.xscale)

[State 4920, pos]
type = posadd
trigger1 = time =48
x = 7*const(size.xscale)

;------ combo scaling ------
[State 4920, increment combo count]
type = varadd
trigger1 = movehit = 1
v = 40
value = 1
ignorehitpause = 1
persistent = 0

;------ juggle points -------
[State 4920, juggle]
type = varadd
trigger1 = movehit = 1
v = 13
value = 99
ignorehitpause = 1
persistent = 0

;------ cancel potential ------
[State 4920, reset cancels]
type = varrangeset
trigger1 = time = 0
first = 27
last = 33
value = 0

;------ sounds ------
[State 4920, voice]
type = playsnd
trigger1 = time = 4
value = 4900, 3
channel = 0

[State 4920, whoosh]
type = playsnd
trigger1 = time = 1
value = 4900, 0
volumescale = 75

;----- effects -----
[State 4920, hit]
type = hitdef
triggerall = var(13) <= 0
trigger1 = animelem = 21
attr = S, SA
hitflag = MAF
guardflag = M
priority = 6, hit
hitsound = s1, 2
guardsound = s1, 22
damage = 60,0
sparkno = -1
guard.sparkno = -1
pausetime = 15, 15
guard.pausetime = 15, 15
animtype = hard
ground.type = high
ground.slidetime = 26
guard.slidetime = 23
ground.hittime = 26 + ifelse(fvar(10), 2, 0)
guard.hittime = 23
guard.ctrltime = 23
ground.velocity = -3.5, -3.6
guard.velocity = -10.9
air.velocity = -3.5, -3.6
fall = 1
fall.recover = 0
getpower = 0, 0
yaccel = 0.4
givepower = 0, 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
guard.kill = 0

[State 4920, hit spark]
type = explod
trigger1 = movehit = 1
anim = 15003
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 34 + pos x + camerapos x , -82 + pos y
scale = 0.5, 0.5
sprpriority = 2
ownpal = 1
ignorehitpause = 1
persistent = 0
angle = -45

[State 4920, block spark]
type = explod
trigger1 = moveguarded = 1
anim = 15008
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 42 + pos x + camerapos x , -65 + pos y
scale = 0.5, 0.5
sprpriority = 2
ownpal = 1
ignorehitpause = 1
persistent = 0

[State 4000, blue]
type = null
trigger1 = time = 8
anim = 4925
id = 4920
space = stage
facing = facing
pos = ifelse(facing = 1, 1, -1) * 47 , 5
scale = 0.56, 0.56
ownpal = 1
bindID = -1
bindtime = 15
sprpriority = 7
removeongethit = 1
ignorehitpause = 0

[State 4920, retract]
type = statetypeset
trigger1 = animelem = 24
movetype = i

[State 4920, return ctrl]
type = ctrlset
trigger1 = time = 46  
value = 1

[State 4920, return]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
