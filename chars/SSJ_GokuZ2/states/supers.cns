;=============================================
; CNS File for SSJ Goku Z2 by Team Z2
; Super Moves
;=============================================

;===========================================================================
; <<<<< KAMEHAMEHA >>>>>
; State = 2000
; Helper : 2001
;===========================================================================

;Lvl 1 Kame

;Lvl 1 Kame
[Statedef 2000]
type = S
physics = S
movetype = A
anim = 2000
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -1000

[State 3000, width]
type=width
trigger1= animelemtime(22)<0
value=25,0

[State 0, for trial]
type = VarSet
trigger1 = !time
var(18) = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [0,48]
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = animelemtime(22) < 0
time = 1
value = SCA

[State 200, 1]
type = PlaySnd	;Voice=English
trigger1 = time = 0
value = 3,308+(Random%5)
volume = 355
channel = 0

[State 200, Kmh charge]
type = PlaySnd
trigger1 = time = 10
trigger2 = time = 30
value = 2000,10
volume = 355

[State 0, Explod]
type = Explod
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 40
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = time=5
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s2000,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 5
anim = 2003
id = 2003
pos = -139,50    ;-145,52
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = 1
scale = 1,1
persistent = 0

[State 0, Charge Ball FX]
type = Explod
trigger1 = time = 5
anim = 2001+10000*(var(2)=0)
id = 2001
pos = -25,-59   ;-31,-57
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = 43
sprpriority = 5
ownpal = 1
bindtime = 1
scale = 1,1
persistent = 0

[State 0, Ki Gather FX]
type = Explod
trigger1 = time = 5
anim = 2002+10000*(var(2)=0)
id = 2002
pos = -25,-59   ;-31,-57
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = 43
sprpriority = 6
ownpal = 1
bindtime = 1
scale = 1,1
persistent = 0

[State 200, Kmh charge long]
type = PlaySnd
trigger1 = time = 5
value = 2400,1

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 48
color=0
mul=0,0,0

;--------------
; Teleportation during superpause
; GROUND (far, mid, behind) = 2010,2020,2030
; AIR    (far, mid, behind) = 2040,2050,2060

[State 2000, VarSet]
type = VarSet
Trigger1=!Time
fvar(6) = 0

[State 2000, VarSet]
type = VarSet
Trigger1=animelemtime(20) < 0 && IfElse(Facing=1,NumExplod(90010104),NumExplod(90010006))
Trigger1= NumExplod(90000200) || NumExplod(90000210) || NumExplod(90000220) || NumExplod(90000205) || NumExplod(90000215) || NumExplod(90000225)
fvar(6) = (IfElse(NumExplod(90000210)||NumExplod(90000215),2,IfElse(NumExplod(90000220)||NumExplod(90000225),3,1)))
;What does that mean? ^ Same thing as above but with different commands. This is one if for QCB and punch
;X=far
;Y=mid
;Z=behind

[State 2000, VarSet]
type = VarSet
Trigger1=!Time
fvar(7) = 0

[State 2000, VarSet]
type = VarSet
Trigger1=animelemtime(20) < 0 && IfElse(Facing=1,NumExplod(90010104),NumExplod(90010006))
Trigger1= NumExplod(90000230) || NumExplod(90000240) || NumExplod(90000250) || NumExplod(90000235) || NumExplod(90000245) || NumExplod(90000255)
fvar(7) = (IfElse(NumExplod(90000240)||NumExplod(90000245),2,IfElse(NumExplod(90000250)||NumExplod(90000255),3,1)))
;A=far
;B=mid
;C=behind

[state 2000, Change to ground teleport Kmh]
type = ChangeState
triggerall = !AILevel && anim = 2000
triggerall = animelemtime(20) < 0
triggerall= Fvar(6)>0
Trigger1=Var(5)>=100
value = 2010 + 10*(fvar(6)=2) + 20*(fvar(6)=3); - 10*(fvar(6)=1))
[state 2000, Change to air teleport Kmh]
type = ChangeState
triggerall = !AILevel && anim = 2000
triggerall = animelemtime(20) < 0
triggerall= Fvar(7)>0
Trigger1=Var(5)>=100
value = 2040 + 10*(fvar(7)=2) + 20*(fvar(7)=3); - 10*(fvar(6)=1))


[state 2000, Change to ground teleport Kmh]
type = ChangeState
triggerall = AILevel  && anim = 2000 && random<100+(20*var(54)) && enemynear,statetype!=A
triggerall = animelemtime(18)>=0 && animelemtime(20)<0
TriggerAll=Var(5)>=100
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,movetype=A)
value = Ifelse(backedgedist >=100 && enemynear,vel x>=1,2010,2030)


[state 2000, Change to air teleport Kmh]
type = ChangeState
triggerall = AILevel && anim = 2000 && random<100+(20*var(54)) && enemynear,statetype!=C
triggerall = animelemtime(18)>=0 && animelemtime(20)<0
TriggerAll=Var(5)>=100
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,movetype=A)
value = Ifelse(backedgedist >=100 && enemynear,vel x>=1,2040,2060)

;--------------

[state 1215, Change to up Kmh]
type = ChangeAnim
trigger1 = !AILevel && anim = 2000 && animelemtime(20)=3
trigger1 = command = "holdup"
trigger2 = AILevel && anim = 2000 && animelemtime(20)=3
trigger2 = numenemy && (p2dist y<=-60) && (p2bodydist x=[20,140])
value = 2100

[state 1215, Smoke FX]
type = explod
trigger1 = anim=2000 && animelemtime(21)=0
trigger2 = anim=2100 && animelemtime(1)=0
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

;[state 1215, Flash FX straight]
;type = explod
;trigger1 = anim=2000 && animelemtime(21)=0
;anim = 2005
;id = 2005
;pos = 0,0
;postype = P1
;sprpriority = 3
;ownpal = 1
;removetime = -2
;persistent = 0
;ignorehitpause = 0
;
;[state 1215, Flash FX Up]
;type = explod
;trigger1 = anim=2100 && animelem=1
;anim = 2105
;id = 2105
;pos = 0,0
;postype = P1
;sprpriority = 3
;ownpal = 1
;removetime = -2
;persistent = 0
;ignorehitpause = 0

[State 3000, Kamehameha]
type = helper
trigger1 = anim=2000 && animelem=21
helpertype = normal
stateno = 2001
ID = 2001
name = "kameha"
postype = p1
pos = 80,-60
ownpal = 1

[State 3000, Up Kamehameha]
type = helper
trigger1 = anim=2100 && animelem=1
helpertype = normal
stateno = 2101
ID = 2101
name = "kameha_up"
postype = p1
pos = 40,-67
ownpal = 1

[State 3000, Idle]
type = statetypeset
trigger1 = animelemtime(34) = 0
movetype = I

[State 3000, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;-------------------------------------
; TELEPORT KAMEHAMEHA
;-------------------------------------

;Light Ground Kmh teleport
[Statedef 2010]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
;poweradd = ifelse(var(49)>0,0,-500)
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 12
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 12

[State 4001, Ground version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype!=A
value = 2011

[State 4001, Air version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype=A || pos Y < -5
value = 2012

[State 4001, Teleport]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
X = -100

[State 4001, Teleport]
type = PosSet
trigger1 = AnimElemTime(2) = 0
Y = 0

[State 4001, Teleport]
type = StatetypeSet
trigger1 = AnimElemTime(2) = 0
statetype = S
physics = S

[State 4001, Launch Kmh]
type = ChangeState
trigger1 = !AnimTime
value = 2065
ctrl = 0

;-----------------------------
;Medium Ground Kmh teleport
[Statedef 2020]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
;poweradd = ifelse(var(49)>0,0,-500)
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 12
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 12


[State 4001, Ground version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype!=A
value = 2011 ;1400

[State 4001, Air version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype=A || pos Y < -5
value = 2012 ;1405

[State 4001, Teleport]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
X = (p2dist X)/2

[State 4001, Teleport]
type = PosSet
trigger1 = AnimElemTime(2) = 0
Y = 0

[State 4001, Teleport]
type = StatetypeSet
trigger1 = AnimElemTime(2) = 0
statetype = S
physics = S

[State 4001, Launch Kmh]
type = ChangeState
trigger1 = !AnimTime
value = 2065
ctrl = 0

;-----------------------------
;Strong Ground Kmh teleport
[Statedef 2030]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
;poweradd = ifelse(var(49)>0,0,-500)
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 12
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 12


[State 4001, Ground version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype!=A
value = 2011 ;1400

[State 4001, Air version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype=A || pos Y < -5
value = 2012 ;1405


[State 4001, Teleport]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
X = (p2dist X) + 60

[State 4001, Teleport]
type = PosSet
trigger1 = AnimElemTime(2) = 0
Y = 0

[State 4001, Teleport]
type = StatetypeSet
trigger1 = AnimElemTime(2) = 0
statetype = S
physics = S

[State 4001, Teleport]
type = Turn
trigger1 = !AnimTime
trigger1 = p2dist X < -10

[State 4001, Launch Kmh]
type = ChangeState
trigger1 = !AnimTime
value = 2065
ctrl = 0

;-------------------------------------
;Light Aerial Kmh teleport
[Statedef 2040]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
;poweradd = ifelse(var(49)>0,0,-500)
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 12
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 12

[State 4001, Ground version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype!=A
value = 2011 ;1400

[State 4001, Air version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype=A || pos Y < -5
value = 2012 ;1405

[State 4001, Teleport]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
X = -100

[State 4001, Teleport]
type = PosSet
trigger1 = AnimElemTime(2) = 0
Y = ifelse((enemy,statetype=A),(enemy,pos Y)-80,-100)

[State 4001, Teleport]
type = StatetypeSet
trigger1 = AnimElemTime(2) = 0
statetype = A
physics = A

[State 4001, Launch Air Kmh]
type = ChangeState
trigger1 = !AnimTime
value = 2070
ctrl = 0

;-------------------------------------
;Medium Aerial Kmh teleport
[Statedef 2050]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
;poweradd = ifelse(var(49)>0,0,-500)
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 12
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 12

[State 4001, Ground version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype!=A
value = 2011 ;1400

[State 4001, Air version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype=A || pos Y < -5
value = 2012 ;1405

[State 4001, Teleport]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
X = (p2dist X)/2

[State 4001, Teleport]
type = PosSet
trigger1 = AnimElemTime(2) = 0
Y = ifelse((enemy,statetype=A),(enemy,pos Y)-40,-60)

[State 4001, Teleport]
type = StatetypeSet
trigger1 = AnimElemTime(2) = 0
statetype = A
physics = A

[State 4001, Launch Air Kmh]
type = ChangeState
trigger1 = !AnimTime
value = 2070
ctrl = 0

;-------------------------------------
;Strong Aerial Kmh teleport
[Statedef 2060]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
;poweradd = ifelse(var(49)>0,0,-500)
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 12
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 12

[State 4001, Ground version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype!=A
value = 2011 ;1400

[State 4001, Air version]
type = ChangeAnim
triggerall = !time
trigger1 = statetype=A || pos Y < -5
value = 2012 ;1405

[State 4001, Teleport]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
X = (p2dist X) + 70

[State 4001, Teleport]
type = PosSet
trigger1 = AnimElemTime(2) = 0
Y = ifelse((enemy,statetype=A),(enemy,pos Y)-40,-60)

[State 4001, Teleport]
type = StatetypeSet
trigger1 = AnimElemTime(2) = 0
statetype = A
physics = A

[State 4001, Teleport]
type = Turn
trigger1 = !AnimTime
trigger1 = p2dist X < -10

[State 4001, Launch Air Kmh]
type = ChangeState
trigger1 = !AnimTime
value = 2070
ctrl = 0

;----------------------------------
;Ground Kmh teleport LAUNCH
[Statedef 2065]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
sprpriority = 1

;JUSTICE MODE
[State 3000, Buffer var]
type = varadd
trigger1 = !time
trigger1 = Var(28) <100
var(49) = IfElse(Enemy, MoveType != H,-50,-150) ;0
;JUSTICE MODE
[State 3000, Justice var]
type = varadd
trigger1 = !time
var(50) = 100

[State 4001, Launch Kmh]
type = ChangeAnim
trigger1 = !time
value = 2000
elem = 18

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 12
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time 
time = 10
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 10

[state 1215, Change to up Kmh]
type = ChangeAnim
trigger1 = anim = 2000
trigger1 = animelemtime(20)=3
trigger1 = command = "holdup"
value = 2100

[state 1215, Smoke FX]
type = explod
trigger1 = anim=2000 && animelemtime(21)=0
trigger2 = anim=2100 && animelemtime(1)=0
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

;[state 1215, Flash FX straight]
;type = explod
;trigger1 = anim=2000 && animelemtime(21)=0
;anim = 2005
;id = 2005
;pos = 0,0
;postype = P1
;sprpriority = 3
;ownpal = 1
;removetime = -2
;persistent = 0
;ignorehitpause = 0
;
;[state 1215, Flash FX Up]
;type = explod
;trigger1 = anim=2100 && animelem=1
;anim = 2105
;id = 2105
;pos = 0,0
;postype = P1
;sprpriority = 3
;ownpal = 1
;removetime = -2
;persistent = 0
;ignorehitpause = 0

[State 3000, Kamehameha]
type = helper
trigger1 = anim=2000 && animelem=21
helpertype = normal
stateno = 2001
ID = 2001
name = "kameha"
postype = p1
pos = 80,-60
ownpal = 1

[State 3000, Up Kamehameha]
type = helper
trigger1 = anim=2100 && animelem=1
helpertype = normal
stateno = 2101
ID = 2101
name = "kameha_up"
postype = p1
pos = 40,-67
ownpal = 1

[State 3000, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------
;Air Kmh teleport LAUNCH
[Statedef 2070]
type = U
physics = N
movetype = A
velset = 0,0
ctrl = 0
sprpriority = 1


;JUSTICE MODE
[State 3000, Buffer var]
type = varadd
trigger1 = !time
trigger1 = Var(28) <100
var(49) = IfElse(Enemy, MoveType != H,-50,-150) ;0
;JUSTICE MODE
[State 3000, Justice var]
type = varadd
trigger1 = !time
var(50) = 100

[State 4001, Launch Kmh]
type = ChangeAnim
trigger1 = !time
value = 2200
elem = 18

[State 3000, superpause]
type = superpause
trigger1 = !time 
time = 7
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 7

[State 3000, Kamehameha]
type = helper
trigger1 = anim=2200 && animelemtime(20)=0
helpertype = normal
stateno = 2201
ID = 2201
name = "kameha_down"
postype = p1
pos = 40,-60
ownpal = 1

[State 2200, vel]
type = velset
trigger1 = animelemtime(20)=0
x = -1.5
y = -6

[State 2200, sts]
type = statetypeset
trigger1 = animelemtime(20)>0
physics = A



;===========================================================================
; <<<<< AIR KAMEHAMEHA >>>>>
; State = 2200
; Helper : 2201
;===========================================================================

;Air Lvl1 Kame
[Statedef 2200]
type = A
physics = N
movetype = A
anim = 2200
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -1000

[State 0, from Blast Fist]
type = PosAdd
trigger1 = !time && (prevstateno=[1201,1251])
X = 15
Y = -40

[State 0, for trial]
type = VarSet
trigger1 = !time
var(18) = 1

[State 3000, width]
type = width
trigger1 = anim=2200 && animelemtime(21)<0
value = 15,0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [5,45]
flag = noBG
flag2 = noFG

[State 3000, nhb]
type = nothitby
trigger1 = animelemtime(21) < 0
time = 1
value = SCA

[State 200, 1]
type = PlaySnd		;Voice=English
trigger1 = time = 0
value = 3,308+(Random%5)
volume = 355
channel = 0

[State 0, Explod]
type = Explod
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 40
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = time = 5
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s2000,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 5
anim = 2003
id = 2003
pos = -131,27
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Charge Ball FX]
type = Explod
trigger1 = time = 5
anim = 2001+10000*(var(2)=0)
id = 2001
pos = -17,-78
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = 41
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Ki Gather FX]
type = Explod
trigger1 = time = 5
anim = 2002+10000*(var(2)=0)
id = 2002
pos = -17,-78
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = 41
sprpriority = 6
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 200, Kmh charge long]
type = PlaySnd
trigger1 = time = 5
value = 2400,1

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = time = 0
time = 45
color=0
mul=0,0,0

;--------------
; Teleportation during superpause
; GROUND (far, mid, behind) = 2010,2020,2030
; AIR    (far, mid, behind) = 2040,2050,2060

[State 2000, VarSet]
type = VarSet
Trigger1=!Time
fvar(6) = 0

[State 2000, VarSet]
type = VarSet
Trigger1=animelemtime(20) < 0&&NumExplod(90000562)
Trigger1=(ifElse(NumExplod(90000200), 1, 0) + ifElse(NumExplod(90000210), 1, 0) + ifElse(NumExplod(90000220), 1, 0) >= 2) || (ifElse(NumExplod(90000205), 1, 0) + ifElse(NumExplod(90000215), 1, 0) + ifElse(NumExplod(90000225), 1, 0) >= 2) 
fvar(6) = (IfElse(NumExplod(90000220)&&NumExplod(90000210),2,IfElse(NumExplod(90000220)&&NumExplod(90000200),3,1)))
;X+Y=far
;Y+Z=mid
;X+Z=behind

[State 2000, VarSet]
type = VarSet
Trigger1=animelemtime(20) < 0 && IfElse(Facing=1,NumExplod(90010104),NumExplod(90010006))
Trigger1= NumExplod(90000200) || NumExplod(90000210) || NumExplod(90000220) || NumExplod(90000205) || NumExplod(90000215) || NumExplod(90000225)
fvar(6) = (IfElse(NumExplod(90000210)||NumExplod(90000215),2,IfElse(NumExplod(90000220)||NumExplod(90000225),3,1)))
;X=far
;Y=mid
;Z=behind

[State 2000, VarSet]
type = VarSet
Trigger1=!Time
fvar(7) = 0

[State 2000, VarSet]
type = VarSet
Trigger1=animelemtime(20) < 0&&NumExplod(90000562)
TriggerAll=(ifElse(NumExplod(90000230), 1, 0) + ifElse(NumExplod(90000240), 1, 0) + ifElse(NumExplod(90000250), 1, 0) >= 2) || (ifElse(NumExplod(90000235), 1, 0) + ifElse(NumExplod(90000245), 1, 0) + ifElse(NumExplod(90000255), 1, 0) >= 2) 
fvar(7) = (IfElse(NumExplod(90000250)&&NumExplod(90000240),2,IfElse(NumExplod(90000250)&&NumExplod(90000230),3,1)))
;A+B=far
;B+C=mid
;A+C=behind

[State 2000, VarSet]
type = VarSet
Trigger1=animelemtime(20) < 0 && IfElse(Facing=1,NumExplod(90010104),NumExplod(90010006))
Trigger1= NumExplod(90000230) || NumExplod(90000240) || NumExplod(90000250) || NumExplod(90000235) || NumExplod(90000245) || NumExplod(90000255)
fvar(7) = (IfElse(NumExplod(90000240)||NumExplod(90000245),2,IfElse(NumExplod(90000250)||NumExplod(90000255),3,1)))
;A=far
;B=mid
;C=behind

[state 2000, Change to ground teleport Kmh]
type = ChangeState
triggerall = !AILevel && anim = 2200
triggerall = animelemtime(20) < 0
TriggerAll=Var(5)>=100
;trigger1 = var(48) = 0  Normal commands. Commented out because easy commands are no longer used
trigger1 = Fvar(6)>0
value = 2010 + 10*(fvar(6)=2) + 20*(fvar(6)=3); - 10*(fvar(6)=1))

[state 2000, Change to ground teleport Kmh]
type = ChangeState
triggerall = AILevel  && anim = 2200 && random<100+(5*var(54)) && enemynear,statetype!=A
triggerall = animelemtime(17)>=0 && animelemtime(19)<0
TriggerAll=Var(5)>=100
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,movetype=A)
value = Ifelse(backedgedist >=100 && enemynear,vel x>=1,2010,2030)

[state 2000, Change to air teleport Kmh]
type = ChangeState
triggerall = !AILevel && anim = 2200
triggerall = animelemtime(20) < 0
TriggerAll=Var(5)>=100
;trigger1 = var(48) = 0  Normal commands. Commented out because easy commands are no longer used
trigger1 = Fvar(7)>0
value = 2040 + 10*(fvar(7)=2) + 20*(fvar(7)=3); - 10*(fvar(6)=1))

[state 2000, Change to air teleport Kmh]
type = ChangeState
triggerall = AILevel && anim = 2200 && random<100+(5*var(54)) && enemynear,statetype!=C
triggerall = animelemtime(17)>=0 && animelemtime(19)<0
TriggerAll=Var(5)>=100
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,movetype=A)
value = Ifelse(backedgedist >=100 && enemynear,vel x>=1,2040,2060)
;--------------

;[state 1215, Flash FX]
;type = explod
;trigger1 = anim=2200 && animelemtime(20)=0
;anim = 2210
;id = 2210
;pos = 0,0
;postype = P1
;sprpriority = 3
;ownpal = 1
;removetime = -2
;persistent = 0
;ignorehitpause = 0
;bindtime = -1

[State 3000, Kamehameha]
type = helper
trigger1 = anim=2200 && animelemtime(20)=0
helpertype = normal
stateno = 2201
ID = 2201
name = "kameha_down"
postype = p1
pos = 40,-60
ownpal = 1

[State 2200, vel]
type = velset
trigger1 = animelemtime(20)=0
x = -1.2;-1.5
y = -2.25;-6

[State 2200, sts]
type = statetypeset
trigger1 = animelemtime(23)>0
physics = A


;===========================================================================
; <<<<< SONIC RUSH >>>>>
; Charge State = 2300
; Charging up = 2301
; Charging 45� = 2302
; Hitting = 2310
; P2 binded = 2311
; Roundhouse Kick = 2315
;===========================================================================

;Sonic Rush
[Statedef 2300]
type = S
physics = S
movetype = A
anim = 2300
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -1000


[State 0]
Type=PlaySND;This is my chance!
Trigger1=!Time&&Random<500
Value=3,296
Channel=0
VolumeScale=200

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG

[State 0, Explod]
type = Explod
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 40
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = time=5
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s2000,0
darken = 0
movetime = 40

[State 0, Super FX]
type = Explod
trigger1 = time = 5
anim = 2003
id = 2003
pos = -110,67
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,1
volume = 255
[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,0
loop = 1
pan = 1
volume = 25
channel = 3

[State 1900, Aura helper]
type = Helper
trigger1 = animelemtime(2)=0
id = 905
name = "Charge"
pos = 0,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
supermovetime = 9999
pausemovetime = 9999

[State 1900, dust]
type = explod
trigger1 = animelemtime(2)=0
anim = 908+(var(2)=0)
id = 908
pos = 17,5
sprpriority = 4
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = -1
removetime = -1
supermovetime = 9999
pausemovetime = 9999

[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,0
loop = 1
pan = 1
volume = 25
channel = 3

[State 1000, shake]
type = EnvShake
triggerall = animelemtime(2)>=0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.02*time

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 48
color = 0
mul = 0,0,0

[State 4001, End]
type = ChangeState
trigger1 = !AILevel && time=49 && command!="holdfwd"
trigger2 = AILevel && time=49 && p2bodydist x<=45 && p2dist y<=-75
value = 2301
ctrl = 0
[State 4001, End]
type = ChangeState
trigger1 = !AILevel && time=49 && command="holdfwd"
trigger2 = AILevel && time=49 
value = 2302
ctrl = 0

;-------------------------
; Sonic Rush Charging
[Statedef 2301]
type = S
physics = S
movetype = A
anim = 2301
ctrl = 0
velset = 0,0
sprpriority = 2

[State 3000, noshadow]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 0]
Type=PlayerPush
Trigger1=1
Value=0

[State 3000, width]
type = width
trigger1 = 1
value = 25,0

[State 4500, 1];Speed FX
type = PlaySnd
trigger1 = !time
value = 2700,1

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType !=A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = MA
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2310
;p2stateno = 2311
id = 2301

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType =A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
;guardflag = MA
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2310
;p2stateno = 2311
id = 2311

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2398)
trigger1 = MoveHit = 1
anim = 15999
ID = 2398
removetime = -1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2399)
trigger1 = NumTarget(2311)
anim = 15999
ID = 2399
removetime = 160
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = MoveHit=1
value = 2310
ignorehitpause = 1
persistent = 0

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2311
ID = 2301
ignorehitpause = 1
persistent = 0

[State 1000, in air]
type = PosAdd
trigger1 = !AnimTime
X = 80
Y = -230

[State 1000, in air]
type = statetypeset
trigger1 = !AnimTime
movetype = I
statetype = A
physics = A

[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
Trigger2=Pos X!=[-260,260]
value = 50
ctrl = 0

;-------------------------
; Sonic Rush Charging 45�
[Statedef 2302]
type = S
physics = S
movetype = A
anim = 2302
ctrl = 0
velset = 0,0
sprpriority = 2

[State 3000, noshadow]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 0]
Type=PlayerPush
Trigger1=1
Value=0

[State 3000, width]
type = width
trigger1 = 1
value = 25,0

[State 4500, 1];Speed FX
type = PlaySnd
trigger1 = !time
value = 2700,1

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType !=A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = MA
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2310
;p2stateno = 2311
id = 2302

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType =A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = MA
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2310
;p2stateno = 2311
id = 2312

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2398)
trigger1 = MoveHit = 1
anim = 15999
ID = 2398
removetime = -1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2399)
trigger1 = NumTarget(2312)
anim = 15999
ID = 2399
removetime = 160
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = MoveHit=1
value = 2310
ignorehitpause = 1
persistent = 0

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2311
ID = 2302
ignorehitpause = 1
persistent = 0

[State 1000, in air]
type = PosAdd
trigger1 = !AnimTime
X = Cond(FrontEdgeBodyDist<=100,50,260)
Y = -90

[State 1000, in air]
type = statetypeset
trigger1 = !AnimTime
movetype = I
statetype = A
physics = A

[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
Trigger2=Pos X!=[-260,260]
value = 50
ctrl = 0

;-------------------------
; Sonic Rush Attacking
[Statedef 2310]
type = A
physics = N
movetype = A
anim = 2310+2*(prevstateno=2302)
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=TimerFreeze
Flag2=RoundNotOver

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 =time=10
value = 3,216+(Random%5)

[State 0, ChangeState]
type = ChangeState
trigger1 = Time >=10
trigger1 = P2MoveType != H
value = 50

[State 3000, width]
type = width
trigger1 = !time
value = 25,0

[State 1000, in air]
type = PosAdd
trigger1 = !Time && prevstateno=2301
X = 80
Y = -230
[State 1000, in air]
type = PosSet
trigger1 = !Time && prevstateno=2301
Y = -120

[State 1000, in air]
type = PosAdd
trigger1 = !Time && prevstateno=2302
X = 260
Y = -90

[State 810, bind 1]
type = targetbind
trigger1 = animelemtime(1)>=0 && animelemtime(4)<0
pos = 60,-40

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 = !time
value = S3,206+(random%9)
channel = 0

[State 640, 2]
type = HitDef
trigger1 = animelem = 1
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 7, 7, fvar(11) * 15)), 1
;Ceil(IfElse(fvar(11) * 10 < 5, 5, fvar(11) * 10)), 1
;10, 1
; ceil(10.0/fvar(15)),1                ;;;old
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s7030
guard.sparkno = s7000
sparkxy = -16,-87
hitsound   = s5,9
guardsound = S6,random%2
ground.type = High
pausetime = 19,25
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time = 20
envshake.freq = 100
envshake.ampl = 7
fall = 1
fall.recover = 0
kill = 0


[State 640, 2]
type = HitDef
trigger1 = animelemtime(2)>0
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 15 < 7, 7, fvar(11) * 15)), 1
;Ceil(IfElse(fvar(11) * 10 < 5, 5, fvar(11) * 10)), 1
;10, 1
; ceil(10.0/fvar(15)),1                ;;;old
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s(7010+10*(random%2))
guard.sparkno = s7000
sparkxy = -10-(random%20),-70-(random%40)
hitsound   = s5,ifelse(random<333,200,random%2)
guardsound = S6,random%2
ground.type = High
pausetime = 4,5
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time=16
envshake.freq=80
envshake.ampl=4
fall = 1
fall.recover = 0
kill = 0

[State 902, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 5000
ignorehitpause = 1


[State 4001, Go to Roundhouse Kick]
type = ChangeState
trigger1 = !AnimTime
value = 2315
ctrl = 0

;-------------------------
; Sonic Rush - P2 binded
[Statedef 2311]
type = A
physics = N
movetype = H
ctrl = 0
velset = 0,0
sprpriority = 1

[State 802, anim]
type = changeanim2
trigger1 = !time
value = 2311

;-------------------------
; Sonic Rush - Roundhouse Kick
[Statedef 2315]
type = A
physics = N
movetype = A
anim = 2315
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=TimerFreeze
Flag2=RoundNotOver

[State 250, woosh]
type = PlaySnd
trigger1 = AnimElem = 2
value = 0, 2

[State 0, StopSnd]
type = StopSnd
trigger1 = Time=0
channel = -1

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 =animelem=2
value = S3,206+(random%9)
channel = 0

[State 250, 2]
type = HitDef
trigger1 = AnimElem = 3
attr = S, HA
animtype  = Hard
damage = Ceil(IfElse(fvar(11) * 18 < 7, 7, fvar(11) * 18)), 6
;Ceil(IfElse(fvar(11) * 18 < 7, 7, fvar(11) * 18)), 6
;18, 6
; ceil(18.0/fvar(15)),6                ;;;old
priority = 4, Hit
guardflag = MA
pausetime = 24,25
guard.pausetime = 20,20
sparkno = s7030
guard.sparkno = s7000
sparkxy = -25,-90
hitsound   = s5,5
guardsound = S6,1
ground.type = high
ground.slidetime = 15
ground.hittime = 20
ground.velocity = -7
air.velocity = -12,-3
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
envshake.time = 25
envshake.freq = 120
envshake.ampl = 8
p2facing = 1
;p2stateno = 275		; <- Opponent sent to flying state
airguard.cornerpush.veloff= 0
air.animtype = Back
air.juggle = 0
fall = 1
fall.recover = 0


[State 1211, AllPalFX]
type = AllPalFX
trigger1 = Movehit
time = 5
color = 0
invertall = 1
ignorehitpause = 1
persistent = 0

[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = Cond(NumExplod(2399),1,0)


;===========================================================================
; <<<<< SUPERSONIC RUSH >>>>>
; Charge State = 2500
; Charging up = 2501
; Charging 45� = 2502
; Hitting = 2510
; P2 binded = 2511
; Roundhouse Kick = 2515
;===========================================================================

;Supersonic Rush
[Statedef 2500]
type = S
physics = S
movetype = A
anim = 2300
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -2000

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG

[State 0, Explod]
type = Explod
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 40
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = time=5
time = 40
p2defmul = 1
unhittable = 1
anim = -1
sound = s2350,0
darken = 0
movetime = 40

[State 0, Hyper Charge FX]
type = Explod
trigger1 = time = 5
anim = 2441
id = 2441
pos = 8,-40
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,1
volume = 255
[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,0
loop = 1
pan = 1
volume = 25
channel = 3

[State 0]
Type=PlaySND;This is my chance!
Trigger1=!Time&&Random<800
Value=3,296
Channel=0
VolumeScale=200

[State 1900, Aura helper]
type = Helper
trigger1 = animelemtime(2)=0
id = 905
name = "Charge"
pos = 0,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
supermovetime = 9999
pausemovetime = 9999

[State 1900, dust]
type = explod
trigger1 = animelemtime(2)=0
anim = 908+(var(2)=0)
id = 908
pos = 17,5
sprpriority = 4
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = -1
removetime = -1
supermovetime = 9999
pausemovetime = 9999

[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,0
loop = 1
pan = 1
volume = 25
channel = 3

[State 1000, shake]
type = EnvShake
triggerall = animelemtime(2)>=0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.04*time

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 48
color = 0
mul = 0,0,0

[State 4001, End]
type = ChangeState
trigger1 = !AILevel && time=49 && command!="holdfwd"
trigger2 = AILevel && time=49 && p2bodydist x<=45 && p2dist y<=-75
value = 2501
ctrl = 0
[State 4001, End]
type = ChangeState
trigger1 = !AILevel && time=49 && command="holdfwd"
trigger2 = AILevel && time=49 
value = 2502
ctrl = 0

;-------------------------
; Supersonic Rush Charging
[Statedef 2501]
type = S
physics = S
movetype = A
anim = 2301
ctrl = 0
velset = 0,0
sprpriority = 2

[State 3000, noshadow]
type = assertspecial
trigger1 = 1
flag = noshadow
Flag2=TimerFreeze

[State 3000, width]
type = width
trigger1 = 1
value = 25,0

[State 0]
Type=PlayerPush
Trigger1=1
Value=0

[State 4500, 1];Speed FX
type = PlaySnd
trigger1 = !time
value = 2700,1

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType !=A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
;guardflag = 
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2510
;p2stateno = 2511
id = 2501

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType =A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
;guardflag = 
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2510
;p2stateno = 2511
id = 2511

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2398)
trigger1 = MoveHit = 1
anim = 15999
ID = 2398
removetime = -1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2399)
trigger1 = NumTarget(2511)
anim = 15999
ID = 2399
removetime = 160
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = MoveHit=1
value = 2510
ignorehitpause = 1
persistent = 0

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2511
ID = 2501
ignorehitpause = 1
persistent = 0

[State 1000, in air]
type = PosAdd
trigger1 = !AnimTime
X = 80
Y = -230

[State 1000, in air]
type = statetypeset
trigger1 = !AnimTime
movetype = I
statetype = A
physics = A

[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
Trigger2=Pos X!=[-260,260]
value = 50
ctrl = 0

;-------------------------
; Supersonic Rush Charging 45�
[Statedef 2502]
type = S
physics = S
movetype = A
anim = 2302
ctrl = 0
velset = 0,0
sprpriority = 2

[State 3000, noshadow]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 3000, width]
type = width
trigger1 = 1
value = 25,0

[State 0]
Type=PlayerPush
Trigger1=1
Value=0

[State 4500, 1];Speed FX
type = PlaySnd
trigger1 = !time
value = 2700,1

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType !=A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = 
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2510
;p2stateno = 2511
id = 2502

[State 3005, hit]
type = hitdef
triggerall = roundstate=2
trigger1 = !NumHelper(2398)
trigger1 = p2statetype = A
trigger1 = P2MoveType =A
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = 
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p1stateno = 2510
;p2stateno = 2511
id = 2512

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2398)
trigger1 = MoveHit = 1
anim = 15999
ID = 2398
removetime = -1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = !NumHelper(2399)
trigger1 = NumTarget(2512)
anim = 15999
ID = 2399
removetime = 160
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = MoveHit=1
value = 2510
ignorehitpause = 1
persistent = 0

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2511
ID = 2502
ignorehitpause = 1
persistent = 0

[State 1000, in air]
type = PosAdd
trigger1 = !AnimTime
X = Cond(FrontEdgeBodyDist<=100,50,260)
Y = -90

[State 1000, in air]
type = statetypeset
trigger1 = !AnimTime
movetype = I
statetype = A
physics = A

[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
Trigger2=Pos X!=[-260,260]
value = 50
ctrl = 0

;-------------------------
; Supersonic Rush Attacking
[Statedef 2510]
type = A
physics = N
movetype = A
anim = 2511;+(prevstateno=2502)
ctrl = 0
velset = 0,0
sprpriority = 2


[State 0, Explod];This is a counter special move
type = null;Explod
TriggerAll=!NumExplod(754)
Trigger1=Fvar(8);&&MoveHit;=1
anim = 15999
ID = 754
IgnoreHitPause=1
removetime =-1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=TimerFreeze
Flag2=RoundNotOver

[State 0, ChangeState]
type = ChangeState
trigger1 = Time >=10
trigger1 = P2MoveType != H
value = 50

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 =time=10
value = 3,216+(Random%5)
channel=1

[State 3000, width]
type = width
trigger1 = !time
value = 25,0

[State 1000, in air]
type = PosAdd
trigger1 = !Time && prevstateno=2501
X = 80
Y = -230
[State 1000, in air]
type = PosSet
trigger1 = !Time && prevstateno=2501
Y = -120

[State 1000, in air]
type = PosAdd
trigger1 = !Time && prevstateno=2502
X = 260
Y = -90

[State 810, bind 1]
type = targetbind
trigger1 = animelemtime(1)>=0 && animelemtime(4)<0
pos = 60,-40

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 = !time
value = S3,206+(random%9)
channel = 0

[State 640, 2]
type = HitDef
trigger1 = animelem = 1
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 20 < 10, 10, fvar(11) * 20)), 1
;Ceil(IfElse(fvar(11) * 15 < 7, 7, fvar(11) * 15)), 1
;15, 1
; ceil(15.0/fvar(15)),1                ;;;old
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s7030
guard.sparkno = s7000
sparkxy = -16,-87
hitsound   = s5,9
guardsound = S6,random%2
ground.type = High
pausetime = 19,25
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time = 20
envshake.freq = 100
envshake.ampl = 7
fall = 1
fall.recover = 0
kill = 0

[State 640, 2]
type = HitDef
trigger1 = animelemtime(2)>0
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 10 < 5, 5, fvar(11) * 10)), 1
;Ceil(IfElse(fvar(11) * 9 < 5, 5, fvar(11) * 9)), 1
;9, 1
; ceil(9.0/fvar(15)),1                ;;;old
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s(7010+10*(random%2))
guard.sparkno = s7000
sparkxy = -10-(random%20),-70-(random%40)
hitsound   = s5,ifelse(random<333,200,random%2)
guardsound = S6,random%2
ground.type = High
pausetime = 4,5
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time=16
envshake.freq=80
envshake.ampl=4
fall = 1
fall.recover = 0
kill = 0

[State 902, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 5000
ignorehitpause = 1


[State 4001, Go to Final Punch]
type = ChangeState
trigger1 = !AnimTime
value = 2515
ctrl = 0

;-------------------------
; Supersonic Rush - P2 binded
[Statedef 2511]
type = A
physics = N
movetype = H
ctrl = 0
velset = 0,0
sprpriority = 1

[State 802, anim]
type = changeanim2
trigger1 = !time
value = 2311

;-------------------------
; Supersonic Rush - Final Punch
[Statedef 2515]
type = A
physics = N
movetype = A
anim = 2316
ctrl = 0
velset = 0,0
sprpriority = 2


[State 0]
Type=AssertSpecial
Trigger1=1
Flag=TimerFreeze
Flag2=RoundNotOver

[State 0, StopSnd]
type = StopSnd
trigger1 = Time=0
channel = -1

[State 250, woosh]
type = PlaySnd
trigger1 = AnimElem = 2
value = 0, 2

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 = !time
value = S3,237+(random%2)
channel = 0

[State 250, 2]
type = HitDef
trigger1 = AnimElem = 3
attr = S, HA
animtype  = Hard
damage = Ceil(IfElse(fvar(11) * 65 < 62, 62, fvar(11) * 65)), 6
;Ceil(IfElse(fvar(11) * 18 < 7, 7, fvar(11) * 18)), 6
;18, 6
; ceil(18.0/fvar(15)),6                ;;;old
priority = 4, Hit
guardflag = MA
pausetime = 24,25
guard.pausetime = 20,20
sparkno = s7030
guard.sparkno = s7000
sparkxy = -25,-90
hitsound   = s5,5
guardsound = S6,1
ground.type = high
ground.slidetime = 15
ground.hittime = 20
ground.velocity = -7
air.velocity = -2,13
air.animtype = back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
envshake.time = 25
envshake.freq = 120
envshake.ampl = 8
p2facing = 1
;p2stateno =IfElse(NumExplod(754),651,2520)		; <- Opponent sent to flying state
airguard.cornerpush.veloff= 0
air.animtype = Back
air.juggle = 0
fall = 1
fall.recover = 0

[State 802, TargetState]
type =null; TargetState
trigger1 = movehit&&NumExplod(754)
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 651
ID = -1
ignorehitpause = 1
persistent = 0

[State 0]
Type=ChangeState
trigger1 = movehit=1&&Enemy,MoveType = H
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 1700
ignorehitpause = 0
persistent = 0

[State 802, TargetState]
type =TargetState
trigger1 = !NumExplod(2399)&&!NumExplod(754)
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2520
ID = -1
ignorehitpause = 1
persistent = 0

[State 802, TargetState]
type =null;TargetState
trigger1 = NumExplod(2399)
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2521
ID = 2515
ignorehitpause = 1
persistent = 0

[State 1211, AllPalFX]
type = AllPalFX
trigger1 = Movehit
time = 5
color = 0
invertall = 1
ignorehitpause = 1
persistent = 0


[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl =0

;===========================================================================
;P2 custom state, sent away
[Statedef 2520]
type = A
movetype = H
physics = N
ctrl = 0
velset = 0,0
facep2 = 1


[State 4005, anim]
type = ChangeAnim2
trigger1 = !Time
Value = 2520

[State 4005, vel]
type = Velset
trigger1 = anim=2520
x = 0
y = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 4005, vel]
type = ChangeAnim
trigger1 = anim=2520 && !AnimTime
Value = ifelse(selfanimexist(5052),5052,5030)

[State 4005, vel]
type = velset
trigger1 = anim=5052 || anim=5030
x = -3
y = 15
persistent = 0

[State 9011, VelAdd]
type = VelAdd
triggerall = anim=5052 || anim=5030
trigger1 = (Pos Y < 0)
y = 0.35
 
[State 9011, ChangeState]
type = ChangeSTate
triggerall = anim=5052 || anim=5030
trigger1 = (Pos Y >= 0) && (Vel Y > 0)
value = 5100
;===========================================================================
;P2 CH custom state, sent away
[Statedef 2521]
type = A
movetype = H
physics = N
ctrl = 0
velset = 0,0
facep2 = 1

[State 4005, anim]
type = ChangeAnim2
trigger1 = !Time
Value = 2520

[State 4005, vel]
type = Velset
trigger1 = anim=2520
x = 0
y = 0

[State 4005, vel]
type = ChangeAnim
trigger1 = anim=2520 && !AnimTime
Value = ifelse(selfanimexist(5052),5052,5030)

[State 4005, vel]
type = velset
trigger1 = anim=5052 || anim=5030
x = -10
y = -7
persistent = 0

[State 9011, VelAdd]
type = VelAdd
triggerall = anim=5052 || anim=5030
trigger1 = (Pos Y < 0)
y = 0.35
 
[State 9011, ChangeState]
type = SelfState
triggerall = anim=5052 || anim=5030
trigger1 = (Pos Y >= 0) && (Vel Y > 0)
value = 5100


;===========================================================================
;===========================================================================

;Lvl3 Kame
[Statedef 2400]
type=a
physics = N
movetype = A
anim = IfElse(Var(49)>0,2600,2900)
ctrl = 0
sprpriority = 1
poweradd = -3000

;SSJ2 Lightning Aura
[State 2800, lightning aura]
type = explod
trigger1=Var(49)=0
trigger1=Time%3=0
anim = 3810+(random%12);2805+(random%4)
id = 2805
pos = 30-(random%76),-120+(Random%80);10-5*(random%5),-55
sprpriority = 4
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = IfElse(random%2=0,1,-1)
removetime = -2
scale = 0.5+0.1*(random%4), 0.5+0.1*(random%4)
pausemovetime = 99999
supermovetime = 99999

[State 0, PalFXWiz]
type = PalFX
trigger1 =Var(49)>0
time = 10
add = 70,-50,-50
mul = 256,256,256

[state 17100, radial aura];Red Aura
type = explod
trigger1 = !time&&Var(49)>0
anim = 2829
id = 2829
pos = 0,0
postype = P1
sprpriority = -2
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[State 0, for trial]
type = VarSet
trigger1 = !time
var(18) = 1

[State 0, remove Dust FX]
type = RemoveExplod
trigger1 = time>0&&Pos Y<0
trigger2=enemynear,movetype=a
ID = 17100

[State 0, remove Kmh Flash FX]
type = RemoveExplod
trigger1 = !time
ID = 2005
[State 0, remove Kmh Flash FX]
type = RemoveExplod
trigger1 = !time
ID = 2105

[State 3000, width]
type=width
trigger1 = 1
value = 25,0

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(26) = 0

[State 0, AssertSpecial]
type = AssertSpecial
triggerall = anim = 2900||anim = 2600
trigger1 = time = [0,200]
;flag = noBG
flag = noFG

[State 3000, nhb]
type = nothitby
trigger1 = anim = 2900 && var(26) = 0
trigger1 = Time <200
trigger1 = anim = 2600 && var(26) = 0
trigger1 = Time <200
time = 1
value = SCA

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4)
time=4
freq=80
ampl=2+0.02*time

[State 200, 1];Voice (Kamehame)
type = PlaySnd
 		;Voice=English
trigger1 = time = 0
value = 3,300+(Random%8)
channel = 0
volume = 255

[State 200, Kmh charge long]
type = PlaySnd
trigger1 = time = 60
value = 2400,1

[State 200, 1];charge power-up sound
type = null;PlaySnd
trigger1 = time = 5
value = 2400,20
channel = 5

[State 200, electricity]
type = PlaySnd
trigger1 = time > 60
trigger1 = (GameTime%40) = 20
value = 2400,2
volume = 10

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = time = [1,200]
time = 1
color=0
mul=0,0,0

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time>=200
time = 1
add	= ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26))
mul	= 256,256,256
invertall = 0
color = 256

[State 0, Explod]
type = Explod
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 192
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = time=5
time = 192
p2defmul = 1
unhittable = 1
anim = -1
sound = s2350,1
darken = 0
movetime = 192

[State 0, Floor Dust]
type =Explod
trigger1 = Time=1&&Pos Y=0
anim = 17100
id = 17100
pos =  -15,0
postype =p1
sprpriority = -3
facing = 1
bindtime = -1
ownpal = 1
removetime = -1
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
scale=.8,.8

[State 0, mouth LOL]
type = Explod
trigger1 = time =0
anim = 24000
id = 24000
pos = 5,-9
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Hyper Charge FX]
type = Explod
trigger1 = time = 5
anim = 2440
id = 2440
pos = -21,-81
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 6
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Charge Ball FX]
type = Explod
;triggerall = anim = 2900 
trigger1 = time = 5
anim = 2420+10000*(var(2)=0)
id = 2420
pos = -21,-81
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 0.6,0.6
persistent = 0

[state 17100, scale charge FX]
type = modifyexplod
trigger1 = numexplod(2420)
scale = 0.6+0.002*(time-20),0.6+0.002*(time-20)
id = 2420

[State 0, Charge lightning FX]
type = Explod
trigger1 = time = 5
anim = 2430
id = 2430
pos = -25,-57
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0,from sky lightning]
type = explod
triggerall=pos y =0
triggerall = time>=45
trigger1 = gametime%(40-var(26)/5) = 0
anim = 2450+random%6
sprpriority = 7
postype = p1
pos = 0,ceil(pos y)
facing = ifelse(random<500,-1,1)
random = 160,0
scale = 1,2
pausemovetime = -1
supermovetime = -1
ownpal = 1

[State 0, lightning sound]
type = playsnd
triggerall =time>=45
trigger1 = gametime%(40-var(26)/5) = 0
value = 2400,3
volume = -170-(32*numexplod)
freqmul = .9 + (random/5000.0)

[State 1211, BGPalFX]
type = BGPalFX
triggerall =time>=45&&Time<300
trigger1 = gametime%(40-var(26)/5) = 0
time = 3
color = 0
invertall = 1

[State 0, remove dust]
type = RemoveExplod
trigger1 = time>0&&Pos Y<0
ID = 17100

[State 800, VarSet]
type = VarAdd
triggerall = anim = 2900&& time>150
trigger1 = !AILevel && ((command = "holdx") || (command = "holdy") || (command = "holdz"))
trigger2 = AILevel
var(26) = 1

[State 800, VarSet]
type = VarAdd
triggerall = anim = 2600&& time>140
trigger1 = !AILevel && ((command = "holdx") || (command = "holdy") || (command = "holdz"))
trigger2 = AILevel
var(26) = 1

;Moving Around
[State 0, VelSet]
type = VelSet
trigger1= time<350
trigger1=command!="holdfwd" || command!="holdback"||command!="holddown" || command!="holdup"
trigger2=Time>=350
x =0
y =0

[State 0, Veladd]
type = VelAdd
trigger1= Time>=192&& time<350
x =(Command = "holdfwd" - Command = "holdback") * 1.5

[State 0, Veladd]
type = VelAdd
trigger1= Time>=192&& time<350
trigger1=pos y >-200
y =(Command = "holddown" - Command = "holdup") * 1.5

[State 0, Veladd]
type = null;VelAdd
trigger1= Time>=192&& time<350
y =(Command = "holddown" - Command = "holdup") * ((Pos Y*.01)*1.5)

[State 0, PosSet];Dont go into the floor
type = PosSet
trigger1 = Pos Y >0
y = 0

;Throw Kmh
[State 901, ChangeState]
type = ChangeState
triggerall = !AILevel
triggerall =time>=200
trigger1 = (command != "holdx") && (command != "holdy") && (command != "holdz")
trigger2 = time >= 340
value = 2401
ctrl = 0
[State 901, ChangeAnim]
type = ChangeState
triggerall = AILevel
;triggerall = enemynear,Statetype!=A && (p2dist y>=-80)
triggerall =time>=200
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = time >= 340
trigger4 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,Movetype=A)
value = 2401
ctrl = 0

;-----------------------------
;Throwing LVL3 Kamehameha
[Statedef 2401]
type = a
physics = N
movetype = A
anim = IfElse(Var(49)>0,2602,2901)
ctrl = 0
velset = 0,0
sprpriority = 5

[State 0, PalFXWiz]
type = PalFX
trigger1 = !(Time&10)&&Var(49)>0
time = 10
add = 70,-50,-50
mul = 256,256,256

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = !Time
ID = 2829
pos = 0,5
postype = p1 
scale = 1.2,1.2

[state -2, remove charge ball FX Chou Kmh]
type = removeexplod
trigger1 = !time
id = 2420

[State 0, remove dust]
type = RemoveExplod
trigger1 = !time
ID = 17100

[State 3000, nhb]
type = nothitby
trigger1 = var(26)=0 && time<6
time = 1
value = SCA

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = floor(var(26)/7.5) + 5

[State 3000, width]
type=width
trigger1 = 1
value = 25,0

[State 200, 1];Voice (Haaa)
type = PlaySnd
	;Voice=English
trigger1 = time = 0
value = 3,320+(Random%6)
channel = 0
volume = 355

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = time=4
value = 2401,1


[state 1215, Smoke FX]
type = explod
trigger1=pos y=0
trigger1 = animelem=3
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 6
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

[State 3000, Kamehameha]
type = helper
trigger1 =  animelem=1
helpertype = normal
stateno = 2402
ID = 2402
name = "ckameha"
postype = p1
pos = 48,-78
ownpal = 1

[State -2, Explod];On hands explod
type = Explod
triggerall = !numexplod(2403)
trigger1 = animelem=1
anim = 2403
removetime = -1
sprpriority = 4
id = 2403
ownpal = 1
RemoveOnGetHit=1
pos = 42,-78
ignorehitpause = 1
pausemovetime = 99999
supermovetime = 99999
bindtime =-1
scale =1.5,1.5

[State -2, Explod];On hands explod
type = ModifyExplod
trigger1 = WinKO && MatchOver
pos = 58,-58
scale = .6,1.5
ID = 2403

[State 3000, Kamehameha FX beam]
type = helper
trigger1 = animelem=1
helpertype = normal
stateno = 2464
ID = 2464
name = "ckamehaFX_scale_beam"
postype = p1
pos = 47,-58
ownpal = 1

[State 200, 1];Dramatic SFX
type = PlaySnd
trigger1 = WinKO && (p2stateno=5941 || p2stateno=5943)
value = 5941,0
volume = 255
persistent = 0

;Stop
[State 901, ChangeAnim]
type = ChangeState
trigger1 = numhelper(2402)
trigger1 = helper(2402),var(2)=20+var(25)
trigger1 = Anim=2901 || anim = 2602
trigger2 = time>120 && !MatchOver
trigger3 = time>120 && MatchOver&&WinKO
value = 2403
ctrl = 0

;-----------------------------
;Stop throwing LVL3 Kamehameha
[Statedef 2403]
type = a
physics = N
movetype = A
ctrl = 0
sprpriority = 1

[State 13300, Fadeout]
type =removeExplod
trigger1 = !Time
ID = 2826

[State 13300, Fadeout]
type =removeExplod
trigger1 = !Time
ID = 2829

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
value = 2410
persistent=0

[State 0, Pause];Pause for the white flash
type = Pause
trigger1 = !Time&&Var(49)=0
time = 10
movetime = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time=1&&Var(49)=0
value = S181,0
channel = 0
ignorehitpause = 1

[State 10000, Explod]; White BG
type =Explod
trigger1 = !time&&Var(49)=0
anim = 957
id = 11111
pos =  0,-30
postype = left
sprpriority = 7
facing = 1
bindtime = -1
ownpal = 1
removetime = 10
supermovetime = -1
pausemovetime = -1
ignorehitpause = 1
scale = 2,2

[State 10000, RemoveExplod white BG]
type = RemoveExplod
trigger1 = time = 10
id = 11111

[State 0, VelAdd]
type = VelAdd
trigger1 = Time=0
y = -6

[State 0, VelAdd]
type = VelAdd
trigger1 = Time>10
y = .5

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Time=0&&Vel Y < 0
value = 41
persistent=0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Anim=41&&Time>=25
value = 44

[state 17100,remove FX]
type = removeexplod
trigger1 = !time
id = 2405

[state 17100,remove overlay FX]
type = removeexplod
trigger1 = !time
id = 2908

[State -2, Explod];On hands explod
type =Explod
triggerall = !numexplod(2413)
trigger1 = !Time
anim = 2403
removetime = -1
sprpriority = 4
id = 2413
ownpal = 1
pos = 42,-72
facing=1
RemoveOnGetHit=1
ignorehitpause = 1
pausemovetime = 0
supermovetime =0
bindtime =1
scale =1.5,1.5

[state 17100,scale FX]
type =modifyexplod
trigger1 = numexplod(2413)
scale = 1, ifelse(1-0.05*time<0, 0, 1-0.05*time)
id = 2413

[state 17100,remove FX]
type = removeexplod
trigger1 =!AnimTime
id = 2413

[state 17100,remove FX]
type = removeexplod
trigger1 =!Time
id = 2403

[State 3000, end];Hop ending for ssj3
type = changestate
trigger1 = pos Y >=0 && Vel Y>0
value = 52
ctrl = 0

;-----------------------------
;Stop throwing Chou Kamehameha Up
[Statedef 2466]
type = S
physics = S
movetype = A
anim = 2466
ctrl = 0
velset = 0,0
sprpriority = 5

[State 3000, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1
;========================
;Lvl2 Kame
[Statedef 3100]
type = S
physics = S
movetype = A
anim = 2400
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -2000

[State 0, for trial]
type = VarSet
trigger1 = !time
var(18) = 1

[State 0, remove Kmh Flash FX]
type = RemoveExplod
trigger1 = !time
ID = 2005
[State 0, remove Kmh Flash FX]
type = RemoveExplod
trigger1 = !time
ID = 2105

[State 3000, width]
type=width
trigger1 = 1
value = 25,0

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(26) = 0

[State 0, AssertSpecial]
type = AssertSpecial
triggerall = anim = 2400
trigger1 = time = [0,200]
;flag = noBG
flag = noFG

[State 3000, nhb]
type = nothitby
trigger1 = anim = 2400 && var(26) = 0
trigger1 = Time <200
time = 1
value = SCA

[State 1000, shake]
type = EnvShake
triggerall = anim=2400
trigger1 = !(time%4)
time=4
freq=80
ampl=2+0.02*time

[State 200, 1];Voice (Kamehame)
type = PlaySnd
 		;Voice=English
trigger1 = time = 0
value = 3,300+(Random%8)
channel = 0
volume = 255

[State 200, Kmh charge long]
type = PlaySnd
triggerall = anim = 2400
trigger1 = time = 60
value = 2400,1

[State 200, 1];charge power-up sound
type = PlaySnd
trigger1 = time = 5
value = 2400,20
channel = 5

[State 200, electricity]
type = PlaySnd
trigger1 = time > 60
trigger1 = (GameTime%40) = 20
value = 2400,2
volume = 10

[State 2500, bgpalfx1]
type = bgpalfx
triggerall = anim = 2400
trigger1 = time = [1,200]
time = 1
color=0
mul=0,0,0

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time>=200
time = 1
add	= ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26))
mul	= 256,256,256
invertall = 0
color = 256

[State 200, Superpause sound]
type = PlaySnd
trigger1 = time=5
value = 2350,0

[State 0, Explod]
type = Explod
triggerall = anim = 2400
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 192
removeongethit = 1

[State 3000, superpause]
type = superpause
triggerall = anim = 2400
trigger1 = time=5
time = 192
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2350,0
darken = 0
movetime = 192

[State 0, mouth LOL]
type = Explod
triggerall = anim = 2400
trigger1 = time = 5
anim = 24000
id = 24000
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Hyper Charge FX]
type = Explod
trigger1 = time = 5
anim = 2441
id = 2441
pos = -25,-57
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 6
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Charge Ball FX]
type = Explod
trigger1 = time = 5
anim = 2420+10000*(var(2)=0)
id = 2420
pos = -25,-60
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 0.6,0.6
persistent = 0

[state 17100, scale charge FX]
type = modifyexplod
trigger1 = numexplod(2420)
scale = 0.6+0.002*(time-20),0.6+0.002*(time-20)
id = 2420

[State 0, Charge lightning FX]
type = Explod
trigger1 = time = 5
anim = 2430
id = 2430
pos = -25,-57
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0,from sky lightning]
type = explod
triggerall = anim = 2400 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
anim = 2450+random%6
sprpriority = 7
postype = p1
pos = 0,ceil(pos y)
facing = ifelse(random<500,-1,1)
random = 160,0
scale = 1,2
pausemovetime = -1
supermovetime = -1
ownpal = 1

[State 0, lightning sound]
type = playsnd
triggerall = anim = 2400 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
value = 2400,3
volume = -170-(32*numexplod)
freqmul = .9 + (random/5000.0)

[State 1211, BGPalFX]
type = BGPalFX
triggerall = anim = 2400 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
time = 3
color = 0
invertall = 1

[State 800, VarSet]
type = VarAdd
triggerall = Anim=2400 && time>250
trigger1 = !AILevel && ((command = "holdx") || (command = "holdy") || (command = "holdz"))
trigger2 = AILevel
var(26) = 1

;Throw Kmh
[State 901, ChangeAnim]
type = ChangeState
triggerall = !AILevel
triggerall = command != "holdup"
triggerall = Anim=2400 && time>=200
trigger1 = (command != "holdx") && (command != "holdy") && (command != "holdz")
trigger2 = time >= 350
value = 3101
ctrl = 0
[State 901, ChangeAnim]
type = ChangeState
triggerall = AILevel && numenemy
triggerall = enemynear,Statetype!=A && (p2dist y>=-80)
triggerall = Anim=2400 && time>=200
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = time >= 350
trigger4 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,Movetype=A)
value = 3101
ctrl = 0

;Throw Kmh Up
[State 901, ChangeAnim]
type = ChangeState
triggerall = !AILevel
triggerall = command = "holdup"
triggerall = Anim=2400 && time>=200
trigger1 = (command != "holdx") && (command != "holdy") && (command != "holdz")
trigger2 = time >= 350
value = 3161
ctrl = 0
[State 901, ChangeAnim]
type = ChangeState
triggerall = AILevel && numenemy
triggerall = enemynear,Statetype=A && (p2dist y<-80)
triggerall = Anim=2400 && time>=200
trigger1 = enemynear,Movetype=A||Inguarddist
trigger2 = enemynear,vel x>1
trigger3 = time >= 350
trigger4 = (enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<100 || enemy,numproj>0 || enemy,Movetype=A)
value = 3161
ctrl = 0

;-----------------------------
;Throwing Chou Kamehameha
[Statedef 3101]
type = S
physics = S
movetype = A
anim = 2401
ctrl = 0
velset = 0,0
sprpriority = 5

[state -2, remove charge ball FX Chou Kmh]
type = removeexplod
trigger1 = !time
id = 2420

[State 3000, nhb]
type = nothitby
trigger1 = var(26)=0 && time<6
time = 1
value = SCA

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = floor(var(26)/7.5)

[State 3000, width]
type=width
trigger1 = 1
value = 25,0

[State 200, 1];Voice (Haaa)
type = PlaySnd
	;Voice=English
trigger1 = time = 0
value = 3,320+(Random%6)
channel = 0
volume = 355

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = time=4
value = 2401,1

[state 1215, Smoke FX]
type = explod
trigger1 = anim=2401 && animelem=3
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 6
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

[state 1215, Flash FX]
type = null ;explod
trigger1 = anim=2401 && time=3
anim = 2406
id = 2405
pos = 0,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 0
bindtime = -1

[State 3000, Kamehameha]
type = helper
trigger1 = anim=2401 && animelem=3
helpertype = normal
stateno = 2402
ID = 2402
name = "ckameha"
postype = p1
pos = 40,-58
ownpal = 1

[State -2, Explod];On hands explod
type = Explod
triggerall = !numexplod(2403)
trigger1 = anim=2401 && animelem=3
anim = 2403
removetime = -1
sprpriority = 4
RemoveOnGetHit=1
id = 2403
ownpal = 1
pos = 58,-58
ignorehitpause = 1
pausemovetime = 99999
supermovetime = 99999
bindtime = -1
;scale = 0.5,1

[State -2, Explod];On hands explod
type = ModifyExplod
trigger1 = anim=2401
trigger1 = WinKO && MatchOver
pos = 58,-58
scale = .6,1.5
ID = 2403

[State 3000, Kamehameha FX beam]
type = helper
trigger1 = anim=2401 && animelem=3
helpertype = normal
stateno = 2464
ID = 2464
name = "ckamehaFX_scale_beam"
postype = p1
pos = 47,-58
ownpal = 1

[State 200, 1];Dramatic SFX
type = PlaySnd
trigger1 = WinKO && (p2stateno=5941 || p2stateno=5943)
value = 5941,0
volume = 255
persistent = 0

;Stop
[State 901, ChangeAnim]
type = ChangeState
trigger1 = numhelper(2402)
trigger1 = helper(2402),var(2)=20+var(25)
trigger1 = Anim=2401
trigger2 = time>91 && !MatchOver
trigger3 = time>120 && WinKO && MatchOver
value = 3103
ctrl = 0

;-----------------------------
;Stop throwing Chou Kamehameha
[Statedef 3103]
type = S
physics = S
movetype = A
anim = 2410
ctrl = 0
velset = 0,0
sprpriority = 1

[state 17100,remove FX]
type = removeexplod
trigger1 = !time
id = 2405
[state 17100,remove overlay FX]
type = removeexplod
trigger1 = !time
id = 2908

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2403)
scale = 1, ifelse(1-0.05*time<0, 0, 1-0.05*time)
id = 2403

[state 17100,remove FX]
type =null; removeexplod
trigger1 = !animtime
id = 2403

[State 3000, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;-----------------------------
;Throwing Chou Kamehameha Up
[Statedef 3161]
type = S
physics = S
movetype = A
anim = 2461
ctrl = 0
velset = 0,0
sprpriority = 5

[state -2, remove charge ball FX Chou Kmh]
type = removeexplod
trigger1 = !time
id = 2420

[State 3000, nhb]
type = nothitby
trigger1 = var(26)=0 && time<6
time = 1
value = SCA

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = floor(var(26)/7.5)

[State 3000, width]
type = width
trigger1 = 1
value = 25,0

[State 200, 1];Voice (Haaa)
type = PlaySnd
	;Voice=English
trigger1 = time = 0
value = 3,320+(Random%6)
channel = 0
volume = 355

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = time=4
value = 2401,1

[state 1215, Smoke FX]
type = explod
trigger1 = anim=2461 && animelem=2
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 6
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

[state 1215, Flash FX]
type = null;explod
trigger1 = anim=2461 && time=3
anim = 2462
id = 2462
pos = 0,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 0
bindtime = -1

[State 3000, Kamehameha]
type = helper
trigger1 = anim=2461 && animelem=2
helpertype = normal
stateno = 2462
ID = 2462
name = "ckameha"
postype = p1
pos = 40,-58
ownpal = 1

[State 3000, Kamehameha FX on hands]
type = helper
trigger1 = anim=2461 && animelem=2
helpertype = normal
stateno = 2463
ID = 2463
name = "ckamehaFX_hands"
postype = p1
pos = 47,-58
ownpal = 1

[State 3000, Kamehameha FX beam]
type = helper
trigger1 = anim=2461 && animelem=2
helpertype = normal
stateno = 2464
ID = 2464
name = "ckamehaFX_scale_beam"
postype = p1
pos = 47,-58
ownpal = 1

[state 1215, Hands overlay]
type = null ;explod
trigger1 = anim=2461 && animelem=2
anim = 2467
id = 2467
pos = 0,0
postype = P1
sprpriority = 4
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
bindtime = -1

[State 200, 1];Dramatic SFX
type = PlaySnd
trigger1 = WinKO && p2stateno=5944
value = 5941,0
volume = 255
persistent = 0

;Stop
[State 901, ChangeAnim]
type = ChangeState
trigger1 = numhelper(2462)
trigger1 = helper(2462),var(2)=20+var(25)
trigger1 = Anim=2461
trigger2 = time>91 && !MatchOver
trigger3 = time>120 && WinKO && MatchOver
value = 3166
ctrl = 0

;-----------------------------
;Stop throwing Chou Kamehameha Up
[Statedef 3166]
type = S
physics = S
movetype = A
anim = 2466
ctrl = 0
velset = 0,0
sprpriority = 5

[State 3000, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;-------------------------------------
[Statedef 2467];P2 knocked down by Chou Kamehameha Up.
type = A
movetype = H
physics = N
anim = ifelse(selfanimexist(5052),5052,5030)
ctrl = 0
velset = -6, -8
 
[State 9011, VelAdd]
type = VelAdd
trigger1 = (Pos Y < 0)
y = 0.35
 
[State 9011, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
 
[State 9011, ChangeState]
type = SelfState
trigger1 = (Pos Y >= 0) && (Vel Y > 0)
value = 5100

;-------------------------------------
;Beam counter - Big Portraits
[Statedef 2480]
type = S
physics = S
movetype = A
anim = 2400
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -2000

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[state 1215, big portrait P1]
type = explod
trigger1 = !time && facing=1
anim = 2480
id = 2480
pos = 0,0
postype = Left
sprpriority = -5
;ontop = 1
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
scale = 0.71875,0.71875
vel = -.7,0
supermovetime = 99999
pausemovetime = 99999

[state 1215, big portrait P1 flash]
type = explod
trigger1 = !time && facing=1
anim = 2481
id = 2480
pos = 0,0
postype = Left
sprpriority = -4
;ontop = 1
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
scale = 0.71875,0.71875
vel = -.7,0
supermovetime = 99999
pausemovetime = 99999

[state 1215, big portrait mouth P1]
type = explod
trigger1 = !time && facing=1
anim = 2482
id = 2480
pos = 0,0
postype = Left
sprpriority = -3
;ontop = 1
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
scale = 0.71875,0.71875
vel = -.7,0
supermovetime = 99999
pausemovetime = 99999

[state 1215, big portrait P2]
type = explod
trigger1 = !time && facing=-1
anim = 2480
id = 2480
pos = 320,0
postype = Left
sprpriority = -5
;ontop = 1
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
facing = -1
scale = 0.71875,0.71875
vel = .7,0
supermovetime = 99999
pausemovetime = 99999

[state 1215, big portrait P2 flash]
type = explod
trigger1 = !time && facing=-1
anim = 2481
id = 2480
pos = 320,0
postype = Left
sprpriority = -4
;ontop = 1
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
facing = -1
scale = 0.71875,0.71875
vel = .7,0
supermovetime = 99999
pausemovetime = 99999

[state 1215, big portrait mouth P2]
type = explod
trigger1 = !time && facing=-1
anim = 2482
id = 2480
pos = 320,0
postype = Left
sprpriority = -3
;ontop = 1
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
facing = -1
scale = 0.71875,0.71875
vel = .7,0
supermovetime = 99999
pausemovetime = 99999

[State 3000, width]
type=width
trigger1 = 1
value = 25,0

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(26) = 0

[State 3000, nhb]
type = nothitby
trigger1 = anim = 2400 && var(26) = 0
time = 1
value = SCA

[State 200, 1];Voice (Kamehame)
type = PlaySnd
 		;Voice=English
triggerall = anim = 2400
trigger1 = time = 0
value = 2400,100
channel = 0
volume = 255

[State 200, Kmh charge long]
type = PlaySnd
triggerall = anim = 2400
trigger1 = time = 60
value = 2400,1

[State 200, electricity]
type = PlaySnd
trigger1 = time > 60
trigger1 = (GameTime%40) = 20
value = 2400,2
volume = 10

[State 2500, bgpalfx1]
type = bgpalfx
triggerall = anim = 2400
trigger1 = time = [1,200]
time = 1
color=0
mul=0,0,0

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time>=200
time = 1
add	= ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26))
mul	= 256,256,256
invertall = 0
color = 256

[State 200, Superpause sound]
type = PlaySnd
trigger1 = time=5
value = 2350,0

[State 0, mouth LOL]
type = Explod
triggerall = anim = 2400
trigger1 = time = 5
anim = 24000
id = 24000
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Hyper Charge FX]
type = Explod
triggerall = anim = 2400
trigger1 = time = 5
anim = 2440
id = 2440
pos = -22,-55
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 6
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Charge Ball FX]
type = Explod
triggerall = anim = 2400
trigger1 = time = 5
anim = 2420+10000*(var(2)=0)
id = 2420
pos = -22,-55
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 0.6,0.6
persistent = 0

[state 17100, scale charge FX]
type = modifyexplod
trigger1 = numexplod(2420)
scale = 0.6+0.002*(time-20),0.6+0.002*(time-20)
id = 2420

[State 0, Charge lightning FX]
type = Explod
triggerall = anim = 2400
trigger1 = time = 5
anim = 2430
id = 2430
pos = -22,-55
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0,from sky lightning]
type = explod
triggerall = anim = 2400 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
anim = 2450+random%6
sprpriority = 7
postype = p1
pos = 0,ceil(pos y)
facing = ifelse(random<500,-1,1)
random = 160,0
scale = 1,2
pausemovetime = -1
supermovetime = -1
ownpal = 1

[State 0, lightning sound]
type = playsnd
triggerall = anim = 2400 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
value = 2400,3
;channel=1
volume = -170-(32*numexplod)
freqmul = .9 + (random/5000.0)

[State 1211, BGPalFX]
type = BGPalFX
triggerall = anim = 2400 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
time = 3
color = 0
invertall = 1

[State 1000, Fade to Black]
type = Helper
trigger1 = time=100
helpertype = Normal
name = "fade"
id = 2771
pos = 0,0
postype = p1
facing = 1
stateno = 2771
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

;Throw Kmh
[State 901, ChangeAnim]
type = ChangeState
trigger1 = enemy,name = "Goku Z2" || enemy,name = "Yellow Suika" || enemy,name = "Combo Stickman" || enemy,name="Vegeta Z2" || enemy,name = "SSJ Goku Z2" || enemy,name = "Gohan Z2"
trigger1 = Anim=2400 && time>=200
value = 2481
ctrl = 0

;-----------------------------
;Throwing Chou Kamehameha as Beam Counter
[Statedef 2481]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1

;Proportionality variable
[State 800, count]
type = VarSet
trigger1 = !time
fvar(20) = 0.5

[State -2, notification]
type = helper
trigger1 = !time && numhelper(13250)=0 && teamside = 1
helpertype=normal
stateno=13250
ID=13250
name="notif-col"
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = timerfreeze
ignorehitpause = 1

[state 0, 1 tick fix]
type = ChangeAnim
trigger1 = enemy,stateno = 2481 && anim!=2401
value = 2401

[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2480
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2420
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2430
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2440
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 24000

[State 13100, shake]
type = envshake
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 3

[State 0, Scale]
type = AngleDraw
trigger1 = 1
scale = .5,.5
[State 0, Position]
type = PosSet
trigger1 = 1
X = ifelse(facing=1, -130, 130)
Y = -20

[State -2];Counter variable from state -2
type = VarSet
trigger1 = !time
var(31) = 0

[State 200, 1];Voice (Haaa)
type = PlaySnd
 		;Voice=English
trigger1 = time = 0
value = 2401,100
channel = 0
volume = 355

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = time=4
value = 2401,1
[State 200, 1];Beam clash
type = PlaySnd
trigger1 = time=4
value = 2480,0
loop = 1
channel = 5

[State 200, 1];Beam colision voice gnaaa
type = PlaySnd
 		;Voice=English
trigger1 = time>40 && fvar(20)<=0.2
value = 2480,2
channel = 5
persistent = 0

[state 1215, Smoke FX]
type = explod
trigger1 = anim=2401 && animelem=2
anim = 1206+(var(2)=0)
id = 1206
pos = -12,2
postype = P1
sprpriority = 3
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
scale = .5,.5

[State -2, Explod];On hands explod
type = Explod
triggerall = !numexplod(2403)
trigger1 = anim=2401 && animelem=2
anim = 2403
removetime = -1
supermove = 1
sprpriority = 3
id = 2481
ownpal = 1
pos = 23,-27
ignorehitpause = 1
pausemovetime = -1
bindtime = -1
scale = 0.25,.5

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2481)
scale = 0.25+0.1*(fvar(20)-0.5) ,0.5+0.3*(fvar(20)-0.5)
id = 2481
ignorehitpause = 1

[State -2, Explod];Scaling part
type = Explod
triggerall = !numexplod(2464)
trigger1 = anim=2401 && animelem=2
anim = 2464
removetime = -1
supermove = 1
sprpriority = 2
id = 2464
pos = 36,-27
scale = .5,.5
bindtime = -1
ownpal = 1
ignorehitpause = 1
pausemovetime = -1

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2464)
scale = fvar(20)*2. ,0.5+0.3*(fvar(20)-0.5)
id = 2464
ignorehitpause = 1

[State 3000, Center Ball]
type = helper
triggerall = !numhelper(2483)
trigger1 = anim=2401 && animelem=2 ;&& facing=1
helpertype = normal
stateno = 2483
ID = 2483
name = "centerball"
postype = left
pos = 0,0
ownpal = 1

[state 3250, speedlines1 WIN]
type = explod
trigger1 = numexplod(2923)<6 && teamside = 1
trigger1 = fvar(20)>0.5
anim = 2923
ID = 2923
postype = back
pos = 0,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines2 WIN]
type = explod
trigger1 = numexplod(2923)<6 && teamside = 1
trigger1 = fvar(20)>0.5
anim = 2923
ID = 2923
postype = back
pos = 149,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines3 WIN]
type = explod
trigger1 = numexplod(2923)<6 && teamside = 1
trigger1 = fvar(20)>0.5
anim = 2923
ID = 2923
postype = back
pos = 298,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines4 WIN]
type = explod
trigger1 = numexplod(2923)<6 && teamside = 1
trigger1 = fvar(20)>0.5
anim = 2923
ID = 2923
postype = back
pos = 0,120
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines5 WIN]
type = explod
trigger1 = numexplod(2923)<6 && teamside = 1
trigger1 = fvar(20)>0.5
anim = 2923
ID = 2923
postype = back
pos = 149,120
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines6 WIN]
type = explod
trigger1 = numexplod(2923)<6 && teamside = 1
trigger1 = fvar(20)>0.5
anim = 2923
ID = 2923
postype = back
pos = 298,120
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[State 800, trans speedlines WIN]
type = ModifyExplod
trigger1 = fvar(20) > 0.5
trans = addalpha
alpha = ceil(512*(fvar(20)-0.5)), ceil(256-512*(fvar(20)-0.5))
ID = 2923
[State 800, remove speedlines WIN]
type = RemoveExplod
trigger1 = fvar(20) <= 0.5
ID = 2923

[state 3250, speedlines1 LOSE]
type = explod
trigger1 = numexplod(2922)<6 && teamside = 1
trigger1 = fvar(20)<0.5
anim = 2922
ID = 2922
postype = back
pos = 0,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines2 LOSE]
type = explod
trigger1 = numexplod(2922)<6 && teamside = 1
trigger1 = fvar(20)<0.5
anim = 2922
ID = 2922
postype = back
pos = 149,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines3 LOSE]
type = explod
trigger1 = numexplod(2922)<6 && teamside = 1
trigger1 = fvar(20)<0.5
anim = 2922
ID = 2922
postype = back
pos = 298,0
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines4 LOSE]
type = explod
trigger1 = numexplod(2922)<6 && teamside = 1
trigger1 = fvar(20)<0.5
anim = 2922
ID = 2922
postype = back
pos = 0,120
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines5 LOSE]
type = explod
trigger1 = numexplod(2922)<6 && teamside = 1
trigger1 = fvar(20)<0.5
anim = 2922
ID = 2922
postype = back
pos = 149,120
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[state 3250, speedlines6 LOSE]
type = explod
trigger1 = numexplod(2922)<6 && teamside = 1
trigger1 = fvar(20)<0.5
anim = 2922
ID = 2922
postype = back
pos = 298,120
bindtime = -1
supermove = 0
sprpriority = -1
ontop = 0
ownpal = 1
facing = 1
ignorehitpause = 1
removetime = -1
scale = 0.5,0.5
[State 800, trans speedlines LOSE]
type = ModifyExplod
trigger1 = fvar(20) < 0.5
trans = addalpha
alpha = ceil(-512*(fvar(20)-0.5)), ceil(256+512*(fvar(20)-0.5))
ID = 2922
[State 800, remove speedlines LOSE]
type = RemoveExplod
trigger1 = fvar(20) >= 0.5
ID = 2922

[State 800, count];Smashing counter set
type = VarSet
trigger1 = !time
var(30) = 0
[State 800, count];Smashing counter
type = VarAdd
trigger1 =  NumExplod(90000200) ||  NumExplod(90000210) ||  NumExplod(90000220) || NumExplod(90000230) ||  NumExplod(90000240) ||  NumExplod(90000250)
trigger2 = NumExplod(90000008) ||  NumExplod(90000002) ||  NumExplod(90000004) ||  NumExplod(90000006)
var(30) = 1

[State 800, count];Dump power
type = VarAdd
triggerall = power>0
trigger1 = NumExplod(90000195) || command="holdstart"
trigger1 = time%5 = 0
var(30) = 1
[State 800, count];Dump power
type = PowerAdd
triggerall = power>0
trigger1 = NumExplod(90000195) || command="holdstart"
trigger1 = time%5 = 0
value = -20
[State 800, count];Dump power
type = PalFX
triggerall = power>0
trigger1 = NumExplod(90000195) || command="holdstart"
trigger1 = time%5 = 0
time = 5
add = 150,0,0
mul = 200,200,200
;sin = 50,50,50

;Proportionality variable for scaling : =1 when beating the opponent by 20, =0 when beaten by 20.
[State 800, count]
type = VarSet
trigger1 = 1
fvar(20) = 0.5+(var(30)-enemy,var(30))/40.0

[State 800, WIN]
type = ChangeState
triggerall = time>10
trigger1 = fvar(20)>=.9
value = 2485

[State 800, no winner, both take damage]
type = ChangeState
trigger1 = time>=300
value = 2489

;-----------------------------
;WIN Chou Kamehameha Beam Counter
[Statedef 2485]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
anim = 2485

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 800, hit]
type = hitdef
trigger1 = !movehit
attr = S,HA
hitflag = MAF
priority = 7,Hit
damage = 0,0
sparkno = -1

[State 3025, p2state - killed]
type = targetstate
trigger1 = movehit && numtarget
value = ifelse(target,life > 350,2486,2487)
ignorehitpause = 1

[state 0, remove explod];center ball
type = RemoveExplod
trigger1 = !time
ID = 2483

[State 200, 1];Beam clash stop
type = StopSnd
trigger1 = !time
channel = 5

[State 13100, shake]
type = envshake
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 3

[State 0, Scale]
type = AngleDraw
trigger1 = 1
scale = .5,.5
[State 0, Position]
type = PosSet
trigger1 = 1
X = ifelse(facing=1, -130, 130)
Y = -20

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2481)
scale = 0.25+0.1*(fvar(20)-0.5) ,0.5+0.3*(fvar(20)-0.5)
id = 2481
ignorehitpause = 1

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2464)
scale = fvar(20)*2. ,0.5+0.3*(fvar(20)-0.5)
id = 2464
ignorehitpause = 1

;Proportionality variable for scaling
[State 800, count]
type = VarSet
trigger1 = 1
fvar(20) = 2.0

[State 1315, Sparks]
type=explod
trigger1= time<60 && !(time%3)
anim=7030
sprpriority=6
postype=p2
pos=(random%20), -floor(p2dist y)+(random%20)-30
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
pausemovetime=100
supermovetime=100
scale = .5,.5

[State 3000, hitsound]
type = PlaySnd
trigger1= time<60 && !(time%3)
value = 1000,0
volume = -100

[State 3000, hitadd]
type = HitAdd
trigger1= time<60 && !(time%3)
value = 20

[State 800, WIN]
type = ChangeState
trigger1 = time=120
value = 2488
ctrl = 0

;-----------------------------
;LOSE Chou Kamehameha Beam Counter (normal)
[Statedef 2486]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 5
anim = 5017

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[state 0, remove explod];center ball
type = RemoveExplod
trigger1 = !time
ID = 2483
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 1206
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2403
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2464
[state 0, remove explod];on hands
type = RemoveExplod
trigger1 = !time
ID = 2481
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2922
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2923

[State 200, 1];Beam clash stop
type = StopSnd
trigger1 = !time
channel = 5

[State 13100, shake]
type = envshake
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 3

[State 0, Scale]
type = AngleDraw
trigger1 = 1
scale = .5,.5
[State 0, Position]
type = PosSet
trigger1 = 1
X = ifelse(facing=1, -230, 230)
Y = -20

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 20
anim = 2763
id = 19875
pos =  160,120
postype = left
sprpriority = 7
bindtime = -1
ownpal = 1
removetime = -2
pausemovetime = 999999
supermovetime = 999999
supermove = 1
scale = 1.50,1.50
ignorehitpause = 1
persistent = 0

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
X = ifelse(time%4=0,-2,ifelse(time%4=2,2,0))
ignorehitpause = 1

[State 6100, voice killed snd]
type = playsnd
 		;Voice=English
trigger1 = time=20
value = 11,10
volume = 255

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 13100, Hurt]
type = LifeAdd
trigger1 = !time
value = ceil(ifElse(fvar(11) * -350 > -175, -175, fvar(11) * -350))

[State 800, hitground]
type = SelfState
trigger1 = time=120
value = 5110
;ctrl = 0

;-----------------------------
;LOSE Chou Kamehameha Beam Counter (Fatality)
[Statedef 2487]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
anim = 15999

[State 10500, snd]
type = playsnd
trigger1 = time=60
value = 9,0

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[state 0, remove explod];center ball
type = RemoveExplod
trigger1 = !time
ID = 2483
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 1206
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2403
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2464
[state 0, remove explod];on hands
type = RemoveExplod
trigger1 = !time
ID = 2481
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2922
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2923

[State 200, 1];Beam clash stop
type = StopSnd
trigger1 = !time
channel = 5

[State 13100, shake]
type = envshake
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 3

[State 0, Scale]
type = AngleDraw
trigger1 = 1
scale = .5,.5
[State 0, Position]
type = PosSet
trigger1 = 1
X = ifelse(facing=1, -130, 130)
Y = -20

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 20
anim = 2763
id = 19875
pos =  160,120
postype = left
sprpriority = 7
bindtime = -1
ownpal = 1
removetime = -2
pausemovetime = 999999
supermovetime = 999999
supermove = 1
scale = 1.50,1.50
ignorehitpause = 1
persistent = 0

[State 10000, Explod]; White BG front holes
type = Explod
triggerall = !SelfAnimExist(5941)
trigger1 = time=30
anim = 5944
id = 5944
postype = p1
pos =  0, -20
sprpriority = 10
bindtime = -1
ownpal = 1
removetime = -2
pausemovetime = 999999
supermovetime = 999999
supermove = 1
ignorehitpause = 1
persistent = 0
facing = -1
ontop = 1
scale = .5,.5

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
X = ifelse(time%4=0,-2,ifelse(time%4=2,2,0))
ignorehitpause = 1

[State 1315, Goku]
type = explod
triggerall = !SelfAnimExist(5941)
trigger1 = !time
anim = 5943
ID = 5943
sprpriority=7
postype = p1
pos = 0,-7
removetime=-2
ownpal=0
ignorehitpause=1
bindtime = -1
ontop = 1
scale = 0.5,0.5
[State 1315, Goku]
type = explod
triggerall = SelfAnimExist(5941)
trigger1 = !time
anim = 5941
ID = 5941
sprpriority=7
postype = p1
pos = 0,-7
removetime=-2
ownpal=0
ignorehitpause=1
bindtime = -1
ontop = 1
scale = 0.5,0.5
[State 1315, Goku]
type = explod
triggerall = SelfAnimExist(5942)
trigger1 = !time
anim = 5942
ID = 5942
sprpriority=7
postype = p1
pos = 0,-7
removetime=-2
ownpal=0
ignorehitpause=1
bindtime = -1
ontop = 1
scale = 0.5,0.5

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [0,30]
time = 1
add = -8*(Time),-8*(Time),-8*(Time)

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 30
time = 1
add = -256,-256,-256

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

;This prevent freeze game
[State 49999, 5]
type = ChangeState
trigger1 = time = 120
value = 5942

;-----------------------------
;WIN Beam collision, remove explods, posset
[Statedef 2488]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
anim = 0

[state 0, put on ground]
type = PosSet
trigger1 = !time
Y = 0

[state 0, remove explod];center ball
type = RemoveExplod
trigger1 = !time
ID = 2483
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 1206
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2403
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2464
[state 0, remove explod];on hands
type = RemoveExplod
trigger1 = !time
ID = 2481
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2922
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2923

[State 800, WIN]
type = ChangeState
trigger1 = time=1
value = 0
ctrl = 1

;-----------------------------
;NO WINNER Chou Kamehameha Beam Counter
[Statedef 2489]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
anim = 2485

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 200, 1];Beam clash stop
type = StopSnd
trigger1 = !time
channel = 5

[State 13100, shake]
type = envshake
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 3

[State 0, Scale]
type = AngleDraw
trigger1 = time>0
scale = .5,.5
[State 0, Position]
type = PosSet
trigger1 = 1
X = ifelse(facing=1, -130, 130)
Y = -20

[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2481)
scale = 0.25+0.1*(fvar(20)-0.5) ,0.5+0.3*(fvar(20)-0.5)
id = 2481
ignorehitpause = 1
[state 17100,scale FX]
type = modifyexplod
trigger1 = numexplod(2464)
scale = fvar(20)*2. ,0.5+0.3*(fvar(20)-0.5)
id = 2464
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 10
anim = 2489   ;2763
id = 19875
pos =  160,120
postype = left
sprpriority = 7
bindtime = -1
ownpal = 1
removetime = -2
pausemovetime = 999999
supermovetime = 999999
supermove = 1
scale = 1.50,1.50
ignorehitpause = 1
persistent = 0

[State 6100, voice killed snd]
type = playsnd
 		;Voice=English
trigger1 = time=40
value = 11,10
volume = 255

[State 800, WIN]
type = ChangeState
trigger1 = time=130
value = 2490
ctrl = 0

;-----------------------------
;HitState NO WINNER Chou Kamehameha Beam Counter
[Statedef 2490]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
anim = 5017

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[state 0, remove explod];center ball
type = RemoveExplod
trigger1 = !time
ID = 2483
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 1206
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2403
[state 0, remove explod]
type = RemoveExplod
trigger1 = !time
ID = 2464
[state 0, remove explod];on hands
type = RemoveExplod
trigger1 = !time
ID = 2481
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2922
[state 0, remove explod];speed lines
type = RemoveExplod
trigger1 = !time
ID = 2923

[State 13100, shake]
type = envshake
trigger1 = !time
time = 12
freq = 130
ampl = 3

[State 0, Scale]
type = AngleDraw
trigger1 = 1
scale = .5,.5
[State 0, Position]
type = PosSet
trigger1 = 1
X = ifelse(facing=1, -130, 130)
Y = -20

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 13100, Hurt];remove life depending on smashing variable
type = LifeAdd
trigger1 = !time
;value = floor(-350*(enemy,var(30))/(var(30)+(enemy,var(30))+.001))
value = floor(-350.0*(1.0-fvar(20)))

[State 800, hitground]
type = SelfState
trigger1 = time=10
value = 5110


;===========================================================================
; <<<<< AIR CHOU KAMEHAMEHA >>>>>
; State = 2600
; Throw state = 2601
;===========================================================================

;Air lvl2 Kame
[Statedef 2600]
type = A
physics = N
movetype = A
anim = 2600
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = -2000

[State 2600, No Push Dummy]
type		= Helper
triggerall	= !NumHelper(2650)
trigger1		= !time
name		= "Air Chou Kame - No Push"
id		= 2650
stateno		= 2650
size.ground.back	= Const(size.ground.back) +20
size.ground.front	= Const(size.ground.front) +20
size.height	= Const(size.height) +60
pausemovetime	= 99999
supermovetime	= 99999

[State 2600, No Push]
type		= PlayerPush
trigger1		= 1
value		= 0
ignorehitpause	= 1

[State 0, from Blast Fist]
type = PosAdd
trigger1 = !time && (prevstateno=[1201,1251])
X = 15
Y = -40

[State 0, for trial]
type = VarSet
trigger1 = !time
var(18) = 1

[State 3000, width]
type = width
trigger1 = 1
value = 20,0

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(26) = 0

[State 0, AssertSpecial]
type = AssertSpecial
triggerall = anim = 2600
trigger1 = time = [0,200]
flag = noFG

[State 3000, nhb]
type = nothitby
trigger1 = anim = 2400 && var(26) = 0
trigger1 = Time <200
time = 1
value = SCA

[State 1000, shake]
type = EnvShake
triggerall = anim=2600
trigger1 = !(time%4)
time=4
freq=80
ampl=2+0.02*time

[State 200, 1];Voice (Kamehame)
type = PlaySnd
 		;Voice=English
trigger1 = time = 0
value = 3,300+(Random%8)
channel = 0
volume = 255

[State 200, Kmh charge long]
type = PlaySnd
triggerall = anim = 2600
trigger1 = time = 60
value = 2400,1

[State 200, 1];charge power-up sound
type = PlaySnd
trigger1 = time = 5
value = 2400,20
channel = 5

[State 200, electricity]
type = PlaySnd
trigger1 = time > 60
trigger1 = (GameTime%40) = 20
value = 2400,2
volume = 10

[State 2500, bgpalfx1]
type = bgpalfx
triggerall = anim = 2600
trigger1 = time = [1,200]
time = 1
color=0
mul=0,0,0

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time>=200
time = 1
add	= ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26)),ceil(-256+1.7*Var(26))
mul	= 256,256,256
invertall = 0
color = 256

[State 200, Superpause sound]
type = PlaySnd
trigger1 = time=5
value = 2350,0

[State 0, Explod]
type = Explod
triggerall = anim = 2600
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 192
removeongethit = 1

[State 3000, superpause]
type = superpause
triggerall = anim = 2600
trigger1 = time=5
time = 192
p2defmul = 1
unhittable = 1
anim = -1
;sound = s2350,0
darken = 0
movetime = 192

[State 0, mouth LOL]
type = Explod
triggerall = anim = 2600
trigger1 = time = 5
anim = 24000
id = 24000
pos = 6,-9
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 2
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Hyper Charge FX]
type = Explod
triggerall = anim = 2600
trigger1 = time = 5
anim = 2441
id = 2441
pos = -21,-80
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 6
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0, Charge Ball FX]
type = Explod
triggerall = anim = 2600
trigger1 = time = 5
anim = 2420+10000*(var(2)=0)
id = 2420
pos = -21,-81
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 0.6,0.6
persistent = 0

[state 17100, scale charge FX]
type = modifyexplod
trigger1 = numexplod(2420)
scale = 0.6+0.002*(time-20),0.6+0.002*(time-20)
id = 2420

[State 0, Charge lightning FX]
type = Explod
triggerall = anim = 2600
trigger1 = time = 5
anim = 2430
id = 2430
pos = -17,-78  ;-25,-57
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0,from sky lightning]
type = explod
triggerall = anim = 2600 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
anim = 2450+random%6
sprpriority = 7
postype = p1
pos = 0,-ceil(pos y)
facing = ifelse(random<500,-1,1)
random = 160,0
scale = 1,2
pausemovetime = -1
supermovetime = -1
ownpal = 1

[State 0, lightning sound]
type = playsnd
triggerall = anim = 2600 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
value = 2400,3
volume = -170-(32*numexplod)
freqmul = .9 + (random/5000.0)

[State 1211, BGPalFX]
type = BGPalFX
triggerall = anim = 2600 && time>=45
trigger1 = gametime%(40-var(26)/5) = 0
time = 3
color = 0
invertall = 1

[State 800, VarSet]
type = VarAdd
triggerall = Anim=2600 && time>200
trigger1 = !AILevel && ((command = "holdx") || (command = "holdy") || (command = "holdz"))
trigger2 = AILevel
var(26) = 1

;Throw Kmh
[State 901, ChangeAnim]
type = ChangeState
triggerall = Anim=2600 && time>=200
trigger1 = !AILevel && ((command != "holdx") && (command != "holdy") && (command != "holdz"))
trigger2 = time >= 350
trigger3 = AILevel && (inguarddist || enemy,hitdefattr= SAC,AA,AT,AP   || p2dist x<90  || enemynear,vel x>=1 || enemy,numproj>0 || enemy,Movetype=A)
value = 2601
ctrl = 0

;-----------------------------
;Throwing Air Chou Kamehameha
[Statedef 2601]
type = A
physics = N
movetype = A
anim = 2601
ctrl = 0
velset = 0,0
sprpriority = 1

[State 2601, No Push]
type		= PlayerPush
trigger1		= 1
value		= 0
ignorehitpause	= 1

[state -2, remove charge ball FX Chou Kmh]
type = removeexplod
trigger1 = !time
id = 2420

[State 3000, nhb]
type = null;nothitby
trigger1 = var(26)=0 && time<6
time = 1
value = SCA

[State 800, VarSet];Charging time
type = VarSet
trigger1 = !time
var(25) = floor(var(26)/7.5)

[State 3000, width]
type = width
trigger1 = 1
value = 25,0

[State 200, 1];Voice (Haaa)
type = PlaySnd
	;Voice=English
trigger1 = time = 0
value = 3,320+(Random%6)
channel = 0
volume = 355

[State 200, 1];Launching SFX
type = PlaySnd
trigger1 = time=4
value = 2401,1

[state 1215, Flash FX]
type = null;explod
trigger1 = !time
anim = 2611
id = 2611
pos = 0,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1

[State 3000, Kamehameha]
type = helper
trigger1 = animelem=1
helpertype = normal
stateno = 2602
ID = 2602
name = "ckameha"
postype = p1
pos = 40,-54
ownpal = 1

[State 3000, Kamehameha FX on hands]
type = helper
trigger1 = animelem=1
helpertype = normal
stateno = 2603
ID = 2603
name = "ckamehaFX_hands"
postype = p1
pos = 47,-54
ownpal = 1

[State 3000, Kamehameha FX beam]
type = helper
trigger1 = animelem=1
helpertype = normal
stateno = 2604
ID = 2604
name = "ckamehaFX_scale_beam"
postype = p1
pos = 47,-54
ownpal = 1

[State 200, 1];Dramatic SFX
type = PlaySnd
trigger1 = WinKO && p2stateno=5946
value = 5941,0
persistent = 0

;Stop
[State 901, ChangeState]
type = ChangeState
trigger1 = numhelper(2602)
trigger1 = helper(2602),var(2)=20+var(25)
trigger1 = Anim=2601
trigger2 = time>91 && !MatchOver
trigger3 = time>120 && WinKO && MatchOver
value = 2610
ctrl = 0

;-----------------------------
;Stop throwing Air Chou Kamehameha
[Statedef 2610]
type = A
physics = A
movetype = I
anim = 2610
ctrl = 0
velset = 0,0
sprpriority = 1

[State 2610, No Push]
type		= PlayerPush
trigger1		= 1
value		= 0
ignorehitpause	= 1

[state 17100,remove FX]
type = removeexplod
trigger1 = !time
id = 2611

[State 2200, vel]
type = velset
trigger1 = !time
x = -1.5
y = -5

[State 4001, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 0


;===========================================================================
; <<<<< HYPER RUSH >>>>>
; State = 2700
; Aura Helper = 2701 ?
; Afterimage helper = 2702
; Speed Dash state = 2703
;===========================================================================

;Hyper Rush
[Statedef 2700]
type = S
physics = S
movetype = A
anim = 2300
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = ifelse(var(49)=0,-3000,-2000)

[State 0]
Type=VarSet
Trigger1=!Time
V = 3
Value = 0
IgnoreHitPause=1

[State 0]
Type=PlaySND;This is my chance!
Trigger1=!Time&&Random<800
Value=3,296
Channel=0
VolumeScale=200

;Palette Code
[State 5900, Apply Pal]
type = RemapPal
trigger1 = var(58)
source = 1,1
dest = Cond(Var(49)>0,2,1),var(58)

[State 3000, remove justice bar when Hyper Rush fails]
type = varset
trigger1 = !time
var(16) = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
Flag3=NoJuggleCheck

[State 0, Explod]
type = Explod
trigger1 = time=5
anim = 15999
ID = 9993999
removetime = 40
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = time=5
time = 40
p2defmul = 1.2
unhittable = 1
anim = -1
sound = s2350,1
darken = 0
movetime = 40

[State 0, Hyper Charge FX]
type = Explod
trigger1 = time = 5
anim = 2440
id = 2440
pos = 8,-40
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 5
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,1
volume = 255
[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,0
loop = 1
pan = 1
volume = 25
channel = 3

[State 1900, Aura helper]
type = Helper
trigger1 = animelemtime(2)=0
id = 905
name = "Charge"
pos = 0,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
supermovetime = 9999
pausemovetime = 9999

[State 1900, dust]
type = explod
trigger1 = animelemtime(2)=0
anim = 908+(var(2)=0)
id = 908
pos = 17,5
sprpriority = 4
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = -1
removetime = -1
supermovetime = 9999
pausemovetime = 9999

[State 1000, flash]
type = PalFX
trigger1 = !(time%10)
add = 10, 20, -20
sinadd = -10,20,60,10
mul = 256,256,256
time = 10

[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 8,0
loop = 1
pan = 1
volume = 25
channel = 3

[State 1000, shake]
type = EnvShake
triggerall = animelemtime(2)>=0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.04*time

[State 2500, bgpalfx1]
type = bgpalfx
trigger1 = !time
time = 48
color = 0
mul = 0,0,0

[State 4001, End]
type = ChangeState
trigger1 = time=48
value = 2703
ctrl = 0

;-------------------------------
; Hyper Rush Dash
[Statedef 2703]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 2703

;controlled number of hits
[State 1055, movehitvar]
type=varadd
trigger1= moveguarded=1
var(3)=1

;Palette Code
[State 5900, Apply Pal]
type = RemapPal
trigger1 = var(58)
source = 1,1
dest = Cond(Var(49)>0,2,1),var(58)

[State 4500, 1];speed SFX
type = PlaySnd
trigger1 = animelemtime(3)=0
value = 2700,1

[State 1000, flash]
type = null ;PalFX
trigger1 = 1
add = 10, 20, -20
sinadd = -10,20,60,10
mul = 256,256,256
time = 1

[State 1900, horizontal dash FX]
type = explod
trigger1 = animelemtime(3)=0
anim = 2704
id = 2704
pos = 40,-45
sprpriority = -1
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = 1
removetime = -1
supermovetime = 99999
pausemovetime = 99999
scale = 1.2,1.2

[State 3005, 2]
type = VelSet
trigger1 = animelemtime(3)=0
x = 20

[State 3005, 3]
type = VelMul
trigger1 = Time > 5
x = .97

[State 3000, width]
type=width
trigger1 = 1
value=35,0

[State 100, A must for dashes everywhere]
type = Assertspecial
trigger1 = 1
flag = nowalk
[State 100, No Turn]
type = AssertSpecial
trigger1 = 1
flag = NoAutoTurn

[state 1215, Smoke FX]
type = explod
trigger1 = animelemtime(3)=0
anim = 1206+(var(2)=0)
id = 1206
pos = -25,3
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

[State 13000, HelpTrain]
type = Helper
trigger1 = Time = 1
name = "Trainee"
ID = 2702
stateno = 2702
pausemovetime = 50

[State 3005, hit]
type = hitdef
trigger1 = !MoveReversed
attr = S, HA
damage = 0,20
guard.pausetime =12,6
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = MA
numhits = 0
sparkno = -1
getpower = 0,0
guard.sparkno = s7000
sparkxy = -35,-50
hitsound = -1
guardsound = s6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
id = 2703

[State 902, TargetState]
type = TargetState
trigger1 = movehit=1&& Var(50)<=2100
trigger1 = numtarget(2703)
trigger1 = !(target, ishelper)
value = 2711
ignorehitpause = 1
persistent = 0
id = 2703
[State 0, ChangeState]
type = ChangeState
trigger1 = numtarget(2703)
trigger1 = movehit=1 && Var(50)<=2100
trigger1 = !(target, ishelper)
trigger1=target,stateno=2711
value = 2710
persistent = 1


[State 4001, End]
type = ChangeState
trigger1 = time > 30
Trigger2 = Var(3)>2
value = 2705
ctrl = 0

;-------------------------
;Hyper Rush, Dash Stop
[Statedef 2705]
type    = S
physics = S
movetype = A
anim = 2705
sprpriority = 1
ctrl = 0

[State 0, AttackDist]
type = AttackDist
;trigger1 = Anim = 240
trigger1 = 1
value = 0

[State 100, snd]
type = playsnd
trigger1 = time=0
value = 5,8
persistent = 0

[State 101, 1]
type = AssertSpecial
trigger1 = 1
flag = NoWalk

[State 101, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 100, 1]
type = VelMul
trigger1 = 1
x = .85

[State 100, 1]
type = VelSet
trigger1 = animtime = 0
x = 0

[State 100, 4]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;-------------------------
; Hyper Rush Attacking
[Statedef 2710]
type = S
physics = N
movetype = A
anim = 2710
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0]
Type=PosSet
Trigger1=!Time
Y=0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0, VarAdd]
type = VarAdd
trigger1 = !Time
fvar(13) = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = Time >=5
trigger1 = !NumTarget
value = 105

[State 3000, width]
type = width
trigger1 = !time
value = 25,0

[State 810, bind 1]
type = targetbind
trigger1 = animelemtime(1)>=0 && animelemtime(4)<0
pos = 55,0

[State 220, snd];voice
type = playsnd
trigger1 = Var(50)<2100
trigger1 = !time&&Enemy,MoveType=H
value = 3,216+(Random%5)
channel = 0

[State 640, 2]
type = HitDef
trigger1 = time%4 = 0
trigger1 = animelemtime(3)>=0 && animelemtime(30)<0
attr = A, HA
damage = Cond(Var(50)>=2100,0,Ceil(IfElse(fvar(11) * 7 < 4, 4, fvar(11) * 7))), 1
;Ceil(IfElse(fvar(11) * 7 < 4, 4, fvar(11) * 7)), 1
;7, 1
; ceil(7.0/fvar(15)),1                ;;;old
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s(7010+10*(random%2))
guard.sparkno = s7000
sparkxy = -10-(random%20),-30-(random%40)
hitsound   = s5,ifelse(random<333,200,random%2)
guardsound = S6,random%2
ground.type = High
pausetime = 4,5
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time=16
envshake.freq=80
envshake.ampl=4
fall = 0
fall.recover = 0
kill = 0
forcestand = 1
forcenofall = 1

[State 640, 2]
type = HitDef
trigger1 = time%4 != 0
trigger1 = animelemtime(3)>=0 && animelemtime(30)<0
attr = A, HA
damage = Cond(Var(50)>=2100,0,Ceil(IfElse(fvar(11) * 7 < 4, 4, fvar(11) * 7))), 1
;Ceil(IfElse(fvar(11) * 7 < 4, 4, fvar(11) * 7)), 1
;7, 1
; ceil(7.0/fvar(15)),1                ;;;old
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s(7010+10*(random%2))
guard.sparkno = s7000
sparkxy = -10-(random%20),-30-(random%40)
hitsound   = s5,ifelse(random<333,200,random%2)
guardsound = S6,random%2
ground.type = low
pausetime = 4,5
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time=16
envshake.freq=80
envshake.ampl=4
fall = 0
fall.recover = 0
kill = 0
forcestand = 1
forcenofall = 1

[State 902, TargetState]
type = TargetState
trigger1 = time > 2 && Var(50)>=2100
trigger1 = !(target, ishelper)
value = 2716
ignorehitpause = 1
persistent = 1
id = 2703
[State 0, ChangeState]
type = ChangeState	;go straight into shinsho on full emo
trigger1 = numtarget(2703)
trigger1 = time > 2 && Var(50)>=2100
trigger1 = !(target, ishelper)
value = 2715
persistent = 1

[State 902, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2711;5000
ignorehitpause = 1


[State 4001, Go to Shoryuken (Piccolo)]
type = null;ChangeState
triggerall = enemy, name = "Piccolo Z2" && (enemy, numhelper(3501) || enemy, numhelper(3502))
trigger1 = !AnimTime
value = 1220
ctrl = 0
[State 4001, Go to Shoryuken (Saibamen)]
type = ChangeState
triggerall = enemy, name = "Saibamen Z2" && authorname = "Team Z2"
trigger1 = !AnimTime
value = 1220
ctrl = 0
[State 4001, Go to Shoryuken (Candy)]
type = null;ChangeState
triggerall = enemy, name = "Vegetto Z2" && authorname = "Team Z2"
trigger1 = Time=0
value = 2710
ctrl = 0
[State 4001, Go to Shin Shoryuken]
type = ChangeState
trigger1 = TeamMode != Simul
trigger1 = !AnimTime
value = 2715
ctrl = 0

[State 4001, Go to Shin Shoryuken]
type = ChangeState
trigger1 = TeamMode = Simul
trigger1 = !AnimTime
value = 1220
ctrl = 0

;-------------------------
; Hyper Rush - P2 binded
[Statedef 2711]
type = S
physics = N
movetype = H
ctrl = 0
velset = 0,0
sprpriority = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 802, anim]
type = changeanim2
trigger1 = !time
value = 2711

;-------------------------
; Shin Shoryuken 1 - on ground
[Statedef 2715]
type    = S
movetype = A
physics = N
anim = 2715
juggle = 0
ctrl = 0
velset = 0,0
facep2 = 1
sprpriority = 2

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]	;Remove Dash FX
Type=RemoveExplod
Trigger1=!time
Id=2704

[State 0, ChangeState]
type = ChangeState
trigger1 = Time >=5
trigger1 = !NumTarget
value = 105

[State -2, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobg
flag2 = nofg
flag3 = nobardisplay
ignorehitpause = 1

[State 2201, helper]; Background lines
type = Helper
trigger1 = Time=0 && !(var(49)>0 && var(50)>=700 && var(50)<1400)
pos = -640, -480
postype = back
stateno = 2718
helpertype = normal
name = "vertical_lines_BG"
id = 2773
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 4
size.xscale = 5
size.yscale= 5

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 = !time
value = S3,210+(Random%5)
channel = 0

[State 1120, HitDef]
type = HitDef
trigger1 = !time       
attr = S, HA
animtype  = hard
air.animtype  = hard
damage = Ceil(IfElse(fvar(11) * 25 < 13, 13, fvar(11) * 25)), 0
;Ceil(IfElse(fvar(11) * 200 < 7, 7, fvar(11) * 200)), 0
;200, 0
priority = 6,Hit
getpower = 0,0
givepower = 0,0
hitflag = MAF
guardflag = M
pausetime = 49,50   ;35,35
sparkno = s2719  ;s7020
sparkxy = -15, -65
hitsound = S2720,0
ground.type = Low
ground.slidetime = 13
ground.hittime  = ifelse(p2statetype=C,22,20)
guard.hittime = 18
guard.slidetime = 13
guard.ctrltime = 18
ground.velocity = 3.0*const(size.xscale),-5.0*const(size.yscale)
guard.velocity = -5.0*const(size.xscale)
air.velocity = 3.0*const(size.xscale),-5.0*const(size.yscale)
fall = 0
fall.recover = 0
fall.envshake.time = 12
fall.envshake.freq = 80
fall.envshake.ampl = -4
down.bounce = 1
air.fall = 0
yaccel = .60*const(size.yscale)
envshake.time = 15
envshake.freq = 100
envshake.ampl = 8
forcestand = 1
P2facing = 1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
;p2stateno = 2716
id = 2716
kill = 0

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2716
ID = 2716
ignorehitpause = 1
persistent = 0

[State 0, TargetBind]
type = TargetBind
trigger1 = enemy,name="Vegetto Z2"
time = 1
id = 2716
pos = 0,-100

[State 4001, Go to 1 inch punch]
type = ChangeState
triggerall = var(49)>0 && var(50)>=700 && var(50)<1400
trigger1 = !AnimTime
value = 3200
ctrl = 0

[State 3700]; Send Goku to next state
type = changestate
trigger1 = !animtime
value = 2720
ignorehitpause = 1


;---------------------------------
; P2 state, hit by Shin Shoryuken 1
[Statedef 2716]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5020, 1]
type = ChangeAnim2
trigger1 = Time = 0
value = 2716

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time <3
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[State 0, PosSet]
type = PosSet
trigger1 = !Time && Facing = 1
X=Enemy,Pos X - Enemy,Const(Size.Ground.Back)-40
y = 0

[State 0, PosSet]
type = PosSet
trigger1 = !Time && Facing = -1
X=Enemy,Pos X + Enemy,Const(Size.Ground.Front)+40
y = 0

[State 5020, 3]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"
value = 105050

[State 1100, �����炷]
type = playsnd
trigger1 = time = 0
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"||name="Ibuki"||name="Gill"
value = 5000,1
channel = 2

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = anim = [105050,105051]
trigger1 = time <= 60
value = anim

[State -2, posadd]
type = posadd
trigger1 = time <= 60
x = 3*ifelse(time%2=0,1,-1)*ifelse(enemy,fvar(38)>1.0,1.5,1)

[State -2, AngleDraw]
type = AngleDraw
trigger1 = numenemy
trigger1 = enemy,authorname = "GM"
trigger1 = enemy,name = "Ryu"
trigger1 = enemy,var(6) = 2
value = 0
scale = enemy,fvar(38),enemy,fvar(38)

[State 810, ScreenBound]
type = ScreenBound
trigger1 = time <= 60
value = 1
movecamera = 1,1

[State 820, ChangeAnim2]
type = ChangeAnim
Trigger1 = anim != [105050,105051]
trigger1 = time > 60
value = 5030
persistent = 0

[State 5020, 3]
type = ChangeAnim
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"
trigger1 = time > 60
value = 105050
persistent = 0

[State 820, ChangeAnim2]
type = ChangeAnim
trigger1 = time > 60
trigger1 = SelfAnimExist(5035)
Trigger1 = anim = 5030
Trigger1 = AnimTime = 0
value = 5035
persistent = 0

[State 820, ChangeAnim2]
type = ChangeAnim
triggerall = time > 60
trigger1 = SelfAnimExist(5035)
Trigger1 = anim = 5035
Trigger1 = AnimTime = 0
trigger2 = !SelfAnimExist(5035)
Trigger2 = anim = 5030
Trigger2 = AnimTime = 0
value = 5050
persistent = 0

[State 5050, 2]
type = ChangeAnim
triggerall = time > 60
trigger1 = anim = 5050
trigger1 = Vel Y >= 1
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5030, 1]
type = VelAdd
trigger1 = time > 60
y = GetHitVar(yaccel)

[State 5030, 2]
type = HitVelSet
trigger1 = time > 60
x = 1
y = 1
persistent = 0

[State 810, ScreenBound]
type = ScreenBound
trigger1 = time > 60
value = 1
movecamera = 1,0

[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3200;Goku is doing the 1 inch punch
Value=3205
Ctrl=0

[State 5030, 4]
type = SelfState
trigger1 = time > 60
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;-------------------------
; Shin Shoryuken 2 - on ground
[Statedef 2720]
type    = S
movetype = A
physics = N
anim = 2720
juggle = 0
ctrl = 0
velset = 0,0
facep2 = 1
sprpriority = 2

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 1000, flash]
type = null ;PalFX
trigger1 = 1
add = 40, 30, -40
time = 1
ignorehitpause = 1

[State 0, TargetBind]
type = TargetBind
trigger1 = enemy,name="Vegetto Z2"
time = 1
id = 2721
pos = 0,-100

[State -2, scale var]
type = VarSet
trigger1 = !time
fvar(38) = 1

[State -2, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobg
flag2 = nofg
flag3 = nobardisplay
ignorehitpause = 1

[State -2, scale var]
type = VarAdd
triggerall = fvar(38) < 1.5
trigger1 = 1
fvar(38) = 0.0625
ignorehitpause = 1

[State -2, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = fvar(38), fvar(38)
ignorehitpause = 1

[State 1120, HitDef]
type = HitDef
trigger1 = animelem=2
attr = S, HA
animtype  = back
air.animtype  = back
damage = Ceil(IfElse(fvar(11) * 50 < 25, 25, fvar(11) * 50)), 0
;Ceil(IfElse(fvar(11) * 200 < 7, 7, fvar(11) * 200)), 0
;200, 0
priority = 6,Hit
getpower = 0,0
givepower = 0,0
hitflag = MAF
guardflag = M
pausetime = 49,50   ;35,35
sparkno = -1
guard.sparkno = S8410
sparkxy = -15, ceil(-60*const(size.yscale))
hitsound = S2720,0  ;S2720,1
ground.type = Low
ground.slidetime = 13
ground.hittime  = ifelse(p2statetype=C,22,20)
guard.hittime = 18
guard.slidetime = 13
guard.ctrltime = 18
ground.velocity = 2.0*const(size.xscale),-15.0*const(size.yscale)
guard.velocity = 0
air.velocity = 2.0*const(size.xscale),-15.0*const(size.yscale)
fall = 0
fall.recover = 0
fall.envshake.time = 12
fall.envshake.freq = 80
fall.envshake.ampl = -4
down.bounce = 1
air.fall = 0
yaccel = .80*const(size.yscale)
persistent = 0
envshake.time = 15
envshake.freq = 100
envshake.ampl = 8
forcestand = 1
P2facing = 1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
kill = 0
;p2stateno = 2721
id = 2721

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2721
ID = 2721
ignorehitpause = 1
persistent = 0

[State 1315, Sparks]
type = explod
trigger1 = movehit && numtarget
trigger1 = (target,movetype=H) && !(target,time)
anim = 2719  ;7030
sprpriority=7
postype = p1
pos = 55,-67
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent = 1
pausemovetime=100
supermovetime=100
scale = fvar(38),fvar(38)

[State 3700]; Send Goku to next state
type = changestate
trigger1 = !animtime
value = 2725

;--------------------------------
; P2 hit by Shin Shoryuken 2
[Statedef 2721]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5020, 1]
type = ChangeAnim2
trigger1 = Time = 0
value = 2721

[State 5020, 3]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"
value = 5030

[State 1100, �����炷]
type = playsnd
trigger1 = time = 0
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"||name="Ibuki"||name="Gill"
value = 5000,1
channel = 2

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = anim = 5030
trigger1 = !HitShakeOver
value = anim

[State -2, posadd]
type = posadd
trigger1 = !HitShakeOver
x = 3*ifelse(time%2=0,1,-1)*ifelse(enemy,fvar(38)>1.0,1.5,1)

[State -2, AngleDraw]
type = AngleDraw
trigger1 = numenemy
value = 0
scale = enemy,fvar(38), enemy,fvar(38)

[State 810, ScreenBound]
type = ScreenBound
trigger1 = !HitShakeOver
value = 1
movecamera = 1,1

[State 820, ChangeAnim2]
type = ChangeAnim
trigger1 = HitShakeOver
value = 5030
persistent = 0

[State 820, ChangeAnim2]
type = ChangeAnim
trigger1 = HitShakeOver
trigger1 = SelfAnimExist(5035)
Trigger1 = anim = 5030
Trigger1 = AnimTime = 0
value = 5035
persistent = 0

[State 820, ChangeAnim2]
type = ChangeAnim
triggerall = HitShakeOver
trigger1 = SelfAnimExist(5035)
Trigger1 = anim = 5035
Trigger1 = AnimTime = 0
trigger2 = !SelfAnimExist(5035)
Trigger2 = anim = 5030
Trigger2 = AnimTime = 0
value = 5050
persistent = 0

[State 5050, 2]
type = ChangeAnim
triggerall = HitShakeOver
trigger1 = anim = 5050
trigger1 = Vel Y >= 1
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5030, 1]
type = VelAdd
trigger1 = HitShakeOver
y = GetHitVar(yaccel)

[State 5030, 2]
type = HitVelSet
trigger1 = HitShakeOver
x = 1
y = 1
persistent = 0

[State 810, ScreenBound]
type = ScreenBound
trigger1 = HitShakeOver
value = 1
movecamera = 1,0

[State 5030, 4]
type = SelfState
trigger1 = HitShakeOver
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;----------------------------
; Shin Shoryuken Rising
[StateDef 2725]
type = A
movetype = A
physics = N
ctrl = 0
anim = 2725
velset = 0,-1

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 4001, StopFwd]
type = VelSet   ;FOR TEST
triggerall = (var(49)=0) || (var(49)>0 && var(50)<700) || (Var(49)>0&&Var(50)>=2100)
trigger1 = time = 2
X = 4
Y = -14

[State 4001, Sonic Beatdown vel init]
type = VelSet
triggerall = (var(49)=0) || (var(49)>0 && var(50)>=700 && var(50)<1400) || Var(49) > 0 && Var(50)>=2100
trigger1 = time = 2
X = 4
Y = -6

[State 1000, flash]
type = null ;PalFX
trigger1 = 1
add = 40, 30, -40
time = 1
ignorehitpause = 1

[State -2, AssertSpecial]
type = AssertSpecial
trigger1 = fvar(38) > 1.0   ;anim = 2725
trigger2 = var(49)>0 && var(50)>=700
flag = nobg
flag2 = nofg
flag3 = nobardisplay
ignorehitpause = 1

[State -2, VarAdd]
type = VarAdd
triggerall = fvar(38) > 1.0
trigger1 = anim=1202
trigger2 = anim=1203
trigger3 = anim=2725 && animelemtime(4)>5 && var(49)>0 	;Ultimate Kmh
fvar(38) = -0.05

[State -2, AngleDraw]
type = AngleDraw
trigger1 = time>0
value = 0
scale = fvar(38), fvar(38)
ignorehitpause = 1

[State 6100, snd]
type = playsnd
trigger1 = !time
value = 20,2

[State 220, snd];scream voice
type = playsnd
 		;Voice=English
trigger1 = !time
value = S3,210+(Random%5)
channel = 0

[State 4001, Pos]
type = PosAdd
trigger1 = time=0
x = 10

[State 4001, AirFriction]
type = VelMul
trigger1 = Vel X != 0
X = .9

[State 1120, HitDef]
type = HitDef
trigger1 = animelemtime(1)=1 
attr = A, HA
animtype  = up
air.animtype  = up
damage = Ceil(IfElse(fvar(11) * 90 < 50, 50, fvar(11) * 90)), 0
;Ceil(IfElse(fvar(11) * 150 < 7, 7, fvar(11) * 150)), 0
;150, 0
;ceil(150.0/fvar(15)),0         ;;;old
priority = 6,Hit
getpower = 0,0
givepower = 0,0
hitflag = MAF
guardflag = M
pausetime = 59,60  ;40,40
sparkno = -1
guard.sparkno = S8410
sparkxy = -15, ceil(-100*const(size.yscale))
hitsound = S2720,2
ground.type = high
ground.slidetime = 13
ground.hittime  = ifelse(p2statetype=C,22,20)
guard.hittime = 18
guard.slidetime = 13
guard.ctrltime = 18
ground.velocity = -1.5*const(size.xscale),-20*const(size.yscale)+2*(var(49)>0)
guard.velocity = -15.0*const(size.xscale)
air.velocity = -1.5*const(size.xscale),-20*const(size.yscale)+2*(var(49)>0)
fall = 0
fall.recover = 0
fall.envshake.time = 20
fall.envshake.freq = 120
fall.envshake.ampl = -10
down.bounce = 1
air.fall = 0
yaccel = 0.45+0.1*(var(49)=0)   ;0.55
persistent = 0
envshake.time = 10
envshake.freq = 90
envshake.ampl = 5
P2facing = 1
forcestand = 1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
;p2stateno = 2726
id = 2725
kill = (var(49)=0) || (var(49)>0 && var(50)<700)

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value =2726
ID = 2725
ignorehitpause = 1
persistent = 0

[State 1315, Sparks]
type = explod
trigger1 = movehit && numtarget
trigger1 = (target,movetype=H) && !(target,time)
anim = 2719
sprpriority=7
postype = p1
pos = 30,-165
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
persistent = 1
pausemovetime=100
supermovetime=100
scale = fvar(38),fvar(38)

;----------------
; Falling and change to Finisher states if necessary

; var(50) = [0,700[ 		-> nothing
; var(50) = [700,1400[		-> Finisher 1, Sonic Beatdown
; var(50) = [1400,2100[		-> Finisher 2, Ultimate Kmh
; var(50) = 2100			-> Finisher 3, Buu Genkidama

[State 4001, Fall]
type = VelAdd
trigger1 = Anim = 2725
trigger1 = Pos Y < -30
trigger2 = Anim = 1202
Y = .38

[State 4001, Return&Landing normal - no finisher]
type = ChangeAnim   ;FOR TEST
triggerall = (var(49)>=0 && var(50)<700)  || Var(49)=0 || Enemy,Alive=0; No justice level or Justice level 3 (for now until the UI level 3 is finished)
trigger1 = Anim = 2725
trigger1 = Vel Y >= 0.0
trigger2 = Anim = 1202
trigger2 = Pos Y = 0
value = ifelse(anim=2725,1202,1203)

[State 4001, Go to Sonic Beatdown]
type = null;ChangeState
triggerall = var(49)>0 && var(50)>=700 && var(50)<1400
Trigger1=Enemy,Alive=1
trigger1 = Anim = 2725 && animelemtime(4)>5 && abs(fvar(38)-1)<0.1
value = 2800
ctrl = 0

[State 4001, Go to Buu Genkidama];LVL2
type = ChangeState
trigger1 = var(49)>0 && var(50)>=1400
Trigger1=Enemy,Alive=1
triggerall = Anim = 2725 && animelemtime(4)>5 && abs(fvar(38)-1)<0.1
triggerall = time=28   ;ScreenPos Y >= 175
value = 2930
ctrl = 0


[State 4001, Go to X10 KHH]
type = null;ChangeState
triggerall = var(49)>0 && var(50)>=2100
trigger1 = Anim = 2725 && animelemtime(4)>5 && abs(fvar(38)-1)<0.1
trigger1 = time=28   ;ScreenPos Y >= 175
value = 3000
ctrl = 0

[State 4001, StopFwd]
type = VelSet
trigger1 = Vel X = (0,0.4]
X = 0

[State 4001, Stop]
type = VelSet
trigger1 = Vel Y > abs(Pos Y)
Y = 0

[State 4001, Replace]
type = PosSet
trigger1 = Vel Y = 0
Y = 0

[State 4001, ToGround]
type = StateTypeSet
trigger1 = Anim = 1203
persistent = 0
statetype = S
physics = S

[State 17100, Landing Sound]
type = PlaySnd
trigger1 = anim=1203
value = 40, 0
persistent = 0

[state 17100, Landing Effect]
type=explod
trigger1 = Anim = 1203
anim=17100
id=17100
pos=-15,0
postype=P1
sprpriority=-3
ownpal=1
supermovetime=-1
removetime = -2
persistent = 0

[State 4001, End]
type = ChangeState
trigger1 = Anim = 1203
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;--------------------------------
;P2 hit by Shin Shoryuken 3 Rising
[Statedef 2726]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5020, 1]
type = ChangeAnim2
trigger1 = Time = 0
value = 2726

[State 5020, 3]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"
value = 105051

[State 1100, �����炷]
type = playsnd
trigger1 = time = 0
trigger1 = authorname = "GM"
trigger1 = name="Ryu"||name="Ken"||name="Gouki"||name="Sean"||name="Alex"||name="Hugo"||name="Ibuki"||name="Gill"
value = 5000,1
channel = 2

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = anim = [105050,105051]
trigger1 = !HitShakeOver
value = anim

[State -2, posadd]
type = posadd
trigger1 = !HitShakeOver
x = 3*ifelse(time%2=0,1,-1)*ifelse(enemy,fvar(38)>1.0,1.5,1)

[State -2, AngleDraw]
type = AngleDraw
trigger1 = numenemy
value = 0
scale = enemy,fvar(38),enemy,fvar(38)

[State 810, ScreenBound]
type = ScreenBound
trigger1 = !HitShakeOver && enemy,var(49)=0
value = 1
movecamera = 1,1
ignorehitpause = 1

[State 810, ScreenBound]
type = ScreenBound
trigger1 = HitShakeOver && enemy,var(49)=0
value = 1
movecamera = 1,0
ignorehitpause = 1

[State 0, out of screen - Ultimate Kmh]
type = screenbound
trigger1 = enemy,var(49)>0 || enemy,stateno=2900
value = 0
movecamera = 0,0
ignorehitpause = 1

[State 820, ChangeAnim2]
type = ChangeAnim
Trigger1 = anim != [105050,105051]
trigger1 = HitShakeOver
value = 5030+(SelfAnimExist(5051)=1)*21
persistent = 0

[State 820, ChangeAnim2]
type = ChangeAnim
trigger1 = HitShakeOver
trigger1 = SelfAnimExist(5035)
Trigger1 = anim = 5030
Trigger1 = AnimTime = 0
value = 5035
persistent = 0

[State 820, ChangeAnim2]
type = ChangeAnim
triggerall = HitShakeOver
trigger1 = SelfAnimExist(5035)
Trigger1 = anim = 5035
Trigger1 = AnimTime = 0
trigger2 = !SelfAnimExist(5035)
Trigger2 = anim = 5030
Trigger2 = AnimTime = 0
value = 5050
persistent = 0

[State 5050, 2]
type = ChangeAnim
triggerall = HitShakeOver
trigger1 = (anim = [5050,5051])||(anim = [105050,105051])
trigger1 = Vel Y >= 1
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5030, 1]
type = VelAdd
trigger1 = HitShakeOver
y = GetHitVar(yaccel)

[State 5030, Buu Genkidama]
type = Changestate
triggerall = enemy,stateno=2935
trigger1 = HitShakeOver
value = 2933

[State 5030, Sonic Beatdown repositioning]
type = posadd
triggerall = enemy,stateno=2801
trigger1 = HitShakeOver
X = enemy,fvar(4)
persistent = 0

[State 5030, 2]
type = HitVelSet
trigger1 = HitShakeOver
x = 1
y = 1
persistent = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = HitShakeOver
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
;value2 = S,NA
time = 1
;ignorehitpause = 
;persistent = 


[State 5030, 4]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5954;5100


;===========================================================================
; <<<<< JUSTICE MODE >>>>>
; Rage Activation = 2745
;===========================================================================

;JUSTICE MODE
[Statedef 2745]
type = S
movetype = I
physics = S
anim = 2745
ctrl = 0
velset = 0,0
sprpriority = 1


[State 0, RemapPal];Turn SSB
type = RemapPal
trigger1 = Var(49)>0
source = 1,1
dest = 2,Var(58)

[State 200, BGPalFX]
type = BGPalFX
trigger1 = animelemtime(7)>=0
time = 1
add	= -100,-100,-100
;mul	= 256,100,100
mul	= 100,100,256
invertall = 0
color = 256

[State 0]
Type=PowerAdd
Trigger1=AnimElem=7
Value=-2000

[State 0, Explod]
type = Explod
trigger1 = animelemtime(7)=0
anim = 15999
ID = 9993999
removetime = 144
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = animelemtime(7)=0
time = 144
p2defmul = 1
unhittable = 1
anim = -1
sound = s2350,2
darken = 0
movetime = 144

[State 0, VarSet]
type = VarSet
trigger1 = animelemtime(7)=0
var(5) = 200
[State 0, VarSet]
type = VarSet
trigger1 = animelemtime(7)=0
var(28) = 100

[State 3000, nhb]
type = nothitby
trigger1 = animelemtime(7)>=0
time = 1
value = SCA

[State 13100, shake]
type = envshake
trigger1 = animelemtime(7)>=0
trigger1 = !(time%12)
time = 12
freq = 130
ampl = 5

[State 4500, 1];Scream
type = PlaySnd
 		;Voice=English
trigger1 = animelemtime(5)=5
value = 3,267+(Random%2)
volumescale = 200
channel = 1
[State 4500, 1];power up SFX
type = PlaySnd
trigger1 = animelemtime(7)=0
value = 193,1
volume = 500
channel = 9

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = time=21
value = 8,6
channel = 9
[State 4500, 2];long sound
type = PlaySnd
trigger1 = time=21
value = 8,5
pan = 1
channel = 9

[State 0, Aura Burst]
type = Helper
trigger1 = AnimElemTime(5)=0
name = "Shield"
ID = 2746
stateno = 2746
pos = 0,0
postype = p1    ;p2,front,back,left,right
ownpal = 1
supermovetime = 999999
pausemovetime = 999999

[State 0, Aura Flakes]
type = null;Helper
trigger1 = AnimElemTime(7)=1
name = "Emitter"
ID = 274000
stateno = 274000
pos = 0,0
postype = p1    ;p2,front,back,left,right
ownpal = 1
supermovetime = 999999
pausemovetime = 999999

[State 0, Aura Flakes]
type = null;Helper
trigger1 = AnimElemTime(7)=5
name = "Emitter"
ID = 274000
stateno = 274000
pos = 0,0
postype = p1    ;p2,front,back,left,right
ownpal = 1
supermovetime = 999999
pausemovetime = 999999

[State 1003, Helper]
type = Helper
trigger1 = AnimElemTime(7)=1
trigger2=AnimElemTime(7)>1&&time%5=0
helpertype = Normal
name = "PerseEffect"
id = 2932
;pos = ((random%240)-120),((random%240)-120)
pos =((random%Const(Size.Ground.Front))-5),((random%Const(Size.Height))-50)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
sprpriority=-1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .02 - (.1*fvar(20))
size.yscale = .02 - (.1*fvar(20))
[State 1003, Helper]
type = Helper
trigger1 = AnimElemTime(7)=1
trigger2=AnimElemTime(7)>1&&time%40=0
helpertype = Normal
name = "PerseEffect"
id = 2932
pos =((random%Const(Size.Ground.Front))-5),0
;pos = 0,0;-ceil(random/10)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .04 - (.1*fvar(20))
size.yscale = .04 - (.1*fvar(20))
[State 1003, Helper]
type = Helper
trigger1 = AnimElemTime(7)=1
trigger2=AnimElemTime(7)>1&&time%80=0
helpertype = Normal
name = "PerseEffect"
id = 2932
pos =((random%Const(Size.Ground.Front))-5),0
;pos = 0,0;-ceil(random/10)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .06 - (.1*fvar(20))
size.yscale = .06 - (.1*fvar(20))

[State 1900,Breakaway FX]
type = explod
trigger1 =animelemtime(7)=0&&!NumExplod(2748)
anim = 2747
id = 2747
pos = 0,0
sprpriority = 4
bindtime = -1
ownpal = 0
removeongethit = 1
ignorehitpause = 1
facing = 1
removetime = -1
pausemovetime = 99999
supermovetime = 99999

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time>=123
id = 2747

[State 3000, Buffer var]
type = varset
trigger1 = animelemtime(7)=0
var(49) = 1000   ;32 in Vegeta

[State 3000, Justice var]
type = varset
trigger1 = animelemtime(7)=0
var(50) = 0      ;33 in Vegeta

[State 3000, end]
type = changestate
trigger1 = !AnimTime
value = 0
ctrl = 1

;===========================================================================
; <<<<< SONIC BEATDOWN >>>>>
; Start charge : 2800
; Sonic Beatdown combo : 2801
; Gut Punch : 2805
; Transition Gut Punch to charge : 2810
; Charge Loop : 2815
; Final Punch Attack : 2820
; P2 State - Sent down : 2822
; P2 State - Hitting ground : 2823
; Final Punch Loop : 2825
; P2 Hit Lie Down (copy 5110) : 2829
; Recovery : 2830
;===========================================================================

; Sonic Beatdown - 1
[Statedef 2800]
type = A
movetype = A
physics = N
anim = 2800
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[State 3000, Buffer var]
type = varset
trigger1 = time=10
var(49) = 0

;Palette Code
[State 5900, Apply Pal]
type = RemapPal
trigger1 = 1
source = 1,1
dest = 2,Var(58)

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4)
time=4
freq=80
ampl=2+0.02*time

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 15999
ID = 9993999
removetime = 45
removeongethit = 1

[State 3000, superpause]
type = superpause
trigger1 = !time
time = 45
p2defmul = 1
unhittable = 1
anim = -1
darken = 0
movetime = 45

[state 17100, aura]
type = explod
trigger1 = time=7
anim = 30013
id = 30013
pos = 0,0
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[state 17100, mouth sprite]
type = explod
trigger1 = animelemtime(3)=0 && !numexplod(2803)
anim = 2803
id = 2803
pos = 0,0
postype = P1
sprpriority = 3
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[State 4500, 1];Niyjaaa voice
type = PlaySnd
 		;Voice=English
trigger1 = !time
value = 3,320;+(Random%6)
volume = 500
channel = 0

[State 4500, 1];power up SFX
type = PlaySnd
trigger1 = !time
value = 193,1
volume = 500
[State 4500, 2];long sound
type = PlaySnd
trigger1 = !time
value = 8,0
loop = 1
pan = 1
volumescale = 50
channel = 4

[State 3000, position save]
type = varset
trigger1 = !time
fvar(3) = pos X

[State 3000, position properly]
type = posadd
triggerall = time >= 1
trigger1 = (pos X > 3) || (pos X < -3)
X = ifelse (pos X > 3, ifelse(facing=1,-3.5,3.5), ifelse(facing=1,3.5,-3.5))

[State 3000, X pos to move P2]
type = varset
trigger1 = !time
fvar(4) = fvar(3) - (pos X)

;Sonic Beatdown
[State 901, ChangeAnim]
type = ChangeState
trigger1 = time=80
value = 2801
ctrl = 0

;------------------------------------
; Sonic Beatdown combo
[Statedef 2801]
type = A
movetype = A
physics = N
anim = 2801
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

;Palette Code
[State 5900, Apply Pal]
type = RemapPal
trigger1 = 1
source = 1,1
dest = 2,Var(58)

[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 30013
[state 17100, mouth]
type = removeexplod
trigger1 = !time
ID = 2803

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[state 17100, aura]
type = explod
trigger1 = !time
anim = 2802
id = 2802
pos = 0,0
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[State 810, bind 1]
type = targetbind
trigger1 = animelemtime(1)>=0 && animelemtime(3)<0
pos = 70,-30

[State 4500, 1];Atatatata voice
type = PlaySnd
 		;Voice=English
trigger1 = !time
value = 3,216+(Random%5)
volume = 500

[State 640, 2]
type = HitDef
trigger1 = 1
attr = A, HA
damage = 0,0
guardflag = HA
hitflag = MAF
animtype  = Hard
priority = 3,Hit
sparkno = s(7010+10*(random%2))
guard.sparkno = s7000
sparkxy = -10-(random%20),-70-(random%40)
hitsound   = s5,ifelse(random<333,200,random%2)
guardsound = S6,random%2
ground.type = High
pausetime = 4,5
ground.slidetime = 8
ground.hittime = 15
ground.velocity = -4
air.velocity = -1,0
getpower= 0,0
givepower = 5,5
yaccel = 0.5
envshake.time=16
envshake.freq=80
envshake.ampl=4
fall = 1
fall.recover = 0
kill = 0

[State 902, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 5000
ignorehitpause = 1

;to gut punch
[State 901, ChangeAnim]
type = ChangeState
trigger1 = !animtime
value = 2805
ctrl = 0

;------------------------------------
; Gut Punch
[Statedef 2805]
type = A
movetype = A
physics = N
anim = 2805
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 2802

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[state 17100, aura]
type = explod
trigger1 = !time
anim = 2806
id = 2806
pos = 0,0
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[State 810, bind 1]
type = targetbind
trigger1 = 1
pos = 50,-40

[State 220, snd];voice
type = playsnd
 		;Voice=English
trigger1 = !time
value = S3,206+(Random%9)
channel = 0

[State 3005, hit]
type = hitdef
trigger1 = !time
attr = S, HA
damage = 0,0
animtype = light
priority = 7, Miss
hitflag = MAF
guardflag = MA
sparkno = s7030
getpower = 0,0
guard.sparkno = s7000
sparkxy = -16,-87
hitsound   = s5,9
guardsound = 6,1
guard.dist = 0
pausetime = 0,0
ground.hittime = 15
ground.type = high
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = 0,0
p2facing = 1
kill = 0
;p2stateno = 2311
id = 2805

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2311
ID = 2805
ignorehitpause = 1
persistent = 0

[State 13100, shake]
type = envshake
trigger1 = movehit
time = 20
freq = 180
ampl = 8-0.2*time
persistent = 0

[State 200, 1];Hitsound SFX
type = PlaySnd
trigger1 = !time
value = 2805,0
volume = 500
ignorehitpause = 1

;gut punch to charge transition
[State 901, ChangeAnim]
type = ChangeState
trigger1 = time = 30
value = 2810
ctrl = 0

;------------------------------------
; Transition Gut Punch to charge
[Statedef 2810]
type = A
movetype = A
physics = N
anim = 2810
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 2806

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[state 17100, aura]
type = explod
trigger1 = !time
anim = 2811
id = 2811
pos = 0,0
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -2
persistent = 0
bindtime = -1

[State 810, bind 1]
type = targetbind
trigger1 = 1
pos = 50,-40

[State 1305, P2 pushed sound (ultimate hitbreak SFX)]
type = PlaySnd
trigger1 = !time
value = 2905,0
volume = 300

;to charge anim
[State 901, ChangeAnim]
type = ChangeState
trigger1 = !AnimTime
value = 2815
ctrl = 0

;------------------------------------
; Charge Loop
[Statedef 2815]
type = A
movetype = A
physics = N
anim = 2815
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 2811

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[state 17100, aura]
type = explod
trigger1 = !time
anim = 2816
id = 2816
pos = 0,0
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[State 810, bind 1]
type = targetbind
trigger1 = 1
pos = 50,-40

;to Gut Punch
[State 901, ChangeAnim]
type = ChangeState
trigger1 = time = 15  ;60
value = 2820
ctrl = 0

;------------------------------------
; Final Punch Attack
[Statedef 2820]
type = A
movetype = A
physics = N
anim = 2820
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0


[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 2816

[State 4500, 1];Harria voice
type = PlaySnd
 		;Voice=English
trigger1 = !time
value = 3,320;+(Random%6)
volume = 500
channel = 0

[State 810, bind 1]
type = targetbind
trigger1 = !time
pos = 50,-40

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[state 17100, aura]
type = explod
trigger1 = !time
anim = 2821
id = 2821
pos = 0,0
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -2
persistent = 0
bindtime = -1
ignorehitpause = 0

[State 650, 3]
type = HitDef
trigger1 = !time
attr = A, HA
damage = Ceil(IfElse(fvar(11) * 50 < 25, 25, fvar(11) * 50)), 0
;Ceil(IfElse(fvar(11) * 50 < 7, 7, fvar(11) * 50)), 50
;50, 50
;ceil(50.0/fvar(15)),ceil(50.0/fvar(15))         ;;;old
hitflag = MAF
guardflag = HA
animtype = Hard
priority = 4, Hit
pausetime = 11,12
sparkno = s7030
guard.sparkno = s7000
sparkxy = -30,-55
hitsound   = s5,2
guardsound = S6,1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -5
air.velocity = 0,10
envshake.time = 20
envshake.freq = 80
envshake.ampl = 6
fall = 1
fall.recover = 0
p2facing = 1
airguard.cornerpush.veloff= 0
air.animtype = Back
fall.animtype = Back
getpower= 0,0
givepower = 35,35
yaccel = 0.5
;p2stateno = 2822
id = 2820

[State 802, TargetState]
type = TargetState
trigger1 = movehit
trigger1 = numtarget
trigger1 = !(target, ishelper)
value = 2822
ID = 2820
ignorehitpause = 1
persistent = 0

[State 200, 1];Hitsound SFX
type = PlaySnd
trigger1 = animelemtime(3)=0
value = 2805,1
volume = 500
ignorehitpause = 1

;Thunder Strike hit sound
[State 901, thunder sound]
type = Playsnd
trigger1 = animelemtime(3)=0
value = 2820,0
ignorehitpause = 1

[state 1215, Thunder Strike FX]
type = explod
trigger1 = animelemtime(3)=0
anim = 2823
id = 2823
pos = 60,-50
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
[state 1215, Thunder Strike FX]
type = explod
trigger1 = enemy,stateno = 2822
anim = 2824
id = 2824
pos = 0,-15
postype = P2
sprpriority = 2
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
bindtime = -1
scale = 0.3,0.3
[state 1215, Thunder Strike FX]
type = explod
trigger1 = enemy,stateno = 2822
anim = 2828
id = 2824
pos = 15,-5
postype = P2
sprpriority = 2
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
bindtime = -1
scale = 0.3,0.3
[state 1215, Thunder Strike FX]
type = explod
trigger1 = enemy,stateno = 2822
anim = 2824
id = 2824
pos = 35,-15
postype = P2
sprpriority = 2
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
bindtime = -1
scale = 0.3,0.3
[state 1215, Thunder Strike FX]
type = explod
trigger1 = enemy,stateno = 2822
anim = 2828
id = 2824
pos = -20,-20
postype = P2
sprpriority = 2
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
bindtime = -1
scale = 0.3,0.3
[state 1215, Thunder Strike FX]
type = explod
trigger1 = enemy,stateno = 2822
anim = 2824
id = 2824
pos = -30,-5
postype = P2
sprpriority = 2
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1
bindtime = -1
scale = 0.3,0.3

;to final punch loop
[State 901, ChangeAnim]
type = ChangeState
trigger1 = !AnimTime
value = 2825
ctrl = 0

;------------------------------------------------
;P2 State - Sent down
[Statedef 2822]
type = A
physics = N
movetype = H
ctrl = 0
velset = 0, 14

[State 3020, 2]
type = changeanim2
trigger1 = !time && anim !=2822
value = 2822

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 200

[State 1050, 1]
type = sprpriority
trigger1 = 1
value = 1

[State 901, ChangeAnim]
type = ChangeState
trigger1 = Pos Y >= -10
value = 2823
ctrl = 0

;------------------------------------------------
; P2 State - Hitting ground
[Statedef 2823]
type = A
physics = N
movetype = H
ctrl = 0
velset = 0, 0.2

[State 13100, shake]
type = envshake
trigger1 = !time
time = 100
freq = 150
ampl = 10
persistent = 0

[State 3020, 2];hit ground
type = changeanim
trigger1 = time>=0 && time<100 && (time%12)=0
value = 5080

[State 3020, 2];lie on ground
type = changeanim
trigger1 = time>=100 && anim!=5110
value = 5110

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 200

[State 1050, 1]
type = sprpriority
trigger1 = 1
value = 1

[State 5101, 6];vel
type = Velset
trigger1 = time>=130
Y = 0

[State 5101, 6];Position
type = Posset
trigger1 = time=130
Y = 0

[State 5101, 6];get up
type = ChangeState
trigger1 = time=210
value = 2829   ;5110

;------------------------------------
; Final Punch Loop
[Statedef 2825]
type = A
movetype = A
physics = N
anim = 2825
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 2821

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[state 17100, radial aura]
type = explod
trigger1 = !time
anim = 2826
id = 2826
pos = 0,-5
postype = P1
sprpriority = -1
ownpal = 1
supermovetime = -1
removetime = -1
persistent = 0
bindtime = -1

[State 13300, Fadeout]
type = modifyexplod
trigger1 = Time = [80,110]
trans = addalpha
alpha = floor(256-8.53*(Time-80)),floor(8.53*(Time-80))
ID = 2826

;P2 hits ground sound
[State 901, hitground sound]
type = Playsnd
trigger1 = enemy,stateno=2823
value = 2820,5;1
persistent = 0
[State 901, hitground sound]
type = Playsnd
trigger1 = enemy,stateno=2823
value = 2820,1
persistent = 0

[State 1900, lightning ground burst]
type = explod
trigger1 = enemy,stateno=2823
anim = 2827
Postype = P2
pos = 0,25
sprpriority = 6
bindtime = 1
ownpal = 1
ignorehitpause = 1
removetime = -2
persistent = 0

[State 5101, 6];vel
type = Velset
trigger1 = time=20
Y = -1.5
[State 5101, 6];vel
type = Velset
trigger1 = Pos Y < -180
Y = 0

[State 0, out of screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, stop power charge SFX]
type = stopsnd
trigger1 = time=60 && !winKO
trigger2 = time=10 && winKO
channel = 4

[State 1900, white circle]
type = explod
trigger1 = time = 60
anim = 90200
id = 90200
Postype = P2
pos = 0,-10
sprpriority = 7
ontop = 1
bindtime = -1
ownpal = 1
ignorehitpause = 1
removetime = -2
scale = .005,.005

[State 1900, white circle]
type = modifyexplod
trigger1 = numexplod(90200)
scale = .12*(time-60),.12*(time-60)
ID = 90200

[State 1900, lightning bind remove]
type = removeexplod
trigger1 = time=70
ID = 2824

;to Recovery
[State 901, ChangeAnim]
type = ChangeState
trigger1 = time = 165  ;180
value = 2830
ctrl = 0

;------------------------------------
;P2 Hit Lie Down (copy 5110)
[Statedef 2829]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = SelfState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 11];not dead
type = SelfState
triggerall = alive
trigger1 = AnimTime = 0
trigger2 = Anim = [5110,5119]
value = 5120

;------------------------------------
; Recovery
[Statedef 2830]
type = A
movetype = A
physics = N
anim = 2830
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

;Palette Code
[State 5900, Apply Pal]
type = RemapPal
trigger1 = var(58)
source = 1,1
dest = Cond(Var(49)>0,2,1),var(58)

[state 17100, aura]
type = removeexplod
trigger1 = !time
ID = 2826

[State 0, AssertSpecial]
type = null ;AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

;to fall state
[State 1400, EndState]
type = ChangeState
trigger1 = !animtime
value = 50
ctrl = 0


;===========================================================================
; <<<<< MUI Finisher>>>>>
; Start charge : Dash Collision
; Throwing Angry Kamehameha : 2901
; (Helper) Horizontal Lines BG - Angry Kmh : 2902
; (Helper) Ultimate Kamehameha Beam hits : 2903
; (Helper) Ultimate Kamehameha Beam moves : 2905
; P2 hit by tip of beam : 2906
; Throwing Angry Kamehameha - Goku moving out of screen : 2910
; SSJ Goku waiting : 2911
; Goku going back to screen : 2912
; P2 hit goes back to screen : 2915
;===========================================================================

;UI Clash
[Statedef 2900]
type=s
movetype = A
physics = N
anim = 4000
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[State 3000, Buffer var]
type = varset
trigger1 = time=10
var(49) = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[State 222, hit]
type = HitDef
trigger1 = 1
damage = 0
hitflag = MAF
fall.recover = 0
getpower= 0,0
givepower = 0,0
fall = 0
id = 2901

[State 0, TargetState]
type = TargetState
triggerall = NumTarget;()
trigger1 = Enemy,StateNo!=2901
value =2901

[State 0, TargetBind]
type = TargetBind
trigger1 = Time=0
time = 9999
id = -1
pos = 120,0

[State 0, VelSet]
type = VelSet
trigger1 = Time >60
x = -2

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4)
time=4
freq=80
ampl=2+0.02*time

;Throw Kmh
[State 901, ChangeAnim]
type = null;ChangeState
trigger1 = time=187   ;170
value = 2901
ctrl = 0

;-----------------------------
;Opponent Binded during Clash
[Statedef 2901]
type = S
physics = N
movetype = I
ctrl = 0
velset = 0,0
sprpriority = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AuthorName = "Team Z2" && AnimExist(950)
value = 950

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AuthorName != "Team Z2"
value = 130



[State 0, VelSet]
type =null; VelSet
trigger1 = Time >60
x = 2

[State 3005, end]
type = changestate
trigger1 = helper(2903),movehit
value = 2910

;-----------------------------
;Throwing Angry Kamehameha - Goku moving out of screen
[Statedef 2910]
type = A
physics = N
movetype = A
anim = 2901
ctrl = 0
velset = -1,0
sprpriority = 1

[State 0, out of screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4)
time=4
freq=80
ampl=6

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[State 0, vel]
type = velset
trigger1 = time=30
X = -8
[State 0, vel]
type = velset
trigger1 = ifelse(facing=1,pos X <-790,pos X > 790)
X = 0

[State 0, vel]
type = velset
trigger1 = time>=50 && (pos Y != [-26,-24])
Y = ifelse(pos Y > -24, -1, 1)
[State 0, vel]
type = velset
trigger1 = pos Y = [-26,-24]
Y = 0

[State 1315, Sparks]
type=explod
trigger1= numtarget
trigger1= (time%4=0) && (time> 180) && (time < 180+ 39*4 + 1)
anim=7030
sprpriority=8
postype=p2
pos=(target,const(size.ground.front)-40)+(random%60), (random%60)-90
removetime=-2
ownpal=1
facing=-1
ignorehitpause=1
pausemovetime=100
supermovetime=100

[State 800, count]
type = HitAdd
trigger1= (time%4=0) && (time> 180) && (time < 180+ 39*4 + 1)
value = 1

[State 800, hitsound]
type = PlaySnd
trigger1= (time%8=0) && (time> 180) && (time < 180+ 39*4 + 1)
value = s1000,0
volume = 300

[State 13100, Hurt]
type = TargetLifeAdd
trigger1 = time = 180 + 39*4 + 1
value = ceil(ifElse(fvar(11) * -350 > -70, -70, fvar(11) * -350))
kill = 1
persistent = 0

[State 13100, Hurt]
type = TargetPowerAdd
trigger1 = time = 180+ 39*4 + 1
value = 2000
persistent = 0

[State 13100, Back to screen]
type = ChangeState
trigger1 = time = 180+ 39*4 + 60
value = 2911
ctrl = 0

;--------------------------------
; P2 hit by tip of beam
[Statedef 2906]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0

[State 0, anim hit]
type = changeanim2
trigger1 = !time
value = 2906

[State 0, out of screen]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 1000]
type = PosAdd
trigger1 = abs(P2bodydist X) < 700
X = -40
[State 1000]
type = PosAdd
trigger1 = abs(P2bodydist X) > 700 && abs(P2bodydist X) < 740
X = -5
[State 1000]
type = PosAdd
trigger1 = abs(P2bodydist X) > 740 && abs(P2bodydist X) < 760
X = -2

[State 0, reposition P2]
type = posAdd
trigger1 = !time
Y = ceil(-ScreenPos Y + 120)-const(size.head.pos.Y)-20

[State 0, vel]
type = velset
trigger1 = time=30
X = 8

[State 0, vel]
type = velset
trigger1 = enemy,vel X = 0
X = 0

;[State -3, GetHit Snd]
;type = playsnd
;trigger1 = Time >= 180 && time<=(180+ 39*4)
;trigger1 = Time%20 = 0
;value = 5000,1+(random%5)
;volume = 200
;ignorehitpause = 1

[State 13100, shake]
type = envshake
trigger1 = Time >= 180
trigger1 = (time%12)=0
time = 12
freq = 150
ampl = 10

[State 3025, p2state - killed fatality]
type = changestate
trigger1 = enemy,stateno=2911
trigger1 = MatchOver
value = ifelse(SelfAnimExist(5941), 5941, 5943)
ignorehitpause = 1

[State 801, end]
type = changestate
trigger1 = enemy,stateno=2911
value = 2915
ctrl = 0

;----------------------------
; SSJ Goku waiting
[Statedef 2911]
type = A
physics = N
movetype = A
ctrl = 0
sprpriority = 1
velset = 0,0

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 3025, killed, beam fatality sound]
type = playsnd
trigger1 = numenemy
trigger1 = (enemy,stateno=5941 || enemy,stateno=5943 || enemy,stateno=2990) && enemy,time=30
value = 5941,0
volume = 300
persistent = 0

[State 13100, Back to screen]
type = ChangeState
triggerall = enemy,stateno != 2990
trigger1 = time >= 2+120*MatchOver
value = 2912
ctrl = 0

;---------------------------------------
; Going back to screen
[Statedef 2912]
type    = S
movetype = A
physics = N
ctrl = 0
anim = 102
sprpriority = 1
velset = 0,0


[State 0, RemapPal]
type = RemapPal
trigger1 =1
source = 1,1
dest = 1,Var(58)

[State 105, 3]
type = PosSet
trigger1 = !time
x = ifelse(facing=1,-250,250)
y = -50

[State 3010, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1
ignorehitpause = 1

[State 41, Train]
type = AfterImage
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 100, 7]
type = Explod
trigger1 = Time = 0
Anim = 8050
postype = P1
pos = -10,-20
scale = 1,.8
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 111, 1]
type = VelSet
trigger1 = time=0
x = 9

[State 115, dash Sound]
type = PlaySnd
trigger1 = time=0
value = 100,0

[State 111, 1]
type = VelAdd
trigger1 = time>=5 && vel X>=0
x = -0.3

[State 111, 1]
type = StateTypeSet
trigger1 = time >= 5
physics = A

[State 111, 1]
type = ChangeState
trigger1 = time = 15
value = 50

[State 111, end]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 112

;---------------------------------------------------------------------------
;P2 hit goes back to screen
[Statedef 2915]
type = S
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 4005, vel Y]
type = posset
trigger1 = !time
x = ifelse(facing=1, -90, 90)
y = -40

[State 111, go to common hitstate]
type = SelfState
trigger1 = !Time
value = 5100


;===========================================================================
; <<<<< BUU GENKIDAMA >>>>>
; Transition : 2930
; Little balls charge helpers : 2931, 2932
; P2 invisible & waiting : 2933
; Genkidama charge : 2935
; Goku throws Genkidama : 2940
; Genkidama helper : 2941
; Horizontal BG lines : 2942
; P2 back on screen guarding : 2945
; Goku back on screen and powering up : 2950
;===========================================================================

;Finisher- Genkidama
[Statedef 2930]
type = A
movetype = A
physics = N
anim = 2930
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0];Music Start
Type=PlaySND
Trigger1=Time=1&&Var(50)>=2100
Value=s3000,0
volumescale=500
Channel=21

[State 0];Explod for LVL3
type =Explod
TriggerAll=!NumExplod(9992100)
Trigger1=!Time&&Var(50)>=2100
anim = 1
ID = 9992100
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
IgnoreHitPause=1


[State 0]
Type=AssertSpecial
Trigger1=NumExplod(9992100)
Flag=NoMusic
IgnoreHitPause=1

[State 3000, Buffer var]
type = varset
trigger1 = time=5
var(49) = 0

[State 3000, Buffer var]
type = varset
trigger1 = time=5
var(50) = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noBG
flag2 = noFG
flag3 = nobardisplay
ignorehitpause = 1

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4)
time=4
freq=80
ampl=3

[State 3000, position properly]
type = posadd
trigger1 = (pos X > 3) || (pos X < -3)
X = ifelse (pos X > 3, ifelse(facing=1,-3.5,3.5), ifelse(facing=1,3.5,-3.5))

[State 111, to charge]
type = ChangeState
trigger1 = !animtime
value = 2935

;------------------------------------------------
[StateDef 2933] ; P2 invisible and waiting
type = S
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 13200, Anim]
type = ChangeAnim2
trigger1 = Time = 0
value = 15999

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 13200, Anim];Go to hit ground
type = ChangeState
trigger1 = Enemy,NumExplod(9992100) = 1 && Time = 100
value = 3245

[State 13200, Anim];Go to guarding state back on screen
type = ChangeState
trigger1 = Enemy,NumExplod(9992100) = 0 && Time = 430
value = 2945


;---------------------------------------------------------------------------
;Genkidama charge loop
[Statedef 2935]
type = A
movetype = A
physics = N
anim = 2935
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[State 0, RemapPal];Turn back
type = null;RemapPal
trigger1 = Var(49)=0
source = 1,1
dest = 1,Var(58)

[State 0]
Type=AssertSpecial
Trigger1=NumExplod(9992100)
Flag=NoMusic
IgnoreHitPause=1
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 3001, shake]
type = EnvShake
trigger1 = time = 0
time = 300
freq = 100
ampl = 3

[State 181, 1];revert SFX
type = PlaySnd
trigger1 = !time
value = 181,0

[State 8000, less vibrant]
type = PalFX
trigger1 = 1
add = -15,-15,-15
color = 200
time = 1

[State 1000, Helper]
type = Helper
trigger1 = anim = 2935 && !(time%7) && numhelper(2931)<20 && numhelper(2932)<20
helpertype = Normal
name = "PerseEffect_GK"
id = 2931
pos = 0,0   ;ceil(50-random/20),-ceil(random/7)
postype = p1
facing = 1
stateno = 2931
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 200, 1];Super charging SND
type = PlaySnd
trigger1 = !time
value = 2930,0
volume = 355

[State 200, charge SFX]
type = PlaySnd
trigger1 = (GameTime%20) = 0
value = 2500,1
volume = -200
freqmul = .9 + (random/5000.0)

[State 13300, Genkidama Ball]
type = Explod
trigger1 = NumExplod(9992100) = 1
trigger1 = !time
anim = 2936
ID = 2936
postype = p1
pos =-5,-200
bindtime = -1
removetime = -1
pausemovetime = -1
ontop = 1
sprpriority = 7
scale = 0.3,0.3
persistent = 0

[State 13300, Genkidama Ball]
type = Explod
trigger1 = NumExplod(9992100) = 0
trigger1 = time=100
anim = 2936
ID = 2936
postype = p1
pos =-5,-260
bindtime = -1
removetime = -1
pausemovetime = -1
ontop = 1
sprpriority = 7
scale = 0.3,0.3
persistent = 0

[State 13300, Genkidama Ball Scale]
type = ModifyExplod
trigger1 = NumExplod(9992100) = 1 
trigger1 =  time<64
scale = 0.8+.01*(time),0.8+.01*(time)
ID = 2936

[State 13300, Goku Scale]
type = AngleDraw
trigger1 = NumExplod(9992100) = 1 
trigger1 =  time<60
scale =1-.009*(time),1-.009*(time)

[State 13300, Goku Scale]
type = AngleDraw
trigger1 = NumExplod(9992100) = 1 
trigger1 = Time>=60
scale = .45,.45
persistent=1

[State 13300, Genkidama Ball Scale]
type = ModifyExplod
trigger1 = NumExplod(9992100) = 0
trigger1 = time>100 && time<264
scale = 0.8+.008*(time-100),0.8+.008*(time-100)
ID = 2936

[State 13300, Goku Scale]
type =AngleDraw
trigger1 = NumExplod(9992100) = 0
trigger1 = time>200&& time<250
scale = 0.9-.009*(time-200),0.9-.009*(time-200)

[State 13300, Goku Scale]
type = AngleDraw
trigger1 = NumExplod(9992100) = 0
trigger1 = Time>=250
scale = .45,.45
persistent=1

[State 0, Move Down]
type =PosAdd
trigger1 =  time>220&& time<230
y = 1

[State 111, end];LVL INVIS
type =ChangeState
Trigger1=Enemy,Alive=1
trigger1 = NumExplod(9992100) = 1 && time = 100
value = 3240

[State 111, end]
type =ChangeState
trigger1 = NumExplod(9992100) = 0 && time=320
value = 2940

;------------------------------------------------
; Goku throws his HUGE genkidama
[StateDef 2940] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2940

[State 13300, Goku Scale]
type = AngleDraw
trigger1 = Time>=0
scale = .45,.45
persistent=1

[State 8000, less vibrant]
type = PalFX
trigger1 = 1
add = -15,-15,-15
color = 200
time = 1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 3001, shake]
type = EnvShake
trigger1 = time = 0
time = 150
freq = 100
ampl = 3

[State 220, snd];voice scream
type = playsnd
 		;Voice=English
trigger1 = Anim=2940 && AnimElemtime(3)=0
value = 3,245
channel = 0
volume = 255

[State 220, snd];Genkidama goes
type = playsnd
trigger1 = Anim=2940 && AnimElemtime(6)=0
value = 2940,0   ;2401,1
volume = 255

[State 13300, Genkidama Ball old]
type = RemoveExplod
trigger1 = Anim=2940 && AnimElemtime(5)=0
ID = 2936

[State 1000, Helper Genkidama]
type = Helper
trigger1 = Anim=2940 && AnimElemtime(5)=0
helpertype = Normal
name = "Genkidama"
id = 2941
pos = -20,-190
postype = p1
stateno = 2941
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 13100, go out of screen]
type = Velset
trigger1 = time=40
x = -6
y=-4
[State 2201, helper]; Background lines
type = Helper
trigger1 = !time
pos = -640, -480
postype = back
stateno = 2942
helpertype = normal
name = "horizontal_lines_BG"
id = 2942
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 4
size.xscale = 5
size.yscale= 5

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 13100, stop moving back]
type = Velset
trigger1 = time=150
x = 0

[State 13100, stop moving up]
type = Velset
trigger1 = time=55
y = 0
[State 200, 1];Beam clash
type = PlaySnd
trigger1 = Anim=2940 && AnimElemtime(6)=0   ;time=176
value = 2480,0
loop = 1
channel = 5
volume = 300

[State 13300, Guard sparks]
type = Explod
trigger1 = time>=176 && time%10=0
anim = 7000
ID = 7000
postype = p2
pos = -10+3*(random%15), -30-3*(random%16)
bindtime = 1
removetime = -2
pausemovetime = -1
ontop = 1
sprpriority = 7

[State 640, guard sounds]
type = PlaySnd
trigger1 = time>=176 && time%10=0
value = 6,1

[State 1000, shake]
type = EnvShake
trigger1 = time>=176 && time%6=0
time = 4
ampl = 5
freq = 176

[State 200, 1];Beam clash Stop
type = StopSnd
trigger1 = time=300
channel = 5

[State 111, go back to screen]
type = ChangeState
trigger1 = time=300
value = 2950

;------------------------------------------------
;P2 Guarding Comes back to screen
[StateDef 2945] 
type = S
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0, ChangeAnim];Jiren Special
type = ChangeAnim
trigger1 = Name = "Jiren Z2"&&!Time
value = 1300

[State 0, ChangeAnim];Jiren Special
type = ChangeAnim
trigger1 = Name = "Jiren Z2"
Trigger1=Time=68
value = 1301
[State 0, ChangeAnim];Jiren Special
type = ChangeAnim
trigger1 = Name = "Jiren Z2"&&Anim=1301
Trigger1=AnimElemTime(7)=0
value = 1301
Elem=6

[State 0, ChangeAnim]
type = ChangeAnim
Triggerall=Name!="Jiren Z2"
trigger1 = AuthorName = "Team Z2" && AnimExist(950)
value = 950

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = AuthorName != "Team Z2"
value = 130

[State 13300, Goku Scale]
type = AngleDraw
trigger1 = Time>=0
scale = .45,.45
persistent=1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 13200, Pos]
type = PosSet
trigger1 = !time&&Anim = 130
x = 500*(enemy,facing)
y = -15
[State 13200, Pos]
type = PosSet
trigger1 = !time&&Anim = 950
x = 520*(enemy,facing)
y = -15
[State 13200, Pos]
type = PosSet
trigger1 = !time&&Anim =1300
x = 540*(enemy,facing)
y = -15

[State 13200, Move]
type = VelSet
trigger1 = !time
x = 6

[State 13200, In contact with Genkidama]
type = VelSet
trigger1 = time=68
x = 0

[State 13200, Invisible]
type = changeanim2
trigger1 = (enemy,stateno = [2950,2975])
value = 15999

[State 13200, go to hit state]
type = changestate
trigger1 = enemy,stateno = 2980
value = 2985
;------------------------------------------------
; Goku push loop normal
[StateDef 2950] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2950

[State 0, RemapPal];Turn back to a SSJ1
type = RemapPal
trigger1 =!Time
source = 1,1
dest = 1,Var(58)
persistent = 0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 2260, destroy guard sparks]
type = RemoveExplod
trigger1 = !time
ID = 7000

[State 4500, 1];Hitbreak sound for build up
type = PlaySnd
trigger1 = time=30
trigger2 = time=100
value = 2905,0

[State 8000, less vibrant]
type = PalFX
trigger1 = 1
add = -15,-15,-15
color = 200
time = 1

[State 13200, Pos]
type = PosSet
trigger1 = !time
Y=-20
x = -20 * facing

[State 0, Helper];Flash against Jiren
type =Helper
TriggerAll=Enemy,Name="Jiren Z2"
trigger1 = time=120
trigger2 = time=180
helpertype = normal ;player
name = "Flash"
stateno = 2956
ID = 2956
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
ownpal = 1

[State 13300, yellow flash]
type = Explod
TriggerAll=Enemy,Name!="Jiren Z2"
trigger1 = time=120
trigger2 = time=180
anim = 2951
ID = 2951
postype = p1
pos = 0,0
bindtime = -1
removetime = -2
pausemovetime = -1
sprpriority = 6

[State 4500, 1];Aura Burst
type = PlaySnd
trigger1 = time=120
trigger2 = time=180
value = 8,1

[State 111, go to SSJ]
type = ChangeState
trigger1 = time=200
value = 2955

;------------------------------------------------
; Goku push loop SSJ
[StateDef 2955] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2955
sprpriority = 4

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0, RemapPal];Turn blue against Jiren
type = RemapPal
Trigger1=Enemy,AuthorName = "Team Z2"
trigger1 =Enemy,Name="Jiren Z2"
source = 1,1
dest = 2,Var(58)
persistent = 0

[State 0, PalFXWiz];Red
type = PalFX
Trigger1=AuthorName = "Team Z2"
trigger1 =Enemy,Name="Jiren Z2"
time = 10
add = 70,-50,-50
mul = 256,256,256

[state 17100, radial aura];Red Aura
type =explod
Trigger1=Enemy,AuthorName = "Team Z2"
trigger1 = !time&&Enemy,Name="Jiren Z2"
anim = 2957
id = 2956
pos = 5,0
postype = P1
sprpriority = -2
scale=1,1
ownpal = 1
supermovetime = 999999
removetime = -1
bindtime = -1

[State 13300, yellow flash]
type = Explod
trigger1 = !time
anim = 2951
ID = 2956
postype = p1
pos = 0,0
bindtime = -1
removetime = -2
pausemovetime = -1
sprpriority = 6

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 13200, Pos]
type = PosSet
trigger1 = !time
x = -20 * facing

[State 4500, 1];Transformation sound
type = PlaySnd
trigger1 = !time
value = 188,0

[State 4500, 1];"push the genki" presence sound
type = PlaySnd
trigger1 = !time
value = 2955,0

[State 13300, aura]
type = Explod
Trigger1=AuthorName = "Team Z2"
trigger1 = !time&&Enemy,Name!="Jiren Z2"
anim = 2956
ID = 2956
postype = p1
pos = 0,0
bindtime = -1
removetime = -1
pausemovetime = -1
sprpriority = 2

[State 4500, 1];Small sound
type = null ;PlaySnd
trigger1 = !time
value = 8,1
volume = 255
[State 4500, 2];long sound
type = PlaySnd
trigger1 = !time
value = 8,5 ;8,0
;loop = 1
pan = 1
volume = 25
channel = 3
[State 4500, 2];long sound
type = PlaySnd
trigger1 = time=150
value =  8,5 ;8,0
;loop = 1
pan = 1
volume = 25
channel = 3

[State 111, go to Salute transition]
type = ChangeState
trigger1 = time=160  ;200
value = 2960

;------------------------------------------------
; Goku salute transition
[StateDef 2960] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2960

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0, PalFXWiz];Red
type = PalFX
Trigger1=AuthorName = "Team Z2"
trigger1 =Enemy,Name="Jiren Z2"
time = 10
add = 70,-50,-50
mul = 256,256,256
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 111, go to Salute]
type = ChangeState
trigger1 = !animtime
value = 2965

;------------------------------------------------
; Goku salute 
[StateDef 2965] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2965

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0, PalFXWiz];Red
type = PalFX
Trigger1=AuthorName = "Team Z2"
trigger1 =Enemy,Name="Jiren Z2"
time = 10
add = 70,-50,-50
mul = 256,256,256
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 4500, 2];See you voice
type = PlaySnd
 		;Voice=English
trigger1 = time=50
value = 3,278+(Random%5)

[State 13300, mouth LOL]
type = Explod
trigger1 = Time = 50
anim = 2966
pos = 0,0
postype = P1
bindtime = -1
removetime = -2
ontop = 1
sprpriority = 7

[State 111, go to push transition]
type = ChangeState
trigger1 = time=150
value = 2970

;------------------------------------------------
; Goku push transition
[StateDef 2970] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2970

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0, PalFXWiz];Red
type = PalFX
Trigger1=AuthorName = "Team Z2"
trigger1 =Enemy,Name="Jiren Z2"
time = 10
add = 70,-50,-50
mul = 256,256,256
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 4500, 1];Niyjaaa scream voice
type = PlaySnd
 		;Voice=English
trigger1 = !time
value = 3,328;+(Random%6)
volume = 500
channel = 0

[State 4500, 1];power boost sound
type = PlaySnd
trigger1 = !time
value = 2970,0

[State 2201, helper]; Background lines
type = Helper
trigger1 = !time
pos = -640, -480
postype = back
stateno = 2942
helpertype = normal
name = "horizontal_lines_BG"
id = 2942
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 4
size.xscale = 5
size.yscale= 5

[State 111, go to push loop]
type = ChangeState
trigger1 = !animtime
value = 2975

;------------------------------------------------
; Goku push loop
[StateDef 2975] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2975

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0, PalFXWiz];Red
type = PalFX
Trigger1=AuthorName = "Team Z2"
trigger1 =Enemy,Name="Jiren Z2"
time = 10
add = 70,-50,-50
mul = 256,256,256
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 111, invisible]
type = ChangeState
trigger1 = time=60  ;80
value = 2980

;------------------------------------------------
; Goku invisible
[StateDef 2980] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 15999

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 111, remove aura]
type = removeexplod
trigger1 = !time
ID = 2956
[State 111, remove aura]
type = removeexplod
trigger1 = !time
ID = 2829
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 200, 1];Beam clash
type = PlaySnd
trigger1 = !time
value = 2480,0
channel = 5
loop = 1
volume = 300

[State 1000, Helper Genkidama advances]
type = Helper
trigger1 = time=1
helpertype = Normal
name = "Genkidama"
id = 2981
pos = 0,0
postype = p1
stateno = 2981
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 13100, Hurt]
type = TargetLifeAdd
trigger1 = enemy,anim= 2985
value = ceil(ifElse(fvar(11) * -200 > -130, -130, fvar(11) * -200))
;- ceil(250*fvar(11)) - var(21)*ceil(4*fvar(11)) - 95
kill = 1
persistent = 0

[State 13300, white screen fade]
type = Explod
trigger1 = Time = 20
anim = 2982  ;2907
ID = 2982    ;2907
postype = left
pos = 0,-50
bindtime = -1
removetime = -2
ownpal = 1
ontop = 1
sprpriority = 9
scale = 2,3
ignorehitpause = 1
facing = 1

[State 200, 1];Beam clash stop
type = StopSnd
trigger1 = time=105
channel = 5

[State 13100, Back to screen]
type = ChangeState
trigger1 = time = 180  ;105
value = 2911
ctrl = 0

;------------------------------------------------
;P2 Guard broken
[StateDef 2985] 
type = S
movetype = H
physics = N
velset = 0,0
ctrl = 0
anim = 130
sprpriority = -1

[State 13300, Goku Scale]
type = AngleDraw
trigger1 = Time>=0
scale = .68,.68
persistent=1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
ignorehitpause = 1

[State 2260, bg]
type = changeanim2
trigger1 = time=10
value = 2985

[State 3025, p2state - Genki killed fatality]
type = changestate
trigger1 = enemy,stateno=2911
trigger1 = MatchOver
value = 2990
ignorehitpause = 1

[State 801, end]
type = changestate
trigger1 = enemy,stateno=2911
value = 2915
ctrl = 0

;------------------------------------------------
;God Bind Start
[StateDef 3000] 
type = S
movetype = A
physics = N
velset = 0,0
ctrl = 0
anim = 3000
sprpriority = 2

;Palette Code
[State 5900, Apply Pal]
type =null; RemapPal
trigger1 =1
source = 1,1
dest =2,var(58)


[State 0, PlaySnd];Revert SFX
type = PlaySnd
trigger1 =!Time
value = S181,0
channel = 0

[State 0, PalFXWiz];All white
type = PalFX
trigger1 = !Time
Trigger2=!AnimTime
time = 4
add = 256,256,256
sinadd = 0,0,0,1
invertall = 0
color = 256

[State 1000, lkb]
type = Helper
helpertype = normal
trigger1 = AnimElemtime(6)=0
name = "Startup FX"
postype = P1
pos = 72,-62
ownpal = 1
stateno = 3001
id = 3001

[State 0];Weird sound
Type=PlaySnd
Trigger1=AnimElem=6
Value=s3200,0
volumescale=60

[State 0, Explod]
type = Explod
triggerall = anim = 3000
trigger1 = AnimElem=5
anim = 15999
ID = 9993999
removetime = 29
removeongethit = 1

[State 3000, superpause]
type = superpause
triggerall = anim = 3000
trigger1 = AnimElem=5
time = 29
p2defmul = 1
unhittable = 1
anim = -1
sound = s2000,0
darken = 1
movetime = 29

[State 1000, lkb]
type = Helper
helpertype = normal
trigger1 = AnimElemtime(6)=0
name = "BindHelper"
postype = P1
pos = 60,-60
ownpal = 1
stateno = 3005
id = 3005

[State 0, Super FX]
type = Explod
trigger1 = AnimElemtime(5)=0
anim = 2003
id = 2003
pos = -40,50    ;-145,52
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 8
ownpal = 1
bindtime = -1
scale = 1,1
persistent = 0

[State 0]
type = hitdef
trigger1 =Time=0
attr = S,HT
hitflag = M-
priority = 6,Hit 
sparkno = -1
p1facing = 1
p2facing = 1
hitsound=s3200,3
;p1stateno = 821
guard.dist = 0
fall = 1
getpower=0,0
givepower=0,0
fall.recover = 0
numhits = 0
id=3005

[State 0, TargetState]
type = TargetState
trigger1 = MoveHit =1
trigger1 = NumTarget(3005)
value = 3010
ignorehitpause = 1

[State 1000, Relax]
type = statetypeset
trigger1 = animelem = 8
movetype = I

[State 0, VarSet];Take away emo
type = VarSet
trigger1 =AnimElemTime(10)=0
v = 49   
value = 0

[State 0, VarSet];Take away emo
type = VarSet
trigger1 = AnimElemTime(10)=0
v = 50 
value = 0

[State 0, PlaySnd];Revert SFX
type = PlaySnd
trigger1 =AnimElemTime(10)=0
value = S181,0
channel = 0

[State 0]
Type=ChangeState
Trigger1 = Time >= 42
Trigger1=Enemy,StateNo=3010
Value=3015
Ctrl=0

[State 0];If the move whiffs
Type=ChangeState
Trigger1=!AnimTime
Value=0
Ctrl=1


;------------------------------------------------
;P2 Binded
[StateDef 3010] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=PosAdd
Trigger1=!Time&&Pos Y=0
Y=-10

[State 0, PalFXWiz];Flash Red
type = PalFX
trigger1=Time%7=0
time =1
add = 150,-50,0
mul = 256,256,256
sinadd = 256,20,0,1
invertall = 0
color = 256

[State 0]
Type=ChangeAnim2
Trigger1=!Time
Value=3010
Elem=1

[STate 0]
Type=SelfState
Trigger1=Enemy,MoveType=H
Trigger2=Enemy,StateNo!=[3000,3025]
Value=5030
Ctrl=0
;------------------------------------------------
;Goku holds blast
[StateDef 3015] 
type = A
movetype = A
physics = N
facep2=1
velset = 0,0
ctrl = 0
sprpriority = 2
anim=3015


[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(9993000)
Trigger1=!Time
anim = 15999
ID = 9993000
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 0

[State 200, BGPalFX]
type = BGPalFX
trigger1 = 1
time = 1
add	= -100,-100,-100
;mul	= 256,100,100
mul	= 100,100,256
invertall = 0
color = 256

[State 0]
Type=NotHitBy
Trigger1=1
Value=SCA
Time=1

[State 0];Woosh
Type=PlaySnd
Trigger1=AnimElem=5
trigger2=animelem=7
Value=s0,2
persistent=1

[State 17100, Teleport Sound]
type = PlaySnd
trigger1 = AnimElem=2
value = 2302, 0
persistent = 0


[State 0];Go back
Type=PosAdd
Trigger1=AnimElemTime(5)=0
X=-120

[State 1000, lkb]
type = Helper
helpertype = normal
trigger1 = AnimElemtime(5)=0
name = "SSG Blast"
postype = P1
pos = -53,-134
ownpal = 1
stateno = 3016
id = 3016

[State 1000, lkb]
type = Helper
helpertype = normal
trigger1 = AnimElemtime(5)=0
name = "SSG Aura"
postype = P1
pos = 0,0
ownpal = 1
stateno = 3230
id = 3230

[State 0]
Type=ChangeState
Trigger1=Time=100
Value=3020
Ctrl=0

;------------------------------------------------
;Goku flys forward
[StateDef 3020] 
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 2
anim=3020


[State 0]
Type=NotHitBy
Trigger1=1
Value=SCA
Time=1

[State 0];Woosh
Type=PlaySnd
Trigger1=!Time
Value=s3200,2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0]
Type=VelSet
Trigger1=!time
X=30

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = MoveContact
id =3017
ignorehitpause=1

[State 0, Explod];Impact
type = Explod
trigger1=NumExplod(3019)=0
trigger1 =MoveHit=2
anim = 3019
ID = 3019
pos =120,-80
postype = p1  ;p2,front,back,left,right
bindtime = 1
removetime = -2
sprpriority = 4
ontop = 1
ownpal = 1
persistent=0
ignorehitpause=1

[State 0, Explod];Impact
type = Explod
trigger1=NumExplod(3021)=0
trigger1 =MoveHit=1
anim = 3021
ID = 3021
pos =120,-80
postype = p1  ;p2,front,back,left,right
bindtime = 1
removetime = -2
sprpriority = 4
ontop = 1
ownpal = 1
persistent=0
;ignorehitpause=1

[State 250, 2]
type = HitDef
TriggerAll = Var(50) < 1400
trigger1 = !MoveContact
attr = A, HA
animtype  = Hard
damage = Ceil(IfElse(fvar(11) * 200 < 90, 90, fvar(11) * 200)), 0
;Ceil(IfElse(fvar(11) * 20 < 7, 7, fvar(11) * 20)), 0
;20, 0
priority = 6, Hit
guardflag = MA
pausetime = IfElse(Target,IsHelper=1,0,15),IfElse(Target,IsHelper=1,0,20)
sparkno =s3018
guard.sparkno = -1
sparkxy = -15,-90
hitsound   = s3200,4
;guardsound = S6,1
ground.type = high
ground.slidetime = 15
ground.hittime = 20
ground.velocity = -5,-8
air.velocity = -4,-4
air.animtype = back
fall=1
air.fall=1
fall.recover=0
yaccel = 0.5
givepower=0,0
getpower=0,0
envshake.time = 20
envshake.freq = 80
envshake.ampl = 6
p2facing = 1
id = 3020

[State 250, 2]
type = HitDef
TriggerAll = Var(50) >= 1400 && Var(50) < 2100 
trigger1 = !MoveContact
attr = A, HA
animtype  = Hard
damage = Ceil(IfElse(fvar(11) * 260 < 90, 90, fvar(11) * 260)), 0
;Ceil(IfElse(fvar(11) * 20 < 7, 7, fvar(11) * 20)), 0
;20, 0
priority = 6, Hit
guardflag = MA
pausetime = IfElse(Target,IsHelper=1,0,15),IfElse(Target,IsHelper=1,0,20)
sparkno =s3018
guard.sparkno = -1
sparkxy = -15,-90
hitsound   = s3200,4
;guardsound = S6,1
ground.type = high
ground.slidetime = 15
ground.hittime = 20
ground.velocity = -5,-8
air.velocity = -4,-4
air.animtype = back
fall=1
air.fall=1
fall.recover=0
yaccel = 0.5
givepower=0,0
getpower=0,0
envshake.time = 20
envshake.freq = 80
envshake.ampl = 6
p2facing = 1
id = 3020

[State 250, 2]
type = HitDef
TriggerAll = Var(50) >= 2100
trigger1 = !MoveContact
attr = A, HA
animtype  = Hard
damage = Ceil(IfElse(fvar(11) * 320 < 90, 90, fvar(11) *  320)), 0
;Ceil(IfElse(fvar(11) * 20 < 7, 7, fvar(11) * 20)), 0
;20, 0
priority = 6, Hit
guardflag = MA
pausetime = IfElse(Target,IsHelper=1,0,15),IfElse(Target,IsHelper=1,0,20)
sparkno =s3018
guard.sparkno = -1
sparkxy = -15,-90
hitsound   = s3200,4
;guardsound = S6,1
ground.type = high
ground.slidetime = 15
ground.hittime = 20
ground.velocity = -5,-8
air.velocity = -4,-4
air.animtype = back
fall=1
air.fall=1
fall.recover=0
yaccel = 0.5
givepower=0,0
getpower=0,0
envshake.time = 20
envshake.freq = 80
envshake.ampl = 6
p2facing = 1
id = 3020

[State 0, BGPalFX];Darken Screen
type = BGPalFX
trigger1 = MoveHit<2
time = 4
mul = 0,0,0
ignorehitpause = 1

[State 0]
Type=ChangeState
Trigger1=MoveHit=1
Trigger1=NumTarget(3020)
Trigger1=Target,IsHelper=0
Trigger1=StateNo!=3021
Value=3021 

;Jump after GB hit
[Statedef 3021]
Type=A
MoveType=A
Physics=A
Ctrl=0
VelSet=0,0
Anim=41


[State 0]
Type=ChangeAnim
Trigger1=Vel Y>0&&Anim!=44
Value=44

[State 0];After the hit is up, go up
Type=VelSet
trigger1=!Time
Y=-8

;Palette Code
[State 5900, Apply Pal]
type = RemapPal
trigger1 =!Time
source = 1,1
dest =1,var(58)

[State 0, VarSet];Take away emo
type = VarSet
trigger1 =!Time
v = 49   
value = 0

[State 0, VarSet];Take away emo
type = VarSet
trigger1 =!Time
v = 50 
value = 0

[State 0, PlaySnd];Revert SFX
type = PlaySnd
trigger1 =!Time
value = S181,0
channel = 0

[State 0, PalFXWiz];All white
type = PalFX
trigger1 =!Time
time = 10
add = 256,256,256
invertall = 0
color = 256
persistent=0
ignorehitpause=1

[State 100, jump SND]
type = playsnd
trigger1 =!Time
value = 40,1
persistent=0


[State 0];Landing
Type=ChangeState
Trigger1=Pos Y>=0&&Vel Y>0
Value=52
Ctrl=0

;------------------------------------------------
;P2 hit by Blast
[StateDef 3025] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=PosSet
Trigger1=!Time
Y=0

[State 0]
Type=ChangeAnim2
Trigger1=!Time
Value=3025
Elem=1

;------------------------------------------------
;1 Inch Punch Startup
[StateDef 3200] 
type = S
movetype = A
physics = N
anim=3100
velset = 0,0
ctrl = 0
sprpriority = 1


[State 0]
Type=PosAdd
Trigger1=!Time&&FrontEdgeDist < 200
X=-100

[State 0, RemapPal]
type = RemapPal
trigger1 =1
source = 1,1
dest = 2,Var(58)

[State 810, bind 1]
type = targetbind
trigger1 = !Time
pos = 65,0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=HitAdd
Trigger1=AnimElemTime(5)=0
Value=1

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(5)=0
anim = 1207
ID = 1207
pos = -40,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = 1,1
sprpriority = 1
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(4)=32
anim = 3150
ID = 3150
pos = 108,-62
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =.8,.8
sprpriority = 5
ontop = 0
ownpal = 1
removeongethit = 1


[State 0, Explod];fx cont
type = Explod
trigger1 =  AnimElemTime(4)=52
anim = 3151
ID = 3151
pos = 108,-62
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =.8,.8
sprpriority = 5
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod];Hit spark
type = Explod
trigger1 =  AnimElemTime(5)=0
anim = 3019
ID = 3019
pos = 70,-64
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =1.2,1.2
sprpriority = 6
ontop = 0
ownpal = 1
removeongethit = 1

[State 1000, shake]
type = EnvShake
trigger1 = AnimElemTime(5)<0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.02*time

[State 1000, shake]
type = EnvShake
trigger1 = AnimElemTime(5)=0
time=15
freq=130
ampl=8

[State 0]
Type=null;PlaySND
Trigger1=!Time
Value=193,1
volumescale=200

[State 0]
Type=PlaySND
Trigger1=AnimelemTime(5)=0
Value=3100,0
[State 0]
Type=PlaySND
Trigger1=AnimelemTime(5)=1
Value=2604,0

[State 0]
Type=RemoveExplod
Trigger1=AnimElemTime(5)>1
Trigger1=Enemy,Pos X!=[-480,480]
Trigger2 = Time > 90
Id=-1

[State 0]
Type=ChangeState
Trigger1=AnimElemTime(5)>1
;Trigger1=Enemy,Pos X!=[-480,480]
Trigger1 = Time > 90
Value=3210
;------------------------------------------------
;P2 1 Inch Punch
[StateDef 3205] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=ScreenBound
Trigger1=1
Value=0
MoveCamera=0,0

[State 0]
Type=ChangeAnim2
Trigger1=!Time
Value=2520

[State 0];Change to flying back anim when goku reaches the right frame
Type=ChangeAnim2
Trigger1=Enemy,StateNo=3200
Trigger1=Enemy,AnimElem=5
Value=2985

[State 0];if you are in the flying back anim, you should be flying back
Type=VelSet
Trigger1=Anim=2985
X=-24

[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3210
Value=3215
Ctrl=0
;------------------------------------------------
;1 Inch Punch 2nd Hit
[StateDef 3210] 
type = S
movetype = A
physics = N
anim=3100
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=HitAdd
Trigger1=!Time
Value=-1
[State 0]
Type=HitAdd
Trigger1=AnimElemTime(5)=0
Value=1
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=AngleDraw
Trigger1=1
Value=1
Scale=1.5,1.5

[State 0]
Type=PosAdd
Trigger1=!Time&&FrontEdgeDist < 200
X=-100

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(5)=0
anim = 1207
ID = 1207
pos = -80,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = 1.5,1.5
sprpriority = 1
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(4)=32
anim = 3150
ID = 3150
pos = 148,-92
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =1,1
sprpriority = 5
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(4)=52
anim = 3151
ID = 3151
pos = 158,-92
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =1,1
sprpriority = 5
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod];Hit spark
type = Explod
trigger1 =  AnimElemTime(5)=0
anim = 3019
ID = 3019
pos = 110,-94
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =1.6,1.6
sprpriority = 6
ontop = 0
ownpal = 1
removeongethit = 1

[State 0]
Type=RemoveExplod
Trigger1=AnimElemTime(5)>1
Trigger1=Enemy,Pos X!=[-480,480]
Id=-1

[State 0, RemapPal]
type = RemapPal
trigger1 =1
source = 1,1
dest = 2,Var(58)

[State 810, bind 1]
type = targetbind
trigger1 = !Time
pos = 95,0

[State 0]
Type=PlaySND
Trigger1=AnimelemTime(5)=0
Value=3100,0
[State 0]
Type=PlaySND
Trigger1=AnimelemTime(5)=1
Value=2604,0

[State 1000, shake]
type = EnvShake
trigger1 = AnimElemTime(5)<0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.02*time

[State 1000, shake]
type = EnvShake
trigger1 = AnimElemTime(5)=0
time=15
freq=130
ampl=8

[State 0]
Type=ChangeState
;Trigger1=Enemy,Pos X!=[-480,480]
Trigger1=AnimElemTime(5)>1
Trigger1 = Time > 90
Value=3220
;------------------------------------------------
;P2 1 Inch Punch 2nd hit
[StateDef 3215] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=AngleDraw
Trigger1=1
Value=1
Scale=1.5,1.5

[State 0]
Type=PosSet
Trigger1=!Time
Y=0

[State 0]
Type=ScreenBound
Trigger1=1
Value=0
MoveCamera=0,0

[State 0]
Type=ChangeAnim2
Trigger1=!Time
Value=2520

[State 0];Change to flying back anim when goku reaches the right frame
Type=ChangeAnim2
Trigger1=Enemy,AnimElem=5
Value=2985

[State 0];if you are in the flying back anim, you should be flying back
Type=VelSet
Trigger1=Anim=2985
X=-24

[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3220
Value=3225
Ctrl=0
;------------------------------------------------
;1 Inch Punch Final Hit
[StateDef 3220] 
type = S
movetype = A
physics = N
anim=3100
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=HitAdd
Trigger1=!Time
Value=-1
[State 0]
Type=HitAdd
Trigger1=AnimElemTime(5)=0
Value=1

[State 0]
Type=AssertSpecial
Trigger1=Pos X = [-240,240]
Flag=NoBarDisplay
Flag2=NoFG
[State 0]
Type=AssertSpecial
Trigger1=Pos X = [-240,240]
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 =  AnimElemTime(5)=0
value = ceil(ifElse(fvar(11) * -200 > -100, -100, fvar(11) * -200))
ID = -1
kill = 1
absolute = 0

[State 0]
Type=AngleDraw
Trigger1=1
Value=1
Scale=.7,.7

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(5)=0
anim = 1207
ID = 1207
pos = -40,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale = .7,.7
sprpriority = 1
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(4)=32
anim = 3150
ID = 3150
pos = 68,-42
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =.5,.5
sprpriority = 5
ontop = 0
ownpal = 1
removeongethit = 1


[State 0, Explod]
type = Explod
trigger1 =  AnimElemTime(4)=52
anim = 3151
ID = 3151
pos = 78,-42
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =.5,.5
sprpriority = 5
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, Explod];Hit spark
type = Explod
trigger1 =  AnimElemTime(5)=0
anim = 3019
ID = 3019
pos = 50,-49
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -2
pausemovetime = 0
scale =.8,.8
sprpriority = 6
ontop = 0
ownpal = 1
removeongethit = 1

[State 0, RemapPal]
type = RemapPal
trigger1 =1
source = 1,1
dest = 2,Var(58)

[State 810, bind 1]
type = targetbind
trigger1 = !Time
pos = 55,0

[State 1000, shake]
type = EnvShake
trigger1 = AnimElemTime(5)<0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.02*time

[State 1000, shake]
type = EnvShake
trigger1 = AnimElemTime(5)=0
time=15
freq=130
ampl=8

[State 0]
Type=PlaySND
Trigger1=AnimelemTime(5)=0
Value=3100,0
[State 0]
Type=PlaySND
Trigger1=AnimelemTime(5)=1
Value=2604,0
[State 0]
Type=ScreenBound
Trigger1=1
Value=0
MoveCamera=0,0

[State 0];Pulling a sneaky and moving Soku off screen
Type=PosSet
Trigger1=Enemy,StateNo=3235
X=-480*Facing

[State 0];Delaying when he comes back to screen, to sell impact of the punch
Type=ChangeState
Trigger1=Time>180
;Trigger2=Enemy,StateNo = 3235 && StateNo != 2912
Value=2912
Ctrl=0
;------------------------------------------------
;P2 1 Inch Punch Final hit
[StateDef 3225] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0]
Type=AngleDraw
Trigger1=1
Value=1
Scale=.7,.7

[State 0]
Type=PosSet
Trigger1=!Time
Y=0

[State 0]
Type=ScreenBound
Trigger1=1
Value=0
MoveCamera=0,0

[State 0]
Type=ChangeAnim2
Trigger1=!Time
Value=2520

[State 0];Change to flying back anim when goku reaches the right frame
Type=ChangeAnim2
Trigger1=Enemy,AnimElem=5
Value=2985

[State 0];if you are in the flying back anim, you should be flying back
Type=VelSet
Trigger1=Anim=2985
X=-24

[State 0]
Type=ChangeState
;Trigger1=Pos X!=[-480,480]
Trigger1=Time>120
;Trigger3 = Enemy,StateNo = 2912
Value=3235
Ctrl=0

;------------------------------------------------
;P2 1 Inch Punch Back to Screen
[StateDef 3235] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
facep2=1
sprpriority = 1

[State 0]
Type=PosSet
Trigger1=!Time
X=240*Facing
Y=-20

[State 0]
Type=VelSet
Trigger1=!Time
X=-6

[State 0]
Type=VelAdd
Trigger1=Time>0
Y=.45

[State 0]
Type=SelfState
Trigger1=Pos Y>=0&&Vel Y>0
Value=5100

;------------------------------------------------
; P1 SMALL GENKI
[StateDef 3240] 
type = S
movetype = H
physics = N
anim=3240
velset = 0,0
ctrl = 0


[State 0]
Type=RemoveExplod
Trigger1=NumExplod(2936)
Id=2936

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze


[State 3033, Snd]	;dizzy sound for p2
type = playsnd
trigger1 =Enemy,Anim=5300
value = 2522, ifelse(random < 500, 0, 1)  ;Dizzy sounds. 
persistent = 0

[State 0]
Type=PosSet
Trigger1=!Time
X = -50 * Facing
Y=-120

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=null;VelSet
Trigger1= Time=90
Trigger1=Time%2=0
X=1.5
[State 0]
Type=null;VelSet
Trigger1= Time=300
;Trigger1=Time%2=0
X=0

[State 200, charge SFX]
type = PlaySnd
trigger1 = (GameTime%20) = 0
value = 2500,1
volumescale = 10
freqmul = .9 + (random/5000.0)

[State 13300, Genkidama Ball]
type = Explod
trigger1 = !Time
anim = 2936
ID = 9992936
postype = p1
pos =-2,-110
bindtime = -1
removetime = -1
pausemovetime = -1
ontop = 0
sprpriority = -3
scale = 0.9,0.9
persistent = 0

[State 1003, Helper]
type = Helper
Trigger1=!Time
trigger2 =Time>90 && time%5=0
helpertype = Normal
name = "PerseEffect"
id = 2932
;pos = ((random%240)-120),((random%240)-120)
pos =((random%Const(Size.Ground.Front))-5),((random%Const(Size.Height))-50)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
sprpriority=-1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .02 
size.yscale = .02 
[State 1003, Helper]
type = Helper
Trigger1=!Time
trigger2 =Time>90 && time%20=0
helpertype = Normal
name = "PerseEffect"
id = 2932
pos =((random%Const(Size.Ground.Front))-5),0
;pos = 0,0;-ceil(random/10)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .04 
size.yscale = .04 

[State 0]
Type = RemoveExplod
Trigger1 = Enemy,StateNo = 3255
Id = 9992100

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
Flag2=TimerFreeze
ignorehitpause = 1



[State 0]
Type=ChangeState
Trigger1=Time = 250
Value=3260

;------------------------------------------------
;P2 LVL3 Falling
[StateDef 3245] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0
facep2=1
sprpriority = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
Flag2=TimerFreeze
ignorehitpause = 1

[State 0]
Type=ChangeAnim
Trigger1=AnimExist(5030)
Trigger1=Anim!=5030&&!Time
Value=5030
Elem=1

[State 0]
Type=ChangeAnim
Trigger1=AnimExist(5035)
Trigger1=Anim=5030&&!Animtime
Value=5035
Elem=1

[State 0]
Type=ChangeAnim
Trigger1=AnimExist(5050)
Trigger1=Anim=5035&&!Animtime
Trigger2=Anim!= 5035
Trigger2 =Anim=5030&&AnimTime = 20
Value=5050
Elem=1

[State 0]
Type=PosSet
Trigger1=!Time
X=-30 * Facing
Y=-200

[State 0]
Type=VelSet
Trigger1=!Time
X=-2

[State 0]
Type=VelAdd
Trigger1=Time>0
Y=.45

[State 0]
Type=ChangeState
Trigger1=Pos Y>=0&&Vel Y>0
Value=3255

;------------------------------------------------
;P2 LVL3 Hit Ground
[StateDef 3255] 
type = L
movetype = H
physics = N
velset = 0,0
ctrl = 0
facep2=1
sprpriority = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1
[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = globalnoshadow
Flag2=TimerFreeze
ignorehitpause = 1

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
Trigger2=Anim=5080
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
Trigger2=Anim=5080
y = 0

[State 0];HIT FLOOR
Type=ChangeAnim
Trigger1=AnimExist(5100)
Trigger1=Anim!=5100&&!Time
Value=5100
Elem=1
[State 0];BOUNCE
Type=ChangeAnim
Trigger1=AnimExist(5100)
Trigger1=Anim=5100&&!Animtime
Value=5160
Elem=1

[State 0];FALL AFTER BOUNCE
Type=ChangeAnim
Trigger1=AnimExist(5030)
Trigger1=Anim=5160&&!AnimTime
Value=5030
Elem=1
[State 0]
Type=ChangeAnim
Trigger1=AnimExist(5035)
Trigger1=Anim=5030&&!Animtime
Value=5035
Elem=1
[State 0]
Type=ChangeAnim
Trigger1=AnimExist(5050)
Trigger1=Anim=5035&&!Animtime
Trigger2=Anim!= 5035
Trigger2 =Anim=5030&&AnimTime = 20
Value=5050
Elem=1
[State 0]
Type=VelSet
Trigger1=Anim=5160&&AnimElem=1
Y=-3
[State 0]
Type=VelAdd
Trigger1=Time>10&&Time<50
Y=.45

[State 0];LIE DOWN
Type=ChangeAnim
Trigger1=Pos Y >=0 && Vel Y > 0 ;&& Time > 20
Value=5080
Elem=1
Persistent=0
[State 0];LIE DOWN
Type=ChangeAnim
Trigger1=AnimExist(5110)
Trigger1=Anim=5170&&!Animtime
Value=5080
Elem=1

[State 0];GET UP
Type=ChangeAnim
Trigger1=Anim=5080 && Time = 100
Value=5120
Elem=1
[State 0];DIZZY
Type=ChangeAnim
Trigger1=AnimExist(5300)
Trigger1=Anim=5120&&!Animtime
Value=5300
Elem=1

[State 0]
Type=null;VelSet
Trigger1=Time=190
;Trigger1=Time%2=0
X=1
[State 0]
Type=VelSet
Trigger1=Time=280
;Trigger1=Time%2=0
X=0

[State 0]
Type=null;ChangeAnim
Trigger1=Anim=5300&&Time>=200
Value=Anim
Elem=AnimElemNo(0)

[State 0]
Type=ChangeState
Trigger1=Time=220
Value=3265

;------------------------------------------------
; COPY Goku throws his HUGE genkidama COPY
[StateDef 3260] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 2940


[State 0]
Type=RemoveExplod
Trigger1=1
Id=9992936

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=PosSet
Trigger1=!Time
Y=-30

[State 0]
Type = RemoveExplod
Trigger1 = !Time
Id = 2936

[State 13300, Goku Scale]
type = null;AngleDraw
trigger1 = Time>=0
scale = .45,.45
persistent=1

[State 8000, less vibrant]
type = PalFX
trigger1 = 1
add = -15,-15,-15
color = 200
time = 1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 3001, shake]
type = EnvShake
trigger1 = time = 0
time = 150
freq = 100
ampl = 3

[State 220, snd];voice scream
type = playsnd
 		;Voice=English
trigger1 = Anim=2940 && AnimElemtime(3)=0
value = 3,245
channel = 0
volume = 255

[State 220, snd];Genkidama goes
type = playsnd
trigger1 = Anim=2940 && AnimElemtime(6)=0
value = 2940,0   ;2401,1
volume = 255

[State 13300, Genkidama Ball old]
type = RemoveExplod
trigger1 = Anim=2940 && AnimElemtime(5)=0
ID = 2936

[State 1000, Helper Genkidama]
type = Helper
trigger1 = Anim=2940 && AnimElemtime(5)=0
helpertype = Normal
name = "Genkidama"
id = 2941
pos = -20,-190
postype = p1
stateno = 2941
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999

[State 13100, go out of screen]
type = Velset
trigger1 = time=40
x = -6
y=-4
[State 2201, helper]; Background lines
type = Helper
trigger1 = !time
pos = -640, -480
postype = back
stateno = 2942
helpertype = normal
name = "horizontal_lines_BG"
id = 2942
ownpal = 1
supermovetime = 150
pausemovetime = 150
sprpriority = 4
size.xscale = 5
size.yscale= 5

[State 3001, screen]
type = Screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 13100, stop moving back]
type = Velset
trigger1 = time=150
x = 0

[State 13100, stop moving up]
type = Velset
trigger1 = time=55
y = 0
[State 200, 1];Beam clash
type = PlaySnd
trigger1 = Anim=2940 && AnimElemtime(6)=0   ;time=176
value = 2480,0
loop = 1
channel = 1
volumescale = 300

[State 200, 1];Beam clash Stop
type = StopSnd
trigger1 = time=300
channel = 1

[State 111, go back to screen]
type = ChangeState
trigger1 = Enemy,StateNo=3270 && StateNo!= 3264
value = 3264

;------------------------------------------------
; P1 invisible and tiny struggle
[StateDef 3264] 
type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
Anim=15999

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=StopSND
Trigger1=!Time
Channel=1

[State 0]
Type=RemoveExplod
Trigger1=!Time
Id=-1


[State 200, 1]
type = PlaySnd
trigger1 = !Time
value = 2480,0
loop = 1
channel = 5
volumescale = 20 + 3*(time)

;These are FX of the genkidama coming in from off screen so P2 can slap it away
[State 1000, shake]
type = EnvShake
trigger1 = !(time%4)
time=4
freq=80
ampl=4+0.04*time
[state 3250, speedlines]
type = explod
Trigger1=Enemy,StateNo = 3270
trigger1 = time = 0 
anim = 2923
ID = 2923
postype = back
pos = 160,20
bindtime = -1
supermove = 0
sprpriority = 1
facing=-1
ontop = 0
ownpal = 1
persistent=0
ignorehitpause = 1
removetime = -1
[state 0]	;genkidama
type = explod
Trigger1=Enemy,StateNo = 3270
trigger1 = time = 0 
anim = 2936
id = 2936
pos = -200,90
bindtime = 1
sprpriority = 6
ownpal = 1
scale=2,2
PosType=Back
Vel=1.5,0
removetime = -1
persistent = 0
ignorehitpause = 1

[State 0]	;speedlines
Type=RemoveExplod
Trigger1=Time=140
Id=2923
[State 0]	;genkidama
Type=RemoveExplod
Trigger1=Time=140
Id=2936
;tiny SB struggle after p2 knocks the bomb away
[state 0]
type = explod
Trigger1=Time=140
anim = 3245
ID =3245
postype = Back
pos = Floor(GameWidth/2),210
bindtime = -1
supermove = 0
sprpriority = 1
facing=1
SprPriority=4
ontop = 0
ownpal = 1
persistent=0
ignorehitpause = 1
removetime = -1

[State 220, snd];Genkidama goes
type = playsnd
trigger1 = Time=140
value = 2940,0   ;2401,1
volumescale = 60
[State 0];HitSpark FX
Type=Explod
trigger1 = Time=140
Anim=7030
Id=7030
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=.5,.5
RemoveTime=-2
pos =210,180
PosType=Back
OwnPal=1
SprPriority=2
OnTop=1
[State 0];PunchySFX
Type=PlaySND
trigger1 = Time=140
Value=2400,4

[State 13300, Genkidama Ball coming back at goku]
type = Explod
trigger1 = Time=140 && NumExplod(2936)=0
anim = 2936
ID = 2936
postype = Back
pos =190,160
vel = -0.6,-0.6
bindtime = 1
removetime = -1
pausemovetime = 99999
ontop = 1
sprpriority = 1
scale = 0.6,0.6
persistent = 0

;"Oh No!"
[State 0]
Type=null;PlaySND
Trigger1=Time=160
Value=s11,16

;Change to goku struggling to hold SB
[State 0]
Type=ChangeState
Trigger1=Time=280&&StateNo!=3275
Value=3275
Ctrl=0
;------------------------------------------------
; P2 invisible and waiting
[StateDef 3265] 
type = S
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0]
Type=HitAdd
Trigger1=Enemy,StateNo=3275
Trigger1=Enemy,Time>=10&&Enemy,Time<120
Trigger1=Time%5=0
Value=Time-120

[State 13200, Anim]
type = ChangeAnim2
Trigger1=PrevStateNo!=3270
trigger1 = Time = 0
Trigger2=Enemy,StateNo  =3275
value = 15999

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0


;change state after goku throws the bomb
[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3260
Trigger1=Time>=130 && StateNo!= 3270
Value=3270
Ctrl=0

;have p2 change to the end of their FA and pause on the last frame
;**TO-DO** have a non-Z2 anim
[State 0]
Type=ChangeAnim
Trigger1=AuthorName = "Team Z2" && SelfAnimExist(1301)
Trigger1=!Time&&PrevStateNo = 3270
Value=1301
[State 0]
Type=ChangeAnim
Trigger1=Anim=1301&&!AnimTime
Value=1301
Elem=AnimElemNo(-1)

[State 0]
Type=PosSet
Trigger1=!Time&&PrevStateNo = 3270
X=-120 * Facing
Y=0

[State 0]
Type=AngleDraw
Trigger1=PrevStateNo = 3270
Scale=0.1,0.1


;change state to trying to hit goku
[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3280&&StateNo!= 3285
Value=3285
Ctrl=0
;------------------------------------------------
;P2 LVL3 Charge FA
[StateDef 3270] 
type = S
movetype = H
physics = N
velset = 0,0
ctrl = 0
facep2=1
sprpriority = 1


;Start the state in the dizzy anim to give continuity to the previous anims
[State 0]
Type=ChangeAnim
Trigger1=!Time&&Anim!=5300
Value=5300

;have p2 sort of flinch to snap out of being dizzy cuz there's a large genkidama coming at them
[State 0]
Type=ChangeAnim
Trigger1=Anim=5300
Trigger1=Time=60&&Anim!=5000
Value=5000
[State 0]
Type=ChangeAnim2
Trigger1=Anim=5000&&!AnimTime
Value=5005

;have p2 start their FA anim
;**TO-DO** have a non-Z2 anim
[State 0]
Type=ChangeAnim
Trigger1=Name = "TenShinHan Z2"
Trigger1=AuthorName = "Team Z2" && SelfAnimExist(1500)
Trigger1=Anim=5005&&AnimElemTime(2)=5
Value=1500

[State 0]
Type=ChangeAnim
Trigger1=Name = "TenShinHan Z2"
Trigger1=AuthorName = "Team Z2" && SelfAnimExist(1501)
Trigger1=Time=130
Value=1501

[State 0]
Type=ChangeAnim
Trigger1=Name != "TenShinHan Z2"
Trigger1=AuthorName = "Team Z2" && SelfAnimExist(1300)
Trigger1=Anim=5005&&AnimElemTime(2)=5
Value=1300

[State 0]
Type=ChangeAnim
Trigger1=Name != "TenShinHan Z2"
Trigger1=AuthorName = "Team Z2" && SelfAnimExist(1301)
Trigger1=Time=130
Value=1301

[State 0]
Type=ChangeAnim
Trigger1=AuthorName != "Team Z2" && SelfAnimExist(1300)=0
Trigger1=Anim=5005&&AnimElemTime(2)=5
Value=130
;change state to tiny SB struggle
[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3264
Trigger1=Time>=140 && StateNo!= 3265
Value=3265
Ctrl=0

;------------------------------------------------
; Goku cant hold it!!
[StateDef 3275] 
type = A
movetype = A
physics = N
velset = 0,0
ctrl = 0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=RemoveExplod
Trigger1=!Time
Id=-1
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze
;Goku is struggling
[State 0]
Type=ChangeAnim
Trigger1=!Time
Value=2940
Elem=26

[State 1000, shake]
type = EnvShake
trigger1 = !(time%4) && Time < 200
time=4
freq=80
ampl=4+0.04*time
[State 0]
Type=PosSet
Trigger1=!Time
X=-60*Facing
Y=-100

;Fade to white
[State 0]
type = Explod
trigger1 = Time=20
anim = 2996
ID = 2996
postype = Left
pos =Floor(GameWidth/2),Floor(GameHeight/2)
bindtime = -1
Scale=2,2
removetime = -2
pausemovetime = 0
OwnPal=1
ontop = 1
sprpriority = 7
persistent = 0

[State 0]
Type=StopSND
Trigger1=Time=150
Channel=5

;Fake Hits
[State 0];HitSpark FX
Type=Explod
Trigger1=Time>=10&&Time<120
Trigger1=Time%5=0
Anim=7030
Id=7030
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
RemoveTime=-2
Pos=Random%400,(Random%200)
PosType=Left
OwnPal=1
SprPriority=2
OnTop=1
[State 0];PunchySFX
Type=PlaySND
Trigger1=Time>=10&&Time<120
Trigger1=Time%5=0
Value=2400,4


;Goku is falling Scene
;**TO-DO** 
;sfx to sell the falling and hitting the ground

[State 0];	Woosh
Type=PlaySND
Trigger1=Time=110
Channel=9
Value=3280,0
[State 0]
Type=StopSND
Trigger1=Time=170
Channel=9

;Falling
[State 0]
Type=ChangeAnim
Trigger1=Time=110&&Anim!=5061
Value=5061
[State 0]
Type=PosSet
Trigger1=Time=110
X=-60*Facing
Y=-100
[state 0]
Type=PosAdd
Trigger1=Time>=110&&Time<170
;Trigger1=Time%2=0
Y=1
[State 0]
Type=PosSet
Trigger1=Anim=5080
Y=0

;color all black
[State 0]
Type=PalFX
Trigger1=Time>=110
Time=1
Mul=0,0,0
Color=0
[State 1000, shake]
type = EnvShake
trigger1 =Time<110&& !(time%4)
time=4
freq=80
ampl=2+0.02*time
[state 3250, speedlines]
type = explod
Trigger1=Time=110
anim = 2773
ID = 2773
postype = back
pos = 200,0
bindtime = -1
supermove = 0
sprpriority = -1
facing=-1
ontop = 0
ownpal = 0
persistent=0
ignorehitpause = 1
removetime = -1
[state 3250, speedlines]
type = explod
Trigger1=Time=110
anim = 2773
ID = 2773
postype = back
pos = 240,0
bindtime = -1
supermove = 0
sprpriority = -1
facing=1
ontop = 0
ownpal = 0
persistent=0
ignorehitpause = 1
removetime = -1
[State 0]
Type=RemoveExplod
Trigger1=Time=170
Id=2773

;white bg into fade out
[State 0]
type =null;Explod
trigger1 = Time=230
anim = 2997
ID = 2997
postype = Left
pos =Floor(GameWidth/2),Floor(GameHeight/2)
bindtime = -1
Scale=2,2
removetime = -2
pausemovetime = 0
OwnPal=1
ontop = 0
sprpriority = -3
persistent = 0

[State 0];	Hit the ground
Type=PlaySND
Trigger1=Time=170
Value=15000,1
Channel=5
VolumeScale=70
[State 0]
Type=ChangeAnim
Trigger1=Time=170&&Anim!=5080
Value=5080

[State 0];	Taking steps
Type=null;PlaySND
Trigger1=Time=490
Trigger2=Time=550
Value=0,50
VolumeScale=100
[State 0];	Hurt
Type=null;PlaySND
Trigger1=Time=530
Value=3280,2
Channel=0
VolumeScale=70
[State 0]
Type=ChangeState
Trigger1=Time>=200&&StateNo!=3280
Value=3280


;==================================================================
;		FX for p2 in the next state
[State 0];Landing
Type=Explod
Trigger1=Enemy,Anim=47&&Enemy,AnimElem=1
Anim=17100
Id=17100
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
RemoveTime=-2
Pos=0,0
PosType=P2
OwnPal=1
SprPriority=-2
OnTop=0
;------------------------------------------------
;Kachi-Daze Start
[StateDef 3280] 
type = A
movetype = A
physics = N
velset = 0,0
ctrl = 0

[State 0]
Type=TargetState
Trigger1=!Time
Value=3285
Id=-1

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=ChangeAnim
Trigger1=Time<40
Value=3280
Elem=1

[State 0]
Type=RemoveExplod
Trigger1=!Time
Id=2997

[State 0]
Type=PosSet
Trigger1=!Time
X=0
Y=-20

[State 0];	Hurt
Type=null;PlaySND
Trigger1=!Time
Value=3280,3
Channel=0
VolumeScale=70

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze


[State 0];UI transform
Type=PlaySND
Trigger1=AnimElemTime(1)=5
Value=3405,0
channel=1
volumescale=30
;Fx 1
[State 0]
type = Explod
trigger1 = AnimElemTime(1)=5&&NumExplod(3281)=0
anim = 3281
ID = 3281
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -2
pausemovetime = 0
OwnPal=1
sprpriority = 3
persistent = 0
;Fx 2
[State 0]
type = Explod
trigger1 = AnimElem=3&&NumExplod(3282)=0
anim = 3282
ID = 3282
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -2
pausemovetime = 0
OwnPal=1
sprpriority = -1
persistent = 0
;Fx 3
[State 0]
type = Explod
trigger1 = AnimElem=3&&NumExplod(3283)=0
anim = 3283
ID = 3283
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -2
pausemovetime = 0
OwnPal=1
sprpriority = -1
persistent = 0
[State 0]
Type=ModifyExplod
Trigger1=Animelem=8
SprPriority=3
Id=3283
;Fx 4
[State 0]
type = Explod
trigger1 = Time=134&&NumExplod(3284)=0
anim = 3284
ID = 3284
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = 106
pausemovetime = 0
OwnPal=1
sprpriority = -1
persistent = 0
;Fx 5
[State 0]
type = Explod
trigger1 = Time=134&&NumExplod(3287)=0
anim = 3287
ID = 3287
postype = P1
pos =0,-10
bindtime = -1
Scale=1,1
removetime = -2
pausemovetime = 0
OwnPal=1
sprpriority = 4
persistent = 0
[State 0]
Type=null;ChangeAnim
Trigger1=!Time
Value=3280
Elem=1
[State 0]
Type=EnvShake
Trigger1=Anim=3280&&AnimElem=6
Time=20
Freq=110
Ampl=7

[State 0]
Type=StopSND
Trigger1=Time=150
Channel=1
[State 0];UI spectacle
Type=PlaySND
Trigger1=Time=134
Value=3405,1
VolumeScale=30
[State 0];		Oozaru yelll
Type=PlaySND
Trigger1=Time=40
Value=3285,4
Channel=0
VolumeScale=120
[State 0]		;Idle Loop Start
Type=ChangeAnim
Trigger1=Time=220
Value=3285
;Fx 5
[State 0]
type = Explod
trigger1 = Time=134&&NumExplod(3285)=0
anim = 3286
ID = 3286
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = -3
persistent = 0

[State 0]
Type=ChangeState
;Trigger1=P2StateNo=3285
Trigger1=Time>=250 && StateNo!=3290
Value=3290
Ctrl=0

;------------------------------------------------
; P2 trying to hit Goku
[StateDef 3285] 
type = A
movetype = H
physics = N
velset = 0,0
FaceP2=1
ctrl = 0

[State 0]
Type=AssertSpecial
Trigger1=Pos X !=[-320,320]
Flag=Invisible

;so the idea is to have p2 try to do an aerial from off screen IF THEY HAVE THE ANIM NUMBER!!!!
;and goku is gonna dodge it, or else theyll just run and jab i guess
[State 0]
Type=PosSet
Trigger1=!Time
Trigger1=SelfAnimExist(640)=1
X=-350*Facing
Y=-80
[State 0]
Type=VelSet
Trigger1=SelfAnimExist(640)=1
Trigger1=Time=210
X=6
[State 0]
Type=VelAdd
Trigger1=SelfAnimExist(640)=1
Trigger1=Time>235
Y=.35

[State 0]		;Aerial
Type=ChangeAnim
Trigger1=SelfAnimExist(640)=1
Trigger1=Time<250
Value=640
Elem=1
[State 0]		;Aerial
Type=ChangeAnim
Trigger1=SelfAnimExist(640)=1
Trigger1=Anim=640&&!AnimTime
Value=44
Elem=1
[State 0]		;Landing
Type=ChangeAnim
TriggerAll=Pos Y>-20 ;&& Vel Y >0
Trigger1=Anim=44
Trigger2=Anim=640
Value=47
[State 0]
Type=VelSet
Trigger1=Anim=47
Trigger2=Anim=200
X=0
Y=0
[State 0]
Type=PosSet
Trigger1=Anim=47
Y=-20

	;non aerial version
[State 0]
Type=PosSet
Trigger1=!Time
Trigger1=SelfAnimExist(640)=0
X=-350*Facing
Y=-20
[State 0]
Type=VelSet
Trigger1=Time=240
Trigger1=SelfAnimExist(640)=0
Trigger2=Anim=100
X=5
[State 0]
Type=ChangeAnim
TriggerAll=SelfAnimExist(640)=0
Trigger1=Time=240
Trigger2=Anim=200&&!AnimTime
Value=100
[State 0]
Type=ChangeAnim
Trigger1=Anim=100&&P2BodyDist X < 50
Trigger1=SelfAnimExist(640)=0
Value=200
[State 0]
Type=Turn
Trigger1=P2BodyDist X <-15


[State 0]
Type=ChangeAnim
Trigger1=Enemy,StateNo=3300&&Enemy,Anim=3310
Trigger1=Anim!=120
Trigger1=SelfAnimExist(640)=0
Value=120
[State 0]
Type=PosSet
Trigger1=Anim=120
X=0
Y=-20
[State 0]
Type=ChangeAnim
Trigger1=Enemy,StateNo=3300&&Enemy,Anim=3310
Trigger1=Anim=120&&!AnimTime
Trigger1=SelfAnimExist(640)=0
Value=150

[State 0]
Type=ChangeState
Trigger1=SelfAnimExist(640)=0
Trigger1=Enemy,Anim=3315&&StateNo!=3305
Value=3305

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=ChangeState
Trigger1=SelfAnimExist(640)=1
Trigger1=Anim=47&&!AnimTime&&StateNo!=3295
Value=3295
Ctrl=0
;------------------------------------------------
;Dodge 1
[StateDef 3290] 
type = A
movetype = I
physics = N
velset = 0,0
ctrl = 0
SprPriority=2
Anim=3290

[State 0]
Type=null;TargetState
Trigger1=!Time
Value=3295
Id=-1

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=RemoveExplod
Trigger1=1
Id=3286

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

		
[State 0]	;aura FX 1
type = Explod
trigger1 = !Time&&NumExplod(3291)=0
anim = 3291
ID = 3291
postype = P1
pos =7,7
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = -1
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Time>=25&&NumExplod(3291)=1
Id=3291

[State 0]
Type=PlaySND
Trigger1=!Time
Value=3300,5+Random%3
[State 0]
Type=PosAdd
Trigger1=!Time
X=-20
[State 0]
Type=PosAdd
Trigger1=Time>5&&Time<15
Trigger1=Time%2=0
X=-1

[State 0]		;Dodge 2
Type=ChangeAnim
Trigger1=Time=25
Value=3295
[State 0]	;aura FX 2
type = Explod
Trigger1=Time=25&&NumExplod(3296)=0
anim = 3296
ID = 3296
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = -3
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Time>=60&&NumExplod(3296)=1
Id=3296
[State 0]
Type=PlaySND
Trigger1=Time=25
Value=3300,5+Random%3
[State 0]
Type=SprPriority
Trigger1=Time=25
Value=-2
[State 0]
Type=PosAdd
Trigger1=Time=25
X=-30
[State 0]
Type=PosAdd
Trigger1=Time>=25&&Time<45
Trigger1=Time%2=0
X=-1
[State 0]		;Dodge 3
Type=ChangeAnim
Trigger1=Time=60
Value=3290
[State 0]	;aura FX 3
type = Explod
Trigger1=Time=60&&NumExplod(3292)=0
anim = 3292
ID = 3292
postype = P1
pos =3,3
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 3
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Time>=80&&NumExplod(3292)=1
Id=3292
[State 0]
Type=PlaySND
Trigger1=Time=60
Value=3300,5+Random%3
[State 0]
Type=SprPriority
Trigger1=Time=60
Value=4
[State 0]
Type=PosAdd
Trigger1=Time=60
X=-30
[State 0]
Type=PosAdd
Trigger1=Time>=60&&Time<75
Trigger1=Time%2=0
X=-1

[State 0]		;Dodge 4 Up
Type=ChangeAnim
Trigger1=Time=80
Value=3300
[State 0]	;aura FX 4
type = Explod
Trigger1=Time=80&&NumExplod(3301)=0
anim = 3301
ID = 3301
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = -3
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Time>=92&&NumExplod(3301)=1
Id=3301
[State 0]
Type=PlaySND
Trigger1=Time=80
Value=3300,5+Random%3
[State 0]
Type=SprPriority
Trigger1=Time=80
Value=-2
[State 0]
Type=PosAdd
Trigger1=Time=80
Y=-60
[State 0]
Type=PosAdd
Trigger1=Time>=80&&Time<95
Trigger1=Time%2=0
Y=-2

[State 0]		;Dodge 5
Type=ChangeAnim
Trigger1=Time=92
Value=3305
[State 0]	;aura FX 4
type = Explod
Trigger1=Time=92&&NumExplod(3306)=0
anim = 3306
ID = 3306
postype = P1
pos =0,0
bindtime = -1
Facing=-1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 1
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Time>=104&&NumExplod(3306)=1
Id=3306
[State 0]
Type=Turn
Trigger1=Time=92
[State 0]
Type=PlaySND
Trigger1=Time=92
Value=3300,5+Random%3
[State 0]
Type=SprPriority
Trigger1=Time=92
Value=2
[State 0]
Type=PosAdd
Trigger1=Time=92
X=-160
Y=60
[State 0]
Type=PosAdd
Trigger1=Time>=92&&Time<105
Trigger1=Time%2=0
X=-2
Y=3

[State 0]
Type=ChangeState
Trigger1=Time=104&&StateNo!=3300
Value=3300
;------------------------------------------------
; P2 trying to hit Goku
[StateDef 3295] 
type = A
movetype = H
physics = N
velset = 0,0
FaceP2=1
ctrl = 0

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=PosSet
Trigger1=!Time
Y=-20

[State 0]
Type=PosAdd
Trigger1=Anim=440&&AnimElem=3
X=30

[State 0]
Type=ChangeAnim
Trigger1=SelfAnimExist(440)=1
Trigger1=!Time&&Anim!=440
Value=440
[State 0]
Type=ChangeAnim
Trigger1=Anim=440 && !AnimTime
Value=12
[State 0]
Type=ChangeAnim
Trigger1=Anim=12 && !AnimTime
Value=240

;		Charge at goku
[State 0]
Type=ChangeAnim
Trigger1=Anim=240 && !AnimTime
Trigger2=SelfAnimExist(440)=0&&!Time
Value=100
[State 0]
Type=VelSet
Trigger1=Anim=100
X=8

[State 0]
Type=VelSet
Trigger1=Anim!=100
X=0
[State 0]
Type=ChangeState
Trigger1=P2BodyDist X <-15
Value=3296

;------------------------------------------------
; P2 trying to hit Goku in air
[StateDef 3296] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=Turn
Trigger1=!Time

;			Jump after the charge
[State 0]
Type=ChangeAnim
Trigger1=!Time
Value=41
[State 0]
Type=VelSet
Trigger1=Anim=41&&AnimElem=1
X=4
Y=-5
[State 0]
Type=ChangeAnim
Trigger1=Time=5&&Anim!=600
Value=600
[State 0]
Type=VelAdd
Trigger1=Pos Y<-20
Y=.45


[State 0]
Type=ChangeAnim
Trigger1=SelfAnimExist(44)
Trigger1=Anim=600&&!AnimTime
Value=44
[State 0]
Type=VelSet
Trigger1=Anim=47
X=0
Y=0
[State 0]
Type=PosSet
Trigger1=Anim=47
Y=-20
[State 0]
Type=ChangeAnim
Trigger1=Pos Y>-20 && Vel Y>0
Trigger1=Anim!=47
Value=47
[State 0]
Type=ChangeAnim
Trigger1=Anim=47&&!AnimTime
Value=440
[State 0]
Type=ChangeAnim
Trigger1=Anim=440&&!AnimTime
Value=120
[State 0]
Type=ChangeAnim
Trigger1=Anim=120&&!AnimTime
Value=130

[State 0]
Type=ChangeState
Trigger1=Enemy,Anim=3315&&StateNo!=3305
Value=3305
;------------------------------------------------
;Dodge Part 2
[StateDef 3300] 
type = A
movetype = I
physics = N
velset = 0,0
ctrl = 0
Anim=3300

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]	;aura FX 4
type = Explod
Trigger1=!Time&&NumExplod(3301)=0
anim = 3301
ID = 3301
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = -3
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Anim!=3300&&NumExplod(3301)=1
Id=3301

[State 0]
Type=PlaySND
Trigger1=!Time
Value=3300,5+Random%3
[State 0]
Type=PosAdd
Trigger1=!Time
Y=-60
[State 0]
Type=PosAdd
Trigger1=Time>5&&Time<15
Trigger1=Time%2=0
Y=-1


		;Slow Mo Kick

[State 0];UI dodge flip kick
Type=PlaySND
Trigger1=Time=12
Value=3405,2
VolumeScale=200
[State 0]
Type=Turn
Trigger1=Time=12
[State 0]
Type=ChangeAnim
Trigger1=Time=12&&Anim!=3310
Value=3310
[State 0]	;aura FX 5
type = Explod
Trigger1=Time=12&&NumExplod(3311)=0
anim = 3311
ID = 3311
postype = P1
pos =15,-5
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 1
persistent = 0
[State 0]
Type=RemoveExplod
Trigger1=Time>=52&&NumExplod(3311)=1
Id=3311
[State 0]
Type=PosSet
Trigger1=Time=12
X=-100*Facing
Y=-40
[State 0]
Type=null;PosAdd
Trigger1=Time>5&&Time<15
Trigger1=Time%2=0
Y=-1

[State 0]
Type=ChangeAnim
Trigger1=Time=52&&Anim!=3315
Value=3315
[State 0]	;aura FX 6
type = Explod
Trigger1=Time=52&&NumExplod(3316)=0
anim = 3316
ID = 3316
postype = P1
pos =4,5
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 1
persistent = 0
[State 0];UI flip kick impact
Type=PlaySND
Trigger1=Time=52
Value=3405,3
VolumeScale=200
[State 0]
Type=HitAdd
;TriggerAll=Time<40;&&Anim=3320
Trigger1=Time=52
Value=1
[State 0];HitSpark FX
Type=Explod
Trigger1=Time=52
Anim=7020
Id=7020
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=1,1
RemoveTime=-2
pos =73,-57
PosType=P1
OwnPal=1
SprPriority=2
OnTop=1
[State 0]
Type=RemoveExplod
Trigger1=Time>=100&&NumExplod(3316)=1
Id=3316

[State 0]
Type=ChangeState
Trigger1=Time>=100&&StateNo!=3310
Value=3310
;------------------------------------------------
; P2 wall slam
[StateDef 3305] 
type = S
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0]
Type=PosSet
Trigger1=!Time
X=0
Y=-40

[State 0]
Type=StateTypeSet
Trigger1=Anim=5051
StateType=A
[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

;so the idea is that p2 is getting hit so hard they bounce off the back wall, like a full charge FA. 
;this is just a fake version of that

[State 0]
Type=Turn
Trigger1=!Time&&PrevStateNo!=3285
[state 1321, envshake]
type =EnvShake
trigger1 = !Time
Trigger2=BackEdgeBodyDist <= 20
time = 15
ampl = 7
freq = 110

[State 0]
Type=VelSet
Trigger1=Time=15
X=-20
[State 0]
Type=Changeanim
Trigger1=Time<15&&Anim!=5012
Value=5012
Elem=1
[State 0]
Type=Changeanim
Trigger1=Anim=5012&&!AnimTime
Value=5017
 
	;hits the wall right here
[state 1321, changeanim]
type = changeanim
trigger1 = BackEdgeBodyDist <= 20
value = 5030

 [State 0]
Type=ChangeAnim
TriggerAll=Enemy,StateNo!=3310
Trigger1=AnimExist(5035)
Trigger1=Anim=5030&&Animtime>=15
Value=5035
Elem=1
[State 0]
Type=ChangeAnim
TriggerAll=Enemy,StateNo!=3310
Trigger1=AnimExist(5050)
Trigger1=Anim=5035&&!Animtime
Trigger2=Anim!= 5035
Trigger2 =Anim=5030&&AnimTime = 20
Value=5050
Elem=1
[State VelSet];Move backwards
Type=VelSet
TriggerAll=Enemy,StateNo!=3310
Trigger1=Anim=5030&&AnimElem=1
X=3
Y=-4

[State 0];Gravity
Type=VelAdd
TriggerAll=Enemy,StateNo!=3310
Trigger1=Anim=[5030,5035]
Y=.25

[State 0]
Type=PosSet
Trigger1=Enemy,StateNo=3310
X=0
Y=-40
 [State 0]
Type=ChangeAnim
TriggerAll=Enemy,StateNo=3310
Trigger1=AnimExist(5030)
Trigger1=Anim!=5030
Value=5030
Elem=1

[State 0]
Type=ChangeState
Trigger1=Enemy,StateNo=3315&&StateNo!=3320
Value=3320
;Flurry Attack
[StateDef 3310]
Type=A
MoveType=A
Physics=N
Ctrl=0
Anim=3320
SprPriority=2
VelSet=0,0



[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=PosSet
TriggerAll=Time<40&&Anim=3320
Trigger1=Time%4=0
X=-80*Facing
Y=-40

[State 0]
Type=Turn
TriggerAll=Time<40&&Anim=3320
Trigger1=Time%4=0
[State 0]	;aura FX 6
type = Explod
TriggerAll=NumExplod(3321)=0
Trigger1=AnimElem=1 ;|| Anim=3320&&AnimElem=4
anim = 3321
ID = 3321
Facing=IfElse(Time%8=0,1,IfElse(Time%8=4,1,-1))
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 1
[State 0]
Type=RemoveExplod
Trigger1=Time>=40&&NumExplod(3321)=1
Id=3321

[State 0]
Type=Envshake
TriggerAll=Time<40&&Anim=3320
Trigger1=Time%4=0
Time=4
Freq=70
Ampl=4
[State 0]
Type=HitAdd
TriggerAll=Time<40&&Anim=3320
Trigger1=Time%4=0
Value=2
[State 0];PunchySFX
Type=PlaySND
TriggerAll=Time<40&&Anim=3320
Trigger1=Time%4=0
Value=5,5
volumescale=50
[State 0];HitSpark FX
Type=Explod
TriggerAll=Time<40&&Anim=3320
Trigger1=Time%4=0
Anim=7020
Id=7020
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=1,1
RemoveTime=-2
pos =Floor(GameWidth/2),Floor(GameHeight/2)
Random=30,60
PosType=Left
OwnPal=1
SprPriority=2
OnTop=1
[State 0];UI flurry attack
Type=PlaySND
Trigger1=!Time
Value=3405,4
VolumeScale=200

[State 0]
Type=ChangeState
Trigger1=Time>=40&&StateNo!=3315
Value=3315

;Launcher Kick and landing
[StateDef 3315]
Type=A
MoveType=A
Physics=N
Ctrl=0
Anim=3325
VelSet=0,0

[State 0]
Type=TargetState
Trigger1=!Time
Value=3320
Id=-1

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0];UI slow mo
Type=PlaySND
Trigger1=!Time
Value=3405,5
VolumeScale=200

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=PosSet
Trigger1=!Time
X=-80*Facing
Y=-40

[State 0]	;slow mo aura
type = Explod
TriggerAll=NumExplod(3326)=0
Trigger1=Anim=3325
anim = 3326
ID = 3326
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -2
pausemovetime = 0
OwnPal=1
sprpriority = 1
persistent = 1

[state 0]
Type=ChangeAnim
Trigger1=Time>=49&&Anim!=3330
Value=3330

[State 0]	;slow mo aura
type = Explod
TriggerAll=NumExplod(3331)=0
Trigger1=Anim=3330
anim = 3331
ID = 3331
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 1
persistent = 1
[state 0]
type=RemoveExplod
Trigger1=Time>=80&&NumExplod(3331)=1
Id=3331

[State 0]
Type=Envshake
Trigger1=Anim=3330&&AnimElem=1
Time=20
Freq=110
Ampl=7


[State 0]
Type=HitAdd
Trigger1=Anim=3330&&AnimElem=1
Value=1
[State 0];HitSpark FX
Type=Explod
Trigger1=Anim=3330&&AnimElem=1
Anim=7030
Id=7030
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=1,1
RemoveTime=-2
pos =86,-81
PosType=P1
OwnPal=1
SprPriority=2
OnTop=1
[State 0];UI impact kick
Type=PlaySND
Trigger1=Anim=3330&&AnimElem=1
Value=3405,6
VolumeScale=200

[State 0]
Type=ChangeState
Trigger1=Time>=80&&StateNo!=3335
Value=3335
;------------------------------------------------
; P2 hit off screen
[StateDef 3320] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0]
Type=PosSet
Trigger1=!Time
X=0

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 1321, changeanim]
type = changeanim
trigger1 = !Time
value = 5030

 [State 0]
Type=ChangeAnim
Trigger1=Time=50
Value=5012
Elem=1
[State 0]
Type=ChangeAnim
Trigger1=Anim=5012&&!AnimTime
Value=5012
Elem=AnimElemNo(-1)
[State 0]
Type=PosAdd
Trigger1=Time<50&&Time%4=0
Y=-.8
[State VelSet];Move backwards
Type=VelSet
Trigger1=Time=50
X=-30

[State 0]
Type=ChangeState
Trigger1=(Pos X!=[-320,320]) && StateNo!= 3325
Value=3325
;------------------------------------------------
; P2 coming back to be hit
[StateDef 3325] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0]
Type=PosSet
Trigger1=!Time
X=-360*Facing
Y=-20

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 1321, changeanim]
type = changeanim
trigger1 = !Time
value = 5012
[State 0]
Type=ChangeANim
Trigger1=Anim=5012&&!AnimTime
Value=5012
Elem=AnimElemNo(-1)

[State 0]
Type=VelSet
Trigger1=Enemy,StateNo=3340&&Time>=400
X=20

[State 0]		;failsafe to ending
Type=ChangeState
Trigger1=Enemy,StateNo=3400&&StateNo!=3405
Value=3405

;Landing and transform
[StateDef 3335]
Type=A
MoveType=A
Physics=N
Ctrl=0
Anim=3335
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=PosSet
Trigger1=!Time
X=-80*Facing
[State 0];Aura 
Type=Explod
Trigger1=Anim=3335&&NumExplod(3334)=0
Anim=3334
Id=3334
BindTime=-1
RemoveTime=-1
pos =45,5
PosType=P1
OwnPal=1
SprPriority=-2
[State 0]
Type=RemoveExplod
Trigger1=Anim=3336&&NumExplod(3334)=1
Trigger2=Anim=3335&&Pos Y>=-20 && Vel Y>0
Id=3334

[State 0]
Type=VelAdd
Trigger1=Anim=3335
Y=.65

[State 0]	;move to center stage
Type=PosAdd
Trigger1=Time<95&&Time%2=0
X=0.09*(0-Pos X*Facing)

[State 0];UI final landing
Type=PlaySND
Trigger1=Anim=3336&&AnimElem=5
Value=3405,7
VolumeScale=200

[State 0]	;buildup to transform
Type=ChangeAnim
Trigger1=Anim=3335&&Pos Y>=-20 && Vel Y>0
Value=3336
[State 0];Aura 
Type=Explod
Trigger1=Anim=3336&&NumExplod(3337)=0
Anim=3337
Id=3337
BindTime=-1
RemoveTime=-1
pos =0,0
PosType=P1
OwnPal=1
SprPriority=-2
[State 0]
Type=RemoveExplod
Trigger1=Time>=200
Id=3337
[State 0]
Type=PlaySND
Trigger1=Anim=3336&&AnimElem=1
Trigger2=Anim=3336&&AnimElem=5
Value=0,50+Random%2
Channel=4
[State 0]
Type=PosSet
Trigger1=Anim=3336
Y=-20

		;this all the FX for the MUI
[State 1000, shake]
type = EnvShake
triggerall = anim=3336&&Time>140
trigger1 = !(time%4)
time=4
freq=40
ampl=1+0.01*time

[State 0];MUI buildup
Type=PlaySND
Trigger1=Time=140
Value=3405,8
VolumeScale=200
;white bg into fade out
[State 0]
type = Explod
trigger1 = Time=140
anim = 2997
ID = 2997
postype = Left
pos =Floor(GameWidth/2),Floor(GameHeight/2)
bindtime = -1
Scale=2,2
removetime = 60
pausemovetime = 0
OwnPal=1
ontop = 0
sprpriority = -3
persistent = 0
[State 0]
Type=PalFX
Trigger1=Time=140
Time=60
Mul=0,0,0
Color=0

[State 0];MUI transform
Type=PlaySND
Trigger1=Time=200
Value=3405,9
VolumeScale=200
[State 0]	;aura sfx
type = PlaySnd
trigger1 =time=200
value = 3400,3


;Fx 5
[State 0]
type = Explod
trigger1 = Time=200&&NumExplod(3287)=0
anim = 3287
ID = 3287
postype = P1
pos =0,-10
bindtime = -1
Scale=1,1
removetime = -2
pausemovetime = 0
OwnPal=1
sprpriority = 4
persistent = 0
[State 0]
Type=ChangeAnim
Trigger1=Anim=3336&&Time>=200
Trigger1=Anim!=3340
Value=3340
[State 0]
Type=PosSet
Trigger1=Anim=3340
Y=-20
[State 0]
Type=ChangeState
Trigger1=Time>=260&&StateNo!=3340
Value=3340

;Flying after P2
[StateDef 3340]
Type=S
MoveType=A
Physics=N
Ctrl=0
Anim=3345
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=PosSet
Trigger1=!Time
Y=-20

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

 
[State 0]
type=explod
trigger1 = AnimElem=4
anim = 3346
ID = 3346
postype = p1
pos = 0,0
bindtime = 1
removetime = -2
OwnPal=1
sprpriority = -2
[State 0]
Type=VelSet
Trigger1=AnimElem=4
X=50
Y=-5
[State 1000, shake]
type = EnvShake
trigger1= AnimElem=4
time=50
freq=110
ampl=7
[State 0];MUI dash
Type=PlaySND
trigger1= AnimElem=4
Value=3405,10
VolumeScale=200
[State 4500, 1];speed SFX
type = PlaySnd
trigger1= AnimElem=4
value = 2700,1
		;flying really fast
[State 0]
Type=PosSet
Trigger1=Time=50
X=0
Y=-20
[State 0]
Type=VelSet
Trigger1=Time>=50
X=0
Y=0
[State 0]	;aura FX
type = Explod
Trigger1=Time=50&&NumExplod(3347)=0
anim = 3347
ID = 3347
Facing=1
postype = P1
pos =0,0
bindtime = -1
Scale=1,1
removetime = -1
pausemovetime = 0
OwnPal=1
sprpriority = 1

[State 1000, shake]
type = EnvShake
Trigger1=Time>=50
trigger1 = !(time%4)
time=4
freq=80
ampl=2+0.02*time
[state 3250, speedlines]
type = explod
trigger1 = time = 50
anim = 2923
ID = 2923
postype = back
pos = 120,20
bindtime = -1
supermove = 0
sprpriority = -3
facing=1
ontop = 0
ownpal = 1
persistent=0
ignorehitpause = 1
removetime = -1
[state 3250, speedlines]
type = explod
trigger1 = time = 50
anim = 2923
ID = 2923
postype = back
pos = 160,20
bindtime = -1
supermove = 0
sprpriority = -3
facing=1
ontop = 0
ownpal = 1
persistent=0
ignorehitpause = 1
removetime = -1

[State 0]
Type=RemoveExplod
Trigger1=Time>50&&P2BodyDist X <-15&&StateNo!=3400
Trigger2=Time>=300&&StateNo!=3400
Id=2923

[State 0]
Type=ChangeState
Trigger1=Time>50&&P2BodyDist X <-15&&StateNo!=3400
Trigger2=Time>=300&&StateNo!=3400
Value=3400


;Big Sprites Start
[StateDef 3400]
Type=S
MoveType=A
Physics=N
Ctrl=0
Anim=3400
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=RemoveExplod
Trigger1=1
Id=3347

[State 0];MUI transform
Type=PlaySND
Trigger1=!Time
Value=3405,11
VolumeScale=200

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0


[State 0]
Type=HitAdd
Trigger1=!Time
Value=1

[State 0]
Type=PosSet
Trigger1=!Time
X=-30*Facing
Y=-5

[State 0]
Type=PosAdd
Trigger1=Time<10
X=3
Y=1

[State 0]
Type=PosAdd
Trigger1=Time>=10
Trigger1=Time%2=0
X=.5
Y=.1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0];HitSpark FX
Type=Explod
Trigger1=Time>=70&&Time<130
Trigger1=Time%4=0
Trigger2=!Time
Anim=7010
Id=7010
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=1,1
RemoveTime=-2
pos =0,0
Random=30,20
PosType=P2
OwnPal=1
SprPriority=2
OnTop=1

[State 0]
Type=HitAdd
Trigger1=Time>=70&&Time<130
Trigger1=Time%4=0
Value=1

[State 0];PunchySFX
Type=PlaySND
Trigger1=Time>=70&&Time<130
Trigger1=Time%4=0
Trigger2=!Time
Value=5,5

[State 0];flashing
Type=Explod
Trigger1=Time>=70&&Time<130
Trigger1=Time%8=0
Anim=2997
Id=2997
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=2,2
RemoveTime=4
pos =Floor(GameWidth/2),Floor(GameHeight/2)
PosType=Left
OwnPal=1
SprPriority=-4

[State 17100, Teleport Sound]
type = PlaySnd
trigger1 = Time=130
value = 2302, 0


[State 0]
Type=ChangeAnim
Trigger1=Time>=130&&Anim!=3410
Value=3410

[State 0]
Type=ChangeState
Trigger1=Anim=3410&&!AnimTime&&StateNo!=3410
Value=3410
;------------------------------------------------
; P2 hit by big sprites
[StateDef 3405] 
type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0]
Type=AngleDraw
Trigger1=1
Scale=.5,.5

[State 0]
Type=PosSet
Trigger1=!Time
X=80*Facing
Y=-40

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0


[State 0]
Type=EnvShake
Trigger1=Anim=3405&&AnimElemTime(2)>=0
Trigger1=Time%4=0
Time=4
Freq=50
Ampl=4

;randomize positions!!!
[State 0]
Type=Turn
Trigger1=Anim=3405&&AnimElemTime(2)>=0
Trigger1=Time%4=0
[State 0]
Type=PosSet
Trigger1=Anim=3405&&AnimElemTime(2)>=0
Trigger1=Time%4=0
Y=-35+(Random%16 * -1)

[State 0]
Type=ChangeAnim2
Trigger1=!Time&&Anim!=3405
Value=3405

[state 0]
Type=Turn
Trigger1=Time=130&&Facing=Enemy,Facing


[State 0]
Type=PosAdd
Trigger1=Time>=130&&Time<200
Trigger1=Time%20
X=-.3
Y=-.3
[State 0]
Type=ChangeAnim
Trigger1=Anim=3405&&Time>=130
Trigger1=Anim!=5012
Value=5012
[State 0]
Type=ChangeAnim
Trigger1=Anim=5012&&!AnimTime
Value=5012
Elem=AnimElemNo(-1)

[State 0]
Type=AssertSpecial
Trigger1=Time>220
Flag=Invisible


[State 0]	;killed
type = changestate
trigger1 = enemy,stateno=3425
trigger1 = MatchOver&&Alive=0
value = 3999
ignorehitpause = 1

[State 0]	;back to stage
Type=ChangeState
Trigger1=!MatchOver
Trigger1=Time>=750&&StateNo!=2915
Value=2915
;Big Sprites KHH Start
[StateDef 3410]
Type=S
MoveType=A
Physics=N
Ctrl=0
Anim=3415
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0];FX mouth
Type=Explod
TriggerAll=NumExplod(3419)=0
Trigger1=!Time
Trigger2=Time=40
Trigger3=Time=80
Anim=3419
Id=3419
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=1,1
RemoveTime=35
pos =0,0
PosType=P1
OwnPal=0
OnTop=1
[State 0];FX mouth
Type=Explod
TriggerAll=NumExplod(3419)=0
Trigger1=Time=120
Anim=3419
Id=3419
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=1,1
RemoveTime=-1
pos =0,0
PosType=P1
OwnPal=0
OnTop=1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 200, Kmh charge long]
type = PlaySnd
trigger1 = !Time
value = 2400,1
Channel=4

[State 200, 1];charge power-up sound
type = PlaySnd
trigger1 = !Time
value = 2400,20
channel = 5

[State 0]
Type=AngleDraw
Trigger1=Time<75
Scale=.2,.2
[State 0]
Type=PosSet
Trigger1=!Time
X=-100*Facing
Y=-100

[State 200, Kmh charge ]
type = PlaySnd
trigger1 = !Time
value = 3,307
Channel=0

[State 200, Kmh charge ]
type = PlaySnd
trigger1 = Time=75
value = 3400,0
[State 0]
Type=PosSet
Trigger1=Time=75
X=0
Y=0

[State 0]
type = Helper
trigger1 = !NumHelper(9993416)&&Time>=75
stateNo = 3416
ID = 9993416
name = "UI KHH"
posType = P1
Pos=0,0
ignoreHitPause = 1

[State 0]
Type=ChangeState
Trigger1=Time=200&&StateNo!=3415
Value=3415

;Big Sprites KHH Fire 1
[StateDef 3415]
Type=S
MoveType=A
Physics=N
Ctrl=0
Anim=3420
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=RemoveExplod
Trigger1=1
Id=3419

[State 0]
Type=PosSet
Trigger1=!Time
X=0
Y=0

[State 0]
Type=HitAdd
Trigger1=AnimElemTime(4)>=0&&Time%4
Value=1

[State 0];FX BG
Type=Explod
Trigger1=AnimElem=4
Anim=3421
Id=3421
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=1,1
RemoveTime=-1
pos =0,0;Floor(GameWidth/2),Floor(GameHeight/2)
PosType=P1;LEft
OwnPal=1
OnTop=0

[State 0];FX
Type=Explod
Trigger1=!Time&&NumExplod(3417)=0
Anim=3417
Id=3417
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=1,1
RemoveTime=-2
pos =0,0
PosType=P1
OwnPal=1
OnTop=0
[State 0]
Type=ModifyExplod
Trigger1=Anim=3
OnTop=1
Id=3417
[State 0]
Type=StopSND
Trigger1=AnimElem=4
Channel=4
[State 0]
Type=StopSND
Trigger1=AnimElem=4
Channel=5

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 0]	;HAAAA
Type=PlaySND
Trigger1=AnimElem=4
Value=3410,1
Channel=0

[State 200, Kmh charge long]
type = PlaySnd
trigger1 =AnimElem=4
value = 3400,1
[State 200, Kmh charge long]
type = PlaySnd
trigger1 = AnimElem=4
value = 3410,0
Channel=4
[State 0]
Type=EnvShake
Trigger1=AnimElem=4
Time=30
Freq=110
Ampl=7

[State 0];FX
Type=Explod
Trigger1=AnimElem=4
Anim=3418
Id=3418
PauseMoveTime=0
SuperMoveTime=0
BindTime=1
Scale=1,1
RemoveTime=-1
pos =Floor(GameWidth/2),Floor(GameHeight/2)
PosType=Left
OwnPal=1
OnTop=1

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=ChangeState
Trigger1=Time>=80&&StateNo!=3420
Value=3420

;Big Sprites KHH Fire 2
[StateDef 3420]
Type=S
MoveType=A
Physics=N
Ctrl=0
Anim=3425
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=HitAdd
Trigger1=!Time
Value=-49
[State 0]
Type=HitAdd
Trigger1=AnimElemTime(4)>=0&&Time%4
Value=1

[State 0]	;HAAAA
Type=PlaySND
Trigger1=AnimElem=4
Value=3410,1
Channel=0

[State 0]
Type=RemoveExplod
Trigger1=1
Id=3421
[State 0]
Type=RemoveExplod
Trigger1=1
Id=3418

[State 0]
Type=PosSet
Trigger1=!Time
X=-93*Facing
Y=-10

[State 0]
Type=StopSND
Trigger1=AnimElem=4
Channel=4
[State 0]
Type=StopSND
Trigger1=AnimElem=4
Channel=5

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 200, Kmh charge long]
type = PlaySnd
trigger1 =AnimElem=4
value = 3400,1
[State 200, Kmh charge long]
type = PlaySnd
trigger1 = AnimElem=4
value = 3410,0
Channel=4
[State 0]
Type=EnvShake
Trigger1=AnimElem=4
Time=30
Freq=110
Ampl=7

[State 0];FX
Type=Explod
Trigger1=!Time
Anim=3426
Id=3426
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=1,1
RemoveTime=-1
pos =0,0
PosType=P1
OwnPal=1
OnTop=1
SprPriority=2
[State 0]
Type=RemoveExplod
Trigger1=Time=80
Id=3426

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

[State 0]
Type=ChangeState
Trigger1=Time>=80&&StateNo!=3425
Value=3425

;Big Sprites KHH Fire 3
[StateDef 3425]
Type=S
MoveType=A
Physics=N
Ctrl=0
Anim=3430
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0, Explod];Fatality
type = Explod
Trigger1=Enemy,StateNo=3999
Trigger1=!NumExplod(9993450)
anim = 15999
ID = 9993450
pos = Floor(GameWidth/2),Floor(GameHeight/2)
postype = Left  ;p2,front,back,left,right
bindtime = -1
removetime = -1


[State 0, Explod];Fatality BG
type = Explod
Trigger1=NumExplod(9993450)&&Time>=200
Trigger1=!NumExplod(9993454)
anim = 3454
ID = 9993454
pos = Floor(GameWidth/2),Floor(GameHeight/2)
postype = Left  ;p2,front,back,left,right
bindtime = -1
removetime = -1
SprPriority=-3
[State 0]
Type=RemoveExplod
Trigger1=1
Id=3426
[State 0]
Type=PosSet
Trigger1=!Time
X=0
Y=23

[State 0];FX
Type=Explod
Trigger1=!Time
Anim=3431
Id=3431
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=1,1
RemoveTime=-2
pos =0,0
PosType=P1
OwnPal=1
OnTop=1
SprPriority=2
[State 0];FX BG
Type=Explod
Trigger1=AnimElem=3
Anim=3432
Id=3432
PauseMoveTime=0
SuperMoveTime=0
BindTime=-1
Scale=2,2
RemoveTime=180
pos =Floor(GameWidth/2),Floor(GameHeight/2)
PosType=LEft
OwnPal=1
OnTop=0
[State 0]
Type=HitAdd
Trigger1=!Time
Value=-50
[State 0]
Type=HitAdd
Trigger1=AnimElemTime(3)>=0&&Time%4&&Time<200
Value=1

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 =  Time=200
value = ceil(ifElse(fvar(11) * -450 > -330, -330, fvar(11) * -450))
ID = -1
kill = 1
absolute = 0

[State 0]	;HAAAA with echo
Type=PlaySND
Trigger1=AnimElem=4
Value=3410,2
Channel=0

[State 0]
Type=StopSND
Trigger1=AnimElem=4
Channel=4
[State 0]
Type=StopSND
Trigger1=AnimElem=4
Channel=5

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[State 200, Kmh charge long]
type = PlaySnd
trigger1 =AnimElem=3
value = 3400,1
[State 200, Kmh charge long]
type = PlaySnd
trigger1 = AnimElem=3
value = 3410,0
[State 0]
Type=EnvShake
Trigger1=AnimElemTime(3)>=0 && !(Time%4)
Time=4
Freq=110
Ampl=10-0.02*time

[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=1
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze

;Fade to white
[State 0]
type = Explod
trigger1 = Time=100
anim = 2996
ID = 2996
postype = Left
pos =Floor(GameWidth/2),Floor(GameHeight/2)
bindtime = -1
Scale=2,2
removetime = -2
pausemovetime = 0
OwnPal=1
ontop = 1
sprpriority = 7
persistent = 0

[State 0]
Type=ChangeState
Trigger1=Time>=260&&StateNo!=3430
Value=3430

;Ending
[StateDef 3430]
Type=S
MoveType=I
Physics=N
Ctrl=0
Anim=5300
SprPriority=2
VelSet=0,0

[State 0, Explod];Remove Helpers on Cinematics
type = Explod
Trigger1=!NumExplod(991901)
Trigger1=!Time
anim = 5939
ID = 991901
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1
removeongethit = 1

[State 0]
Type=AssertSpecial
Trigger1=NumExplod(9993450)
Flag=NoMusic
Flag2=NoBarDisplay
Flag3=NoFG
[State 0]
Type=AssertSpecial
Trigger1=NumExplod(9993450)
Flag=NoBG
Flag2=GlobalNoShadow
Flag3=TimerFreeze
[State 0]
Type=AssertSpecial
Trigger1=NumExplod(9993450)
Flag=Invisible

[State 0]
Type=PosSet
Trigger1=!Time
X=-60*Facing
Y=0

[State 0];Back to screen
Type=ChangeState
Trigger1=Time>=180&&StateNo!=0
Trigger2=Enemy,Ctrl=1
Trigger3=NumExplod(9993450)
Value=0
Ctrl=1

;-----------------------------------------
;Custom State for where P2 is sent.
[Statedef 3999]
type = S
movetype= H
physics = S
juggle = 0
velset = 0,0
ctrl = 0
sprpriority = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = invisible

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nokosnd
flag2 = nokoslow
flag3 = nomusic

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0
ignorehitpause = 1

;Enemy change position and "disappears" of the screen.
[State 51000, 1]
type = PosSet
trigger1 = time > 4
y = 9999

;Opponent does not have shadow.
[state 51000, 2]
type = AssertSpecial
trigger1 = 1
flag = noshadow

;Life goes the zero.
[State 51000, 3]
type = LifeSet
trigger1 = time >= 5
value = 0

;Enemy comes back to its proper CNS, however it continues in the position Y = 9999.
[State 51000, 4]
;This was changed to change state, because some random mugen characters force position back to 0 on self state.
;Using change state here keeps them in my state which does not move them back to 0.
type = changestate;SelfState
trigger1 = life = 0 && time >= 70
value = 5150