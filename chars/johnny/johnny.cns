;===========================================================================
; コンスタンツ（定数）
;===========================================================================
; 基本データ
;---------------------------------------------------------------------------
[Data]
life              = 950   ;ライフ（体力ゲージ）最大値
power             = 3000   ;パワーゲージ最大値（オプション・デフォルトは3000=Lv.3）
attack            = 90    ;攻撃力（デフォルトは１００％）
defence           = 100    ;防御力（デフォルトは１００％）
fall.defence_up   = 50     ;横に倒れている時に一時的に加える防御力（％）
liedown.time      = 25     ;横に倒れている時間（フレーム）
airjuggle         = 15     ;ジャグルポイント限界値（「小ネタ.txt」参照）
sparkno           = 2      ;デフォルトのヒットスパーク（fightfxから）
guard.sparkno     = 40     ;デフォルトのガードスパーク（fightfxから）
KO.echo           = 0      ;ＫＯ時の音声（11,0）にエコーを掛けるか否か（0=掛けない,1=掛ける）
volume            = 100    ;キャラの標準の音量（最小-255・最大255）
IntPersistIndex   = 50     ;次のラウンドへ持ち越せる「Var」のアドレスの範囲を決める（※１）
FloatPersistIndex = 30     ;次のラウンドへ持ち越せる「FVar」のアドレスの範囲を決める（※１）
;---------------------------------------------------------------------------
; サイズ
;---------------------------------------------------------------------------
[Size]
xscale           = 1.1       ;キャラの横の大きさ（絶対値・float）
yscale           = 1.1       ;キャラの縦の大きさ（絶対値・float）
ground.back      = 19      ;地上にいる時の「後方の物理的な幅」
ground.front     = 20      ;地上にいる時の「前方の物理的な幅」
air.back         = 16      ;空中にいる時の「後方の物理的な幅」
air.front        = 16      ;空中にいる時の「前方の物理的な幅」
height           = 50;60      ;キャラの物理的な高さ（高いほど相手は飛び越しにくくなる）
attack.dist      = 160     ;相手がガード態勢に入る最低の距離
proj.attack.dist = 90      ;自分の「Projectile」に対して相手がガード態勢に入る最低の距離
proj.doscale     = 0       ;xscaleとyscaleを「Projectile」にも影響させるか否か（0=させない・1=させる）
head.pos         = 8,-45  ;キャラの標準の頭の座標（Bind系で適用される）
mid.pos          = 2,-20  ;キャラの標準の体中心の座標（Bind系で適用される）
shadowoffset     = 0       ;影のＹ軸方向の位置座標
draw.offset      = 0,0     ;キャラの表示座標（Ｘ軸,Ｙ軸）

;---------------------------------------------------------------------------
; 移動速度
;---------------------------------------------------------------------------
[Velocity]
walk.fwd     = 0.515       ;前進速度（Ｘ軸・[Statedef 20]に適用される）
walk.back    = -0.43       ;後退速度（Ｘ軸・[Statedef 20]に適用される）
run.fwd      = 4.2,0         ;前方に走る速度（Ｘ軸,Ｙ軸・[Statedef 100]に適用される）
run.back     = -3.0,0        ;後方に走る速度（Ｘ軸,Ｙ軸・[Statedef 105]に適用される）
jump.neu     = 0,-11.2      ;垂直ジャンプの速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
jump.back    = -1.5       ;後方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
jump.fwd     = 2.5         ;前方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
runjump.back = -2.55,-8.1  ;後方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
runjump.fwd  = 4,-8.1      ;前方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
airjump.neu  = 0,-8.1      ;空中垂直ジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 45]に適用される）
airjump.back = -2.55       ;空中後方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）
airjump.fwd  = 2.5         ;空中前方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）

;---------------------------------------------------------------------------
; 運動関係
;---------------------------------------------------------------------------
[Movement]
airjump.num     = 0        ;空中ジャンプが出来る回数
airjump.height  = 35       ;空中ジャンプが出来る最低の高度（Ｙ軸）
yaccel          = .50      ;Ｙ軸加速度（重力）
stand.friction  = .85      ;立っている時の摩擦係数（ステートのPhysicsが「S」の時）
crouch.friction = .82      ;しゃがんでいる時の摩擦係数（ステートのPhysicsが「C」の時）

;===========================================================================
; ステート
;===========================================================================
;===========================================================================
; 基本行動
;===========================================================================
;---------------------------------------------------------------------------
;タイムオーバー（負けた時）
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 無敵]
type = NotHitBy
trigger1 = 1 ;トリガーを何も書かず「1」にする事により、『無条件で常に実行させる命令』になる。
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 2
value = 5300, 0 +random%2
volume = 70
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;勝利ポーズ分岐（common1.cnsには無いけど、これもコモンステート）
[Statedef 180]
type = S
[State ランダム]
type = VarRandom
trigger1 = !time
v = 0
Range = 0,4
[State 180, 対ジョナサン]
type = ChangeState
trigger1 = MatchOver;RoundNo > 1
trigger1 = enemy,name = "jonathan" && enemy,Authorname = "amarimono"
value = 990
[State 180, 同キャラ]
type = ChangeState
trigger1 = MatchOver;RoundNo > 1
trigger1 = enemy,name = "johnny" && enemy,Authorname = "salami"
value = ifelse(TeamSide = 1,992,994) 

[State 180, 僕はまだマイナスなんだ！]
type = ChangeState
trigger1 = var(0)=0
value = 181
[State 180, ずっとずっともっと気高く＆勝ったのは、僕だ]
type = ChangeState
trigger1 = var(0)=1
value = 981
[State 180, 迷ったなら撃つな、だ]
type = ChangeState
trigger1 = var(0)=2
value = 983
[State 180, 見たろ…足が動くんだ…]
type = ChangeState
trigger1 = var(0)=3
value = 984
[State 180, 祈っておこうかな/家に…帰ろう]
type = ChangeState
trigger1 = var(0)=4
value = 985

;---------------------------------------------------------------------------
;勝利ポーズ 僕はまだマイナスなんだ！
[Statedef 181]
type = S
ctrl = 0
anim = 980
velset = 0,0

[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 音]
type = PlaySnd
trigger1 = animelemTime(16) = 0
trigger2 = animelemTime(23) = 0
value = 40, 2
[State 音]
type = PlaySnd
trigger1 = animelemTime(13) = 0
value = 40, 3

[State 音]
type = PlaySnd
trigger1 = animelemTime(22) = 6
value = 0, 4

[State 声]
type = PlaySnd
trigger1 = animelemTime(2) = 1
value = 72, 4
volume = 50
[State 声]
type = PlaySnd
trigger1 = animelemTime(22) = 0
value = 72, 5
volume = 50

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 60
flag = RoundNotOver

;---------------------------------------------------------------------------
;勝利ポーズ 仮 ずっとずっともっと気高く＆勝ったのは、僕だ
[Statedef 981]
type = S
ctrl = 0
anim = 981+random%2
velset = 0,0

[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 2
value = 980, ifelse(random%2=0,6,2)
volume = 100

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 100
flag = RoundNotOver
;---------------------------------------------------------------------------
;勝利ポーズ 迷ったなら撃つな
[Statedef 983]
type = S
ctrl = 0
anim = 983
velset = 0,0
[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 2
value = 980, 7
volume = 120

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 40
flag = RoundNotOver
;---------------------------------------------------------------------------
;勝利ポーズ 見たろ…脚が動くんだ…
[Statedef 984]
type = S
ctrl = 0
anim = 984
velset = 0,0
[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 2
value = 980, 9
volume = 120

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 60
flag = RoundNotOver
;---------------------------------------------------------------------------
;勝利ポーズ　祈っておこうかな/家に…帰ろう
[Statedef 985]
type = S
ctrl = 0
anim = 987;ifelse(MatchOver,986,985)
velset = 0,0
[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 2
value = 980, ifelse(MatchOver,13,14)
volume = 120

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < ifelse(MatchOver,70,20)
flag = RoundNotOver
;---------------------------------------------------------------------------
;勝利ポーズ 対ジョナサン特殊
[Statedef 990]
type = S
ctrl = 0
anim = 990
velset = 0,0
[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 1
value = 980, 10
volume = 120

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 300
flag = RoundNotOver
;---------------------------------------------------------------------------
;勝利ポーズ 同キャラ1P
[Statedef 992]
type = S
ctrl = 0
anim = 992
velset = 0,0
[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 1
value = 980, 12
volume = 120

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 40
flag = RoundNotOver
;---------------------------------------------------------------------------
;勝利ポーズ 同キャラ2P
[Statedef 994]
type = S
ctrl = 0
anim = 994
velset = 0,0
[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 声]
type = PlaySnd
trigger1 = time = 1
value = 980, 11
volume = 120

[State 191, 特殊効果]
type = AssertSpecial
trigger1 = time < 40
flag = RoundNotOver
;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; PREINTRO
[Statedef 190]
type = S
ctrl = 0
velset = 0,0
[State 190, 1]
type = ChangeAnim
trigger1 = SelfAnimExist(190)
value = 190
[State ランダム]
type = VarRandom
trigger1 = !time
v = 0
Range = 0,3

[State 同キャラ特殊イントロ]
type = ChangeState
trigger1 = enemy,name = "johnny" && enemy,Authorname = "salami"
value = ifelse(TeamSide = 1,920,922) 

[State 飢えなきゃ勝てない]
type = ChangeState
trigger1 = var(0)=0
value = 900
[State 遺体を諦めたら、きっと僕の心は再び死ぬ]
type = ChangeState
trigger1 = var(0)=1
value = 902
[State お前、大統領の追手だな！]
type = ChangeState
trigger1 = var(0)=2
value = 904
[State あんたは正しい人なのか]
type = ChangeState
trigger1 = var(0)=3
value = 906
;---------------------------------------------------------------------------
;イントロ 飢えなきゃ勝てない
[Statedef 900]
type = S
ctrl = 0
anim = 901
velset = 0,0

[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 901

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 声]
type = PlaySnd
trigger1 = animelemTime(1) = 4
value = 900, 10
channel = 0

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
trigger1 = AnimTime = 0
value = 0
;---------------------------------------------------------------------------
;イントロ2 遺体を諦めたら、きっと僕の心は再び死ぬ
[Statedef 902]
type = S
ctrl = 0
anim = 900
velset = 0,0
[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 900

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 声]
type = PlaySnd
trigger1 = animelemTime(2) = 0
value = 900, 8
channel = 0

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
trigger1 = AnimTime = 0
value = 0
;---------------------------------------------------------------------------
;イントロ3 お前、大統領の追手だな！
[Statedef 904]
type = S
ctrl = 0
anim = 904
velset = 0,0
[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 904

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 声]
type = PlaySnd
trigger1 = animelemTime(2) = 0
value = 900, 14
channel = 0

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
trigger1 = AnimTime = 0
value = 0
;---------------------------------------------------------------------------
;イントロ4 あんたは正しい人なのか
[Statedef 906]
type = S
ctrl = 0
anim = 906
velset = 0,0
[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 906

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 声]
type = PlaySnd
trigger1 = animelemTime(2) = 0
value = 900, 11
channel = 0

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
trigger1 = AnimTime = 0
value = 0
;---------------------------------------------------------------------------
;同キャラ特殊イントロ1P この現象は、ヴァレンタイン大統領の！
[Statedef 920]
type = S
ctrl = 0
anim = 920
velset = 0,0
[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 920

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 声]
type = PlaySnd
trigger1 = animelemTime(2) = 0
value = 900, 12
channel = 0

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
trigger1 = AnimTime = 0
value = 0
;---------------------------------------------------------------------------
;同キャラ特殊イントロ2P 僕とそっくりな奴がいるぞ
[Statedef 922]
type = S
ctrl = 0
anim = 922
velset = 0,0
[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 0

[State 191, アニメ変更]
type = ChangeAnim
trigger1 = time > 280 && anim=0
value = 922

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 声]
type = PlaySnd
trigger1 = anim = 922 && animelemTime(2) = 0
value = 900, 13
channel = 0

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
trigger1 = anim = 922 && AnimTime = 0
value = 0
;---------------------------------------------------------------------------
;挑発
[Statedef 195]
type = S
movetype = I
physics = S
ctrl = 0
anim = 195
velset = 0,0
sprpriority = 2

[State 195, コントロール]
type = CtrlSet
trigger1 = Time = 40 ;このステートが４０フレームになったら
value = 1            ;キーコントロールが可能になる。

[State 195, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===========================================================================
; 通常攻撃技
;===========================================================================
;立ち弱
[Statedef 200]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 200
sprpriority = 1
facep2 = 1

[State 声]
type = PlaySnd
trigger1 = Time = 1
value = 5, 1+(random<500)
channel = 0
LowPriority = 1

[State 空振り音]
type = PlaySnd
trigger1 = Time = 2
value = 0, 0

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 3
trigger1 = movecontact=0 && movereversed=0
attr = S, NA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(13*fvar(0)), 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 17
ground.velocity = -2.4
airguard.velocity = -1.4,-1.2
air.type = High
air.velocity = -1.4,-1.8
air.hittime = 27
AirGuard.CtrlTime = 30
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = -4.5
getpower  = ceil( 30*(1+(var(48)>0)*0.1) ),ceil( 15*(1+(var(48)>0)*0.1) )
givepower = 18,9
fall.recovertime = 30

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = P2BodyDist X+25+random%20,-80+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.35, 0.35
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;立ち中
[Statedef 210]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 210
sprpriority = 1

[State 210, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 4

[State 声]
type = PlaySnd
trigger1 = Time = 1
value = 5, 3+(random<500)
channel = 0

[State 空振り音]
type = PlaySnd
trigger1 = Time = 2
value = 0, 2

[State 210, 速度];原作にはたぶんない
type = veladd
trigger1 = AnimElemtime(4) = 0
X = 1.8

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 4 || AnimElemno(0) = 5
trigger1 = movecontact=0 && movereversed=0
attr = S, NA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(21*fvar(0)), 0
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 10, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = High
ground.slidetime = 15
ground.hittime  = 23
ground.velocity = -3.3
airguard.velocity = -1.2,-2.0
air.type = High
air.velocity = -1.0,-3
air.hittime = 28
AirGuard.CtrlTime = 40
Guard.CtrlTime = 15
Guard.Kill = 0
Ground.CornerPush.VelOff = -6
getpower  = ceil( 40*(1+(var(48)>0)*0.1) ),ceil( 20*(1+(var(48)>0)*0.1) )
givepower = 23,12
fall.recovertime = 45

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = P2BodyDist X+25+random%20,-90+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.4, 0.4
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 210, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;立ち強
[Statedef 220]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 220
sprpriority = 1
[State 210, 速度]
type = veladd
trigger1 = animelemtime(4) = 3
X = 6.8;*0.90**(time-10)

[State 声]
type = PlaySnd
trigger1 = Time = 4
value = 5, 5+(random<500)
channel = 0

[State 空振り音]
type = PlaySnd
trigger1 = Time = 4
value = 0, 4

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 6 || AnimElemno(0) = 7
trigger1 = movecontact=0 && movereversed=0
attr = S, NA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(34*fvar(0)), 0
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13, 13
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 28-2;長いと永久
ground.velocity = -4.4;-7
airguard.velocity = -1.8,-2.5
air.type = High
air.velocity = -2,-3.0
AirGuard.CtrlTime = 50
air.hittime = 30
fall.recovertime = 46
Guard.CtrlTime = 18-4+3 +5
Guard.Kill = 0
Ground.CornerPush.VelOff = -9
getpower  = ceil( 50*(1+(var(48)>0)*0.1) ),ceil( 25*(1+(var(48)>0)*0.1) )
givepower = 30,15

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = P2BodyDist X+50+var(3)%20,-55-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 210, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;外して撃った
[Statedef 240]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 240
sprpriority = 1

[State キラキラ]
type = PlaySnd
trigger1 = Time = 0
value = 0,26
[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 72,2;ifelse(var(3)%2=0,72,200), ifelse(var(3)%2=0,2,14)
channel = 0

[State SE]
type = PlaySnd
trigger1 = !time;animelemtime(1) = 2
value = 0, 8
volume = -80

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(3) = 0
anim = 1361
ID = 1360
pos = ceil(9*const(size.xscale)),  ceil(-57*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.3*const(size.xscale), 0.3*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(3) = 0
anim = 1390
ID = 1355
pos = ceil(9*const(size.xscale)),  ceil(-57*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.yscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 蝶々が画面端に近い]
type = varset
trigger1 = time=0
var(16) = (FrontEdgeBodyDist<70)

[state 蝶々]
type = helper
trigger1 = time = 0
name = "butterfly"
stateno = 244
ID = 244
postype = p1
pos = ceil(50*const(size.xscale)) -30-var(16)*32,ceil((-88+5)*const(size.yscale)) +var(16)*6
Size.XScale = 0.75
Size.YScale = 0.75
OwnPal = 1

[state 黄金回転爪弾]
type = helper
trigger1 = animelemtime(3) = 0
name = "goldspin nail"
stateno = 242
ID = 242
postype = p1
pos = ceil((9+7)*const(size.xscale)) -30*0.75,  ceil((-57-3)*const(size.yscale))
Size.XScale = 0.75*const(size.xscale)
Size.YScale = 0.75*const(size.yscale)
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(3) = 0
var(51) = -10
persistent = 0

[State 反動]
type = veladd
trigger1 = animelemtime(5) = 0
X = -1.5
persistent = 0

[State ガード距離]
Type = AttackDist
trigger1 = time > 40
value = 0

[State 210, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0 || (numhelper(244)=0 && animelemtime(12)>=1)
trigger2 = numhelper(244) && animelemtime(12)>=1 && helper(244),movecontact=0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;はずして撃った爪弾ヘルパー
[Statedef 242]
type    = A
movetype= I
physics = N
velset = 10*cos(32*Pi/180),-10*sin(32*Pi/180)
ctrl = 0
anim = 242
sprpriority = 2

[State 蝶にぶつかったらエフェクト消すスイッチオン]
type = varset
triggerall = numhelper(244)
trigger1 = helper(244),pos X = [pos X-5 +7.5*facing,pos X+5 +7.5*facing]
trigger1 = helper(244),pos Y = [pos Y-8,pos Y+8]
var(0)=1

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0
anim = 1393
ID = 1358
pos = 0 +30*0.75+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.15*root,const(size.yscale), 0.15*root,const(size.yscale)
sprpriority = 3
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%3 = 0 && time != 0 && var(0)=0
anim = 1392
ID = 1357
pos = 0 +30*0.75, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.23*root,const(size.yscale), 0.23*root,const(size.yscale)
sprpriority = -1
OwnPal = 1
vel = 0.6*cos(32*Pi/180),-0.6*sin(32*Pi/180)
accel = -0.03*cos(32*Pi/180),0.03*sin(32*Pi/180)

[State 無敵]
Type = notHitby
trigger1 = 1
value = SCA
IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
triggerall = numexplod(1358)
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]

;---------------------------------------------------------------------------
;はずして撃った弾に撃たれる待機蝶々ヘルパー
[Statedef 244]
type    = A
movetype= I
physics = N
ctrl = 0
anim = 244
sprpriority = 4

[State キラッエフェクト]
type = Explod
trigger1 = !time
anim = 248
ID = 248
pos = 45, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.6,0.6
ontop=1
OwnPal = 1

[State 移動]
Type = velset
trigger1 = 1
X = sin(time*0.4)*0.8
Y = -0.4 +sin(time*0.3)*0.6
IgnoreHitPause = 1
[State 移動]
Type = posadd
trigger1 = 1
X = 0.5
Y = -0.5
IgnoreHitPause = 1

[State 撃たれて移動]
type = ChangeState
trigger1 = numhelper(242)
trigger1 = helper(242),pos X = [pos X-5 +7.5*facing,pos X+5 +7.5*facing]
trigger1 = helper(242),pos Y = [pos Y-30,pos Y+30]
value = 245

[State 消滅]
type = destroyself
trigger1 = root,stateno != 240

;---------------------------------------------------------------------------
;はずして撃った弾に撃たれる蝶々ヘルパー 穴空いて落下
[Statedef 245]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 245
sprpriority = 4

[State 331,ヒットエフェクト]
type = Explod
trigger1 = !time
anim = 801
postype = p1
pos = 45,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.15, 0.15
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ヒットストップ]
Type = posfreeze
trigger1 = time < 3

[State 初速]
Type = velset
trigger1 = time = 3
X = 0.1
Y = -0.1
IgnoreHitPause = 1
[State 重力]
Type = veladd
trigger1 = time >= 3 && !hitpausetime
Y = 0.15+(time>18)*0.2
IgnoreHitPause = 1

[State 震え]
Type = posadd
trigger1 = time >= 3 && !hitpausetime
X = sin(time*0.2)*0.7 -0.6
Y = cos(time*0.6)*0.5
IgnoreHitPause = 1

[State 穴回転エフェクト]
type = Explod
trigger1 = time = 5
anim = 249
ID = 249
pos = 45, 0
postype = p1
bindtime = -1
removetime = 250
scale = 0.7*root,const(size.yscale), 0.7*root,const(size.yscale)
sprpriority = 3
OwnPal = 1
IgnoreHitPause = 1
trans = sub

[State 200, ヒット定義]
type = HitDef
trigger1 = time > (17+(root,var(16)>0)+(root,var(16))*3) && pos Y <= -35
trigger1 = movecontact=0 && movereversed=0
attr = S, SP
damage = ceil(62*root,fvar(0)), 0
animtype = M
guardflag = HA;中段
hitflag = MAF
priority = 4, Hit
pausetime = 8, 8
Guard.PauseTime = 8,8
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = L
ground.slidetime = 12
ground.hittime  = 13
ground.velocity = 2
guard.velocity = 3
airguard.velocity = 0,-0.4
air.type = High
air.velocity = -0.5,-0.6
air.hittime = 26
fall.recovertime = 40
Guard.CtrlTime = 7
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 35*(1+(root,var(48)>0)*0.1) ),ceil( 16*(1+(root,var(48)>0)*0.1) )
givepower = 30,15

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1
var(6) = 1
persistent = 0
IgnoreHitPause = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 45,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 穴回転エフェクト消滅]
type = removeExplod
trigger1 = numexplod(249) && pos Y > -35
trigger2 = numexplod(249) && movecontact
trigger3 = root,stateno != 240
ID = 249
IgnoreHitPause = 1

[State グルグルエフェクト減算]
type = Explod
trigger1 = movecontact
anim = 250
ID = 1380
pos = 1 +45, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*root,const(size.yscale), 0.4*root,const(size.yscale)
sprpriority = 6
OwnPal = 1
persistent = 0
trans = sub
vel = 0.11
IgnoreHitPause = 1
[State グルグルエフェクト通常]
type = Explod
trigger1 = movecontact
anim = 252
ID = 1385
pos = 1 +45, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.42*root,const(size.yscale), 0.42*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
vel = 0.11

[State ヒットして移動]
type = ChangeState
trigger1 = movecontact
value = 247
IgnoreHitPause = 1

[State 消滅]
type = destroyself
trigger1 = root,stateno != 240
trigger2 = pos Y > -10

;---------------------------------------------------------------------------
;はずして撃った弾に撃たれる蝶々ヘルパー 無事にはばたく
[Statedef 247]
type    = A
movetype= I
physics = N
ctrl = 0
anim = 247
sprpriority = 0
MoveHitPersist = 1

[State 透過]
type = trans
trigger1 = 1
trans = addalpha
alpha = 200,200
IgnoreHitPause = 1

[State 移動]
Type = velset
trigger1 = 1
X =  0.5 +sin(time*0.3)*0.3
Y = -1.3 +cos(time*0.4)*0.3
IgnoreHitPause = 1

[State 消滅]
type = destroyself
trigger1 = time > 60

;---------------------------------------------------------------------------
;しゃがみ弱
[Statedef 400]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 400
sprpriority = 2
facep2 = 1

[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 5, 7+(random<500)
channel = 0
LowPriority = 1

[State 空振り音]
type = PlaySnd
trigger1 = Time = 0
value = 0, 0

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 3
trigger1 = movecontact=0 && movereversed=0
attr = C, NA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(12*fvar(0)), 0
animtype = L
guardflag = LA
hitflag = MAF
priority = 4, Hit
pausetime = 7, 7
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = L
ground.slidetime = 10
ground.hittime  = 16
ground.velocity = -3.55
airguard.velocity = -1.3,-.8
air.type = High
air.velocity = -1.8,-1.4;-1.1,-1.4
air.hittime = 17
Guard.CtrlTime = 10
Guard.Kill = 0
Ground.CornerPush.VelOff = -5.5
getpower  = ceil( 30*(1+(var(48)>0)*0.1) ),ceil( 15*(1+(var(48)>0)*0.1) )
givepower = 18,9
fall.recovertime = 30

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = P2BodyDist X+50+var(3)%20,-25-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 400, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11 ;しゃがむステートへ（コモンステート)
ctrl = 1

;---------------------------------------------------------------------------
;しゃがみ中
[Statedef 410]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 410
sprpriority = 2

[State 210, 速度]
type = posadd
trigger1 = animelemtime(2) >= 0
X = 2.2*0.6**(time-3)

[State 声]
type = PlaySnd
trigger1 = Time = 1
value = 5, 9+(random<500)
channel = 0

[State 空振り音]
type = PlaySnd
trigger1 = Time = 0
value = 0, 3

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 3
trigger1 = movecontact=0 && movereversed=0
attr = C, NA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(20*fvar(0)), 0
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 12, 12
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = L
ground.slidetime = 10
ground.hittime  = 22
ground.velocity = -4.3
airguard.velocity = -1.2,-.8
air.type = High
air.velocity = -1.3,-3.5
air.hittime = 14
Guard.CtrlTime = 17
Guard.Kill = 0
Ground.CornerPush.VelOff = -5.5
getpower  = ceil( 40*(1+(var(48)>0)*0.1) ),ceil( 20*(1+(var(48)>0)*0.1) )
givepower = 23,12
fall.recovertime = 40

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = P2BodyDist X+50+var(3)%20,-25-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 410, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;しゃがみ強
[Statedef 420]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 420
sprpriority = 2

[State ヘルパーがヒットした時のアニメ枚数変数リセット]
type = varset
trigger1 = !time
var(1) = 0

[State 声]
type = PlaySnd
trigger1 = Time = 2
value = 5, 11+(random<500)
channel = 0

[State 空振り音]
type = PlaySnd
trigger1 = Time = 8
value = 0, 5

[State コルクか弾丸]
type = helper
trigger1 = animelemtime(5) = 0
stateno = 422
ID = 422
pos = ceil(55*const(size.xscale)),ceil(-15*const(size.yscale))
persistent = 0
OwnPal = 1
Size.XScale = 0.9*const(size.xscale)
Size.YScale = 0.9*const(size.yscale)

[State ヘルパーがヒットした時のアニメ枚数記憶]
type = varset
trigger1 = var(1) = 0
trigger1 = numhelper(422) && helper(422),HitPauseTime>0
var(1) = animelemno(0)
persistent = 0

[State アニメ停止]
type = changeanim
trigger1 = var(1) > 0
trigger1 = numhelper(422) && helper(422),HitPauseTime>0
value = anim
elem = ifelse(var(1)<=40,var(1),40)

[State アニメ再スタート]
type = changeanim
triggerall = var(1) > 0
trigger1 = numhelper(422) && helper(422),HitPauseTime=0
trigger2 = numhelper(422)=0
value = anim
elem = ifelse(var(1)<=40,var(1),40)
persistent = 0

[State 420, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;しゃがみ強 コルクか弾丸ヘルパー
[Statedef 422]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 422
sprpriority = 3

[State 速度]
type = velset
trigger1 = !time
X = 3.3
Y = -0.1

[State 落下]
type = veladd
trigger1 = 1
Y = 0.15

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;root,var(48)!=2
trigger1 = movecontact=0 && movereversed=0
attr = C, NP
damage = ceil(32*root,fvar(0)), 0
animtype = H
guardflag = LA
hitflag = MAF
priority = 4, Hit
pausetime = 15, 15
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 10
ground.hittime  = 18
ground.velocity = -1,-2.1
airguard.velocity = -1.9,-.8
air.type = L
air.velocity = -1.4,-4.5;-3
air.hittime = 22
Guard.Velocity = -5
Guard.CtrlTime = 18
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 50*(1+(root,var(48)>0)*0.1) ),ceil( 25*(1+(root,var(48)>0)*0.1) )
givepower = 30,15
fall = 1
Fall.Recover = 0
Fall.YVelocity = 0

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1
var(6) = 1
persistent = 0
IgnoreHitPause = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = P2BodyDist X+0+root,var(3)%10,-0-root,var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 423
IgnoreHitPause = 1

[State 消滅]
type = destroyself
trigger1 = pos Y > 3
trigger2 = root,stateno != 420
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;飛び道具が消えるステート
[Statedef 423]
type    = A
movetype= A
physics = N
[State 消滅]
type = destroyself
trigger1 = 1
;--------------------------------------------------------------------------
;空中攻撃
[Statedef 600]
type    = A
movetype= A
physics = N
anim = 600
ctrl = 0
[State 重力]
type = Gravity
trigger1 = 1

[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 5, 15+(random<500)
channel = 0
[State 空振り音]
type = PlaySnd
trigger1 = Time = 4
value = 0, 5

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 6
trigger1 = movecontact=0 && movereversed=0
attr = A, NA
damage = ceil(35*fvar(0)), 0
animtype = H
guardflag = HA
hitflag = MAF
priority = 4, Hit
pausetime = 11, 11
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 3
guardsound = s7, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4
airguard.velocity = -2,-1
air.type = High
air.velocity = -2,-3.0
AirGuard.CtrlTime = 50
air.hittime = 20
;air.fall = 1
fall.recover = 0
Guard.CtrlTime = 9
Guard.Kill = 0
Ground.CornerPush.VelOff = -9
getpower  = ceil( 40*(1+(var(48)>0)*0.1) ),ceil( 20*(1+(var(48)>0)*0.1) )
givepower = 20,10

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 823
postype = p1
pos = P2BodyDist X+20,-15
IgnoreHitPause = 1
scale = 0.5, 0.5
Vfacing = -1
ontop = 1
OwnPal = 1
persistent = 0
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト演出用2個目]
type = Explod
trigger1 = Movehit = 1 && hitpausetime = 10-3
anim = 822
postype = p1
pos = P2BodyDist X+15,-15
IgnoreHitPause = 1
scale = 0.55, 0.55
Vfacing = -1
ontop = 1
OwnPal = 1
persistent = 0
pausemovetime = 2147483647
supermovetime = 2147483647
[State ヒットSE]
type = PlaySnd
trigger1 = Movehit = 1 && hitpausetime = 10-3
value = 6, 3
IgnoreHitPause = 1
persistent = 0
[State 331,ヒットエフェクト強]
type = null;Explod
trigger1 = Movehit = 1
anim = 810
postype = p1
pos = P2BodyDist X+20+var(3)%21,-8-var(3)%19
IgnoreHitPause = 1
Persistent = 0
scale = 0.35, 0.35
ontop = 1
OwnPal = 1
trans = addalpha
alpha = 100,255
pausemovetime = 2147483647
supermovetime = 2147483647
persistent = 0
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ヒット時アニメ]
type = Changeanim
trigger1 = movecontact;hitpausetime
value = 600
elem = 7
persistent = 0
IgnoreHitPause = 1

[State SE]
type = PlaySnd
trigger1 = pos Y >= 0 && vel Y > 0
value = 40, 2
persistent = 0

[State ガード距離]
Type = AttackDist
trigger1 = animelemtime(7)>=2
value = 0
[State ステート変更]
type = ChangeState
trigger1 = pos Y >= 0 && vel Y > 0
value = 1770
;===========================================================================
; 投げ技
;===========================================================================
;投げ
[Statedef 700]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 700
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 5, 14
channel = 0

[State 空振り音]
type = PlaySnd
trigger1 = Time = 4
value = 0, 25

[State 投げ抜け用 相手が投げ抜けコマンドを入力したかリセット]
type = varset
trigger1 = !time
var(28) = 0
[State 投げ抜け用 相手が投げ抜けコマンドを入力したか]
type = varset
trigger1 = enemynear,command="投げ抜けコマンド";自分のコマンドファイル参照
trigger2 = enemynear,command="a" || enemynear,command="b" || enemynear,command="c" || enemynear,command="x" || enemynear,command="y" || enemynear,command="z"
trigger2 = enemynear,command="holdfwd" || enemynear,command="holdback"
trigger2 = enemynear,command!="holddown"
var(28) = 1

[State 投げ抜け不可フラグ]
type = varset
trigger1 = 1
var(26) = (enemynear(0),movetype=A && !(enemynear(0),HitDefAttr = S, NT))

[State 800, ヒット定義]
type = HitDef
triggerall = !(id > enemy,id && (enemy,prevstateno = 5001 || enemy,prevstateno = 5011) && enemy,time <= 1)
triggerall = p2movetype!=H
triggerall = p2stateno!=[150,155]
triggerall = movecontact=0 && movereversed=0;念のため
trigger1 = p2bodydist X = [-10,20]
trigger1 = animelemno(0) <= 4 ;投げ抜け用(相手がhitdefattrで判別可能のハズ)
trigger1 = var(33) >= 5;ガードさせてから5F以降
attr = S, NT ;立ち通常投げ（Standing, Normal Throw）
hitflag = M-  ;マイナスが付加されてるので相手が食らい中の時は掴めない
priority = 1, Miss
sparkno = -1  ;-1だからヒットスパークは表示しない
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 710+(var(27)=1 || var(28)=1)*40;相手通常投げ中で投げ抜けへ
p2stateno = 720
guard.dist = 0 ;相手のガード態勢に入る距離を0にしてるので、ガード不可
fall = 1
ID = 720

[State 800, ステート変更]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;投げ：成功（殴る）
[Statedef 710]
type    = S
movetype= A
physics = S
anim = 710
velset = 0,0
[State 170, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 音]
type = PlaySnd
trigger1 = Time = 0
value = 1,1

[State 画面振動]
type = envshake
trigger1 = Time = 0
time = 8
Ampl = -3

[State 810, 投げ抜け]
type = changestate
triggerall = var(26) = 0
triggerall = time = [0,7]
trigger1 = target,command="投げ抜けコマンド";自分のコマンドファイル参照
trigger2 = target,command="a" || target,command="b" || target,command="c" || target,command="x" || target,command="y" || target,command="z"
trigger2 = target,command="holdfwd" || target,command="holdback"
trigger2 = target,command!="holddown"
value = 750

[State 810, 慣性]
type = veladd
trigger1 = animelemtime(5)=0 && anim = 710
X = -1.1
[State 810, 慣性]
type = veladd
trigger1 = animelemtime(5)=0 && anim = 711
X = 1.1

[State 810, 慣性]
type = veladd
trigger1 = animelemtime(6)=0
X = 4
[State 810, 慣性]
type = velmul
trigger1 = animelemtime(7)=0
X = 0.8

[State 810, 後ろ投げ]
type = Changeanim
trigger1 = anim = 710 && animelemtime(3)=0 && var(2)
value = 711

[State 810, 後ろ投げ]
type = turn
trigger1 = anim = 711 && animelemtime(4)=0
[State 810, 後ろ投げ 掴んだ相手の向き変更]
type = Targetfacing
trigger1 = anim = 711 && animelemtime(4)=0
ID = 720
value = -1

[State 画面振動]
type = envshake
trigger1 = AnimElemtime(7) = 0; && anim = 710
time = 14
Ampl = -4

[State 後ろ投げ 表示優先度]
type = SprPriority
trigger1 = anim = 711 && AnimElemno(0) = 4
value = -1
persistent = 0
[State 後ろ投げ 表示優先度]
type = SprPriority
trigger1 = anim = 711 && AnimElemno(0) = 5
value = 1
persistent = 0

[State 後ろ投げ 画面端との押し出し]
type = width
trigger1 = anim = 711 && AnimElemtime(4) = 0
Edge = 30,30
persistent = 0

[State 810, 終了 ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[State ヒット音]
type = PlaySnd
trigger1 = AnimElemtime(6) = 0; && anim = 710
value = 6,1
[State -2 ヒットカウント増加]
type = Varadd
trigger1 = AnimElemtime(6) = 0
var(6) = 1
[State -2 ヒットカウント増加]
type = hitadd
trigger1 = AnimElemtime(6) = 0
value = 1

[State ゲージ増加]
type = PowerAdd
trigger1 = AnimElemtime(6) = 0
value = 150
[State ゲージ増加]
type = targetPowerAdd
trigger1 = AnimElemtime(6) = 0
value = 150

[State 空ぶり音]
type = PlaySnd
trigger1 = AnimElemtime(6) = 0; && anim = 710
value = 0,1
[State 空ぶり音]
type = PlaySnd
trigger1 = AnimElemtime(6) = 0; && anim = 710
value = 0,14

[State 声]
type = PlaySnd
trigger1 = AnimElemtime(6) = 0; && anim = 710
value = 5200,0

[State 画面振動]
type = envshake
trigger1 = AnimElemtime(7) = 0; && anim = 710
time = 14
Ampl = -4

[State 331,ヒットエフェクト]
type = Explod
trigger1 = AnimElemtime(7) = 0
anim = 812
postype = p1
pos = P2BodyDist X+40+var(3)%10,-65-var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.4, 0.4
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State ガラスエフェクト]
type = Explod
trigger1 = AnimElemtime(7) = 1
anim = 730
postype = p1
pos = 70,-60
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale), Const(size.yscale)
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State ガラス音]
type = PlaySnd
trigger1 = AnimElemtime(7) = 1
value = 0,17
volume = -200

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
triggerall = numtarget(720)
trigger1 = AnimElemtime(7) = 0 && anim = 710
trigger2 = AnimElemtime(7) = 0 && anim = 711
value = -120

[State 810, 掴んだ相手の位置]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 1 && anim = 710
ID = 720
pos = 46,0
[State 810, 掴んだ相手の位置]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 2 && anim = 710
ID = 720
pos = 49,0
[State 810, 掴んだ相手の位置]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 3 && anim = 710
ID = 720
pos = 48,0
[State 810, 掴んだ相手の位置]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 4 && anim = 710
ID = 720
pos = 39,0
[State 810, 掴んだ相手の位置]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 5 && anim = 710
ID = 720
pos = 24,0

[State 810, 掴んだ相手の位置 後ろ投げ]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 1 && anim = 711
ID = 720
pos = 48,0
[State 810, 掴んだ相手の位置 後ろ投げ]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 2 && anim = 711
ID = 720
pos = 39,0
[State 810, 掴んだ相手の位置 後ろ投げ]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 3 && anim = 711
ID = 720
pos = 24,0
[State 810, 掴んだ相手の位置 後ろ投げ]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 4 && anim = 711
ID = 720
pos = 5,0
[State 810, 掴んだ相手の位置 後ろ投げ]
type = Targetbind
triggerall = numtarget(720)
trigger1 = AnimElemno(0) = 5 && anim = 711
ID = 720
pos = 24,0

[State 投げの補正用スイッチ]
type = varset
triggerall = numtarget(720)
trigger1 = AnimElemtime(6) = 0
var(7) = 1

[State 810, 掴んだ相手のステート変更]
type = TargetState
triggerall = numtarget(720)
trigger1 = AnimElemtime(6) = 0
value = 721
ID = 720

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;投げ：相手側１ 掴まれている間
[Statedef 720]
type    = A
movetype= H
physics = N
velset = 0,0
[State 170, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
[State 押し出し]
type = playerpush
trigger1 = 1
value = 0

[State 820, 相手のアニメ変更]
type = ChangeAnim2
trigger1 = Time = 0
value = 720

[State 820, 相手ステートに戻す]
type = SelfState
trigger1 = !GetHitVar(IsBound)
value = 5050
;---------------------------------------------------------------------------
;投げ：相手側2 殴られてヒットストップ
[Statedef 721]
type    = S
movetype= H
physics = S
[State 170, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 押し出し]
type = playerpush
trigger1 = 1
value = 0

[State 820, 相手のアニメ変更]
type = ChangeAnim2
trigger1 = Time = 0
value = 721

[State 820, ヒットバック]
type = posadd
trigger1 = !time
X = -5

[State 820, ヒットストップ]
type = posfreeze
trigger1 = 1

[State 820, ヒットストップ終了]
type = changestate
trigger1 = Time = 0
value = 722

[State 非常用]
type = selfstate
trigger1 = time > 200
value = 5030

;---------------------------------------------------------------------------
;投げ：相手側3 後ずさり
[Statedef 722]
type    = S
movetype= H
physics = N
[State 170, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 押し出し]
type = playerpush
trigger1 = 1
value = 0

[State 820, 位置]
type = posset
trigger1 = 1
Y = 0

[State 820, 初速]
type = velset
trigger1 = Time = 0
X = -7

[State 820, 減速]
type = velmul
trigger1 = 1
X = 0.94

[State 820, 相手のアニメ変更]
type = ChangeAnim2
trigger1 = Time = 0
value = 722

[State 820, 倒れる]
type = changestate
trigger1 = Time = 12
value = 723

[State 非常用]
type = selfstate
trigger1 = time > 200
value = 5030

;---------------------------------------------------------------------------
;投げ：相手側4 吹っ飛びから着地
[Statedef 723]
type    = A
movetype= H
physics = N
[State 170, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 押し出し]
type = playerpush
trigger1 = 1
value = 0

[State 820, 見かけ]
type = offset
trigger1 = 1
Y = 15

[State 820, 初速]
type = velmul
trigger1 = Time = 0
X = 0.5
[State 820, 初速]
type = velset
trigger1 = Time = 0
Y = -2

[State 820, 重力]
type = veladd
trigger1 = 1
Y = 0.45

[State 5030, 5]
type = Changeanim
trigger1 = time = 0
value = 5030
[State 5030, 5]
type = Changeanim
trigger1 = time = 2
value = 5050

[State 戻す]
type = changestate;selfstate
trigger1 = vel Y > 0 && pos Y >= 25
value = ifelse(Alive,724,5100)

[State 非常用]
type = selfstate
trigger1 = time > 200
value = 5030

;---------------------------------------------------------------------------
;投げ：相手側5 バウンド
[Statedef 724]
type    = L
movetype= H
physics = N
[State アニメ変更]
type = Changeanim
trigger1 = !time
value = 5160

[State 5101, 5] ;Acceleration
type = posAdd
trigger1 = !time
y = -5
[State 5101, 5] ;Acceleration
type = Velset
trigger1 = !time
y = -3.5
[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = 0.35

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12
type = changeState
value = 725

[State 変更]
type = selfstate
trigger1 = time > 200
value = 5100
;---------------------------------------------------------------------------
;投げ：相手側6 ダウン
[Statedef 725]
type    = L
movetype= H
physics = N
[State pos]
type = posset
trigger1 = !time
y = 0
[State pos]
type = velset
trigger1 = !time
X = 0
Y = 0
[State アニメ変更]
type = Changeanim
trigger1 = !time
value = 5170
[State アニメ変更]
type = Changeanim
trigger1 = anim=5170 && animtime=0
value = 5110

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
value = F7, 1

[State 5110, 7]
type = GameMakeAnim
trigger1 = Time = 0
value = 60 + 1
pos = 0, 0
under = 1

[State 変更]
type = selfstate
trigger1 = time >= 25
value = 5120

;---------------------------------------------------------------------------
;投げ抜け　自分
[Statedef 750]
type    = S
movetype= I
physics = S
anim = 750

[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State 810, 掴んだ相手のステート変更]
type = TargetState
triggerall = numtarget(720)
trigger1 = time = 0
value = 760
ID = 720

[State SE]
type = playsnd
trigger1 = time = 0
value = 1,2

[State 輪っか]
type = Explod
trigger1 = !numexplod(760) && time = 0
anim = 760
postype = p1
pos = 32,-60
ID = 760
IgnoreHitPause = 1
scale = Const(size.yscale)*0.6, Const(size.yscale)*0.6
ontop = 1
OwnPal = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = -2

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 22
PauseBG = 0;背景はそのまま
persistent = 0

[State 後ずさり]
type = velset
trigger1 = time = 1
X = -5

[State 戻る]
type = selfstate
trigger1 = time > 30
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;投げ抜け　相手
[Statedef 760]
type    = S
movetype= I
physics = S

[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State 5030, 5]
type = Changeanim
trigger1 = time = 0
value = 5011

[State 5030, 5]
type = Changeanim
trigger1 = anim = 5011 && animtime = 0
value = 5016

[State 後ずさり]
type = velset
trigger1 = time = 1
X = -5

[State PalFX]
type = PalFX
trigger1 = time = 22
trigger2 = time = 28
time = 2
add = 100,100,100
ignorehitpause = 1

[State 戻る]
type = selfstate
trigger1 = time > 30
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;挑発
[Statedef 940]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 940
ctrl = 0
sprpriority = 2
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0

[State デバグ]
type = Varset
trigger1 = enemy,name = "TRM Man"
var(51) = 100
IgnoreHitPause = 1

[State 声を決める変数]
type = varset
trigger1 = Time = 0
var(23) = 2
;Var(23) = 挑発  0:LESSON4,敬意を払え
;                1:いィーねェー
;                2:かなり大爆笑
;                3:おったまげたな！今年最大のヒットじゃあないの！？
;                4:ここで全てを終わらせる！
;                5:この間合いだ、必ず致命傷になる、下がるんだ！
;                6:冗談だよ、うそ、落ち着けよ
;                7:そう、落ち着けって、僕の方がな
;                8:爪弾の射程に入ったなら即、始末してやる！
;                9:つまらんただの薄っぺらなハッタリ屋だったか
;               10:諦めねーぞ…
;               11:どういう性格なんだ
;               12:僕に信じさせてみろ！
;               13:降りる気なんてさらさらないよ
;               14:国へ帰るなら今が最後だ
;               15:今、ここで僕を説得してみろ！
;               16:今度追撃するのはぼくの番だ！

[State ボイス再生開始時間変数]
type = null
triggerall = !time
trigger1 = 1 || var(23)=2
trigger1 = 1 || var(24):=3
[State アニメ終了時間変数]
type = null
triggerall = !time
trigger1 = 1 || var(23)=2
trigger1 = 1 || var(25):=60

[State 声]
type = PlaySnd
trigger1 = Time = var(24)
value = 940, var(23)

[State アニメ終了へ]
type = Changeanim
trigger1 = animelemtime(4)<0 && time >= var(25)
value = anim
elem = 4

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[State ヒット定義]
type = HitDef
triggerall = var(22)=0;引き起こしコン未成功
trigger1 = !time
trigger1 = movecontact=0 && movereversed=0
attr = S, ST
hitflag = FD+
Ground.Type = N
NumHits = 0
PauseTime = 0,0
HitSound = -1
GuardSound = -1
SparkNo = -1
Guard.SparkNo = -1
P1StateNo = 961
P2StateNo = 962
Guard.Dist = 0
[State ヒット定義]
type = HitDef
triggerall = var(22)=1
trigger1 = !time
trigger1 = movecontact=0 && movereversed=0
attr = S, ST
hitflag = FD+
Ground.Type = N
NumHits = 0
PauseTime = 0,0
HitSound = -1
GuardSound = -1
SparkNo = -1
Guard.SparkNo = -1
P1StateNo = 961
P2StateNo = 963
Guard.Dist = 0

;---------------------------------------------------------------------------
;挑発 成功した自分側
[Statedef 961]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 2
[State 成功スイッチ]
type = varset
trigger1 = target,statetype != L && target,stateno != 962
var(22)=1

[State 声]
type = PlaySnd
trigger1 = Time = var(24)
value = 940, var(23)

[State アニメ終了へ]
type = Changeanim
trigger1 = animelemtime(4)<0 && time >= var(25)
value = anim
elem = 4

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[State 時間停止]
type = Pause
trigger1 = time < var(25)
Time = 2
movetime = 2
PauseBG = 0;背景はそのまま

;---------------------------------------------------------------------------
;挑発 くらった相手側 挑発コン未成功
[Statedef 962]
type    = S;L
movetype= H
physics = S
velset = 0,0

[State DefenceMulSet];相手が常にこれ使ってるなら不具合
Type = DefenceMulSet
Trigger1 = 1
value = 1

[State 落下解除]
Type = HitFallSet
Trigger1 = 1
value = 0

[state ダウン中無敵]
type = nothitby
trigger1 = time = 0
value = SCA
time = 1

[State 位置変更]
type = posset
trigger1 = time = 1
Y = 0
[State アニメ変更]
type = Changeanim2
trigger1 = time = 1
value = 962

[State ステート変更]
type = selfstate
trigger1 = time > 1
value = 5120
;---------------------------------------------------------------------------
;挑発 くらった相手側 挑発コン成功済み
[Statedef 963]
type    = S;L
movetype= H
physics = S
velset = 0,0

[State 落下解除]
Type = HitFallSet
Trigger1 = 1
value = 0

[state ダウン中無敵]
type = nothitby
trigger1 = 1;time = 0
value = SCA
time = 1

[State 位置変更]
type = posset
trigger1 = time = 1
Y = 0
[State アニメ変更]
type = Changeanim2
trigger1 = time = 1
value = 962

[State ステート変更]
type = selfstate
trigger1 = time > 1
value = 5120
;===========================================================================
; 必殺技
;===========================================================================
;牙！L
[Statedef 1000]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1000
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 2
value = 200, 0
channel = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1000 && animelemtime(7) = 0
trigger2 = anim = 1000 && animelemtime(10) = 0
value = 0, 9

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1000 && animelemtime(7) = 0
trigger2 = anim = 1000 && animelemtime(10) = 0
anim = 1005
ID = 1005
pos = ceil(42*const(size.xscale)),  ceil(-52*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射エフェクト]
type = Explod
trigger1 = anim = 1000 && animelemtime(7) = 0
trigger2 = anim = 1000 && animelemtime(10) = 0
anim = 1007
ID = 1007
pos = ceil(42*const(size.xscale)),  ceil(-52*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.28*const(size.xscale), 0.27*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 爪弾]
type = helper
trigger1 = anim = 1000 && animelemtime(7) = 0
trigger2 = anim = 1000 && animelemtime(10) = 0
name = "spin nail"
stateno = 1050
ID = 1050
postype = p1
pos = ceil(42*const(size.xscale)) -30,  ceil(-52*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===========================================================================
;牙！M
[Statedef 1010]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1010
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 2
value = 200, 0
channel = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1010 && animelemtime(7) = 0
trigger2 = anim = 1010 && animelemtime(10) = 0
trigger3 = anim = 1010 && animelemtime(13) = 0
value = 0, 9

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1010 && animelemtime(7) = 0
trigger2 = anim = 1010 && animelemtime(10) = 0
trigger3 = anim = 1010 && animelemtime(13) = 0
anim = 1005
ID = 1005
pos = ceil(42*const(size.xscale)),  ceil(-52*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射エフェクト]
type = Explod
trigger1 = anim = 1010 && animelemtime(7) = 0
trigger2 = anim = 1010 && animelemtime(10) = 0
trigger3 = anim = 1010 && animelemtime(13) = 0
anim = 1007
ID = 1007
pos = ceil(42*const(size.xscale)),  ceil(-52*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.28*const(size.xscale), 0.27*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 爪弾]
type = helper
trigger1 = anim = 1010 && animelemtime(7) = 0
trigger2 = anim = 1010 && animelemtime(10) = 0
trigger3 = anim = 1010 && animelemtime(13) = 0
name = "spin nail"
stateno = 1050
ID = 1050
postype = p1
pos = ceil(42*const(size.xscale)) -30,  ceil(-52*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===========================================================================
;牙！H
[Statedef 1020]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1020
ctrl = 0
sprpriority = 2

[State 声]
type =PlaySnd
trigger1 = Time = 2
value = 200, 0
channel = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1020 && animelemtime(7) = 0
trigger2 = anim = 1020 && animelemtime(10) = 0
trigger3 = anim = 1020 && animelemtime(13) = 0
trigger4 = anim = 1020 && animelemtime(16) = 0
value = 0, 9

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1020 && animelemtime(7) = 0
trigger2 = anim = 1020 && animelemtime(10) = 0
trigger3 = anim = 1020 && animelemtime(13) = 0
trigger4 = anim = 1020 && animelemtime(16) = 0
anim = 1005
ID = 1005
pos = ceil(42*const(size.xscale)),  ceil(-52*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射エフェクト]
type = Explod
trigger1 = anim = 1020 && animelemtime(7) = 0
trigger2 = anim = 1020 && animelemtime(10) = 0
trigger3 = anim = 1020 && animelemtime(13) = 0
trigger4 = anim = 1020 && animelemtime(16) = 0
anim = 1007
ID = 1007
pos = ceil(42*const(size.xscale)),  ceil(-52*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.28*const(size.xscale), 0.27*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 爪弾]
type = helper
trigger1 = anim = 1020 && animelemtime(7) = 0
trigger2 = anim = 1020 && animelemtime(10) = 0
trigger3 = anim = 1020 && animelemtime(13) = 0
trigger4 = anim = 1020 && animelemtime(16) = 0
name = "spin nail"
stateno = 1050
ID = 1050
postype = p1
pos = ceil(42*const(size.xscale)) -30,  ceil(-52*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;爪弾 ヘルパー
[Statedef 1050]
type    = A
movetype= A
physics = N
velset = 5.5,0
anim = 1050
ctrl = 0
sprpriority = 2

[State 回転エフェ]
type = Explod
trigger1 = time = 0
anim = 1051
postype = p1
pos = 0 +30,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.45*const(size.xscale), 0.45*const(size.xscale)
ID = 1051
BindTime = -1
SprPriority = 4
RemoveTime = 180
OwnPal = 1

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = C, SP
damage = ceil(13*root,fvar(0)), ceil(2*root,fvar(0))
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 4, 4
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 20;17
ground.velocity = -2.2
airguard.velocity = -1.9,-0.8
air.type = L
air.velocity = -1.2,-2
air.hittime = 17
Guard.Velocity = -3
Guard.CtrlTime = 14
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 35*(1+(root,var(48)>0)*0.1) ),ceil( 17*(1+(root,var(48)>0)*0.1) )
givepower = 16,8
fall = 0
air.fall = 1
fall.recovertime = 40

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = 40,0
random = 10,10
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1
var(6) = 1
persistent = 0
IgnoreHitPause = 1

[State 回転エフェact1を消す]
type = removeExplod
trigger1 = numexplod(1051) && movecontact
trigger2 = numexplod(1051) && ScreenPos X != [-50,320+50]
ID = 1051
ignorehitpause = 1

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State ヒットで消滅]
type = destroyself
trigger1 = movecontact
trigger2 = ScreenPos X != [-50,320+50]
IgnoreHitPause = 1

[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1052
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;爪弾ヘルパー消滅ステート
[Statedef 1052]
type    = A

[State 回転エフェact1を消す]
type = removeExplod
trigger1 = numexplod(1051)
ID = 1051
ignorehitpause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = numexplod(1358)
ID = 1358
ignorehitpause = 1

[State act2残像を消す]
type = removeExplod
trigger1 = numexplod(1452)
ID = 1452
[State 残像を消す]
type = removeExplod
trigger1 = numexplod(1453)
ID = 1453
[State 残像を消す]
type = removeExplod
trigger1 = numexplod(1454)
ID = 1454
[State 残像を消す]
type = removeExplod
trigger1 = numexplod(1455)
ID = 1455

[State 消滅]
type = destroyself
trigger1 = 1
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;爪の方が回転してる！
[Statedef 1100]
type    = S
movetype= A
physics = S
;velset = 0,0
anim = 1100
ctrl = 0
sprpriority = 2

[state 無敵化]
type = nothitby
trigger1 = animelemtime(6) < 1
value = SCA,AA,AP,AT

[State PalFX]
type = PalFX
trigger1 = time = 0
trigger2 = time = 6
time = 3
Mul = 160,160,160
ignorehitpause = 1

[State 声]
type = PlaySnd
trigger1 = Time = 2
value = 200, 1
channel = 0

[State SE]
type = PlaySnd
trigger1 = Time = 2
value =0, 12

[State シルシルエフェクト]
type = Explod
trigger1 = animelemtime(4) = 1
anim = 1120
postype = p1
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.45*Const(size.xscale), 0.45*Const(size.yscale)
ontop = 1
OwnPal = 1
ID = 1120

[State 変数リセット]
type = VarSet
trigger1 = !time
var(1) = 0
IgnoreHitPause = 1

[State 変数]
type = Varset
trigger1 = (AnimElemno(0) = 7) && (movecontact=1 || movereversed=1)
var(1) = 1
IgnoreHitPause = 1
[State 変数]
type = Varset
trigger1 = (AnimElemno(0) = 8) && (movecontact=1 || movereversed=1)
var(1) = 2
IgnoreHitPause = 1

[State ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 6
trigger1 = movecontact=0 && movereversed=0
trigger2 = AnimElemno(0) = 7
trigger2 = var(1)!=1
attr = S, SA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(20*fvar(0)), ceil(4*fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2
Guard.pausetime = 3, 3
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 3
guardsound = s7, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 30
ground.velocity = -3,-1.8
guard.velocity = -0.4
airguard.velocity = -2.4,-1-(AnimElemno(0) = 7)*3.5
air.type = High
air.velocity = -2.5,-2
air.hittime = 12
Guard.CtrlTime = 23
AirGuard.CtrlTime = 28
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 46*(1+(var(48)>0)*0.1) ),ceil( 23*(1+(var(48)>0)*0.1) )
givepower = 18,9
fall = 1
fall.recovertime = 28

[State ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 8
trigger1 = var(1)!=2
attr = S, SA ;立ち通常打撃（Standing, Normal Attack）
damage = ceil(20*fvar(0)), ceil(4*fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2
Guard.pausetime = 2, 2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 3
guardsound = s7, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 30
ground.velocity = -4,-4.1
guard.velocity = -3.5
airguard.velocity = -2.4,-4
air.type = High
air.velocity = -2.5,-6
air.hittime = 30
Guard.CtrlTime = 27
AirGuard.CtrlTime = 28
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 50*(1+(var(48)>0)*0.1) ),ceil( 24*(1+(var(48)>0)*0.1) )
givepower = 18,9
fall = 1
fall.recovertime = 28
yaccel = 0.4

[State 変数リセット]
type = VarSet
trigger1 = !time
var(1) = 0

[State 変数];animelem=7でヒットしたら1
type = VarSet
trigger1 = AnimElemno(0) = 7 && (movecontact=1 || movereversed=1)
var(1) = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1 && animelemno(0) = 6
anim = 820+random%6
postype = p1
pos = P2BodyDist X+20+var(3)%30,-35-var(3)%30
IgnoreHitPause = 1
scale = 0.6, 0.6
facing = ifelse(random%2=0,1,-1)
Vfacing = ifelse(random%2=0,1,-1)
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト強]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1 && animelemno(0) = 6
anim = 810
postype = p1
pos = P2BodyDist X+20+var(3)%30,-35-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.35, 0.35
ontop = 1
OwnPal = 1
trans = addalpha
alpha = 100,255
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1 && animelemno(0) = 7
anim = 820+random%6
postype = p1
pos = P2BodyDist X+25+var(3)%30,-55-var(3)%30
IgnoreHitPause = 1
scale = 0.6, 0.6
facing = ifelse(random%2=0,1,-1)
Vfacing = ifelse(random%2=0,1,-1)
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト強]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1 && animelemno(0) = 7
anim = 810
postype = p1
pos = P2BodyDist X+25+var(3)%30,-55-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.35, 0.35
ontop = 1
OwnPal = 1
trans = addalpha
alpha = 100,255
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1 && animelemno(0) = 8
anim = 820+random%6
postype = p1
pos = P2BodyDist X+25+var(3)%20,-75-var(3)%30
IgnoreHitPause = 1
scale = 0.6, 0.6
facing = ifelse(random%2=0,1,-1)
Vfacing = ifelse(random%2=0,1,-1)
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト強]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1 && animelemno(0) = 8
anim = 810
postype = p1
pos = P2BodyDist X+25+var(3)%20,-75-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.35, 0.35
ontop = 1
OwnPal = 1
trans = addalpha
alpha = 100,255
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded = 1 && HitPauseTime = 2-1
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 1100, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;これはなんなんだ！？
[Statedef 1200]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1200
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 200, 2
channel = 0

[State SE]
type = PlaySnd
trigger1 = Time = 5
value =0, 11

[State スパーダエフェクト]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1220
postype = p1
pos = 40,0
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.9, Const(size.yscale)
sprpriority = 7
OwnPal = 1
ID = 1220

[State 溝エフェクト]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1228
postype = p1
pos = 20,4
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.9, Const(size.yscale)*0.9
sprpriority = 5
trans = sub
ID = 1228
removetime = 22
OwnPal = 1
[State 溝を動かす]
type = modifyExplod
trigger1 = numexplod(1228)
anim = 1228
postype = p1
pos = 20,4
ID = 1228
IgnoreHitPause = 1
scale = Const(size.yscale)*ifelse(animelemtime(6)<5,animelemtime(6)*0.92,5*0.92)*0.9, Const(size.yscale)*ifelse(animelemtime(6)<20,0.9,0.3)
bindtime = 1

[State 煙]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1225
postype = p1
pos = 40,0
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.8, Const(size.yscale)*0.8
sprpriority = 6
OwnPal = 1
ID = 1225
[State 煙]
type = Explod
trigger1 = animelemtime(6) = 3
anim = 1225
postype = p1
pos = 70,0
IgnoreHitPause = 1
Persistent = 0
OwnPal = 1
scale = Const(size.yscale)*0.8, Const(size.yscale)*0.8
sprpriority = 6
ID = 1225
[State 煙]
type = Explod
trigger1 = animelemtime(6) = 9
anim = 1225
postype = p1
pos = 100,0
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.9, Const(size.yscale)*0.9
sprpriority = 6
OwnPal = 1
ID = 1225

[State 変数リセット]
type = VarSet
trigger1 = !time
var(1) = 0

[State 変数];ヒットすると増加
type = Varadd
trigger1 = (AnimElemno(0) = [7,9]) && (movecontact=1 || movereversed=1)
var(1) = 1

[State 200, ヒット定義1]
type = HitDef
triggerall = AnimElemno(0) = 7
triggerall = var(1)<4
trigger1 = movecontact=0 && movereversed=0
trigger2 = movecontact>2 || movereversed>2
attr = C, SP
damage = ceil(12*fvar(0)), ceil(1*fvar(0))
animtype = H
guardflag = LA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 4
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 3
guardsound = s7, 0
ground.type = L
ground.slidetime = 7
ground.hittime  = 7
ground.velocity = -1,-3
airguard.velocity = -1.9,-.8
air.type = L
air.velocity = -2,1
Guard.Velocity = -4
Guard.CtrlTime = 7
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 36*(1+(var(48)>0)*0.1) ),ceil( 18*(1+(var(48)>0)*0.1) )
givepower = 17,8
YAccel = 0.5
fall = 1
Fall.Recover = 0
Fall.YVelocity = 0
[State 200, ヒット定義1]
type = HitDef
triggerall = AnimElemno(0) = [8,9]
triggerall = var(1)<4
trigger1 = movecontact=0 && movereversed=0
trigger2 = movecontact>2 || movereversed>2
attr = C, SP
damage = ceil(12*fvar(0)), ceil(1*fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 4
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 3
guardsound = s7, 0
ground.type = L
ground.slidetime = 7
ground.hittime  = 7
ground.velocity = -1,-3
airguard.velocity = -1.9,-.8
air.type = L
air.velocity = -2,1
Guard.Velocity = -4
Guard.CtrlTime = 7
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 36*(1+(var(48)>0)*0.1) ),ceil( 18*(1+(var(48)>0)*0.1) )
givepower = 17,8
YAccel = 0.5
fall = 1
Fall.Recover = 0
Fall.YVelocity = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && HitPauseTime = 2-1
anim = 820+random%6
postype = p1
pos = P2BodyDist X+20+var(3)%20+var(1)*8,-15-var(3)%20
IgnoreHitPause = 1
scale = 0.45, 0.45
facing = ifelse(random%2=0,1,-1)
Vfacing = ifelse(random%2=0,1,-1)
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded = 1 && HitPauseTime = 2-1
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 1100, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾 L
[Statedef 1300]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1300
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 0 && (var(37)>=100 || var(37)=0)
trigger1 = 1 || var(37):=1;言い始めスイッチスタート
value = 200, 7
channel = 0

[State SE]
type = PlaySnd
trigger1 = animelemtime(4) = 2
value = 0, 15
[State SE]
type = PlaySnd
trigger1 = animelemtime(7) = 2
value = 0, 8

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1360
ID = 1360
pos = ceil(38*const(size.xscale)),  ceil(-50*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1355
ID = 1355
pos = ceil(38*const(size.xscale)),  ceil(-50*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.49*const(size.yscale), 0.49*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 黄金回転爪弾]
type = helper
trigger1 = animelemtime(8) = 0
name = "goldspin nail"
stateno = 1350
ID = 1350
postype = p1
pos = ceil(38*const(size.xscale)) -30,  ceil(-50*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(8) = 0
var(51) = -10
persistent = 0

[State 反動]
type = veladd
trigger1 = animelemtime(8) = 0
X = -2.4
persistent = 0

[State ｺﾝﾄﾛｰﾙ]
type = null;ctrlset
trigger1 = animelemtime(15) = 0
value = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾 M
[Statedef 1310]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1310
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 0 && (var(37)>=100 || var(37)=0)
trigger1 = 1 || var(37):=1;言い始めスイッチスタート
value = 200, 7
channel = 0

[State SE]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 0, 15
[State SE]
type = PlaySnd
trigger1 = animelemtime(7) = 2
value = 0, 8

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1361
ID = 1360
pos = ceil(31*const(size.xscale)),  ceil(-74*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1390
ID = 1355
pos = ceil(30*const(size.xscale)),  ceil(-74*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.49*const(size.yscale), 0.49*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 黄金回転爪弾]
type = helper
trigger1 = animelemtime(8) = 0
name = "goldspin nail"
stateno = 1360
ID = 1360
postype = p1
pos = ceil(31*const(size.xscale)) -30,  ceil(-74*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(8) = 0
var(51) = -10
persistent = 0

[State 反動]
type = veladd
trigger1 = animelemtime(8) = 0
X = -2.0
persistent = 0

[State ｺﾝﾄﾛｰﾙ]
type = null;ctrlset
trigger1 = animelemtime(16) = 0
value = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾 H
[Statedef 1320]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1320
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 0 && (var(37)>=100 || var(37)=0)
trigger1 = 1 || var(37):=1;言い始めスイッチスタート
value = 200, 7
channel = 0

[State SE]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 0, 15
[State SE]
type = PlaySnd
trigger1 = animelemtime(7) = 2
value = 0, 8

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1362
ID = 1360
pos = ceil(5*const(size.xscale)),  ceil(-92*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1395
ID = 1355
pos = ceil(5*const(size.xscale)),  ceil(-92*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.49*const(size.yscale), 0.49*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 黄金回転爪弾]
type = helper
trigger1 = animelemtime(8) = 0
name = "goldspin nail"
stateno = 1370
ID = 1370
postype = p1
pos = ceil(5*const(size.xscale)) -30,  ceil(-92*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(8) = 0
var(51) = -10
persistent = 0

[State 反動]
type = veladd
trigger1 = animelemtime(8) = 0
X = -1.3
persistent = 0

[State ｺﾝﾄﾛｰﾙ]
type = null;ctrlset
trigger1 = animelemtime(15) = 0
value = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾L 弾丸ヘルパー
[Statedef 1350]
type    = A
movetype= A
physics = N
velset = 7.4,0
;anim = 1350
ctrl = 0
sprpriority = 2
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 1350 && time = 0
value = 1350

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 100

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = !numtarget;movecontact=0 && movereversed=0
trigger1 = 1 || fvar(0):=root,fvar(0);ヒット時の補正式を保存
attr = S, SP
damage = ceil(25*root,fvar(0)*ifelse((root,fvar(0)=[1.9,2.3]),(0.75),1)), ceil(18*root,fvar(0))
animtype = B
guardflag = MA
hitflag = MAFP
priority = 4, Hit
pausetime = 12, 9+(enemy,statetype=A)*2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 17
ground.hittime  = 20
ground.velocity = -4,-4
airguard.velocity = -1.9,-0.8
air.type = L
air.velocity = -4,-0.5
air.hittime = 17
AirGuard.CtrlTime = 17
Guard.Velocity = -7
airGuard.Velocity = -4,-3
Guard.CtrlTime = 20
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 0,0
fall = 1
fall.recover = 0
EnvShake.Time = 18
EnvShake.Ampl = 4+(root,fvar(0)=[1.9,2.3])
EnvShake.Freq = 60
[State ダメージ処理];アーマーを殺してしまうので
Type = targetlifeadd
trigger1 = numtarget && movehit
value = -Floor(55*fvar(0)*ifelse((fvar(0)=[1.9,2.3]),(0.75),1))
IgnoreHitPause = 1
Persistent = 0
Absolute = 0
[State ゲージ処理]
Type = poweradd
trigger1 = numtarget
value = (movehit)*ceil( 120*(1+(root,var(48)>0)*0.1) )+(moveguarded)*ceil( 60*(1+(root,var(48)>0)*0.1) )
IgnoreHitPause = 1
Persistent = 0
[State ゲージ処理]
Type = targetpoweradd
trigger1 = numtarget
value = (movehit)*70+(moveguarded)*30
IgnoreHitPause = 1
Persistent = 0

[State ヒットしてもターゲットとれないとき回数加算]
type = varadd
trigger1 = movecontact=1 && !numtarget
var(0) = 1
IgnoreHitPause = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%10 +30,-0-root,var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.52, 0.52
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1358
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 180
scale = 0.2*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%5 = 0 && time != 0
anim = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
scale = 0.27*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.5
removetime = -2

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1
var(6) = 1
persistent = 0

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1
[State 飛び道具以外無敵];ヒットしたらグルグル確定
Type = notHitby
trigger1 = numtarget
value2 = SCA
IgnoreHitPause = 1

[State グルグルエフェクト減算]
type = Explod
trigger1 = movecontact && numtarget
anim = 1380
ID = 1380
pos = 5 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*root,const(size.yscale), 0.45*root,const(size.yscale)
sprpriority = 6
OwnPal = 1
persistent = 0
trans = sub
vel = 0.11
IgnoreHitPause = 1
[State グルグルエフェクト通常]
type = Explod
trigger1 = movecontact && numtarget
anim = 1385
ID = 1385
pos = 5 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.48*root,const(size.yscale), 0.48*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
vel = 0.11

[State ヒットアニメ変更]
type = changeanim
trigger1 = movecontact
value = 1350
elem = 1
IgnoreHitPause = 1

[State ヒットした時の相手の状態]
type = varset
trigger1 = numtarget
var(10) = (target,statetype=A)
IgnoreHitPause = 1
persistent = 0

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2;挑発成功
ID = 1358
ignorehitpause = 1\
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2;挑発成功

[State ヒットで移動]
type = changestate;destroyself
trigger1 = movecontact && numtarget
value = 1352
;IgnoreHitPause = 1

[State やられても耐える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,NP,SP;SCA,AP
StateNo = ifelse(var(0)<3,1351,1052)
IgnoreHitPause = 1
slot = 0
[State やられると消える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,HP;SCA,AP
StateNo = 1052
IgnoreHitPause = 1
slot = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾 LMH 弾丸ヘルパー やられてるヒットストップ
[Statedef 1351]
type    = A
movetype= H
physics = N
ctrl = 0
sprpriority = 2
[State 受けた回数加算]
type = varadd
trigger1 = !time
var(0) = 1
[State ちょっと動く?]
type = posadd
trigger1 = !time
X = vel X*0.3
Y = vel Y*0.3
[State 戻る]
type = changestate
trigger1 = time > 2;hitover
value = ifelse((Atan(-vel Y/vel X**1.0))*180/Pi**1.0<10,1350,ifelse((Atan(-vel Y/vel X**1.0))*180/Pi**1.0<45,1360,1370))
;それぞれ速度に対応したところへ
;IgnoreHitPause = 1
[State 無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1
[State やられても耐える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1351
IgnoreHitPause = 1
[State やられヒットストップ]
type = posfreeze
trigger1 = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾LMH ヒットしてグルグルする ヘルパー
[Statedef 1352]
type    = A
movetype= A
physics = N
anim = ifelse((Atan(-vel Y/vel X**1.0))*180/Pi**1.0<10,1352,ifelse((Atan(-vel Y/vel X**1.0))*180/Pi**1.0<45,1372,1376))
;それぞれ速度に対応したところへ
ctrl = 0
sprpriority = 2

[State 200, ヒット定義]
type = HitDef
trigger1 = 1
attr = S, SP
damage = floor(2*root,fvar(0)), floor(4*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAFP
priority = 4, Hit
pausetime = 2 -(ishelper(1370))*1, 1;-var(10)
Guard.PauseTime = 2 -(ishelper(1350)&&animelemno(0)<=2)*1, 1
sparkno = -1
Guard.SparkNo = -1
hitsound = -1,-1;s6, 1
guardsound = s7, 0
ground.type = H
ground.slidetime = 1
ground.hittime  = 5
ground.velocity = -1
guard.velocity = -4.0 ;+(ishelper(1580))*1;回り込み爪弾の時
airguard.velocity = -3,1+animelemno(0)
air.type = H
air.velocity = -4.8-var(10)*1.0 -(ishelper(2150))*2,-0.2 +var(10)*1.0 +(ishelper(1370))*1;相手が空中だったなら追撃しにくく
air.hittime  = 3;18
AirGuard.CtrlTime = 20
Guard.Velocity = -1
Guard.CtrlTime = 4
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 5*(1+(root,var(48)>0)*0.1) ),ceil( 2*(1+(root,var(48)>0)*0.1) )
givepower = 8,4
fall = 1
fall.recovertime = 3+(ishelper(1350)=0)*40;10 +(ishelper(1350)=0)*50
Fall.YVelocity = -3
yaccel = 0.37+var(10)*0.1 +(ishelper(1370))*0.1

[State ヒットサウンド]
type = PlaySnd
trigger1 = Movehit = 1 && hitpausetime = 2-1 && time%2=1
value = 6, 1
volume = -20
IgnoreHitPause = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && hitpausetime = 2-1
anim = 801
postype = p1
pos = -12+root,random%24 +30,-12+root,random%24
IgnoreHitPause = 1
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded = 1 && hitpausetime = 2-1
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1 && hitpausetime = 2-1 && !ishelper(1530);ACT3の爪弾は別処理
var(6) = 1
IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = animtime=0
trigger2 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger3 = root,movehit;そもそも攻撃の邪魔をしない
trigger4 = ishelper(1350)&&moveguarded&&animelemtime(4)=0
ID = 1358
ignorehitpause = 1
[State 消す]
type = destroyself
trigger1 = animtime=0
trigger2 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger3 = root,movehit;そもそも攻撃の邪魔をしない
trigger4 = ishelper(1350)&&moveguarded&&animelemtime(4)=0
ignorehitpause = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾M 弾丸ヘルパー
[Statedef 1360]
type    = A
movetype= A
physics = N
velset = 7.4*cos(32*Pi/180),-7.4*sin(32*Pi/180)
ctrl = 0
sprpriority = 2
[State アニメ変更]
type = Changeanim
trigger1 = Anim != ifelse( ishelper(1580),1586,1370) && time = 0
value = ifelse( ishelper(1580),1586,1370)

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 100

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = !numtarget;movecontact=0 && movereversed=0
trigger1 = 1 || fvar(0):=root,fvar(0);ヒット時の補正式を保存
attr = S, SP
damage = ceil(25*root,fvar(0)*ifelse((root,fvar(0)=[1.9,2.3]),(0.75),1)), ceil(14*root,fvar(0))
animtype = B
guardflag = MA
hitflag = MAFP
priority = 4, Hit
pausetime = 12, 9
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 17
ground.hittime  = 17
ground.velocity = -3,-2.5
airguard.velocity = -1.5,-0.5
air.type = H
air.velocity = -4,-1.8
air.hittime = 17
AirGuard.CtrlTime = 17
Guard.Velocity = -7.0
airGuard.Velocity = -4,-3
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 0,0
fall = 1
fall.recover = 0
EnvShake.Time = 18
EnvShake.Ampl = 4+(root,fvar(0)=[1.9,2.3])
EnvShake.Freq = 60
[State ダメージ処理];アーマーを殺してしまうので
Type = targetlifeadd
trigger1 = numtarget && movehit
value = -Floor(55*fvar(0)*ifelse((fvar(0)=[1.9,2.3]),(0.75),1)) +(ishelper(1580))*20
IgnoreHitPause = 1
Persistent = 0
Absolute = 0
[State ゲージ処理]
Type = poweradd
trigger1 = numtarget
value = (movehit)*ceil( 120*(1+(root,var(48)>0)*0.1) )+(moveguarded)*ceil( 60*(1+(root,var(48)>0)*0.1) )
IgnoreHitPause = 1
Persistent = 0
[State ゲージ処理]
Type = targetpoweradd
trigger1 = numtarget
value = (movehit)*70+(moveguarded)*30
IgnoreHitPause = 1
Persistent = 0

[State ヒットしてもターゲットとれないとき回数加算]
type = varadd
trigger1 = movecontact=1 && !numtarget
var(0) = 1
IgnoreHitPause = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = -5+root,var(3)%10 +30,-0-root,var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.52, 0.52
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1393
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.2*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%5 = 0 && time != 0
anim = 1392
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.27*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.5*cos(32*Pi/180),-0.5*sin(32*Pi/180)

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1 && numtarget
var(6) = 1
persistent = 0

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1
[State 飛び道具以外無敵];ヒットしたらグルグル確定
Type = notHitby
trigger1 = numtarget
value2 = SCA
IgnoreHitPause = 1

[State グルグルエフェクト減算]
type = Explod
trigger1 = movecontact && numtarget
anim = 1380
ID = 1380
pos = 5 +30, -5
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*root,const(size.yscale), 0.45*root,const(size.yscale)
sprpriority = 6
OwnPal = 1
persistent = 0
trans = sub
vel = 0.11
IgnoreHitPause = 1
[State グルグルエフェクト通常]
type = Explod
trigger1 = movecontact && numtarget
anim = 1385
ID = 1385
pos = 5 +30, -5
postype = p1
bindtime = 1
removetime = -2
scale = 0.48*root,const(size.yscale), 0.48*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
vel = 0.11

[State ヒットアニメ変更]
type = changeanim
trigger1 = movecontact
value = ifelse( ishelper(1580),1586,1370)
elem = 1
IgnoreHitPause = 1

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State ヒットした時の相手の状態]
type = varset
trigger1 = numtarget
var(10) = (target,statetype=A)
IgnoreHitPause = 1
persistent = 0

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2;挑発成功
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2

[State ヒットで移動]
type = changestate;destroyself
trigger1 = movecontact && numtarget
value = 1352
;IgnoreHitPause = 1

[State やられても耐える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,NP,SP;SCA,AP
StateNo = ifelse(var(0)<3,1351,1052)
IgnoreHitPause = 1
slot = 0
[State やられると消える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,HP;SCA,AP
StateNo = 1052
IgnoreHitPause = 1
slot = 1

;---------------------------------------------------------------------------
;黄金回転の爪弾H 弾丸ヘルパー
[Statedef 1370]
type    = A
movetype= A
physics = N
velset = 7.4*cos(58*Pi/180),-7.4*sin(58*Pi/180)
ctrl = 0
sprpriority = 2
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 1374 && time = 0
value = 1374

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 100

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = !numtarget;movecontact=0 && movereversed=0
trigger1 = 1 || fvar(0):=root,fvar(0);ヒット時の補正式を保存
attr = S, SP
damage = ceil(25*root,fvar(0)*ifelse((root,fvar(0)=[1.9,2.3]),(0.75),1)), ceil(14*root,fvar(0))
animtype = B
guardflag = MA
hitflag = MAFP
priority = 4, Hit
pausetime = 12, 9
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 17
ground.hittime  = 17
ground.velocity = -4,-4
air.type = H
air.velocity = -1,-3
air.hittime = 17
AirGuard.CtrlTime = 17
Guard.Velocity = -7.0
airGuard.Velocity = -4,-3
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 0,0
fall = 1
fall.recover = 0
EnvShake.Time = 18
EnvShake.Ampl = 4+(root,fvar(0)=[1.9,2.3])
EnvShake.Freq = 60
[State ダメージ処理];アーマーを殺してしまうので
Type = targetlifeadd
trigger1 = numtarget && movehit
value = -Floor(55*fvar(0)*ifelse((fvar(0)=[1.9,2.3]),(0.75),1))
IgnoreHitPause = 1
Persistent = 0
Absolute = 0
[State ゲージ処理]
Type = poweradd
trigger1 = numtarget
value = (movehit)*ceil( 120*(1+(root,var(48)>0)*0.1) )+(moveguarded)*ceil( 60*(1+(root,var(48)>0)*0.1) )
IgnoreHitPause = 1
Persistent = 0
[State ゲージ処理]
Type = targetpoweradd
trigger1 = numtarget
value = (movehit)*70+(moveguarded)*30
IgnoreHitPause = 1
Persistent = 0

[State ヒットしてもターゲットとれないとき回数加算]
type = varadd
trigger1 = movecontact=1 && !numtarget
var(0) = 1
IgnoreHitPause = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 0 +30,-10-root,var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.52, 0.52
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
pausemovetime = 2147483647
supermovetime = 2147483647
trans = addalpha
alpha = 220,60
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1398
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.2*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%5 = 0 && time != 0
anim = 1397
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.27*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.5*cos(58*Pi/180),-0.5*sin(58*Pi/180)

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1 && numtarget
var(6) = 1
persistent = 0

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1
[State 飛び道具以外無敵];ヒットしたらグルグル確定
Type = notHitby
trigger1 = numtarget
value2 = SCA
IgnoreHitPause = 1

[State グルグルエフェクト減算]
type = Explod
trigger1 = movecontact && numtarget
anim = 1380
ID = 1380
pos = 5+30, -10
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*root,const(size.yscale), 0.45*root,const(size.yscale)
sprpriority = 6
OwnPal = 1
persistent = 0
trans = sub
vel = 0.11
IgnoreHitPause = 1
[State グルグルエフェクト通常]
type = Explod
trigger1 = movecontact && numtarget
anim = 1385
ID = 1385
pos = 5+30, -10
postype = p1
bindtime = 1
removetime = -2
scale = 0.48*root,const(size.yscale), 0.48*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
vel = 0.11

[State ヒットアニメ変更]
type = changeanim
trigger1 = movecontact
value = 1374
elem = 1
IgnoreHitPause = 1

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State ヒットした時の相手の状態]
type = varset
trigger1 = numtarget
var(10) = (target,statetype=A)
IgnoreHitPause = 1
persistent = 0

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = (ScreenPos X != [-50,320+50]) || (ScreenPos Y != [-60,240+60])
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = (ScreenPos X != [-50,320+50]) || (ScreenPos Y != [-60,240+60])
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2

[State ヒットで移動]
type = changestate;destroyself
trigger1 = movecontact && numtarget
value = 1352
;IgnoreHitPause = 1

[State やられても耐える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,NP,SP;SCA,AP
StateNo = ifelse(var(0)<3,1351,1052)
IgnoreHitPause = 1
slot = 0
[State やられると消える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,HP;SCA,AP
StateNo = 1052
IgnoreHitPause = 1
slot = 1

;---------------------------------------------------------------------------
;穴が攻撃をする LMH
[Statedef 1400]
type    = S
movetype= A
physics = S
;velset = 0,0
anim = 1400+var(9)
ctrl = 0
sprpriority = 2

[State 声]
type = PlaySnd
trigger1 = Time = 1
value = 200, 8
channel = 0
volume = 80

[State 発射音]
type = playsnd
trigger1 = time = 2-(var(9)>0)
value = 0,16
persistent = 0
[State 発射音]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 0,9
persistent = 0

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1361
pos = ceil(21*const(size.xscale)),  ceil(-17*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
Vfacing = -1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1390
pos = ceil(21*const(size.xscale)),  ceil(-17*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*const(size.yscale), 0.45*const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.1,0.05
Vfacing = -1

[state 穴]
type = helper
trigger1 = animelemtime(7) = 0
name = "hole"
stateno = 1450+var(9)
ID = 1450
postype = p1
pos = ceil(35*const(size.xscale)) +ifelse(var(9)=20,15,0) -60*0.5*const(size.yscale) , 0
Size.XScale = 0.6;0.5*const(size.yscale)
Size.YScale = 0.6;0.5*const(size.yscale)
persistent = 0
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(7) = 0
var(51) = -10
persistent = 0

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;穴が攻撃をする 移動する穴ヘルパーL
[Statedef 1450]
type    = S
movetype= A
physics = N
anim = 1450
ctrl = 0
sprpriority = 2
[State 画面内に収まる]
Type = posadd
trigger1 = !(ScreenPos X = [0-30*facing,GameWidth-30*facing])
X = (ScreenPos X-GameWidth/2+30*facing<0)*3*facing + (ScreenPos X-GameWidth/2+30*facing>0)*(-3)*facing

[State 速度]
type = velset
trigger1 = !time
X = 1.2
[State 速度制限]
type = velset
trigger1 = abs(vel X) > 1.2
X = ifelse(vel X>0,1.2,-1.2)
[State 追尾加速度]
type = veladd
trigger1 = p2dist X < 30 && vel X > -1.2
X = -0.3
[State 追尾加速度]
type = veladd
trigger1 = p2dist X >= 30 && vel X < 1.2
X = 0.3

[State 透過]
type = trans
trigger1 = 1
trans = sub
IgnoreHitPause = 1

[State 舞い上がる土]
type = null;Explod
trigger1 = time%10 = 0
anim = 1455
postype = p1
pos = 0+60*0.6,0
IgnoreHitPause = 1
scale = 0.6, 0.65
;ID = 1455
BindTime = 1
SprPriority = 4
RemoveTime = -2
OwnPal = 1
trans = sub

[State ふらつく]
type = velset
trigger1 = 1
Y = sin(time*0.1)*0.07

[State 残像expパターンB 1から4];4枚をループする 3Fバインドしたら12F後に3Fバインド
type = Explod
triggerall = time = [0,11]
trigger1 = time%3 = 0
anim = 1453
ID = 1452+time/3
postype = p1
pos = 60*0.5*root,const(size.yscale),0
IgnoreHitPause = 1
scale = 0.5*root,const(size.yscale), 0.5*root,const(size.yscale)
BindTime = 3
SprPriority = 1
RemoveTime = 100;15
[State 残像expパターンB 1]
type = ExplodBindTime
trigger1 = time%12=0
ID = 1452
time = 3
[State 残像expパターンB 2]
type = ExplodBindTime
trigger1 = time%12=3
ID = 1453
time = 3
[State 残像expパターンB 3]
type = ExplodBindTime
trigger1 = time%12=6
ID = 1454
time = 3
[State 残像expパターンB 4]
type = ExplodBindTime
trigger1 = time%12=9
ID = 1455
time = 3

[State 200, ヒット定義]
type = HitDef
trigger1 = !(root,var(48)=2 && animelemno(0)=1)
trigger1 = movecontact=0 && movereversed=0
attr = S, SP
damage = ceil(40*root,fvar(0)), ceil(2*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 12; ダウンさせるなら30
ground.velocity = -3; ダウンさせるなら-0.5*(ifelse(vel X>0,1,-1)),-1.2
airguard.velocity = -1.9,-1
air.type = L
air.velocity = -1.0,-1.8
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 70*(1+(root,var(48)>0)*0.1) ),ceil( 35*(1+(root,var(48)>0)*0.1) )
givepower = 35,17
fall = 0;1
fall.recover = 0
Fall.YVelocity = -2
Guard.CtrlTime = 4
yaccel = 0.32
[State 200, ヒット定義]
type = HitDef
trigger1 = (root,var(48)=2 && animelemno(0)=1)
trigger1 = movecontact=0 && movereversed=0
attr = S, SP
damage = ceil(40*root,fvar(0)), ceil(2*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAFD
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 12; ダウンさせるなら30
ground.velocity = -3; ダウンさせるなら-0.5*(ifelse(vel X>0,1,-1)),-1.2
airguard.velocity = -1.9,-1
air.type = L
air.velocity = -1.0,-1.8
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 70*(1+(root,var(48)>0)*0.1) ),ceil( 35*(1+(root,var(48)>0)*0.1) )
givepower = 35,17
fall = 0
fall.recover = 0
Fall.YVelocity = -2
Guard.CtrlTime = 4
yaccel = 0.32
Down.velocity = -1.0,-1

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = movehit=1
var(6) = 1
persistent = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 30 +(p2dist X>=0)*4 +(p2dist X<0)*(-4),-2
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 飛び道具のみくらう]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = !time
trigger2 = !(enemynear,statetype = L)
var(2) = 0
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = p2statetype = L && (p2dist X = [-3+30,3+30]) && var(2)=0
var(2) = 1
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varadd
trigger1 = var(2)
var(2) = 1
IgnoreHitPause = 1

[State 消滅するときのおまけヒット版]
type = Explod
trigger1 = movecontact
anim = 1460
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.5*root,const(size.xscale), 0.5*root,const(size.xscale)
BindTime = 1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub
[State 消滅するときのおまけ]
type = Explod
trigger1 = movereversed
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = movecontact > 10
trigger5 = root,movetype = H
anim = 1461
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.2*root,const(size.xscale), 0.2*root,const(size.xscale)
BindTime = 1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub
vel = vel X*0.05

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1052
IgnoreHitPause = 1
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1452
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1453
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1454
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1455
[State 消滅]
type = destroyself
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
;---------------------------------------------------------------------------
;穴が攻撃をする 移動する穴ヘルパーM
[Statedef 1460]
type    = S
movetype= A
physics = N
anim = 1450
ctrl = 0
sprpriority = 2
[State 画面内に収まる]
Type = posadd
trigger1 = !(ScreenPos X = [0-30*facing,GameWidth-30*facing])
X = (ScreenPos X-GameWidth/2+30*facing<0)*3*facing + (ScreenPos X-GameWidth/2+30*facing>0)*(-3)*facing

[State 速度]
type = velset
trigger1 = !time
X = 1.6
[State 速度制限]
type = velset
trigger1 = abs(vel X) > 1.6
X = ifelse(vel X>0,1.6,-1.6)
[State 追尾加速度]
type = veladd
trigger1 = p2dist X < 30 && vel X > -1.6
X = -0.2
[State 追尾加速度]
type = veladd
trigger1 = p2dist X >= 30 && vel X < 1.6
X = 0.2

[State 透過]
type = trans
trigger1 = 1
trans = sub
IgnoreHitPause = 1

[State 舞い上がる土]
type = null;Explod
trigger1 = time%10 = 0
anim = 1455
postype = p1
pos = 0+60*0.6,0
IgnoreHitPause = 1
scale = 0.6, 0.65
;ID = 1455
BindTime = 1
SprPriority = 4
RemoveTime = -2
OwnPal = 1
trans = sub

[State ふらつく]
type = velset
trigger1 = 1
Y = sin(time*0.1)*0.07

[State 残像expパターンB 1から4];4枚をループする 3Fバインドしたら12F後に3Fバインド
type = Explod
triggerall = time = [0,11]
trigger1 = time%3 = 0
anim = 1453
ID = 1452+time/3
postype = p1
pos = 60*0.5*root,const(size.yscale),0
IgnoreHitPause = 1
scale = 1.1*root,const(size.yscale), 0.5*root,const(size.yscale)
BindTime = 3
SprPriority = 1
RemoveTime = 100;15
[State 残像expパターンB 1]
type = ExplodBindTime
trigger1 = time%12=0
ID = 1452
time = 3
[State 残像expパターンB 2]
type = ExplodBindTime
trigger1 = time%12=3
ID = 1453
time = 3
[State 残像expパターンB 3]
type = ExplodBindTime
trigger1 = time%12=6
ID = 1454
time = 3
[State 残像expパターンB 4]
type = ExplodBindTime
trigger1 = time%12=9
ID = 1455
time = 3

[State 200, ヒット定義]
type = HitDef
trigger1 = !(root,var(48)=2 && animelemno(0)=1)
trigger1 = movecontact=0 && movereversed=0
attr = S, SP
damage = ceil(40*root,fvar(0)), ceil(2*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 30
ground.velocity = -0.5*(ifelse(vel X>0,1,-1)),-2.2
airguard.velocity = -1.9,-1
air.type = L
air.velocity = -1.0,-2.9;-1.8
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 70*(1+(root,var(48)>0)*0.1) ),ceil( 35*(1+(root,var(48)>0)*0.1) )
givepower = 35,17
fall = 1
fall.recover = 0
Fall.YVelocity = -2
Guard.CtrlTime = 12
yaccel = 0.32
[State 200, ヒット定義]
type = HitDef
trigger1 = (root,var(48)=2 && animelemno(0)=1)
trigger1 = movecontact=0 && movereversed=0
attr = S, SP
damage = ceil(40*root,fvar(0)), ceil(2*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAFD
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 30
ground.velocity = -0.5*(ifelse(vel X>0,1,-1)),-2.2
airguard.velocity = -1.9,-1
air.type = L
air.velocity = -1.0,-2.9;-1.8
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 70*(1+(root,var(48)>0)*0.1) ),ceil( 35*(1+(root,var(48)>0)*0.1) )
givepower = 35,17
fall = 1
fall.recover = 0
Fall.YVelocity = -2
Guard.CtrlTime = 12
yaccel = 0.32
Down.velocity = -1.0,-1.2

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = movehit=1
var(6) = 1
persistent = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 30 +(p2dist X>=0)*4 +(p2dist X<0)*(-4),-2
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 飛び道具のみくらう]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = !time
trigger2 = !(enemynear,statetype = L)
var(2) = 0
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = p2statetype = L && (p2dist X = [-3+30,3+30]) && var(2)=0
var(2) = 1
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varadd
trigger1 = var(2)
var(2) = 1
IgnoreHitPause = 1

[State 消滅するときのおまけヒット版]
type = Explod
trigger1 = movecontact
anim = 1460
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.5*root,const(size.xscale), 0.5*root,const(size.xscale)
BindTime = 1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub
[State 消滅するときのおまけ]
type = Explod
trigger1 = movereversed
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = movecontact > 10
trigger5 = root,movetype = H
anim = 1461
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.2*root,const(size.xscale), 0.2*root,const(size.xscale)
BindTime = 1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub
vel = vel X*0.05

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1052
IgnoreHitPause = 1
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1452
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1453
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1454
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1455
[State 消滅]
type = destroyself
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
;---------------------------------------------------------------------------
;穴が攻撃をする 移動する穴ヘルパーH
[Statedef 1470]
type    = S
movetype= A
physics = N
anim = 1449
ctrl = 0
sprpriority = 2
[State 速度]
type = velset
trigger1 = !time
X = 4.5
[State 速度制限]
type = velset
trigger1 = abs(vel X) > 4.5
X = ifelse(vel X>0,4.5,-4.5)
[State 追尾加速度]
type = veladd
trigger1 = p2dist X < 30 && vel X > -4.5
X = -0.18
[State 追尾加速度]
type = veladd
trigger1 = p2dist X >= 30 && vel X < 4.5
X = 0.18
[State 画面内に収まる]
Type = posadd
trigger1 = ScreenPos X < 0-30*facing +15;画面端ギリではない
X = (ScreenPos X - (0-30*facing+15))
[State 画面内に収まる]
Type = posadd
trigger1 = ScreenPos X > GameWidth-30*facing-15
X = -(ScreenPos X - (GameWidth-30*facing-15))

[State 透過]
type = trans
trigger1 = 1
trans = sub
IgnoreHitPause = 1

[State ふらつく]
type = velset
trigger1 = 1
Y = sin(time*0.1)*0.07

[State 残像expパターンB 1から4];4枚をループする 3Fバインドしたら12F後に3Fバインド
type = Explod
triggerall = time = [0,11]
trigger1 = time%3 = 0
anim = 1453
ID = 1452+time/3
postype = p1
pos = 60*0.5*root,const(size.yscale),0
IgnoreHitPause = 1
scale = 1.8*root,const(size.yscale), 0.5*root,const(size.yscale)
BindTime = 3
SprPriority = 1
RemoveTime = 100;15
[State 残像expパターンB 1]
type = ExplodBindTime
trigger1 = time%12=0
ID = 1452
time = 3
[State 残像expパターンB 2]
type = ExplodBindTime
trigger1 = time%12=3
ID = 1453
time = 3
[State 残像expパターンB 3]
type = ExplodBindTime
trigger1 = time%12=6
ID = 1454
time = 3
[State 残像expパターンB 4]
type = ExplodBindTime
trigger1 = time%12=9
ID = 1455
time = 3

[State 画面端で判定小さくならない]
type = changeanim
trigger1 = animelemno(0)<14 && anim = 1449
trigger1 = !(ScreenPos X > 0-30*facing +8 && ScreenPos X <= GameWidth-30*facing-8)
value = 1449
elem = animelemno(0)+7

[State 200, ヒット定義]
type = HitDef
triggerall = !(root,var(48)=2 && animelemno(0)=1)
triggerall = movecontact=0 && movereversed=0
trigger1 = 0;!(p2bodydist X < 30 && vel X > 0 && ScreenPos X > 0-30*facing +8 && ScreenPos X <= GameWidth-30*facing-8) && time > 7 && enemynear,statetype!=L
trigger2 = enemynear,statetype=L && time > 7
trigger3 = time>=25
trigger4 = time>7 && enemynear,movetype!=H;コンボ中は発生を遅く
attr = S, SP
damage = ceil(40*root,fvar(0)), ceil(2*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 30
ground.velocity = -0.6*(ifelse(vel X>0,1,-1)),-4
airguard.velocity = -1.2,-1
air.type = L
air.velocity = -0.6*(ifelse(vel X>0,1,-1)),-1
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 70*(1+(root,var(48)>0)*0.1) ),ceil( 35*(1+(root,var(48)>0)*0.1) )
givepower = 35,17
fall = 1
fall.recover = 0
Fall.YVelocity = -2
Guard.CtrlTime = 12
yaccel = 0.32
[State 200, ヒット定義]
type = HitDef
triggerall = (root,var(48)=2 && animelemno(0)=1)
triggerall = movecontact=0 && movereversed=0
trigger1 = 0;!(p2bodydist X < 30 && vel X > 0 && ScreenPos X > 0-30*facing +8 && ScreenPos X <= GameWidth-30*facing-8) && time > 7 && enemynear,statetype!=L
trigger2 = enemynear,statetype=L && time > 7
trigger3 = time>=25
trigger4 = time>7 && enemynear,movetype!=H;コンボ中は発生を遅く
attr = S, SP
damage = ceil(40*root,fvar(0)), ceil(2*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAFD
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 30
ground.velocity = -0.6*(ifelse(vel X>0,1,-1)),-4
airguard.velocity = -1.2,-1
air.type = L
air.velocity = -0.6*(ifelse(vel X>0,1,-1)),-1
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 70*(1+(root,var(48)>0)*0.1) ),ceil( 35*(1+(root,var(48)>0)*0.1) )
givepower = 35,17
fall = 1
fall.recover = 0
Fall.YVelocity = -2
Guard.CtrlTime = 12
yaccel = 0.32

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = movehit=1
var(6) = 1
persistent = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 30 +(p2dist X>=0)*4 +(p2dist X<0)*(-4),-2
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 飛び道具のみくらう]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = !time
trigger2 = !(enemynear,statetype = L)
var(2) = 0
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = time>7
trigger1 = p2statetype = L && (p2dist X = [-15+30,15+30]) && var(2)=0 && time>2
var(2) = 1
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varadd
trigger1 = time>7
trigger1 = var(2)
var(2) = 1
IgnoreHitPause = 1

[State 消滅するときのおまけヒット版]
type = Explod
trigger1 = movecontact
anim = 1460
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.5*root,const(size.xscale), 0.5*root,const(size.xscale)
BindTime = 1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub
[State 消滅するときのおまけ]
type = Explod
trigger1 = movereversed
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = movecontact > 10
trigger5 = root,movetype = H
anim = 1461
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.2*root,const(size.xscale), 0.2*root,const(size.xscale)
BindTime = 1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub
vel = vel X*0.05

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1452
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1453
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1454
[State 残像を消す]
type = removeExplod
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2
ID = 1455
[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1052
IgnoreHitPause = 1
[State 消滅]
type = destroyself
triggerall = time > 0
trigger1 = movereversed || movecontact
trigger2 = time >= 120;穴持続時間
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
trigger5 = root,movetype = H
trigger6 = var(9)>2

;---------------------------------------------------------------------------
;自分を撃つッ！
[Statedef 1500]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 1
anim = 1500

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1500 && animelemtime(1) = 1
anim = 1597
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.5, 0.5
sprpriority = 7
OwnPal = 1
[State 発射エフェクトグルグル]
type = Explod
trigger1 = time=0;anim = 1500 && animelemtime(1) = 1
anim = 1595
ID = 1595
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.5, 0.5
sprpriority = 7
OwnPal = 1
trans = sub
[State 発射エフェクトグルグル]
type = modifyExplod
trigger1 = anim = 1500 && animelemtime(4) = 0 && numexplod(1595)
pos = ceil(-5*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
[State 爪弾消費]
type = varadd
trigger1 = anim = 1500 && animelemtime(3) = 0
var(51) = -10
persistent = 0

[State 声]
type = PlaySnd
trigger1 = time = 1
value = 200, 9
channel = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1500 && animelemtime(1) = 0
value = 0, 9
volume = -100
[State SE]
type = PlaySnd
trigger1 = anim = 1500 && animelemtime(1) = 0
value = 0, 19

[State 奥の穴エフェクト]
type = Explod
trigger1 = anim = 1500 && animelemtime(5) = 1
anim = 1450
ID = 1450
postype = p1
pos = ceil(18*const(size.xscale))-30 ,2
IgnoreHitPause = 1
Persistent = 0
scale = 0.5*const(size.yscale), 0.5*const(size.yscale)
OwnPal = 1
sprpriority = 0
removetime = 400
bindtime = -1
trans = sub
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = anim != 1500
ID = 1450

[State SE]
type = PlaySnd
trigger1 = anim = 1500 && animelemtime(5) = 1
value = 0, 19

[state 左腕ヘルパー]
type = helper
trigger1 = anim = 1500 && animelemtime(5) = 0
name = "spinarm"
stateno = 1508
ID = 1510
postype = p1
facing = 1
pos = ceil(20*const(size.xscale))+30,  ceil(0*const(size.yscale))+4
Size.XScale = const(size.yscale)
Size.YScale = const(size.yscale)
persistent = 0

[State SE]
type = PlaySnd
trigger1 = anim=1500 && animelemno(0) = 6 && numhelper(1510)=0
value = 0, 20

[State アニメ変更]
type = Changeanim
trigger1 = anim=1500 && animelemno(0) = 6 && numhelper(1510)=0
value = 1502

[State ctrl変更]
type = ctrlset
trigger1 = anim = 1502 && animelemtime(5) = 0
value = 1

[State ステート変更]
type = Changestate
trigger1 = anim = 1502 && animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;自分を撃つッ！ 左腕ヘルパー 移動中
[Statedef 1508]
type    = S
movetype= I
physics = N
anim = 9999
velset = 6,0
ctrl = 0
sprpriority = 2

[State カメラが追う]
Type = ScreenBound
trigger1 = 1
value = 1
MoveCamera = 1,0
[State 画面内に収まる]
Type = posadd
trigger1 = ScreenPos X < 0 +7;画面端ギリではない
X = (0+7 - ScreenPos X)*facing
[State 画面内に収まる]
Type = posadd
trigger1 = ScreenPos X > GameWidth-7
X = -(ScreenPos X - (GameWidth-7))*facing

[State 奥の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1450
ID = 1450
postype = p1
pos = -60*0.6 , 3
IgnoreHitPause = 1
Persistent = 0
scale = 0.6, 0.6
OwnPal = 1
sprpriority = 0
removetime = 400
bindtime = -1
trans = sub
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = root,movetype = H || root,stateno != 1500
ID = 1450

[State 速度]
type = velset
trigger1 = time = [0,1]
X = ifelse(root,command = "holdback",-7.2,7.2)
[State 速度]
type = velset
trigger1 = time = 8
X = ifelse(vel X < 0,-8.6,8.6)

;[State 速度変更]
;type = veladd
;trigger1 = time > 7 && abs(vel X)<=8
;X = (root,command = "holdfwd")*2.5 + (root,command = "holdback")*(-2.5)
;[State 速度変更]
;type = velmul
;trigger1 = time > 7 && root,command != "holdfwd" && root,command != "holdback"
;X = 0.5
;[State 速度調整]
;type = velset
;trigger1 = abs(vel X)>8
;X = ifelse(vel X<0,-8,8)

[State ステート変更]
type = Changestate
trigger1 = time > 8
trigger1 = !(root,command = "hold_x")
trigger2 = time > 60
value = 1510

[State 修了]
type = destroyself
trigger1 = root,movetype = H || root,stateno != 1500
;---------------------------------------------------------------------------
;自分を撃つッ！ 左腕ヘルパー 射出
[Statedef 1510]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 1510
ctrl = 0
sprpriority = 2
[State カメラが追う]
Type = ScreenBound
trigger1 = 1
value = 1
MoveCamera = 1,0

[State 相手の位置への角度の度];0〜90
type = varset
trigger1 = p2dist Y <= 0 && p2dist X > 0
var(0) = Atan( (-p2dist Y**1.0)/(p2dist X**1.0) )*180/Pi
[State 相手の位置への角度の度];90
type = varset
trigger1 = p2dist Y <= 0 && p2dist X = 0
var(0) = 90
[State 相手の位置への角度の度];91〜180
type = varset
trigger1 = p2dist Y <= 0 && p2dist X < 0
var(0) = 180- Atan( (-p2dist Y**1.0)/(-p2dist X**1.0) )*180/Pi

[State 角度に連結するアニメ変数]
type = varset
trigger1 = !time
var(1) = 70
[State 角度に連結するアニメ変数 追いつかせる 10単位]
type = varadd
triggerall = !(anim = 1510 && animelemno(0)=[1,2])
trigger1 = abs( var(1)-var(0) ) >= 10
var(1) = ifelse(var(1)>var(0),-10,10)
[State 角度に連結するアニメ変数 追いつかせる 1単位]
type = varadd
trigger1 = abs( var(1)-var(0) ) = [1,9]
var(1) = ifelse(var(1)>var(0),-1,1)

[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = var(1) <= 30 && anim!=1523
value = 1523
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) = [31,45]) && anim!=1522
value = 1522
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) = [46,60]) && anim!=1521
value = 1521
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) = [61,90]) && anim!=1520
value = 1520
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) = [91,120]) && anim!=1524
value = 1524
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) = [121,135]) && anim!=1525
value = 1525
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) = [136,150]) && anim!=1526
value = 1526
[State 実際にアニメ変更]
type = Changeanim
triggerall = !(anim = 1510 && animelemno(0)=[1,2]) && anim!=1511 && time<14
trigger1 = (var(1) >= 151) && anim!=1527
value = 1527

[State 爪弾を放つ位置変数]
type = null
trigger1 = anim = 1520
trigger1 = 1 || var(2):= 7
trigger1 = 1 || var(3):= 25
trigger2 = anim = 1521
trigger2 = 1 || var(2):= 10
trigger2 = 1 || var(3):= 22
trigger3 = anim = 1522
trigger3 = 1 || var(2):= 15
trigger3 = 1 || var(3):= 20
trigger4 = anim = 1523
trigger4 = 1 || var(2):= 22
trigger4 = 1 || var(3):= 18
trigger5 = anim = 1524
trigger5 = 1 || var(2):= -7
trigger5 = 1 || var(3):= 25
trigger6 = anim = 1525
trigger6 = 1 || var(2):= -10
trigger6 = 1 || var(3):= 22
trigger7 = anim = 1526
trigger7 = 1 || var(2):= -15
trigger7 = 1 || var(3):= 20
trigger8 = anim = 1527
trigger8 = 1 || var(2):= -25
trigger8 = 1 || var(3):= 16

[state 爪弾]
type = helper
trigger1 = time = 14
name = "goldspin nail"
stateno = 1530
ID = 1530
postype = p1
pos = var(2)*const(size.xscale) -30, -var(3)*const(size.yscale)
Size.XScale = 1
Size.YScale = 1
OwnPal = 1
persistent = 0
[State 爪弾消費]
type = parentvaradd
trigger1 = time = 14
var(51) = -10
persistent = 0

[State SE]
type = PlaySnd
trigger1 = time = 14-1
value = 0, 9
volume = 20

[State 反動]
type = offset
trigger1 = (time = [14,15]) && anim != 1520 && anim != 1524
X = ifelse( (anim=[1524,1527]),2,-2 )
[State 反動]
type = offset
trigger1 = (time = [14,15]) && (anim = 1520 || anim = 1524)
Y = 2

[State 穴エフェクト消滅]
type = removeExplod
trigger1 = (anim=[1511,1512]) && animtime = 0
trigger2 = root,movetype = H || root,stateno != 1500
ID = 1450

[State 修了アニメ変更]
type = Changeanim
trigger1 = time > 18 && !(anim=[1511,1512])
value = 1511 +(anim=[1524,1527])
[State 修了]
type = destroyself
trigger1 = (anim=[1511,1512]) && animtime = 0
trigger2 = root,movetype = H || root,stateno != 1500

;---------------------------------------------------------------------------
;自分を撃つッ！ 爪弾ヘルパー
[Statedef 1530]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1530
sprpriority = 3
[State 角度保存]
type = varset
trigger1 = !time
var(1) = parent,var(1)
[State アニメの都合で角度変更]
type = null
triggerall = !time
trigger1 = var(1)=[0,15]
trigger1 = var(1):=1
trigger2 = var(1)=[16,45]
trigger2 = var(1):=30
trigger3 = var(1)=[46,75]
trigger3 = var(1):=60
trigger4 = var(1)=[76,90]
trigger4 = var(1):=90
trigger5 = var(1)=[180-15,180]
trigger5 = var(1):=-1
trigger6 = var(1)=[180-45,180-16]
trigger6 = var(1):=-30
trigger7 = var(1)=[180-75,180-46]
trigger7 = var(1):=-60
trigger8 = var(1)=[180-90,180-76]
trigger8 = var(1):=-90

[State 実際にアニメ変更]
type = Changeanim
triggerall = !time
trigger1 = var(1) < 20 && anim!=1530
trigger2 = (var(1) = [-19,-1]) && anim!=1527
value = 1530
[State 実際にアニメ変更]
type = Changeanim
triggerall = !time
trigger1 = (var(1) = [20,45]) && anim!=1531
trigger2 = (var(1) = [-45,-20]) && anim!=1526
value = 1531
[State 実際にアニメ変更]
type = Changeanim
triggerall = !time
trigger1 = (var(1) = [46,60]) && anim!=1532
trigger2 = (var(1) = [-60,-46]) && anim!=1525
value = 1532
[State 実際にアニメ変更]
type = Changeanim
triggerall = !time
trigger1 = (var(1) = [61,90]) && anim!=1533
trigger2 = (var(1) = [-90,-61]) && anim!=1524
value = 1533

[State クルット反転]
type = turn
trigger1 = var(1)<0 && time=0
[State クルット反転位置補正]
type = posadd
trigger1 = var(1)<0 && time=0
X = -60

[State 速度変更]
type = velset
trigger1 = !time
X = 6*cos(var(1)*Pi/180); *ifelse( var(1)>=0,1,-1 )
Y = -6*sin(var(1)*Pi/180) *ifelse( var(1)>=0,1,-1 )

[State スプライト用意が面倒なので残像]
Type = AfterImage
trigger1 = !time
time = -1
Length = 4
Timegap = 1
Framegap = 1
PalBright = 0,0,0
PalContrast = 255,255,255
PalAdd = 0,0,0
PalMul = 0.95,0.95,0.95;1,1,1
[State スプライト用意が面倒なので残像]
Type = AfterImagetime
trigger1 = 1
value = 2

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 70

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(70*root,fvar(0)), ceil(4*root,fvar(0))
animtype = B
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 8, 8
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 5
ground.hittime  = 35
ground.velocity = -4,-2
air.type = H
air.velocity = -1.2*(ifelse(vel X>0,1,-1)),-5.4 -ifelse(enemynear,pos Y>-15,1.2,0)
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -8
airGuard.Velocity = -(vel X)*0.3,(vel Y)*0.2
Guard.CtrlTime = 14
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 62*(1+(root,var(48)>0)*0.1) ),ceil( 31*(1+(root,var(48)>0)*0.1) )
givepower = 40,20
fall = 1
fall.recover = 0
p2facing = 1
EnvShake.Time = 18
EnvShake.Ampl = 4
EnvShake.Freq = 50

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%5 +30,-10-root,var(3)%5
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0
anim = ifelse(anim=1530,1358, ifelse(anim=1531,1393, ifelse(anim=1532,1398,1537) ) )
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.22*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト];1530,1533
type = Explod
trigger1 = time%7 = 0 && time != 0
anim = ifelse(anim=1530,1357, ifelse(anim=1531,1392, ifelse(anim=1532,1397,1536) ) )
ID = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.29*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = vel X*0.1,vel Y*0.1

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1
[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1052
IgnoreHitPause = 1

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State グルグルエフェクト減算]
type = Explod
trigger1 = movecontact
anim = 1380
ID = 1380
pos = 5+30, -10
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*root,const(size.yscale), 0.45*root,const(size.yscale)
sprpriority = 6
OwnPal = 1
persistent = 0
trans = sub
vel = 0.1
IgnoreHitPause = 1
[State グルグルエフェクト通常]
type = Explod
trigger1 = movecontact
anim = 1385
ID = 1385
pos = 5+30, -10
postype = p1
bindtime = 1
removetime = -2
scale = 0.48*root,const(size.yscale), 0.48*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
vel = 0.1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = (ScreenPos X != [-50,320+50]) || (ScreenPos Y != [0-50,240+50])
trigger2 = var(9)>2
trigger3 = movecontact
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = (ScreenPos X != [-50,320+50]) || (ScreenPos Y != [0-50,240+50])
trigger2 = var(9)>2
trigger3 = movecontact

[State ヒットで移動]
type = null;changestate
trigger1 = movecontact
value = 1352

;---------------------------------------------------------------------------
;あれは人殺しの目だ
[Statedef 1540]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 1
anim = 1540
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0

[State 押し出し]
type = width
trigger1 = anim = 1540 && AnimElemno(0) = 8
Edge = 30,0
Player = 10,0

[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 200, 15
channel = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1540 && animelemtime(3) = 0
value = 0, 9
volume = -100
[State SE]
type = PlaySnd
trigger1 = anim = 1540 && animelemtime(3) = 0
value = 0, 19

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1540 && animelemtime(3) = 1
anim = 1597
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.5, 0.5
sprpriority = 7
OwnPal = 1
[State 発射エフェクトグルグル]
type = Explod
trigger1 = anim = 1540 && animelemtime(3) = 1
anim = 1596
ID = 1595
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 1,1;0.5, 0.5
sprpriority = 7
OwnPal = 1
trans = sub
[State 発射エフェクトグルグル]
type = modifyExplod
trigger1 = anim = 1540 && animelemtime(6) = 0 && numexplod(1595)
pos = ceil(-5*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
[State 爪弾消費]
type = varadd
trigger1 = anim = 1540 && animelemtime(4) = 0
var(51) = -10
persistent = 0

[state 掴め左腕ヘルパー]
type = helper
trigger1 = anim = 1540 && animelemtime(7) = 0
name = "spinarm"
stateno = 1550
ID = 1550
postype = p1
facing = 1
pos = ceil(30*const(size.xscale)),  ceil(0*const(size.yscale))+4
Size.XScale = const(size.yscale)
Size.YScale = const(size.yscale)
persistent = 0

[State 奥の穴エフェクト]
type = Explod
trigger1 = anim = 1540 && animelemtime(7) = 4
anim = 1450
ID = 1450
postype = p1
pos = ceil(38*const(size.xscale))-30 ,0*const(size.yscale)+5
IgnoreHitPause = 1
Persistent = 0
scale = 0.5*const(size.yscale), 0.5*const(size.yscale)
OwnPal = 1
sprpriority = 0
removetime = 400
bindtime = -1
trans = sub
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = anim = 1540 && time >= 50 && numexplod(1450)
ID = 1450

[State 穴の中連続SE]
type = playsnd
trigger1 = anim = 1540 && animelemtime(8) >= 1 && time%20=0
value = 0,20

[State 成功時]
type = changestate
trigger1 = numhelper(1550) && helper(1550),movehit && helper(1550),numtarget && helper(1550),stateno = 1555
value = 1545

[State アニメ変更]
type = Changeanim
trigger1 = anim = 1540 && time >= 50
value = 1542
[State コントロ]
type = ctrlset
trigger1 = anim = 1542 && animelemtime(5) = 0
value = 1542
[State ステート変更]
type = Changestate
trigger1 = anim = 1542 && animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;あれは人殺しの目だ 成功 本体
[Statedef 1545]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 1
anim = 1545

[State 穴の中連続SE]
type = playsnd
trigger1 = anim != 1542 && time%20=0
value = 0,20

[State アニメ変更 ヒートアップ]
type = Changeanim
trigger1 = anim = 1545 && time >= 20-4
value = 1546

[State しぶきエフェクト]
type = Explod
trigger1 = anim = 1546 && animelemtime(2)=0
anim = 1565
ID = 1565
postype = p1
pos = 42*const(size.xscale) ,6*const(size.yscale)
IgnoreHitPause = 1
scale = 0.5,0.5
Persistent = 0
OwnPal = 1
sprpriority = 0
removetime = 100

[State 穴エフェクト消滅]
type = removeExplod
trigger1 = anim != 1543 && numhelper(1550)=0 && numexplod(1450)
ID = 1450
[State しぶきエフェクト消滅]
type = removeExplod
trigger1 = anim != 1543 && numhelper(1550)=0 && numexplod(1565)
ID = 1565
[State アニメ変更]
type = Changeanim
trigger1 = anim != 1543 && numhelper(1550)=0
value = 1543
[State ステート変更]
type = Changestate
trigger1 = anim = 1543 && animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;あれは人殺しの目だ 掴め左腕ヘルパー
[Statedef 1550]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1550
ctrl = 0
sprpriority = 3
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0

[State 画面内に収まる]
Type = posadd
trigger1 = !(ScreenPos X = [0,GameWidth]) && animelemno(0)=1
X = (ScreenPos X-GameWidth/2<0)*3*facing + (ScreenPos X-GameWidth/2>0)*(-3)*facing
[State 速度]
type = velset
trigger1 = !time
X = ifelse(p2dist X < 50,1,4)
[State 速度制限]
type = velset
trigger1 = abs(vel X) > 6 && animelemno(0)=1
X = ifelse(vel X>0,6,-6)
[State 追尾加速度]
type = veladd
trigger1 = p2dist X < 0 && vel X > -11 && animelemno(0)=1 && parentDist X < -46
X = -3.5
[State 追尾加速度]
type = veladd
trigger1 = p2dist X >= 0 && vel X < 11 && animelemno(0)=1
trigger2 = parentDist X > -46
X = 3.5
[State 停止]
type = velmul
trigger1 = animelemtime(1)>9 && vel X !=0
X = 0.4

[State 奥の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1450
ID = 1450
postype = p1
pos = -60*0.7*root,const(size.yscale)+1,5
IgnoreHitPause = 1
Persistent = 0
scale = 0.8, 0.8
OwnPal = 1
sprpriority = 1
removetime = 400
bindtime = -1
trans = sub
sprpriority = 2
[State 手前の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1451
ID = 1451
postype = p1
pos = -60*0.7*root,const(size.yscale)+1,5
IgnoreHitPause = 1
Persistent = 0
scale = 0.8, 0.8
OwnPal = 1
removetime = 400
bindtime = -1
trans = sub
sprpriority = 4
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = animtime = 0
trigger2 = root,movetype = H
ID = 1450
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = animtime = 0
trigger2 = root,movetype = H
ID = 1451

[State SE]
type = PlaySnd
trigger1 = anim = 1550 && animelemtime(5) = 0
value = 0, 5

[State 800, ヒット定義]
type = HitDef
triggerall = !(id > enemy,id && (enemy,prevstateno = 5001 || enemy,prevstateno = 5011) && enemy,time <= 1)
triggerall = p2movetype!=H
triggerall = p2stateno!=[150,155]
triggerall = p2bodydist X = [-25,25]
triggerall = movecontact=0 && movereversed=0;念のため
trigger1 = root,var(48)!=2;漆黒
trigger1 = root,var(33) >= 5;ガードさせてから5F以降
attr = S, ST
hitflag = M-  ;マイナスが付加されてるので相手が食らい中の時は掴めない
guardflag = 
priority = 1, Miss
sparkno = -1  ;ヒットスパークは表示しない
p1sprpriority = 1
p1facing = 1
p2facing = 1
Fall.YVelocity = 0
p1stateno = 1555
p2stateno = 1560
guard.dist = 0 ;相手のガード態勢に入る距離を0にしてるので、ガード不可
fall = 1
fall.recover = 0
ID = 1560
[State 800, ヒット定義 漆黒中]
type = HitDef
triggerall = !(id > enemy,id && (enemy,prevstateno = 5001 || enemy,prevstateno = 5011) && enemy,time <= 1)
triggerall = !(p2movetype=H && p2statetype!=L)
triggerall = p2stateno!=[150,155]
triggerall = movecontact=0 && movereversed=0;念のため
trigger1 = root,var(48)=2;漆黒
trigger1 = root,var(33) >= 5;ガードさせてから5F以降
attr = S, ST
hitflag = MFD
guardflag = 
priority = 1, Miss
sparkno = -1  ;ヒットスパークは表示しない
Fall.YVelocity = 0
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 1555
p2stateno = 1560
guard.dist = 0 ;相手のガード態勢に入る距離を0にしてるので、ガード不可
fall = 1
fall.recover = 0
ID = 1560

[State 消滅]
type = destroyself
trigger1 = animtime = 0
trigger2 = root,movetype = H
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;あれは人殺しの目だ 掴む左腕ヘルパー　成功
[Statedef 1555]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1555
ctrl = 0
sprpriority = 3

[State 画面振動]
type = envshake
trigger1 = time = 1
time = 12
Ampl = -4
Freq = 50

[State つかむSE]
type = PlaySnd
trigger1 = !time
value = 1, 1
[State ボコボコSE]
type = PlaySnd
triggerall = numtarget(1560)
trigger1 = anim = 1555 && animelemtime(5)>=0 && time%8=0
trigger2 = anim = 1556 && time%7=0
trigger3 = anim = 1555 && animelemtime(5)=0
trigger4 = time > 80
value = 6, 2
volume = -100
[State ザクザクSE]
type = PlaySnd
triggerall = numtarget(1560)
trigger1 = anim = 1555 && animelemtime(5)>=0 && time%6=0
trigger2 = anim = 1556 && time%3=0
value = 6, 3
volume = -80
[State 画面振動]
type = envshake
trigger1 = anim = 1555 && animelemtime(5)=0
trigger2 = anim = 1555 && animelemtime(5)>0 && time%8=0
trigger3 = anim = 1556 && time%8=0
time = 8
Ampl = -2
Freq = 90

[State 相手の位置]
type = targetbind
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(4)<=4
pos = 0,0
[State 相手の位置]
type = targetbind
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(4)>4
pos = -15,-2
[State 相手の位置]
type = targetbind
trigger1 = numtarget(1560) && anim = 1556 && time = [0,60]
pos = -15,2
[State 相手の位置]
type = targetbind
trigger1 = numtarget(1560) && anim = 1556 && time = [61,80]
pos = -15,6

[State ダメージ]
type = targetlifeadd
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)>=0 && time%5=0
value = -floor(6*root,fvar(0))
kill = 0
[State ダメージ]
type = targetlifeadd
trigger1 = numtarget(1560) && anim = 1556 && time%5=0
value = -floor(10*root,fvar(0))
kill = 0
[State 最終ダメージ]
type = targetlifeadd
trigger1 = numtarget(1560) && time>80
value = -floor(20*root,fvar(0))
kill = 1
persistent = 0

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)>=0 && time%5=0
trigger2 = numtarget(1560) && anim = 1556 && time%5=0
trigger3 = numtarget(1560) && time>80
var(6) = 1
[State -2 ヒットカウント増加]
type = hitadd
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)>=0 && time%5=0
trigger2 = numtarget(1560) && anim = 1556 && time%5=0
trigger3 = numtarget(1560) && time>80
value = 1

[State ゲージ増加]
type = PowerAdd
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)>=0 && time%5=0
trigger2 = numtarget(1560) && anim = 1556 && time%5=0
trigger3 = numtarget(1560) && time>80
value = ceil( 14*(1+(root,var(48)>0)*0.1) )
[State ゲージ増加]
type = targetPowerAdd
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)>=0 && time%5=0
trigger2 = numtarget(1560) && anim = 1556 && time%5=0
trigger3 = numtarget(1560) && time>80
value = 6

[State しぶきエフェクト]
type = Explod
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)=0
anim = 1566
ID = 1565
postype = p1
pos = 0,-2
IgnoreHitPause = 1
scale = 0.8,1.0
Persistent = 0
OwnPal = 1
sprpriority = 2
removetime = 100
[State 上のみヒットエフェクト]
type = Explod
trigger1 = numtarget(1560) && anim = 1555 && animelemtime(5)=0
anim = 802
ID = 1565
postype = p1
pos = 0,5
IgnoreHitPause = 1
scale = 0.5,0.5
Persistent = 0
OwnPal = 1
ontop=1
removetime = 100
[State 331,ヒットエフェクト]
type = Explod
trigger1 = numtarget(1560) && time>80
anim = 812
postype = p1
pos = 0,-14
IgnoreHitPause = 1
scale = 0.42, 0.42
ontop = 1
Persistent = 0
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
triggerall = numtarget(1560)
trigger1 = anim = 1555 && animelemtime(5)>=0 && time%10=0
trigger2 = anim = 1556 && time%10=0
trigger3 = time = 2 && 0
trigger4 = time>80
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
pausemovetime = 2147483647
supermovetime = 2147483647
trans = addalpha
alpha = 100,155

[State アニメ変更]
type = ChangeAnim
trigger1 = Time = 0
value = 1555
[State アニメ変更 第2段階]
type = ChangeAnim
trigger1 = Time = 35
value = 1556

[State 相手　締めステートへ]
type = targetstate
trigger1 = numtarget(1560) && time>80
value = 1565
persistent = 0

[State 穴エフェクト消滅]
type = removeExplod
trigger1 = time > 80
trigger2 = root,movetype = H
ID = 1450
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = time > 80
trigger2 = root,movetype = H
ID = 1451
[State しぶきエフェクト消滅]
type = removeExplod
trigger1 = time > 80
trigger2 = root,movetype = H
ID = 1565
[State 消滅]
type = destroyself
trigger1 = time > 80
trigger2 = root,movetype = H
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;あれは人殺しの目だ  相手側 ギリギリギリ
[Statedef 1560]
type    = A
movetype= H
physics = N
[State 押し出し]
type = playerpush
trigger1 = 1
value = 0
[State 落下]
Type = HitFallSet
trigger1 = 1
value = 1
persistent = 0

[State アニメ変更]
type = ChangeAnim2
trigger1 = Time = 0
value = 1560

[State 非常用]
type = selfstate
trigger1 = time > 120
value = 5030
;---------------------------------------------------------------------------
;あれは人殺しの目だ  相手側 締め 吹っ飛び待機
[Statedef 1565]
type    = L
movetype= H
physics = N
[State 変更]
type = posset
trigger1 = 1
Y = 8
[State アニメ変更]
type = Changeanim
trigger1 = !time
value = 5100
[State ステ変更]
type = Changestate
trigger1 = Time = 4
value = 1566

[State 変更]
type = selfstate
trigger1 = time > 200
value = 5100
;---------------------------------------------------------------------------
;あれは人殺しの目だ  相手側 締め バウンド
[Statedef 1566]
type    = L
movetype= H
physics = N
[State アニメ変更]
type = Changeanim
trigger1 = !time
value = 5160

[State 5101, 5] ;Acceleration
type = posAdd
trigger1 = !time
y = -5
[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = !time
y = -4
[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = 0.55

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12
type = changeState
value = ifelse(Alive,1567,5110)

[State 変更]
type = selfstate
trigger1 = time > 200
value = 5100
;---------------------------------------------------------------------------
;あれは人殺しの目だ  相手側 締め ダウン
[Statedef 1567]
type    = L
movetype= H
physics = N
[State pos]
type = posset
trigger1 = !time
y = 0
[State pos]
type = velset
trigger1 = !time
X = 0
Y = 0
[State アニメ変更]
type = Changeanim
trigger1 = !time
value = 5170
[State アニメ変更]
type = Changeanim
trigger1 = anim=5170 && animtime=0
value = 5110

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
value = F7, 1

[State 5110, 7]
type = GameMakeAnim
trigger1 = Time = 0
value = 60 + 1
pos = 0, 0
under = 1

[State 変更]
type = selfstate
trigger1 = time >= 25
value = 5120

;---------------------------------------------------------------------------
;よし見える！
[Statedef 1580]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0
sprpriority = 0
anim = 1580

[State すり抜け]
Type = PlayerPush
trigger1 = !(anim = 1580 && animelemtime(4)<0)
value = 0
[State 画面端でも裏回る]
type = Width
trigger1 = 1
Edge = -2,-2
Player = -2,-2
IgnoreHitPause = 1

[state 無敵化]
type = nothitby
trigger1 = !(anim = 1580 && animelemtime(6)<0)
value = SCA,AA,AP,AT

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1580 && animelemtime(2) = 1
anim = 1597
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.5, 0.5
sprpriority = 7
OwnPal = 1
[State 発射エフェクトグルグル]
type = Explod
trigger1 = anim = 1580 && animelemtime(2) = 1
anim = 1595
ID = 1595
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4, 0.4
sprpriority = 7
OwnPal = 1
trans = sub
[State 発射エフェクトグルグル]
type = modifyExplod
trigger1 = anim = 1580 && animelemtime(5) = 0 && numexplod(1595)
pos = ceil(-5*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
[State 爪弾消費]
type = varadd
trigger1 = anim = 1580 && animelemtime(3) = 0
var(51) = -10
persistent = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1580 && animelemtime(2) = 0
value = 0, 9
volume = -120
[State SE]
type = PlaySnd
trigger1 = anim = 1580 && animelemtime(2) = 0
value = 0, 19
volume = -40

[State 奥の穴エフェクト]
type = Explod
trigger1 = anim = 1580 && animelemtime(6) = 0
anim = 1450
ID = 1450
postype = p1
pos = -60*const(size.yscale)*1.0 ,5*const(size.yscale)
IgnoreHitPause = 1
Persistent = 0
scale = 1.0*const(size.yscale), 1.0*const(size.yscale)
OwnPal = 1
sprpriority = 0
removetime = 60;2+30-16+36
bindtime = -1
trans = sub

[State 穴SE]
type = PlaySnd
trigger1 = anim = 1580 && animelemtime(6) = 0
value = 0, 20
volume = -50

[State 脚エフェクト]
type = Explod
trigger1 = animtime = 0 && anim = 1580
anim = 1582
ID = 1582
postype = p1
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = const(size.xscale), const(size.yscale)
sprpriority = 0
removetime = -2
bindtime = 1
[State 奥の穴エフェクト脚用]
type = Explod
trigger1 = animtime = 0 && anim = 1580
anim = 1450
ID = 1582
postype = p1
pos = -60*0.8 ,5
IgnoreHitPause = 1
Persistent = 0
scale = 0.8, 0.8
OwnPal = 1
sprpriority = 0
removetime = 12
bindtime = 1
trans = sub
[State bind]
type = Explodbindtime
trigger1 = numexplod(1582)
ID = 1582
value = 0
persistent = 0

[State アニメ変更]
type = changeanim
trigger1 = animtime = 0 && anim = 1580
value = 9999
[state 99999, 不可視化]
type = assertspecial
trigger1 = anim = 9999
flag = invisible
flag2= noshadow
[State 透過]
type = trans
trigger1 = anim = 9999
trans = sub
[State 速度]
type = velset
trigger1 = anim = 9999
X = 8.6
[State ちょっと先に前進]
type = posadd
trigger1 = anim = 9999
X = 20
persistent = 0

[State ステ変更]
type = changestate
;trigger1 = anim = 9999 && time >= 24 && (!(command="hold_z") || time >= 58 || p2bodydist X < -50)
trigger1 = anim = 9999 && time >= 24
value = 1588;1585
;---------------------------------------------------------------------------
;よし見える 穴から乗り出し射撃
[Statedef 1585]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 0
anim = 1585
facep2 = 1

[state 無敵化]
type = nothitby
trigger1 = (anim = 1585 && animelemtime(3)<0)
value = SCA,AA,AP,AT

[State 相手をむく]
type = turn
trigger1 = p2dist X < 0 && animelemtime(3)<0

[State 声]
type = PlaySnd
trigger1 = !time
value = 5, 17
volume = 50
channel = 0
persistent = 0

[State 穴SE]
type = PlaySnd
trigger1 = !time
value = 0, 19
volume = -50

[State SE]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 0, 15
[State SE]
type = PlaySnd
trigger1 = animelemtime(7) = 2
value = 0, 8

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1361
ID = 1360
pos = ceil(21*const(size.xscale)),  -32*const(size.yscale)
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1390
ID = 1355
pos = ceil(20*const(size.xscale)), -32*const(size.yscale)
postype = p1
bindtime = 1
removetime = -2
scale = 0.49*const(size.yscale), 0.49*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 黄金回転爪弾]
type = helper
trigger1 = animelemtime(8) = 0
name = "goldspin nail"
stateno = 1360
ID = 1580
postype = p1
pos = ceil(21*const(size.xscale)) -30, -32*const(size.yscale)
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(8) = 0
var(51) = -10
persistent = 0

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;よし見える 出てくるだけver
[Statedef 1588]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0
sprpriority = 0
anim = 1588
facep2 = 1

[State 相手をむく]
type = turn
trigger1 = p2dist X < 0 && animelemno(0)=1

[State 奥の穴エフェクト消滅]
type = removeExplod
trigger1 = numexplod(1450) && animelemtime(4) >= 1
ID = 1450

[State 穴SE]
type = PlaySnd
trigger1 = !time
value = 0, 19
volume = -50

[State コントロール]
type = ctrlset
trigger1 = animelemtime(5)=2
value = 1

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;新しい道へ行くぞ！
[Statedef 1600]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0
sprpriority = 0
anim = 1600

[State すり抜け]
Type = PlayerPush
trigger1 = !(anim = 1600 && animelemno(0) = [1,4])
value = 0

[state 無敵化]
type = nothitby
trigger1 = anim = 1600 && animelemno(0) = [3,8]
trigger2 = anim = 9999
value = SCA,AA,AP,AT

[State 発射エフェクト]
type = Explod
trigger1 = anim = 1600 && animelemtime(3) = 1
anim = 1597
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.5, 0.5
sprpriority = 7
OwnPal = 1
[State 発射エフェクトグルグル]
type = Explod
trigger1 = anim = 1600 && animelemtime(3) = 1
anim = 1595
ID = 1595
pos = ceil(-10*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4, 0.4
sprpriority = 7
OwnPal = 1
trans = sub
[State 発射エフェクトグルグル]
type = modifyExplod
trigger1 = anim = 1600 && animelemtime(6) = 0 && numexplod(1595)
pos = ceil(-5*const(size.xscale)),  ceil(-35*const(size.yscale))
postype = p1
[State 爪弾消費]
type = varadd
trigger1 = anim = 1600 && animelemtime(4) = 0
var(51) = -10
persistent = 0

[State SE]
type = PlaySnd
trigger1 = anim = 1600 && animelemtime(3) = 0
value = 0, 9
volume = -120
[State SE]
type = PlaySnd
trigger1 = anim = 1600 && animelemtime(3) = 0
value = 0, 19
volume = -40

[State 奥の穴エフェクト]
type = Explod
trigger1 = anim = 1600 && animelemtime(7) = 0
anim = 1450
ID = 1450
postype = p1
pos = -60*const(size.yscale)*1.0 ,5*const(size.yscale)
IgnoreHitPause = 1
Persistent = 0
scale = 1.0*const(size.yscale), 1.0*const(size.yscale)
OwnPal = 1
sprpriority = 0
removetime = 28;30-16+13
bindtime = -1
trans = sub

[State 穴SE]
type = PlaySnd
trigger1 = anim = 1600 && animelemtime(7) = 0
value = 0, 22
volume = -50

[State 声]
type = PlaySnd
trigger1 = time = 1
value = 200, 10
channel = 0

[State 脚エフェクト]
type = Explod
trigger1 = animtime = 0 && anim = 1600
anim = 1610
ID = 1610
postype = p1
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = const(size.xscale), const(size.yscale)
sprpriority = 0
removetime = -2
bindtime = 1
[State 奥の穴エフェクト脚用]
type = Explod
trigger1 = animtime = 0 && anim = 1600
anim = 1450
ID = 1610
postype = p1
pos = -60*0.8 ,5
IgnoreHitPause = 1
Persistent = 0
scale = 0.8, 0.8
OwnPal = 1
sprpriority = 0
removetime = 12
bindtime = 1
trans = sub
[State bind]
type = Explodbindtime
trigger1 = numexplod(1610)
ID = 1610
value = 0
persistent = 0

[State アニメ変更]
type = changeanim
trigger1 = animtime = 0 && anim = 1600
value = 9999
[state 99999, 不可視化]
type = assertspecial
trigger1 = anim = 9999 && time < 32
flag = invisible
flag2= noshadow
[State 透過]
type = trans
trigger1 = anim = 9999 && time < 32
trans = sub
[State 速度]
type = velset
trigger1 = anim = 9999 && time < 32
X = -8.6

[State ステ変更]
type = changestate
trigger1 = anim = 9999 && time >= 32
value = 1620
;---------------------------------------------------------------------------
;新しい道から出てくる
[Statedef 1620]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0
sprpriority = 0
anim = 1620

[State 穴SE]
type = PlaySnd
trigger1 = !time
value = 0, 23
volume = -50

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1
;--------------------------------------------------------------------------
;僕の体が飛び上がった！ 地上
[Statedef 1700]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1700
ctrl = 0
sprpriority = 2
facep2 = 1

[state 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State SE]
type = PlaySnd
trigger1 = Time = 0
value = 0, 7

[State 初速]
type = veladd
trigger1 = !time
X = 2.3

[State スパーダエフェクト]
type = Explod
trigger1 = Time = 0
anim = 1730
postype = p1
pos = -5,0
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.85, Const(size.yscale)*0.85
sprpriority = -1
OwnPal = 1

[State SE]
type = PlaySnd
trigger1 = AnimTime = 0
value = 40, 1
persistent = 0

[State 声]
type = PlaySnd
trigger1 = Time = 0
value = 200, 3+random%3
channel = 0
volume = 100
persistent = 0

[State ちょっと前進]
type = posadd
trigger1 = AnimTime = 0
X = 5
[State ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 1710

;---------------------------------------------------------------------------
;僕の体が飛び上がった！ 空中
[Statedef 1710]
type    = A
movetype= A
physics = N
anim = 1710
ctrl = 0
sprpriority = 2

[state 無敵化]
type = nothitby
trigger1 = AnimElemtime(2) < 1
value = SCA,AA,AP,AT

[State ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 2
trigger1 = movecontact=0 && movereversed=0
attr = A, SA
damage = ceil(40*fvar(0)), ceil(2*fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 30
ground.velocity = -4,-5
guard.velocity = -3.5
airguard.velocity = -3.5,-9
air.type = High
air.velocity = -4.0,-5
air.hittime = 60;60
Guard.CtrlTime = 18
AirGuard.CtrlTime = 60;60
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 100*(1+(var(48)>0)*0.1) ),ceil( 60*(1+(var(48)>0)*0.1) )
givepower = 70,35
fall = 1
fall.recover = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 811
postype = p1
pos = P2BodyDist X+30+var(3)%20,-60-var(3)%30
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
pausemovetime = 2147483647
supermovetime = 2147483647
trans = addalpha
alpha = 155,155
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ツメエフェクト]
type = Explod
trigger1 = Time = 0
anim = 1740
postype = p1
pos = 15,-115
IgnoreHitPause = 0
Persistent = 0
scale = Const(size.yscale)*0.5, Const(size.yscale)*0.5
sprpriority = 7
OwnPal = 1
bindtime = 8
;trans = addalpha
;alpha = 150,255

[State 初速]
type = velset
trigger1 = !time
Y = -14.5

[State 重力]
type = veladd
trigger1 = 1
Y = 0.8

[State SE]
type = PlaySnd
trigger1 = pos Y >= 0 && vel Y > 0
value = 40, 2
persistent = 0

[State ステート変更]
type = ChangeState
trigger1 = pos Y >= 0 && vel Y > 0
value = 1720

;---------------------------------------------------------------------------
;僕の体が飛び上がった！ 着地
[Statedef 1720]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1720
ctrl = 0
sprpriority = 2

[State SE]
type = PlaySnd
trigger1 = Time = 5
value = 40, 2

[State 位置]
type = posset
trigger1 = !time
Y = 0

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
;僕の体が飛び上がった！ ハイジャンプver 移行動作
[Statedef 1750]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 40
ctrl = 0
sprpriority = 1
facep2 = 1

[State SE]
type = PlaySnd
trigger1 = Time = 5
value = 0, 7

[State スパーダエフェクト]
type = Explod
trigger1 = animTime = 0
anim = 1731
ID = 1731
postype = p1
pos = -5,0
bindtime = 0
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.6, Const(size.yscale)*0.75
sprpriority = -1
OwnPal = 1
[State スパーダエフェクト]
type = Explodbindtime
trigger1 = numexplod(1731)
ID = 1731
value = 0

[State SE]
type = PlaySnd
trigger1 = AnimTime = 0
value = 40, 1
persistent = 0

[State 声]
type = PlaySnd
trigger1 = Time = 2
value = 200, 3;3+random%3
channel = 0
volume = 100
persistent = 0

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 40, 2]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 40, 3]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1

[State 40, 4]
type = VelSet
trigger1 = AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[State 40, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = 1760
ctrl = 1

[state 投げ無敵化]
type = nothitby
trigger1 = 1
value = ,AT
;--------------------------------------------------------------------------
;僕の体が飛び上がった！ ハイジャンプver ジャンプ中
[Statedef 1760]
type    = A
movetype= I
physics = N
anim = 41
ctrl = 0

[State 重力]
type = Gravity
trigger1 = 1

[State SE]
type = PlaySnd
trigger1 = pos Y >= 0 && vel Y > 0
value = 40, 2
persistent = 0

[State ステート変更]
type = ChangeState
trigger1 = pos Y >= 0 && vel Y > 0
value = 1770
;---------------------------------------------------------------------------
;僕の体が飛び上がった！ ハイジャンプver 着地 
[Statedef 1770]
type    = S
physics = S
ctrl = 0
anim = 47
facep2=1

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0
[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 3]
type = CtrlSet
trigger1 = Time = 1
value = 1

[State 52, ガードへ]
type = ChangeState
trigger1 = InGuardDist && Command = "holdback" && StateNo!=[120,140]
value = 150

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;あそこまで行かなくては！突進版
[Statedef 1800]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1800
ctrl = 0
sprpriority = 2

[State 押し出し]
type = width
trigger1 = anim = 1800
trigger2 = anim = 1810 && animelemtime(4)<0
Edge = -14,14
Player = -14,14

[state 投げ無敵化]
type = nothitby
trigger1 = anim = 1800
trigger2 = anim = 1810 && animelemtime(6)<0
value = ,AT

[State 声]
type = PlaySnd
trigger1 = time = 1;anim = 1810 && animelemtime(1)=1
value = 200, 6
channel = 0
persistent = 0

[State anim変更]
type = Changeanim
trigger1 = anim = 1800 && AnimTime = 0
value = 1810

[State SE]
type = PlaySnd
trigger1 = !time;anim = 1810
value = 0, 13
persistent = 0

[State 速]
type = velset
trigger1 = anim = 1810 && animelemtime(3)<0
X = 11
[State 摩擦]
type = velmul
trigger1 = anim = 1810 && animelemtime(4)>=0
X = 0.65

[State ヒット定義]
type = null;HitDef
trigger1 = anim = 1810 && (AnimElemno(0) = [2,3])
trigger1 = movecontact=0 && movereversed=0
attr = S, SA
damage = ceil(40*fvar(0)), ceil(3*fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 12, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 20
ground.hittime  = 21
ground.velocity = -1.5,-3;4
yaccel = 0.28
guard.velocity = -3.5
airguard.velocity = -4,-1
air.velocity = -0.8,-0.5
air.hittime = 50
Guard.CtrlTime = 18 -(time>18) -1
AirGuard.CtrlTime = 50
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 70*(1+(var(48)>0)*0.1) ),ceil( 35*(1+(var(48)>0)*0.1) )
givepower = 30,15
fall.recovertime = 45;36
EnvShake.Time = 14
EnvShake.Ampl = 2
EnvShake.Freq = 55
fall = 1

[State ヒット定義追撃不可版]
type = HitDef
trigger1 = anim = 1810 && (AnimElemno(0) = [2,3])
trigger1 = movecontact=0 && movereversed=0
attr = S, SA
damage = ceil(40*fvar(0)), ceil(3*fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 12, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 20
ground.hittime  = 21
ground.velocity = -1.6,-1.0;3
yaccel = 0.25
guard.velocity = -4
airguard.velocity = -4,-1
air.velocity = -0.8,-1
air.hittime = 50
Guard.CtrlTime = 17
AirGuard.CtrlTime = 50
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 70*(1+(var(48)>0)*0.1) ),ceil( 35*(1+(var(48)>0)*0.1) )
givepower = 30,15
fall.recovertime = 60;36
EnvShake.Time = 14
EnvShake.Ampl = 1; +(time > 14)*3
EnvShake.Freq = 55
fall = 1
Fall.YVelocity = -5

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 15+var(3)%5,-44-var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.4, 0.4
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ちょっと調整]
type = posadd
trigger1 = anim = 1810 && animelemtime(8)=0
X = 8

[State ctrl変更]
type = ctrlset
trigger1 = anim = 1810 && AnimelemTime(9) = 0
value = 1

[State ステート変更]
type = ChangeState
trigger1 = anim = 1810 && AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;あそこまで行かなくては！アタック 突進版
[Statedef 1815]
type    = A
movetype= A
physics = N
velset = 0,0
anim = 1815
ctrl = 0
sprpriority = 2

[State SE]
type = PlaySnd
trigger1 = !time
value = 40, 1
[State SE]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 0, 3
[State SE]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 0, 1

[State スパーダエフェクト]
type = Explod
trigger1 = !time
anim = 1731
ID = 1731
postype = p1
pos = 3,2
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.5, Const(size.yscale)*0.4
sprpriority = -1
OwnPal = 1
[State スパーダエフェクト]
type = Explodbindtime
trigger1 = numexplod(1731)
ID = 1731
value = 0

[State 速]
type = posadd
trigger1 = !time
X = 0
Y = -4

[State 速]
type = velset
trigger1 = animelemtime(5)<0
X = 2.6

[State 跳ぶ]
type = velset
trigger1 = !time
Y = -3
[State 重力]
type = veladd
trigger1 = pos Y < 0
Y = 0.30 +(animelemtime(3)>0)*0.2

[State var]
type = varset
trigger1 = !time
var(1) = 0
[State var]
type = varset
trigger1 = anim = 1815 && AnimElemno(0) = 5
trigger1 = movecontact=1 || movereversed=1
var(1) = 1
ignorehitpause = 1

[State ヒット定義]
type = HitDef
trigger1 = anim = 1815 && AnimElemno(0) = 4
trigger1 = movecontact=0 && movereversed=0
attr = A, SA
damage = ceil(3*fvar(0)), ceil(2*fvar(0))
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = H
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4
guard.velocity = -2.5
airguard.velocity = -4,-0.5
air.velocity = -1.3,-0.5
air.hittime = 50
Guard.CtrlTime = 11
AirGuard.CtrlTime = 50
Guard.Kill = 0
Ground.CornerPush.VelOff = -5
getpower  = ceil( 10*(1+(var(48)>0)*0.1) ),ceil( 5*(1+(var(48)>0)*0.1) )
givepower = 15,8
fall.recovertime = 50
EnvShake.Time = 5
EnvShake.Ampl = 2
EnvShake.Freq = 55
[State ヒット定義]
type = HitDef
trigger1 = anim = 1815 && AnimElemno(0) = 5
trigger1 = var(1) = 0
attr = A, SA
damage = ceil(3*fvar(0)), ceil(2*fvar(0))
animtype = L
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2+4
guard.pausetime = 2, 2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 14
ground.hittime  = 14;20
ground.velocity = -3.5
guard.velocity = -3.5
airguard.velocity = -4,-1
air.velocity = -1.5,-1
air.hittime = 50
Guard.CtrlTime = 9
AirGuard.CtrlTime = 50
Guard.Kill = 0
Ground.CornerPush.VelOff = -5
getpower  = ceil( 10*(1+(var(48)>0)*0.1) ),ceil( 5*(1+(var(48)>0)*0.1) )
givepower = 15,8
fall.recovertime = 50
EnvShake.Time = 7
EnvShake.Ampl = 2
EnvShake.Freq = 55

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && (anim=1815&&AnimElemno(0)=4)
anim = 801
postype = p1
pos = P2BodyDist X+30,-60
IgnoreHitPause = 1
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
persistent = 0
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && (anim=1815&&AnimElemno(0)=[5,6])
anim = 801
postype = p1
pos = P2BodyDist X+30,-20
IgnoreHitPause = 1
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
persistent = 0
pausemovetime = 2147483647
supermovetime = 2147483647

[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State SE]
type = PlaySnd
trigger1 = pos Y >= 0
value = 40, 2
persistent = 0
[State ステート変更]
type = ChangeState
trigger1 = pos Y >= 0
value = 1837

;---------------------------------------------------------------------------
;あそこまで行かなくては！移動技
[Statedef 1830]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 1830
ctrl = 0
sprpriority = 2

[state 投げ無敵化]
type = nothitby
trigger1 = anim = 1830
value = ,AT

[State 声]
type = PlaySnd
trigger1 = time = 2;anim = 1810 && animelemtime(1)=1
value = 200, 6
channel = 0
persistent = 0

[State SE]
type = PlaySnd
trigger1 = time = 3
value = 0, 13
persistent = 0

[State 速度]
type = velset
trigger1 = anim = 1830 && animelemtime(2)=0
X = 4.3
[State 減速]
type = velmul
trigger1 = anim = 1830 && animelemtime(8)>0
X = 0.7

[State ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0 +(command="holddown")*10
ctrl = 1

;---------------------------------------------------------------------------
;あそこまで行かなくては！ピョンっとアタック 空中時
[Statedef 1835]
type    = A
movetype= A
physics = N
velset = 0,0
anim = 1835
ctrl = 0
sprpriority = 2

[State SE]
type = PlaySnd
trigger1 = !time
value = 40, 1
[State SE]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 0, 3
[State SE]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 0, 1

[State スパーダエフェクト]
type = Explod
trigger1 = !time
anim = 1731
ID = 1731
postype = p1
pos = 3,2
IgnoreHitPause = 1
Persistent = 0
scale = Const(size.yscale)*0.5, Const(size.yscale)*0.4
sprpriority = -1
OwnPal = 1
[State スパーダエフェクト]
type = Explodbindtime
trigger1 = numexplod(1731)
ID = 1731
value = 0

[State 速]
type = posadd
trigger1 = !time
X = 2
Y = -4

[State 速]
type = velset
trigger1 = animelemtime(5)<0
X = 2.0

[State 跳ぶ]
type = velset
trigger1 = !time
Y = -4.2
[State 重力]
type = veladd
trigger1 = pos Y < 0
Y = 0.40 +(animelemtime(3)>0)*0.2

[State var]
type = varset
trigger1 = !time
var(1) = 0
[State var]
type = varset
trigger1 = anim = 1835 && AnimElemno(0) = 4
trigger1 = movecontact=1 || movereversed=1
var(1) = 1
ignorehitpause = 1

[State ヒット定義]
type = HitDef
trigger1 = anim = 1835 && AnimElemno(0) = 3
trigger1 = movecontact=0 && movereversed=0
attr = A, SA
damage = ceil(4*fvar(0)), ceil(2*fvar(0))
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = H
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4
guard.velocity = -3.5
airguard.velocity = -4,-1
air.velocity = -0.3,-1
air.hittime = 50
Guard.CtrlTime = 11
AirGuard.CtrlTime = 50
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 38*(1+(var(48)>0)*0.1) ),ceil( 19*(1+(var(48)>0)*0.1) )
givepower = 15,8
fall.recovertime = 50
EnvShake.Time = 5
EnvShake.Ampl = 2
EnvShake.Freq = 55
[State ヒット定義]
type = HitDef
trigger1 = anim = 1835 && AnimElemno(0) = 4
trigger1 = var(1) = 0
attr = A, SA
damage = ceil(4*fvar(0)), ceil(2*fvar(0))
animtype = L
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 2, 2+4
guard.pausetime = 2, 2
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = L
ground.slidetime = 15
ground.hittime  = 20
ground.velocity = -3.5
guard.velocity = -3.5
airguard.velocity = -4,-1
air.velocity = -0.5,-2
air.hittime = 50
Guard.CtrlTime = 10
AirGuard.CtrlTime = 50
Guard.Kill = 0
Ground.CornerPush.VelOff = -3.2
getpower  = ceil( 38*(1+(var(48)>0)*0.1) ),ceil( 19*(1+(var(48)>0)*0.1) )
givepower = 15,8
fall.recovertime = 50
EnvShake.Time = 7
EnvShake.Ampl = 2
EnvShake.Freq = 55

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && (anim=1835&&AnimElemno(0)=3)
anim = 801
postype = p1
pos = P2BodyDist X+30,-60
IgnoreHitPause = 1
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
persistent = 0
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1 && (anim=1835&&AnimElemno(0)=[4,5])
anim = 801
postype = p1
pos = P2BodyDist X+30,-20
IgnoreHitPause = 1
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
persistent = 0
pausemovetime = 2147483647
supermovetime = 2147483647

[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State SE]
type = PlaySnd
trigger1 = pos Y >= 0
value = 40, 2
persistent = 0
[State ステート変更]
type = ChangeState
trigger1 = pos Y >= 0
value = 1837

;---------------------------------------------------------------------------
;あそこまで行かなくては！ピョンっとアタック 着地
[Statedef 1837]
type    = S
movetype= I
physics = N
anim = 1837
ctrl = 0
sprpriority = 2

[State 減速]
type = velmul
trigger1 = 1
X = 0.78
[State 速度0]
type = velset
trigger1 = !time
Y = 0
[State 位置0]
type = posset
trigger1 = !time
Y = 0

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;あそこまで行かなくては！逃げ
[Statedef 1850]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 1850
ctrl = 0
sprpriority = 2

[state 投げ無敵化]
type = nothitby
trigger1 = anim = 1850 && animelemtime(7)<0
value = ,AT

[State 声]
type = PlaySnd
trigger1 = time = 2
value = 200, 6
channel = 0
persistent = 0

[State SE]
type = PlaySnd
trigger1 = time = 5
value = 0, 13
persistent = 0

[State 速]
type = velset
trigger1 = anim = 1850 && animelemtime(3)=1
X = -4.5
[State 摩擦]
type = velmul
trigger1 = anim = 1850 && animelemtime(7)>=0
X = 0.75

[State ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ハーブティー飲む？
[Statedef 1900]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0
sprpriority = 0
anim = 1900

[State ガードゲージ回復]
type = Varadd
trigger1 = animelemtime(5) = 0
var(8) = 5000*0.1
IgnoreHitPause = 1

[State ハーブ効果時間set]
type = varset
trigger1 = animelemtime(5) = 0
var(19) = 330

[State 声]
type = PlaySnd
trigger1 = time = 1
value = 200, 16+random%2
channel = 0
persistent = 0
[State 声]
type = PlaySnd
trigger1 = time = 1
value = 0, 24
volume = -150
persistent = 0



[State ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;生贄は…ヴァレンタイン大統領！どっちになると思う？
[Statedef 3500]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3500
ctrl = 0
sprpriority = 2

[State SE]
type = PlaySnd
trigger1 = animelemtime(3) = 2
value = 0, 15
[State SE]
type = PlaySnd
trigger1 = animelemtime(6) = 2
value = 0, 8

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1360
ID = 1360
pos = ceil(38*const(size.xscale)),  ceil(-50*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 2
OwnPal = 1
[State 発射回転エフェクト]
type = null;Explod
trigger1 = animelemtime(7) = 0
anim = 1355
ID = 1355
pos = ceil(38*const(size.xscale)),  ceil(-50*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.49*const(size.yscale), 0.49*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state タスクact4]
type = helper
trigger1 = animelemtime(6) = 0
name = "ACT4"
stateno = 3510
ID = 3510
postype = p1
pos = ceil(20*const(size.xscale)),  0
Size.XScale = const(size.xscale)
Size.YScale = const(size.yscale)
OwnPal = 1
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(7) = 0
var(51) = -10
persistent = 0

[State 反動]
type = veladd
trigger1 = animelemtime(7) = 0
X = -1.4
persistent = 0

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;生贄は…ヴァレンタイン大統領！どっちになると思う？ ACT4
[Statedef 3510]
type    = S
movetype= A
physics = N
anim = 3540
ctrl = 0
sprpriority = 3

[State オラオラ奥の腕]
type = Explod
trigger1 = !time
anim = 3541
postype = p1
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
ID = 3101
scale = root,const(size.xscale),root,const(size.yscale)
sprpriority = -1
bindtime = -1
OwnPal = 1
removetime = -2
pausemovetime = 2147483647
supermovetime = 2147483647

[State 速度]
type = velset
trigger1 = !time
X = 5.4
persistent = 0

[State 速度]
type = velmul
trigger1 = vel X > 0
X = 0.9

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 4 || AnimElemno(0) = 5
trigger1 = movecontact=0 && movereversed=0
attr = S, SA
damage = ceil(21*fvar(0)), 0
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 10, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = High
ground.slidetime = 15
ground.hittime  = 22
ground.velocity = -3.3
airguard.velocity = -1.2,-2.0
air.type = High
air.velocity = -1.0,-3
air.hittime = 28
AirGuard.CtrlTime = 40
Guard.CtrlTime = 12
Guard.Kill = 0
Ground.CornerPush.VelOff = -6
getpower  = ceil( 40*(1+(var(48)>0)*0.1) ),ceil( 20*(1+(var(48)>0)*0.1) )
givepower = 23,12
fall.recovertime = 35

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = P2BodyDist X+25+random%20,-90+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.4, 0.4
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 1000, ステート変更]
type = destroyself
trigger1 = animtime = 0
trigger2 = root,stateno != 3500

;---------------------------------------------------------------------------
;チュミミーン
[Statedef 3600]
type    = S
movetype= A
physics = S
;velset = 0,0
anim = 3600
ctrl = 0
sprpriority = 2
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0

[State 声]
type = PlaySnd
trigger1 = Time = 1
value = 200, 19
channel = 0
volume = 80

[State 発射音]
type = playsnd
trigger1 = time = 2-(var(9)>0)
value = 0,16
persistent = 0
[State 発射音]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 0,9
persistent = 0

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1361
pos = ceil(21*const(size.xscale)),  ceil(-17*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
Vfacing = -1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1390
pos = ceil(21*const(size.xscale)),  ceil(-17*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*const(size.yscale), 0.45*const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.1,0.05
Vfacing = -1
[State 穴]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1450
postype = p1
pos = 15,0;35*const(size.xscale)-30,0
IgnoreHitPause = 0
Persistent = 0
scale = 0.5, 0.5
BindTime = -1
SprPriority = 1
RemoveTime = -2
OwnPal = 1
trans = sub

[state タスクact4]
type = helper
trigger1 = animelemtime(7) = 0
name = "ACT4"
stateno = 3610
ID = 3610
postype = p1
pos = enemynear,pos X*facing - pos X*facing -50, 0
Size.XScale = const(size.xscale)
Size.YScale = const(size.yscale)
OwnPal = 1
;pausemovetime = 9999999
[State 爪弾消費]
type = varadd
trigger1 = animelemtime(7) = 0
var(51) = -10
persistent = 0

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;チュミミーン ACT4ヘルパー
[Statedef 3610]
type    = S
movetype= A
physics = N
anim = 3640
ctrl = 0
sprpriority = 1
[State ガード距離]
Type = AttackDist
trigger1 = animelemtime(9)<0
value = 0
[state 99999, 無敵化]
type = nothitby
trigger1 = animelemtime(2)<0
value = SCA,AA,AP,AT

[State 時止め中の待機]
type = Changeanim
trigger1 = time < 60 && var(29)
value = 3640
elem = 1

[State 穴]
type = Explod
trigger1 = !time
anim = 1460
postype = p1
pos = 0,0
IgnoreHitPause = 0
Persistent = 0
scale = 0.5, 0.5
BindTime = -1
SprPriority = 1
RemoveTime = -2
OwnPal = 1
trans = sub

[State オラオラ奥の腕]
type = Explod
trigger1 = !time
anim = 3641
postype = p1
pos = 0,0
IgnoreHitPause = 0
Persistent = 0
ID = 3641
scale = root,const(size.xscale),root,const(size.yscale)
sprpriority = -1
bindtime = -1
OwnPal = 1
removetime = -2
;pausemovetime = 2147483647
;supermovetime = 2147483647

[State SE]
type = PlaySnd
trigger1 = animelemtime(9)=0
value = 0,10

[State 200, ヒット定義]
type = HitDef
trigger1 = anim = 3640 && (AnimElemno(0)=[10,22]) && animelemno(0)%4=[0,1]
trigger1 = AnimElemtime( animelemno(0) )=0
attr = S, SP;飛び道具扱い
damage = ceil(40*root,fvar(0)), 0
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 5,5 
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 1
guardsound = s7, 0
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -1
airguard.velocity = -0.9,-0.5
air.velocity = -1.2,-0.7
air.hittime = 28
AirGuard.CtrlTime = 40
Guard.CtrlTime = 8
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 3*(1+(var(48)>0)*0.1) ),ceil( 2*(1+(var(48)>0)*0.1) )
givepower = 2,1
fall.recovertime = 35
[State 200, ヒット定義]
type = HitDef
trigger1 = anim = 3640 && (AnimElemno(0)=[10,22]) && animelemno(0)%4=[2,3]
trigger1 = AnimElemtime( animelemno(0) )=0
attr = S, SP;飛び道具扱い
damage = ceil(3*root,fvar(0)), 0
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 1, 1
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 0
guardsound = s7, 0
ground.type = L
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -1
airguard.velocity = -0.9,-0.5
air.velocity = -1.2,-0.7
air.hittime = 28
AirGuard.CtrlTime = 40
Guard.CtrlTime = 8
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = ceil( 3*(1+(var(48)>0)*0.1) ),ceil( 2*(1+(var(48)>0)*0.1) )
givepower = 2,1
fall.recovertime = 35

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
trigger1 = AnimElemno(0)=[10,22]
trigger1 = AnimElemtime( animelemno(0) )=1
anim = 801
postype = p1
pos = P2BodyDist X+25+random%40,-110+random%50
IgnoreHitPause = 1
scale = 0.3, 0.3
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
trigger1 = AnimElemno(0)=[10,22]
trigger1 = AnimElemtime( animelemno(0) )=1
anim = 840
postype = p2
pos = 10-random%10,-70+random%20
IgnoreHitPause = 1
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1
trigger1 = AnimElemno(0)=[10,22]
trigger1 = AnimElemtime( animelemno(0) )=1
var(6) = 1

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State 投げ無敵]
Type = notHitby
trigger1 = 1
value2 = ,AT
IgnoreHitPause = 1
[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AA,AP,AT
StateNo = 3615
IgnoreHitPause = 1

[State 腕を消す]
type = removeExplod
triggerall = numexplod(3641)
trigger1 = animtime = 0
trigger2 = root,movetype = H
trigger3 = var(9)>2
trigger4 = root,stateno = 3000;GHA
trigger5 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
IgnoreHitPause = 1
ID = 3641
[State 1000, ステート変更]
type = destroyself
trigger1 = animtime = 0
trigger2 = root,movetype = H
trigger3 = var(9)>2
trigger4 = root,stateno = 3000;GHA
trigger5 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget;HHAの邪魔をしない
----------------------------------------------------------------------
;チュミミーン ACT4 消滅
[Statedef 3615]
type    = S
movetype= H
physics = N
anim = -1
ctrl = 0
[State ,ヒットエフェクト]
type = Explod
trigger1 = !time
anim = 810
postype = p1
pos = 0,-60
IgnoreHitPause = 1
scale = 0.4, 0.4
sprpriority = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT
[State 腕を消す]
type = removeExplod
triggerall = numexplod(3641)
trigger1 = 1
IgnoreHitPause = 1
ID = 3641
[State 1000, ステート変更]
type = destroyself
trigger1 = time > 30;クールタイム
;---------------------------------------------------------------------------
;『黄金長方形をつくれ！』
;ジャイロ！回転は穴になっても死なないぞ！
[Statedef 2000]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2000
ctrl = 0
sprpriority = 2

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 45
movetime = 45
PauseBG = 0;背景はそのまま
persistent = 0

[state 99999, 無敵化]
type = nothitby
trigger1 = anim = 2000
trigger2 = anim = 2010 && animelemtime(6) < 0
value = SCA,AA,AP,AT

[State 進化発動！]
type = varset
trigger1 = time = 0
var(50) = 2;ACT2
persistent = 0
[State 弾数設定]
type = varset
trigger1 = time = 0
var(51) = 100;MAX
persistent = 0

[State ゲージ減少]
type = PowerAdd
trigger1 = time = 0
value = -1000
persistent = 0

[state 背景]
Type = BGPalFX
trigger1 = time = [0,39]
mul = 100,100,100
time = 1

[State 盛り上げる]
type = playsnd
trigger1 = time = 0
value = 90,2
persistent = 0

[State 声]
type = playsnd
trigger1 = time = 0
value = 300,0
channel = 0
persistent = 0

[State ズゥゥム]
type = zoom
trigger1 = time = [0,5]
Pos = pos X*2.5,0
Scale = 1 + 0.3*(time**1.0/5**1.0)
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [6,40]
Pos = pos X*2.5,0
Scale = 1.3
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [41,55]
Pos = pos X*2.5,0
Scale = 1.3 - 0.3*((time-40)**1.0/15**1.0)
Lag = 0

[state カットインヘルパー]
type = helper
trigger1 = time = 1
name = "Ci"
stateno = 2030
ID = 2030
postype = p1
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647
persistent = 0
OwnPal = 1

[State 発射音]
type = playsnd
trigger1 = time = 50-20
value = 0,16
persistent = 0
[State 発射音]
type = playsnd
trigger1 = time = 50
value = 0,9
persistent = 0

[state HHA穴]
type = helper
trigger1 = anim = 2010 && animelemtime(5) = 0
name = "spinHHA"
stateno = 2050
ID = 2050
postype = p1
pos = ceil(40*const(size.xscale)) -60*0.6*const(size.yscale),  0
Size.XScale = 0.6*const(size.yscale)
Size.YScale = 0.6*const(size.yscale)
OwnPal = 1

[State 発射エフェクト]
type = Explod
trigger1 = anim = 2010 && animelemtime(5) = 0
anim = 1361
pos = ceil(21*const(size.xscale)),  ceil(-18*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
Vfacing = -1
[State 発射回転エフェクト]
type = Explod
trigger1 = anim = 2010 && animelemtime(5) = 0
anim = 1390
pos = ceil(21*const(size.xscale)),  ceil(-18*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*const(size.yscale), 0.45*const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.1,0.05
Vfacing = -1
[State アニメ変更]
type = Changeanim
trigger1 = anim = 2000 && animtime = 0
value = 2010

[State アニメ変更]
type = Changeanim
trigger1 = anim = 2010 && animelemno(0)=7 && animelemtime(7) >= 20 && numhelper(2050)=0
value = 2010
elem = 8

[State ステート変更]
type = Changestate
trigger1 = anim = 2010 && animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;カットインヘルパー
[statedef 2030]
type = A
movetype = I
physics = N
ctrl = 0
anim = -1

[State カットイン]
type = Explod
trigger1 = !numexplod(2030) && time = 0
anim = 2030
postype = B
pos = 160,150
ID = 2030
IgnoreHitPause = 1
scale = 0.75, 0.75
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 45
sprpriority = -5
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2030) && time = [0,4]
anim = 2030
postype = B
pos = 140 +5*time ,150
ID = 2030
IgnoreHitPause = 1
trans = addalpha
alpha = 255*time**1.0/5**1.0,255- 255*time**1.0/5**1.0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2030) && time = [5,40]
anim = 2030
postype = B
pos = 160 +3*time**0.5 ,150
ID = 2030
IgnoreHitPause = 1
trans = addalpha
alpha = 255,0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2030) && time = [41,45]
anim = 2030
postype = B
pos = 160 +3*40**0.5 ,150
ID = 2030
IgnoreHitPause = 1
trans = addalpha
alpha = 255-255*(time-40)**1.0/5**1.0, 255*(time-40)**1.0/5**1.0
scale = 0.75 *(1+0.1*(time-41)**1.0/5**1.0), 0.75 *(1+0.1*(time-41)**1.0/5**1.0)

[State ヒットで消滅]
type = destroyself
trigger1 = time = 45
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;穴になっても死なない回転 ヘルパー
[Statedef 2050]
type    = S
movetype= A
physics = N
velset = 4.2,0
anim = 1450
ctrl = 0
sprpriority = 6

[State 透過]
type = trans
trigger1 = 1
trans = sub
IgnoreHitPause = 1

[State 追尾]
type = veladd
trigger1 = p2dist X >=30 && vel X < 4.2
x = 0.4
[State 追尾]
type = veladd
trigger1 = p2dist X < 30 && vel X > -4.2
x = -0.4

[State 舞い上がる土]
type = null;Explod
trigger1 = time%10 = 0
anim = 1455
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 1
scale = 0.6*root,const(size.yscale), 0.6*root,const(size.yscale)
;ID = 1455
BindTime = 1
SprPriority = 7
RemoveTime = -2
OwnPal = 1
trans = sub

[State 200, ヒット定義]
type = HitDef
trigger1 = 1
trigger1 = movecontact=0 && movereversed=0
attr = C, SP
damage = ceil(30*root,fvar(0)), ceil(4*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 4, 14
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = L
ground.slidetime = 4
ground.hittime  = 30
ground.velocity = -3
airguard.velocity = -1.9,-1
air.type = L
air.velocity = -1.0,-1
air.hittime = 40
Guard.Velocity = -2.0
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 30,15
fall.recover = 0
EnvShake.Time = 16
EnvShake.Ampl = 5
EnvShake.Freq = 45

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = movehit=1
var(6) = 1
persistent = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 801
postype = p1
pos = P2BodyDist X+4,-2
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト強]
type = Explod
trigger1 = Movehit = 1
anim = 810
postype = p1
pos = P2BodyDist X+4,-2
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.48, 0.48
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = !time
var(2) = 0
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varset
trigger1 = p2statetype = L && (p2dist X = [-5+30,5+30]) && var(2)=0
var(2) = 1
IgnoreHitPause = 1
[State ダウンした相手の上を通ってからの時間]
type = varadd
trigger1 = var(2)
var(2) = 1
IgnoreHitPause = 1

[State 無敵];穴だし
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State ヒットで移動]
type = changestate
trigger1 = numtarget
trigger1 = movecontact && (p2dist X = [-45+30,45+30])
value = 2054
;IgnoreHitPause = 1

[State 消滅するときのおまけ]
type = Explod
trigger1 = movereversed
trigger2 = time >= 100
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = movecontact > 2
anim = 1460
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.3*root,const(size.xscale), 0.3*root,const(size.xscale)
;ID = 1460
BindTime = -1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub

[State KO演出用変数]
Type = varset
trigger1 = enemynear,Alive = 0 && movehit = 0
var(18) =  1
IgnoreHitPause = 1

[State やられたとき]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = 1052
IgnoreHitPause = 1
[State 消滅]
type = destroyself
trigger1 = movereversed
trigger2 = time >= 100
trigger3 = var(2)>6;相手がダウンしてる時
trigger4 = root,movetype = H
trigger5 = movecontact > 2
;IgnoreHitPause = 1
;---------------------------------------------------------------------------
;穴になっても死なない回転 ヘルパー ヒットして爆発
[Statedef 2054]
type    = S
movetype= A
physics = N
;velset = 0,0
anim = 2054
ctrl = 0
sprpriority = 2

[State 速度]
type = velmul
trigger1 = 1
x = 0.4
;IgnoreHitPause = 1

[State 回転エフェ]
type = Explod
trigger1 = time = 0
anim = 1460
postype = p1
pos = 0+60*0.6*root,const(size.yscale),0
IgnoreHitPause = 0
Persistent = 0
scale = 0.6*root,const(size.xscale), 0.6*root,const(size.xscale)
ID = 1460
BindTime = -1
SprPriority = 6
RemoveTime = -2
OwnPal = 1
trans = sub

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = C, SP
damage = ceil(110*root,fvar(0)), ceil(4*root,fvar(0))
animtype = B
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 4, 4
sparkno = -1
Guard.SparkNo = -1
hitsound = -1;s6, 2
guardsound = -1;s7, 0
ground.type = L
ground.slidetime = 15
ground.hittime  = 15
ground.velocity = -3,-6.5
airguard.velocity = -1.9,-1
air.type = L
air.velocity = -1.8,-5
air.hittime = 40
yaccel = 0.45
Guard.Velocity = -3
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 60,30
fall = 1
fall.recover = 0

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = movehit=1
var(6) = 1
persistent = 0

[State 無敵]
Type = Hitby
trigger1 = 1
value = SCA
IgnoreHitPause = 1

[State KOカットイン背景]
type = Explod
triggerall = numtarget && var(18)=0
trigger1 = !numexplod(16600) && target,Alive=0;WinKO
anim = 16600
postype = L
pos = 0,0
ID = 16600
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 120
sprpriority = -3
scale = 1,1
persistent = 0
[State KOスローしない]
type = AssertSpecial
trigger1 = 1 && var(18)=0
flag = NoKOSlow
[State KO音]
type = playsnd
triggerall = numtarget && var(18)=0
trigger1 = target,Alive=0;WinKO
value = 90,6
persistent = 0
[State KO時間停止]
type = Pause
triggerall = numtarget && var(18)=0
trigger1 = target,Alive=0;WinKO
Time = 120
movetime = 120
PauseBG = 0;背景はそのまま
persistent = 0

[State 消滅]
type = destroyself
trigger1 = time = 1
;IgnoreHitPause = 1
;---------------------------------------------------------------------------
;『なんだこの回転は！？』
[Statedef 2100]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2100
ctrl = 0
sprpriority = 2

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 45
movetime = 45
PauseBG = 0;背景はそのまま
persistent = 0

[state 99999, 無敵化]
type = nothitby
trigger1 = time <= 45
value = SCA,AA,AP,AT

[State 進化発動！]
type = varset
trigger1 = time = 0
var(50) = 2;ACT2
persistent = 0
[State 弾数設定]
type = varset
trigger1 = time = 0
var(51) = 100;MAX
persistent = 0

[State ゲージ減少]
type = PowerAdd
trigger1 = time = 0
value = -1000
persistent = 0

[state 背景]
Type = BGPalFX
trigger1 = time = [0,39]
mul = 100,100,100
time = 1

[State 盛り上げる]
type = playsnd
trigger1 = time = 0
value = 90,2
persistent = 0

[State 声]
type = playsnd
trigger1 = time = 0
value = 300,0
channel = 0
persistent = 0

[State ズゥゥム]
type = zoom
trigger1 = time = [0,5]
Pos = pos X*2.5,0
Scale = 1 + 0.4*(time**1.0/5**1.0)
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [6,28]
Pos = pos X*2.5,0
Scale = 1.4
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [29,45]
Pos = pos X*2.5,0
Scale = 1.4 - 0.4*((time-28)**1.0/17**1.0)
Lag = 0

[state カットインヘルパー]
type = helper
trigger1 = time = 1
name = "Ci"
stateno = 2130
ID = 2030
postype = p1
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647
persistent = 0
OwnPal = 1

[State SE]
type = PlaySnd
trigger1 = animelemtime(5) = 3
value = 0, 15
[State SE]
type = PlaySnd
trigger1 = animelemtime(7) = 1
value = 0, 8

[State 画面振動]
type = envshake
trigger1 = animelemtime(7) = 9
time = 8
Ampl = -4
Freq = 90

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1360
ID = 1360
pos = ceil(38*const(size.xscale)),  ceil(-50*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.5*const(size.xscale), 0.5*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
anim = 1355
ID = 1355
pos = ceil(38*const(size.xscale)),  ceil(-50*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.55*const(size.yscale), 0.8*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 黄金回転爪弾]
type = helper
trigger1 = animelemtime(8) = 0
name = "goldspin nail"
stateno = 2150
ID = 2150
postype = p1
pos = ceil(38*const(size.xscale)) -30,  ceil(-50*const(size.yscale))
Size.XScale = 1*const(size.xscale)
Size.YScale = 1*const(size.yscale)
OwnPal = 1

[State 反動]
type = veladd
trigger1 = animelemtime(8) = 0
X = -4
persistent = 0

[State ステート変更]
type = Changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;カットインヘルパー
[statedef 2130]
type = A
movetype = I
physics = N
ctrl = 0
anim = -1

[State カットイン]
type = Explod
trigger1 = !numexplod(2030) && time = 0
anim = 2030
postype = B
pos = 160,150
ID = 2030
IgnoreHitPause = 1
scale = 0.75, 0.75
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 45
sprpriority = -5
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2030) && time = [0,4]
anim = 2030
postype = B
pos = 140 +5*time ,150
ID = 2030
IgnoreHitPause = 1
trans = addalpha
alpha = 255*time**1.0/5**1.0,255- 255*time**1.0/5**1.0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2030) && time = [5,30]
anim = 2030
postype = B
pos = 160 +3*time**0.5 ,150
ID = 2030
IgnoreHitPause = 1
trans = addalpha
alpha = 255,0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2030) && time = [31,45]
anim = 2030
postype = B
pos = 160 +3*40**0.5 ,150
ID = 2030
IgnoreHitPause = 1
trans = addalpha
alpha = 255-255*(time-30)**1.0/5**1.0, 255*(time-30)**1.0/5**1.0
scale = 0.75 *(1+0.1*(time-31)**1.0/5**1.0), 0.75 *(1+0.1*(time-31)**1.0/5**1.0)

[State ヒットで消滅]
type = destroyself
trigger1 = time = 45
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;なんだこの回転は！？ 弾丸ヘルパー
[Statedef 2150]
type    = A
movetype= A
physics = N
velset = 14,0
;anim = 2150
ctrl = 0
sprpriority = 2
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 2150 && time = 0
value = 2150

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 100

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = !numtarget;movecontact=0 && movereversed=0
trigger1 = 1 || fvar(0):=root,fvar(0);ヒット時の補正式を保存
attr = S, HP
damage = ceil(30*root,fvar(0)*ifelse((root,fvar(0)=[1.9,2.3]),(0.75),1)), ceil(18*root,fvar(0))
animtype = B
guardflag = MA
hitflag = MAFP
priority = 4, Hit
pausetime = 17, 17
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 17
ground.hittime  = 20
ground.velocity = -4,-4
airguard.velocity = -1.9,-0.8
air.type = L
air.velocity = -4,-0.5
air.hittime = 17
AirGuard.CtrlTime = 17
Guard.Velocity = -7
airGuard.Velocity = -4,-3
Guard.CtrlTime = 20
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 0,0
fall = 1
fall.recover = 0
EnvShake.Time = 20
EnvShake.Ampl = 8
EnvShake.Freq = 70
[State ダメージ処理];アーマーを殺してしまうので
Type = targetlifeadd
trigger1 = numtarget && movehit
value = -Floor(75*fvar(0)*ifelse((fvar(0)=[1.9,2.3]),(0.75),1))
IgnoreHitPause = 1
Persistent = 0
Absolute = 0

[State ヒットしてもターゲットとれないとき回数加算]
type = varadd
trigger1 = movecontact=1 && !numtarget
var(0) = 1
IgnoreHitPause = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%10 +30,-0-root,var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.54, 0.54
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1358
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 180
scale = 0.3*root,const(size.yscale), 0.4*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%4 = 0 && time != 0
anim = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
scale = 0.3*root,const(size.yscale), 0.4*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.5
removetime = -2

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit = 1
var(6) = 1
persistent = 0

[State 飛び道具以外無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1
[State 飛び道具以外無敵];ヒットしたらグルグル確定
Type = notHitby
trigger1 = numtarget
value2 = SCA
IgnoreHitPause = 1

[State グルグルエフェクト減算]
type = Explod
trigger1 = movecontact && numtarget
anim = 1380
ID = 1380
pos = 5 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.45*root,const(size.yscale), 0.45*root,const(size.yscale)
sprpriority = 6
OwnPal = 1
persistent = 0
trans = sub
vel = 0.11
IgnoreHitPause = 1
[State グルグルエフェクト通常]
type = Explod
trigger1 = movecontact && numtarget
anim = 1385
ID = 1385
pos = 5 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.48*root,const(size.yscale), 0.48*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
vel = 0.11

[State ヒットアニメ変更]
type = changeanim
trigger1 = movecontact
value = 1350
elem = 1
IgnoreHitPause = 1

[State ヒットした時の相手の状態]
type = null;varset
trigger1 = numtarget
var(10) = (target,statetype=A)
IgnoreHitPause = 1
persistent = 0

[State 挑発成功からの時間経過]
type = varadd
trigger1 = root,stateno = 961
var(9) = 1
IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2;挑発成功
ID = 1358
ignorehitpause = 1\
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = var(0)>3;アーマーか何かにヒットしすぎ
trigger3 = var(9)>2;挑発成功

[State ヒットで移動]
type = changestate;destroyself
trigger1 = movecontact && numtarget
value = 1352
;IgnoreHitPause = 1

[State やられても耐える]
Type = HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = ifelse(var(0)<3,1351,1052)
IgnoreHitPause = 1
;===========================================================================
;『もう迷っちゃあいない』
;わかったんだ！さっきわかった…！
[Statedef 2200]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2200
ctrl = 0
sprpriority = 3

[state 99999, 無敵化]
type = nothitby
triggerall = numhelper(2265) || time<80
trigger1 = anim = 2200 || anim = 2250
value = SCA,AA,AP,AT

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 70
movetime = 70
PauseBG = 0;背景はそのまま
persistent = 0

[State 声]
type = playsnd
trigger1 = time = 0
value = 300,1
channel = 0
volume = 200
persistent = 0

[State 声]
type = playsnd
trigger1 = time = 70
value = 300,2
channel = 0
persistent = 0

[State 進化発動！]
type = varset
trigger1 = time = 0 && var(50)<3
var(50) = 3;ACT3
persistent = 0
[State ゲージ減少]
type = PowerAdd
trigger1 = time = 0
value = -1000
persistent = 0

[state 背景]
Type = BGPalFX
trigger1 = time = [0,69]
mul = 100,100,100
time = 1

[State 盛り上げる]
type = playsnd
trigger1 = time = 0
value = 90,2
persistent = 0

[State 画面振動]
type = envshake
trigger1 = anim = 2250 && animelemtime(2) = 0
time = 5
Ampl = -6
Freq = 90

[State ズゥゥム]
type = zoom
trigger1 = time = [0,5]
Pos = pos X*1.4,0
Scale = 1 + 1.4*(time**1.0/5**1.0)
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [6,30]
Pos = pos X*1.4,0
Scale = 2.4
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [31,55]
Pos = pos X*1.4,0
Scale = 2.4 - 1.4*((time-30)**1.0/25**1.0)
Lag = 0

[state カットインヘルパー]
type = helper
trigger1 = time = 1
name = "Ci"
stateno = 2230
ID = 2230
postype = p1
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647
persistent = 0
OwnPal = 1

[State 自分を撃つアニメ]
type = changeanim
trigger1 = time = 40
value = 2250

[State 発射音]
type = playsnd
trigger1 = anim = 2250 && animelemtime(1) = 3
value = 0,9
persistent = 0
[State 巻き込みSE]
type = playsnd
trigger1 = anim = 2250 && animelemtime(4) = 0
value = 0,19
persistent = 0

[state 背景]
Type = BGPalFX
trigger1 = anim = 2250 && animelemtime(1) = [4,5]
mul = 130,130,130
time = 1

[State 発射エフェクト]
type = Explod
trigger1 = anim = 2250 && animelemtime(2) = 0
anim = 1360
ID = 1360
pos = ceil(13*const(size.xscale)),  ceil(-55*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
facing = -1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 発射回転エフェクト1]
type = Explod
trigger1 = anim = 2250 && animelemtime(2) = 0
anim = 2267
pos = ceil(13*const(size.xscale)),  ceil(-55*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.3*const(size.yscale), 0.3*const(size.yscale)
facing = -1
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 発射回転エフェクト2]
type = Explod
trigger1 = anim = 2250 && animelemtime(2) = 1
anim = 2268
pos = ceil(23*const(size.xscale)),  ceil(-47*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.3*const(size.yscale), 0.3*const(size.yscale)
facing = -1
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 発射回転エフェクト2]
type = Explod
trigger1 = anim = 2250 && animelemtime(2) = 2
anim = 2269
pos = ceil(34*const(size.xscale)),  ceil(-32*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.3*const(size.yscale), 0.3*const(size.yscale)
facing = -1
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[state HHA右腕ヘルパー]
type = helper
trigger1 = anim = 2250 && animelemtime(6) = 2
name = "spinarm"
stateno = 2260
ID = 2260
postype = p1
pos = ceil(17*const(size.xscale)),  ceil(-5*const(size.yscale));17,-5
Size.XScale = const(size.yscale)
Size.YScale = const(size.yscale)
persistent = 0
pausemovetime = 10

[State 奥の穴エフェクト]
type = Explod
trigger1 = anim = 2250 && animelemtime(5) = 0
anim = 1450
ID = 1450
postype = p1
pos = -60*const(size.yscale)*1.0 ,5*const(size.yscale)
IgnoreHitPause = 1
Persistent = 0
scale = 1.0*const(size.yscale), 0.8*const(size.yscale)
OwnPal = 1
sprpriority = 2
removetime = 400
bindtime = -1
trans = sub
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = time > 120 && numexplod(1450)
ID = 1450

[State 穴の中連続SE]
type = playsnd
trigger1 = anim = 2250 && animelemtime(6) >= 0 && gametime%16=0
value = 0,20

[State 成功時]
type = changestate
trigger1 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget
value = 2270

[State 終わり]
type = changeanim
trigger1 = time > 120 && anim != 2251
value = 2251
[State 終わり]
type = changestate
trigger1 = anim = 2251 && animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;もう迷っちゃあいないさっきわかったカットインヘルパー 
[statedef 2230]
type = A
movetype = I
physics = N
ctrl = 0
anim = -1

[State カットイン]
type = Explod
trigger1 = !numexplod(2030) && time = 0
anim = 2230
postype = B
pos = 30,150
ID = 2230
IgnoreHitPause = 1
scale = 0.75, 0.75
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 45
sprpriority = 8
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2230) && time = [0,10]
postype = B
pos = 0 +5*time ,150
ID = 2230
IgnoreHitPause = 1
trans = addalpha
alpha = 255*(time)**1.0/11**1.0,255- 255*(time)**1.0/11**1.0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2230) && time = [11,30]
postype = B
pos = 0+(5*10) +3*(time-11)**0.5 ,150
ID = 2230
IgnoreHitPause = 1
trans = addalpha
alpha = 255,0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(2230) && time = [31,40]
anim = 2030
postype = B
pos = 0+50+3*10**0.5 ,150
ID = 2230
IgnoreHitPause = 1
trans = addalpha
alpha = 155-155*(time-30)**1.0/10**1.0, 100+155*(time-30)**1.0/10**1.0
scale = 0.75 *(1+0.5*(time-31)**1.0/10**1.0), 0.75 *(1+0.5*(time-31)**1.0/10**1.0)

[State 消滅]
type = destroyself
trigger1 = time >= 45
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;もう迷っちゃあいない 腕ヘルパー 始動
[Statedef 2260]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 2260
ctrl = 0
sprpriority = 2
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow

[State 奥の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1450
ID = 1450
postype = p1
pos = -30*root,const(size.yscale),2
IgnoreHitPause = 1
Persistent = 0
scale = 0.5*root,const(size.yscale), 0.5*root,const(size.yscale)
OwnPal = 1
sprpriority = 1
removetime = 400
bindtime = -1
trans = sub
[State 手前の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1451
ID = 1451
postype = p1
pos = -30*root,const(size.yscale),2
IgnoreHitPause = 1
Persistent = 0
scale = 0.5*root,const(size.yscale), 0.5*root,const(size.yscale)
OwnPal = 1
sprpriority = 3
removetime = 400
bindtime = -1
trans = sub
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = animtime = 0
trigger2 = root,movetype = H
ID = 1450
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = animtime = 0
trigger2 = root,movetype = H
ID = 1451

[State 追尾]
type = veladd
trigger1 = 1
x = 0

[State 発射音]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 0,9
persistent = 0
volume = 50

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1360
ID = 1360
pos = ceil(20*const(size.xscale)),  ceil(-17*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1355
pos = ceil(20*const(size.xscale)),  ceil(-18*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.42*const(size.yscale), 0.42*const(size.yscale)
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[state HHA2用黄金回転爪弾]
type = helper
trigger1 = animelemtime(6) = 0
name = "goldspin nail HHA2"
stateno = 2265
ID = 2265
postype = p1
pos = ceil(20*const(size.xscale)) -30,  ceil(-17*const(size.yscale))
Size.XScale = 1;*const(size.xscale)
Size.YScale = 1;*const(size.yscale)
OwnPal = 1

[State -2 爪弾によるヒットカウント増加]
type = parentVaradd
trigger1 = numhelper(2265) && helper(2265),Movehit && helper(2265),numtarget
var(6) = 1
persistent = 0

[State 成功したとき移動]
type = changestate
trigger1 = numhelper(2265) && helper(2265),movehit && helper(2265),numtarget
trigger1 = animelemtime(8)<0
value = 2262

[State 消滅]
type = destroyself
trigger1 = animtime = 0
trigger2 = root,movetype = H
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;もう迷っちゃあいない 腕ヘルパー 始動成功時 追撃一発
[Statedef 2262]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 2263;2
ctrl = 0
sprpriority = -1
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow

[State 穴エフェクトの表示優先度]
type = modifyExplod
trigger1 = !time
ID = 1450
sprpriority = -2
[State 穴エフェクトの表示優先度]
type = modifyExplod
trigger1 = !time
ID = 1451
sprpriority = 0
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = anim = 2263 && animtime = 0
ID = 1450
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = anim = 2263 && animtime = 0
ID = 1451

[State 移動]
type = velset
trigger1 = !time
x = 3+(p2bodydist X-120)*0.04
Y = -2
[State 移動]
type = velmul
trigger1 = anim = 2263 && animelemtime(7) < 0
Y = 0.8
[State 移動]
type = velset
trigger1 = anim = 2263 && animelemtime(7) = 0
x = 0
Y = 0

[State 修了]
type = destroyself
trigger1 = anim = 2263 && animtime = 0
IgnoreHitPause = 1

[state HHA2用爪弾]
type = helper
trigger1 = anim = 2263 && animelemtime(7) = 0
name = "goldspin nail HHA2"
stateno = 2281
ID = 2266
postype = p1
pos = ceil(-10*const(size.xscale)) -30,  ceil(-15*const(size.yscale))
Size.XScale = 1;*const(size.xscale)
Size.YScale = 1;*const(size.yscale)
OwnPal = 1
persistent = 0

[State -2 爪弾によるヒットカウント増加]
type = parentVaradd
trigger1 = numhelper(2266) && helper(2266),Movehit && helper(2266),numtarget
var(6) = 1
persistent = 0

[State 発射音]
type = playsnd
trigger1 = anim = 2263 && animelemtime(7) = 0
value = 0,9
persistent = 0

[State 発射エフェクト]
type = Explod
trigger1 = anim = 2263 && animelemtime(7) = 0
anim = 1360
pos = ceil(-4*const(size.xscale)), ceil(-15*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.34*const(size.xscale), 0.34*const(size.yscale)
sprpriority = 0
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = anim = 2263 && animelemtime(7) = 0
anim = 1355
pos = ceil(-4*const(size.xscale)), ceil(-15*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.37*const(size.yscale), 0.37*const(size.yscale)
sprpriority = 0
OwnPal = 1

;---------------------------------------------------------------------------
;もう迷っちゃあいない！さっきわかった 始動弾丸ヘルパー
[Statedef 2265]
type    = A
movetype= A
physics = N
velset = 8.5,-0.55
ctrl = 0
sprpriority = 3
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 2262 && time = 0
value = 2262

[State スプライト用意が面倒なので残像]
Type = AfterImage
trigger1 = !time
time = -1
Length = 4
Timegap = 2
Framegap = 1
PalBright = 0,0,0
PalContrast = 255,255,255
PalAdd = 0,0,0
PalMul = 0.95,0.95,0.95;1,1,1
[State スプライト用意が面倒なので残像]
Type = AfterImagetime
trigger1 = 1
value = 2

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 100

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(30*root,fvar(0)), ceil(4*root,fvar(0))
animtype = H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 12, 14
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 15
ground.hittime  = 40
ground.velocity = -2
airguard.velocity = -1.9,-0.8
air.type = H
air.velocity = -0.3,-0.8
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -1,-2
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
fall.recover = 0
air.fall = 1
EnvShake.Time = 8
EnvShake.Ampl = 4
EnvShake.Freq = 60
yaccel = 0.14
kill = 0
[State 相手の高さ調整]
Type = targetveladd
trigger1 = numtarget && target,statetype = A && target,pos Y = [0,10]
Y = -1
persistent = 0
[State 相手の高さ調整]
Type = targetveladd
trigger1 = numtarget && target,statetype = A && target,pos Y > 10
Y = -10
persistent = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit && hitpausetime = 12-1
anim = 812
postype = p1
pos = 2+root,var(3)%10 +30,-0-root,var(3)%10
IgnoreHitPause = 1
scale = 0.55, 0.55
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1 && numtarget
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1358
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.2*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%5 = 0 && time != 0
anim = 1357
ID = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.27*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.6,-0.1
accel = -0.03

[State 飛び道具以外無敵]
Type = notHitby
trigger1 = 1
value = SCA;,AP
IgnoreHitPause = 1

[State ヒットで消滅]
type = destroyself
trigger1 = movecontact && numtarget
;IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = movecontact
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]

[State やられても耐える]
Type = null;HitOverRide
trigger1 = 1
Attr = SCA,AP
StateNo = ifelse(var(0)<4,1351,1052)
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時本体待機
[Statedef 2270]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2270
ctrl = 0
sprpriority = 2
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State カメラが追わない]
Type = ScreenBound
trigger1 = anim != 2270
value = 0
[State 押し出し無効]
Type = playerpush
trigger1 = anim != 2270
value = 0

[state HHA左腕ヘルパー]
type = helper
trigger1 = time = 10
name = "spinarm"
stateno = 2280
ID = 2280
postype = p1
pos = ceil(0*const(size.xscale)),  ceil(6*const(size.yscale));17,-5
Size.XScale = const(size.yscale)
Size.YScale = const(size.yscale)
persistent = 0

[State 奥の穴エフェクト位置]
type = modifyExplod
trigger1 = anim = 2270 && animelemtime(3) = 0
ID = 1450
postype = p1
pos = -60*const(size.yscale)*1.0 ,0*const(size.yscale)
IgnoreHitPause = 1
Persistent = 0
scale = 1.0*const(size.yscale), 0.8*const(size.yscale)
sprpriority = 1
[State 奥の穴エフェクト位置]
type = modifyExplod
trigger1 = anim = 2272 && animelemtime(3) = 0
ID = 1450
postype = p1
pos = -60*const(size.yscale)*1.0 ,5*const(size.yscale)
IgnoreHitPause = 1
Persistent = 0
scale = 1.0*const(size.yscale), 0.8*const(size.yscale)
sprpriority = 1

[State 穴の中連続SE]
type = playsnd
trigger1 = 1 && gametime%16=0
value = 0,20

[State よし見える]
type = PlaySnd
trigger1 = anim = 2270 && numhelper(2280) && helper(2280),time > 65
value = 300, 3
volume = 200
channel = 0
persistent = 0

[State 潜るアニメへ]
type = changeanim
trigger1 = anim = 2270 && numhelper(2280) && helper(2280),time > 65
value = 2272

[State 潜り終わったらステート移動]
type = changestate
trigger1 = anim = 2272 && animtime=0
value = 2290

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時 左腕ヘルパー 手前で3連射
[Statedef 2280]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 2280
ctrl = 0
sprpriority = 4
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[State カメラが追う]
Type = ScreenBound
trigger1 = 1
value = 1
MoveCamera = 1,1

[State 奥の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1450
ID = 1450
postype = p1
pos = -30*root,const(size.yscale),2
IgnoreHitPause = 1
Persistent = 0
scale = 0.55*root,const(size.yscale), 0.55*root,const(size.yscale)
OwnPal = 1
sprpriority = 1
removetime = 400
bindtime = -1
trans = sub
[State 手前の穴エフェクト]
type = Explod
trigger1 = !time
anim = 1451
ID = 1451
postype = p1
pos = -30*root,const(size.yscale),2
IgnoreHitPause = 1
Persistent = 0
scale = 0.55*root,const(size.yscale), 0.55*root,const(size.yscale)
OwnPal = 1
sprpriority = 3
removetime = 400
bindtime = -1
trans = sub
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = animelemtime(12) > 0 && pos Y <= 0
trigger2 = root,movetype = H
trigger3 = root,anim = 2290;time>70
ID = 1450
[State 穴エフェクト消滅]
type = removeExplod
trigger1 = animelemtime(12) > 0 && pos Y <= 0
trigger2 = root,movetype = H
trigger3 = root,anim = 2290;time>70
ID = 1451

[State 初段まで移動]
type = velset
trigger1 = !time
X = 0.5 + (p2bodydist X-40)*0.03
Y = 3.2
[State 初段まで移動]
type = velmul
trigger1 = animelemtime(4) < 0
X = 1.01
Y = 0.8
[State ストップ]
type = velmul
trigger1 = animelemno(0) = 4
X = 0.5
Y = 0.5
[State 2射目から移動]
type = velset
trigger1 = animelemtime(6) = 0
X = 3.5
[State 2射目から移動減速]
type = velmul
trigger1 = animelemno(0) = 7
X = 0.9
[State ストップ]
type = velset
trigger1 = animelemtime(8) = 0
X = 0
[State 2射目後移動]
type = velset
trigger1 = animelemtime(9) = 0
X = 4
[State 2射目後移動減速]
type = velmul
trigger1 = animelemno(0) = 9
X = 0.9
[State ストップ]
type = velset
trigger1 = animelemtime(10) = 0
X = 0

[State 相手が壁際なら移動方向転換]
type = turn
trigger1 = animelemtime(12) = 0 && frontEdgeBodyDist < 55;enemynear,BackEdgeBodyDist < 20
trigger1 = var(0):=1;スイッチオン
persistent = 0
[State 回り込み移動]
type = velset
trigger1 = animelemtime(12) = 0
X = 6.7-var(0)*2;6.5 ;回り込まないとき減速
Y = 0.1
[State 回り込み移動]
type = veladd
trigger1 = animelemtime(12) > 0 && pos Y > 0
Y = -0.08
[State 回り込み移動]
type = null;velmul
trigger1 = animelemtime(13) >= 4
X = 0.7
[State 回り込み移動]
type = veladd
trigger1 = animelemtime(13) >= 4
X = -1.0
[State 回り込み移動ストップ]
type = velset
trigger1 = animelemtime(12) > 0 && pos Y <= 0
Y = 0
[State 上に行かない]
type = posset
trigger1 = pos Y < 0
Y = 0

[state HHA2用爪弾1]
type = helper
trigger1 = animelemtime(5) = 0
name = "goldspin nail HHA2"
stateno = 2282
ID = 2267
postype = p1
pos = ceil(0*const(size.xscale)) -30,  ceil(-14*const(size.yscale))
Size.XScale = 1;*const(size.xscale)
Size.YScale = 0.8;*const(size.yscale)
OwnPal = 1
persistent = 0
[state HHA2用爪弾2]
type = helper
trigger1 = animelemtime(8) = 0
name = "goldspin nail HHA2"
stateno = 2283
ID = 2268
postype = p1
pos = ceil(-6*const(size.xscale)) -30,  ceil(-14*const(size.yscale))
Size.XScale = 1;*const(size.xscale)
Size.YScale = 1;*const(size.yscale)
OwnPal = 1
persistent = 0
[state HHA2用爪弾3]
type = helper
trigger1 = animelemtime(10) = 0
name = "goldspin nail HHA2"
stateno = 2283
ID = 2269
postype = p1
pos = ceil(-6*const(size.xscale)) -30,  ceil(-14*const(size.yscale))
Size.XScale = 1;*const(size.xscale)
Size.YScale = 1;*const(size.yscale)
OwnPal = 1
persistent = 0

[State -2 爪弾によるヒットカウント増加]
type = parentVaradd
trigger1 = numhelper(2267) && helper(2267),Movehit && helper(2267),numtarget
var(6) = 1
persistent = 0
[State -2 爪弾によるヒットカウント増加]
type = parentVaradd
trigger1 = numhelper(2268) && helper(2268),Movehit && helper(2268),numtarget
var(6) = 1
persistent = 0
[State -2 爪弾によるヒットカウント増加]
type = parentVaradd
trigger1 = numhelper(2269) && helper(2269),Movehit && helper(2269),numtarget
var(6) = 1
persistent = 0

[State 発射SE]
type = PlaySnd
trigger1 = animelemtime(4) = 2
trigger2 = animelemtime(7) = 2
trigger3 = animelemtime(9) = 12
value = 0, 9

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(5) = 0
anim = 1361
pos = ceil(-6*const(size.xscale)),  ceil(-14*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.35*const(size.xscale), 0.35*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(5) = 0
anim = 1390
pos = ceil(-6*const(size.xscale)),  ceil(-14*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.yscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
trigger2 = animelemtime(10) = 0
anim = 1362
pos = ceil(-7*const(size.xscale)),  ceil(-14*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.35*const(size.xscale), 0.35*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0
trigger2 = animelemtime(10) = 0
anim = 1395
pos = ceil(-7*const(size.xscale)),  ceil(-14*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.yscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state 本体が来たら透明]
type = assertspecial
trigger1 = root,anim = 2290;time>70
flag = invisible

[State 消滅]
type = destroyself
trigger1 = animelemtime(12) > 0 && pos Y <= 0
trigger2 = root,movetype = H
IgnoreHitPause = 1

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時 奥で一射 弾丸ヘルパー
[Statedef 2281]
type    = A
movetype= A
physics = N
velset = 9,0
ctrl = 0
sprpriority = 3
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 2265 && time = 0
value = 2265

[State スプライト用意が面倒なので残像]
Type = AfterImage
trigger1 = !time
time = -1
Length = 4
Timegap = 2
Framegap = 1
PalBright = 0,0,0
PalContrast = 255,255,255
PalAdd = 0,0,0
PalMul = 0.95,0.95,0.95;1,1,1
[State スプライト用意が面倒なので残像]
Type = AfterImagetime
trigger1 = 1
value = 2

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 100

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(26*root,fvar(0)), ceil(3*root,fvar(0))
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 8, 8
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = L
ground.slidetime = 15
ground.hittime  = 40
ground.velocity = -2
airguard.velocity = -1.2,-1.0
air.type = H
air.velocity = -0.3,-2.1
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -2,-1
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
air.fall = 1
fall.recover = 0
EnvShake.Time = 9
EnvShake.Ampl = 2
EnvShake.Freq = 60
yaccel = 0.2
kill = 0
[State 相手の高さ調整]
Type = targetveladd
trigger1 = numtarget && target,statetype = A && target,pos Y = [0,10]
Y = -5
persistent = 0
[State 相手の高さ調整]
Type = targetveladd
trigger1 = numtarget && target,statetype = A && target,pos Y > 10
Y = -15
persistent = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%5 +30,-0-root,var(3)%5
IgnoreHitPause = 1
Persistent = 0
scale = 0.45, 0.45
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1358
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.2*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%4 = 0 && time != 0
anim = 1357
ID = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.27*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.6,-0.1
accel = -0.03

[State 無敵]
Type = notHitby
trigger1 = 1
value = SCA;,AP
IgnoreHitPause = 1

[State ヒットで消滅]
type = destroyself
trigger1 = movecontact && numtarget
;IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = movecontact
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時 弾丸ヘルパー 1/3連射
[Statedef 2282]
type    = A
movetype= A
physics = N
velset = 9*cos(36*Pi/180),-9*sin(36*Pi/180)
ctrl = 0
sprpriority = 3
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 2266 && time = 0
value = 2266

[State スプライト用意が面倒なので残像]
Type = AfterImage
trigger1 = !time
time = -1
Length = 4
Timegap = 1
Framegap = 1
PalBright = 0,0,0
PalContrast = 255,255,255
PalAdd = 0,0,0
PalMul = 0.95,0.95,0.95;1,1,1
[State スプライト用意が面倒なので残像]
Type = AfterImagetime
trigger1 = 1
value = 2

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 70

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(26*root,fvar(0)), ceil(3*root,fvar(0))
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 8, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 5
ground.hittime  = 40
ground.velocity = -1
airguard.velocity = -1.2,-0.8
air.type = H
air.velocity = -0.2,-1
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -3,-2
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
fall.recover = 0
air.fall = 1
EnvShake.Time = 7
EnvShake.Ampl = 2
EnvShake.Freq = 60
yaccel = 0.18
kill = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%5 +30,-10-root,var(3)%5
IgnoreHitPause = 1
Persistent = 0
scale = 0.4, 0.4
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1393
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.22*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%4 = 0 && time != 0
anim = 1392
ID = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.29*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.6,-0.1
accel = -0.03

[State 無敵]
Type = notHitby
trigger1 = 1
value = SCA;,AP
IgnoreHitPause = 1

[State ヒットで消滅]
type = destroyself
trigger1 = movecontact && numtarget
;IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = movecontact
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時 弾丸ヘルパー 2~3/3連射
[Statedef 2283]
type    = A
movetype= A
physics = N
velset = 9*cos(62*Pi/180),-9*sin(62*Pi/180)
ctrl = 0
sprpriority = 3
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 2264 && time = 0
value = 2264

[State スプライト用意が面倒なので残像]
Type = AfterImage
trigger1 = !time
time = -1
Length = 4
Timegap = 1
Framegap = 1
PalBright = 0,0,0
PalContrast = 255,255,255
PalAdd = 0,0,0
PalMul = 0.95,0.95,0.95;1,1,1
[State スプライト用意が面倒なので残像]
Type = AfterImagetime
trigger1 = 1
value = 2

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 60

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(26*root,fvar(0)), ceil(3*root,fvar(0))
animtype = M
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 8, 12
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 5
ground.hittime  = 40
ground.velocity = -1
airguard.velocity = -1.9,-0.8
air.type = H
air.velocity = -0.2,-3.1
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -3,-2
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
fall.recover = 0
EnvShake.Time = 7
EnvShake.Ampl = 2
EnvShake.Freq = 60
yaccel = 0.17
air.fall = 1
kill = 0

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = root,var(3)%5 +30,-10-root,var(3)%5
IgnoreHitPause = 1
Persistent = 0
scale = 0.4, 0.4
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1398
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.22*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%4 = 0 && time != 0
anim = 1397
ID = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.29*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.1,-0.6
accel = -0.01,0.03

[State 無敵]
Type = notHitby
trigger1 = 1
value = SCA;,AP
IgnoreHitPause = 1

[State ヒットで消滅]
type = destroyself
trigger1 = movecontact && numtarget
;IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = movecontact
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時回り込んで撃つ本体
[Statedef 2290]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2290
ctrl = 0
sprpriority = 2
[state 99999, 無敵化]
type = nothitby
trigger1 = 1;animelemtime(13) < 0
value = SCA,AA,AP,AT
[state すり抜け]
type = playerpush
trigger1 = 1
value = !(animelemtime(13)<0)

[State 腕に追従]
type = posset
trigger1 = numhelper(2280)
X = helper(2280),pos X
Y = helper(2280),pos Y
IgnoreHitPause = 1

[State 相手を向く]
type = turn
trigger1 = p2dist X < 0 && time=0
IgnoreHitPause = 1

[State 奥の穴エフェクト位置]
type = modifyExplod
trigger1 = numexplod(1450)
ID = 1450
postype = p1
pos = -60*const(size.yscale)*1.0 ,4
IgnoreHitPause = 1
Persistent = 0
scale = 1.0*const(size.yscale), 0.8*const(size.yscale)
sprpriority = 1

[State 穴の中連続SE]
type = playsnd
trigger1 = animelemtime(11) < 0 && gametime%16=0
value = 0,20

[State 発射SE]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 0, 9
[State 発射SE]
type = PlaySnd
trigger1 = animelemtime(5) = 2
value = 0, 8

[State 発射エフェクト]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1361
ID = 1360
pos = ceil(31*const(size.xscale)),  ceil(-37*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.4*const(size.xscale), 0.4*const(size.yscale)
sprpriority = 7
OwnPal = 1
[State 発射回転エフェクト]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 1390
ID = 1355
pos = ceil(31*const(size.xscale)),  ceil(-37*const(size.yscale))
postype = p1
bindtime = 1
removetime = -2
scale = 0.49*const(size.yscale), 0.49*const(size.yscale)
sprpriority = 7
OwnPal = 1

[state HHA2用爪弾Last]
type = helper
trigger1 = animelemtime(6) = 0
name = "goldspin nail HHA2"
stateno = 2292
postype = p1
pos = ceil(31*const(size.xscale)) -30,  ceil(-37*const(size.yscale))
Size.XScale = 1;*const(size.xscale)
Size.YScale = 1;*const(size.yscale)
OwnPal = 1
persistent = 0

[State 奥の穴エフェクト消滅]
type = removeExplod
trigger1 = numexplod(1450) && animelemtime(15) >= 0
ID = 1450
[State 穴から出るSE]
type = playsnd
trigger1 = animelemtime(11) = 0
value = 0,23

[State 上に行かない]
type = posset
trigger1 = pos Y < 0
Y = 0

[State ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;『もう迷っちゃあいない』成功時 回り込んでラストショット 弾丸ヘルパー
[Statedef 2292]
type    = A
movetype= A
physics = N
velset = 9*cos(30*Pi/180),-9*sin(30*Pi/180)
ctrl = 0
sprpriority = 3
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 2266 && time = 0
value = 2266

[State スプライト用意が面倒なので残像]
Type = AfterImage
trigger1 = !time
time = -1
Length = 4
Timegap = 1
Framegap = 1
PalBright = 0,0,0
PalContrast = 255,255,255
PalAdd = 0,0,0
PalMul = 0.95,0.95,0.95;1,1,1
[State スプライト用意が面倒なので残像]
Type = AfterImagetime
trigger1 = 1
value = 2

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 70

[State 200, ヒット定義]
type = HitDef
trigger1 = 1;AnimElemno(0) = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(32*root,fvar(0)), ceil(4*root,fvar(0))
animtype = B
guardflag = ;MA
hitflag = MAF
priority = 4, Hit
pausetime = 8, 14
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 5
ground.hittime  = 40
ground.velocity = -5,-4
airguard.velocity = -1.9,-0.8
air.type = H
air.velocity = -5,-2
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -3,-2
Guard.CtrlTime = 13
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
fall = 1
fall.recover = 0
EnvShake.Time = 22
EnvShake.Ampl = 6
EnvShake.Freq = 50
yaccel = 0.35
p2facing = 1

[State -2 ヒットカウント増加]
type = parentVaradd
trigger1 = Movehit && numtarget
var(6) = 1
persistent = 0
IgnoreHitPause = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%5 +30,-10-root,var(3)%5
IgnoreHitPause = 1
Persistent = 0
scale = 0.52, 0.52
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p2
pos = 10-random%10,-60+random%20
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0 && prevstateno!=1351
anim = 1393
ID = 1358
pos = 0 +30+3, 0
postype = p1
bindtime = -1
removetime = 300
scale = 0.22*root,const(size.yscale), 0.2*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
IgnoreHitPause = 1

[State 回転軌跡エフェクト]
type = Explod
trigger1 = time%4 = 0 && time != 0
anim = 1392
ID = 1357
pos = 0 +30, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.29*root,const(size.yscale), 0.27*root,const(size.yscale)
sprpriority = 7
OwnPal = 1
vel = 0.6,-0.1
accel = -0.03

[State 無敵]
Type = notHitby
trigger1 = 1
value = SCA;,AP
IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-50,320+50]
trigger2 = movecontact
ID = 1358
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-50,320+50]

[State KOカットイン背景]
type = Explod
triggerall = numtarget && var(18)=0
trigger1 = !numexplod(16600) && target,Alive=0;WinKO
anim = 16600
postype = L
pos = 0,0
ID = 16600
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 120
sprpriority = -3
scale = 1,1
persistent = 0
[State KOスローしない]
type = AssertSpecial
trigger1 = 1 && var(18)=0
flag = NoKOSlow
[State KO音]
type = playsnd
triggerall = numtarget && var(18)=0
trigger1 = target,Alive=0;WinKO
value = 90,6
persistent = 0
[State KO時間停止]
type = Pause
triggerall = numtarget && var(18)=0
trigger1 = target,Alive=0;WinKO
Time = 120
movetime = 120
PauseBG = 0;背景はそのまま
persistent = 0
[State KO演出用変数]
Type = varset
trigger1 = enemynear,Alive = 0 && movehit = 0
var(18) =  1
IgnoreHitPause = 1

[State ヒットで消滅]
type = destroyself
trigger1 = movecontact && numtarget
;IgnoreHitPause = 1

;===========================================================================
;GHA 君に渡せなかったこの一発の『鉄球』始動本体 カットイン中
[Statedef 3000]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 3
[State カウントストップ]
type = AssertSpecial
trigger1 = 1
flag = TimerFreeze

[state 背景]
Type = BGPalFX
trigger1 = 1
mul = 100,100,100
time = 1

[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State なんとなく]
type = changeanim
trigger1 = 1
value = 0
elem = 1

[State 押し出し]
type = width
trigger1 = 1
Edge = 80,0
Player = 80,0

[state カットインヘルパー]
type = helper
trigger1 = time = 0
name = "cut GHA"
stateno = 3007
ID = 3007
postype = p1
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647
persistent = 0
OwnPal = 1

[State シルシル]
type = playsnd
trigger1 = time = 0
value = 310,0

[State 声 LESSON5はこのために]
type = playsnd
trigger1 = time = 60
value = 300,5
channel = 0
volume = 100
persistent = 0

[State 放り投げる]
type = playsnd
trigger1 = time = 66-3
value = 0,14
[State チュンチュンチュン]
type = playsnd
trigger1 = time = 69-4
value = 310,1
volume = -100

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 94+75+38 +2
movetime = 94+75+38 +2
PauseBG = 0;背景はそのまま
persistent = 0

[State 進化発動！]
type = varset
trigger1 = time = 0 && var(50)<4
var(50) = 4;ACT4
persistent = 0
[State ゲージ減少]
type = PowerAdd
trigger1 = time = 0
value = -2000
persistent = 0

[State 発射待機]
type = changestate
trigger1 = time >= 94
value = 3010

;-----------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』 カットインヘルパー
[statedef 3007]
type = A
movetype = I
physics = N
ctrl = 0
anim = -1

[state 時間変数]
Type = null
triggerall = !time
trigger1 = 1 || var(0):=0
trigger1 = 1 || var(1):=0
[state 時間変数]
Type = null
trigger1 = 1 || var(0):=var(0)+1
trigger1 = 1 || var(1):=var(1)+1

[State カットイン背景　鉄球のとき]
type = Explod
trigger1 = !numexplod(3022) && time = 0
anim = 3022
postype = L
pos = 0,0
ID = 3022
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 35
sprpriority = 7
scale = 1, 1
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3022) && time = [0,2]
postype = B
pos = 0 -90*(1-time/2.0),-15 -90*(1-time/2.0) -time*0.1
ID = 3022
IgnoreHitPause = 1
scale = 1.5 *(2-time/2.0), 1.5 *(2-time/2.0)
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3022) && time = [3,20]
postype = B
pos = 0,-15 -time*0.1
ID = 3022
IgnoreHitPause = 1
scale = 1.5, 1.5

[State カットイン背景　引いてるとき]
type = Explod
trigger1 = !numexplod(3023)&& time = 21
anim = 3022
postype = L
pos = 0,0
ID = 3023
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 50
sprpriority = 7
scale = 1, 1

[State カットイン]
type = Explod
trigger1 = !numexplod(3007) && time = 0
anim = 3006
postype = L
pos = 40 +320*(facing=-1),-15
ID = 3007
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 35
ontop = 1
scale = 1.5, 1.5
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3007) && time = [0,2]
postype = L
pos = 40 -90*(1-time/2.0),-15 -90*(1-time/2.0) -time*0.1
ID = 3007
IgnoreHitPause = 1
scale = 1.5 *(2-time/2.0), 1.5 *(2-time/2.0)
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3007) && time = [3,20]
postype = L
pos = 40,-15 -time*0.1
ID = 3007
IgnoreHitPause = 1
scale = 1.5, 1.5
[State カットインを動かす];1枚目フェードアウト
type = modifyExplod
trigger1 = numexplod(3007) && time = [21,35]
postype = L
pos = 40,-15 -time*0.1
ID = 3007
IgnoreHitPause = 1
scale = 1.5, 1.5
trans = addalpha
alpha = 255-255*(time-20)/15.0, 0+255*(time-20)/15.0

[State カットイン白枠　鉄球のとき]
type = Explod
trigger1 = !numexplod(3015) && time = 0
anim = 3015
postype = L
pos = 0,0
ID = 3015
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 35
ontop = 1
scale = 1, 1
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3015) && time = [0,2]
postype = L
pos = -4 -90*(1-time/2.0),0 -90*(1-time/2.0)
ID = 3015
IgnoreHitPause = 1
scale = 1.0 *(2-time/2.0), 1.0 *(2-time/2.0)
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3015) && time = [3,20]
postype = L
pos = -4,0
ID = 3015
IgnoreHitPause = 1
[State カットインを動かす];1枚目フェードアウト
type = modifyExplod
trigger1 = numexplod(3015) && time = [21,35]
postype = L
pos = -4,0
ID = 3015
IgnoreHitPause = 1
scale = 1, 1
trans = addalpha
alpha = 255-255*(time-20)/15.0, 0+255*(time-20)/15.0

[state 時間変数リセット]
Type = varset
trigger1 = time=20
var(0)=0
[State カットイン引いて本体版]
type = Explod
trigger1 = !numexplod(3008) && time = 21
anim = 3006
postype = L
pos = 30,0
ID = 3008
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 50
sprpriority = 8
scale = 1.5, 1.5
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3008) && time = [21,35]
postype = L
pos = 30 -var(0)*0.15,0 -var(0)*0.1
ID = 3008
IgnoreHitPause = 1
scale = 0.55 +0.05*(1-var(0)/45.0)**2.0, 0.55 +0.05*(1-var(0)/45.0)**2.0
trans = addalpha
alpha = 255*var(0)/15.0, 255-255*var(0)/15.0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3008) && time = [36,65]
postype = L
pos = 30-var(0)*0.15,0 -var(0)*0.1
ID = 3008
IgnoreHitPause = 1
scale = 0.55 +0.05*(1-var(0)/45.0)**2.0, 0.55 +0.05*(1-var(0)/45.0)**2.0

[state 時間変数リセット]
Type = varset
trigger1 = time=65
var(0)=0
[State カットインを動かす];ズームイン
type = modifyExplod
trigger1 = numexplod(3008) && time = [65,66]
postype = L
pos = -300 -45*0.15 +330*(1-var(0)/5.0),-90 -45*0.1 +90*(1-var(0)/5.0)
ID = 3008
IgnoreHitPause = 1
scale = 1.0 -0.45*(1-var(0)/5.0),1.0 -0.45*(1-var(0)/5.0)
[State カットインを動かす];ズームインフェードアウト
type = modifyExplod
trigger1 = numexplod(3008) && time = [67,69]
postype = L
pos = -300 -45*0.15 +330*(1-var(0)/5.0),-90 -45*0.1 +90*(1-var(0)/5.0)
ID = 3008
IgnoreHitPause = 1
scale = 1.0 -0.45*(1-var(0)/5.0),1.0 -0.45*(1-var(0)/5.0)
trans = addalpha
alpha = 255-255*((var(0)-5)/3.0), 0+255*((var(0)-5)/3.0)

[State カットイン白枠　引いて本体のとき]
type = Explod
trigger1 = !numexplod(3016) && time = 21
anim = 3016
postype = L
pos = 0,0
ID = 3016
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 46;50
ontop = 1
scale = 1, 1
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3016) && time = [21,35]
postype = L
pos = 0,0
ID = 3016
IgnoreHitPause = 1
;scale = 1 +0.05*(1-var(0)/45.0)**2.0, 1 +0.05*(1-var(0)/45.0)**2.0
trans = addalpha
alpha = 255*var(0)/15.0, 255-255*var(0)/15.0
[State カットインを動かす]
type = modifyExplod
trigger1 = numexplod(3016) && time = [36,65]
postype = L
pos = 0,0
ID = 3016
IgnoreHitPause = 1
;scale = 1 +0.05*(1-var(0)/45.0)**2.0, 1 +0.05*(1-var(0)/45.0)**2.0
[State カットインを動かす];フェードアウト
type = modifyExplod
trigger1 = numexplod(3016) && time = [67,69]
postype = L
pos = 0,0
ID = 3016
IgnoreHitPause = 1
;scale = 1.0 -0.45*(1-var(0)/5.0),1.0 -0.45*(1-var(0)/5.0)
trans = addalpha
alpha = 255-255*((var(0)-5)/3.0), 0+255*((var(0)-5)/3.0)

[State カットイン背景　ドガァ！版]
type = Explod
trigger1 = !numexplod(3024)&& time = 67
anim = 3023
postype = L
pos = 0,0
ID = 3024
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 94-67
sprpriority = 7
scale = 1, 1

[state 時間変数リセット]
Type = varset
trigger1 = time=67
var(1)=0
[State カットイン ドガァ！]
type = Explod
trigger1 = !numexplod(3009) && time = 67
anim = 3008
postype = L
pos = 0,0
ID = 3009
IgnoreHitPause = 1
OwnPal = 1
bindtime = 1;振動についていく
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 94-67
ontop = 1
scale = 0.6 +1.4*(1-var(1)/4.0),0.6 +1.4*(1-var(1)/4.0)
trans = addalpha
alpha = 255*(var(1)/4.0), 255-255*(var(1)/4.0)
[State カットインを動かす];ズームアウトフェードイン
type = modifyExplod
trigger1 = numexplod(3009) && time = [67,71]
postype = L
pos = 0 -380*(1-var(1)/4.0),0 -220*(1-var(1)/4.0)
ID = 3009
IgnoreHitPause = 1
scale = 0.6 +1.9*(1-var(1)/4.0),0.6 +1.9*(1-var(1)/4.0)
trans = addalpha
alpha = 255*(var(1)/4.0), 255-255*(var(1)/4.0)
bindtime = 0
[State 画面振動]
type = envshake
trigger1 = time=67
time = 13
Ampl = -10
Freq = 90

[State カットイン白枠　ドガァ]
type = Explod
trigger1 = !numexplod(3017) && time = 67
anim = 3017
postype = L
pos = 0,0
ID = 3017
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 94-67
ontop = 1
scale = 1,1

[State 消滅]
type = destroyself
trigger1 = time >= 94
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』蹴られる
[Statedef 3010]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 3010
sprpriority = 6
[State カウントストップ]
type = AssertSpecial
trigger1 = 1
flag = TimerFreeze

[State 位置]
type = posadd
trigger1 = !time
y = -52
IgnoreHitPause = 1

[State 画面振動]
type = envshake
trigger1 = time=0
time = 12
Ampl = -8
Freq = 90

[State 蹴られる音]
type = playsnd
trigger1 = time = 0
value = 6,2

[State いななき]
type = playsnd
trigger1 = time = 4
value = 310,2
volume = 110

[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State 速度]
type = velset
trigger1 = anim = 3010
X = -5*(0.5)**(time*0.2)
Y = -2.5*(0.5)**(time*0.2)
[State 速度]
type = velset
trigger1 = anim = 3011
X = 0
Y = 0
IgnoreHitPause = 1
[State 速度]
type = posadd
trigger1 = 1
X = -0.09*(anim = 3010) -0.04*(anim = 3011)
Y = -0.05*(anim = 3010) -0.02*(anim = 3011)
IgnoreHitPause = 1

[State くるっ音]
type = playsnd
trigger1 = anim = 3010 && time = 35
value = 310,3
volume = 40
[State くるっ]
type = Changeanim
trigger1 = anim = 3010 && time = 35
value = 3011

[State ズゥゥム]
type = zoom
trigger1 = time = [36,43]
Pos = pos X*2.0 ,(-gameheight+screenpos Y+140)*((time-36)/7.0)
Scale = 1.0 +1.1*((time-36)/7.0)
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [44,73+36-1]
Pos = pos X*2.1 +(time-44)*0.0005,(-gameheight+screenpos Y+140)
Scale = 2.0 +(time-44)*0.0005
Lag = 0

[State キュピーン]
type = playsnd
trigger1 = time = 46-5
value = 310,5
volume = 150

[State キュピーンエフェクト]
type = Explod
trigger1 = anim = 3011 && animelemtime(2)=1 && numexplod(3014)=0
anim = 3014
ID = 3014
pos = 0, 0
postype = p1
bindtime = 1
removetime = -2
scale = 0.5*Const(size.xscale),0.5*Const(size.yscale)
sprpriority = 7
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 画面振動]
type = envshake
trigger1 = time=46
time = 7
Ampl = -3
Freq = 90

[state 時間変数]
Type = varset
trigger1 = time = 75
var(0) = 0
[state 時間変数]
Type = null
trigger1 = time > 75 || var(0):=var(0)+1

[State カットイン背景]
type = Explod
trigger1 = !numexplod(3022) && time = 75
anim = 3022
postype = L
pos = 0,0
ID = 3022
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 38
sprpriority = 7
scale = 1, 1
[State カットインを動かす フェードイン]
type = modifyExplod
trigger1 = numexplod(3022) && var(0)=[0,3]
postype = L
pos = 0,0
ID = 3022
IgnoreHitPause = 1
scale = 1,1
trans = addalpha
alpha = 255*var(0)/3.0, 255-255*var(0)/3.0

[State カットイン]
type = Explod
trigger1 = !numexplod(3020) && time = 75
anim = 3020 +(facing=-1)
postype = L
pos = -5,10
ID = 3020
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647;postype=BとかLだとbindtimeの間はzoomを受けつけない
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 38
ontop = 1
scale = 0.7, 0.7

[State カットインを動かす フェードイン]
type = modifyExplod
trigger1 = numexplod(3020) && var(0)=[0,5]
postype = L
pos = -180 +165*(var(0)/5.0)**1.8,-60 +70*(var(0)/5.0)**1.8
ID = 3020
IgnoreHitPause = 1
scale = 1.2 -0.6*(var(0)/5.0)**1.8,1.2 -0.6*(var(0)/5.0)**1.8
trans = addalpha
alpha = 255*var(0)/5.0, 255-255*var(0)/5.0
[State カットインを動かす とりあえず何か動かしとけ]
type = modifyExplod
trigger1 = numexplod(3020) && var(0)>20
postype = L
pos = -15,10
ID = 3020
IgnoreHitPause = 1
scale = 0.6 +(var(0)-5)*0.00015,0.6 +(var(0)-5)*0.00015

[State カットイン白枠 ォォォォ]
type = Explod
trigger1 = !numexplod(3018) && time = 75
anim = 3018
postype = L
pos = 0,0
ID = 3018
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 38
ontop = 1
scale = 1,1

[State 発射へ]
type = changestate
trigger1 = time >= 75+38
value = 3030

[state 背景]
Type = BGPalFX
trigger1 = time < 75+38-1
mul = 100,100,100
time = 1

[State 押し出し]
type = width
trigger1 = 1
Edge = 80,30+30*(time=0)
Player = 80,30+30*(time=0)

[State スローダンサー]
type = Explod
trigger1 = !time && numexplod(3012)=0
anim = 3012
ID = 3012
pos = 0, -pos Y
postype = p1
bindtime = 1
removetime = 75+38
scale = 1.1,1.1
sprpriority = 4
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State スローダンサーに蹴られるエフェクト]
type = Explod
trigger1 = !time && numexplod(3013)=0
anim = 3013
ID = 3013
pos = 0+20, -pos Y -60
postype = p1
bindtime = 1
removetime = -2
scale = 1.1*0.5,1.1*0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
;trans = sub
[State 331,ヒットエフェクト]
type = Explod
trigger1 = !time
anim = 810
postype = p1
pos = 0+5, -pos Y -65
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』発射
[Statedef 3030]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 3024
sprpriority = 2
[State ガード距離]
Type = AttackDist
trigger1 = anim = 3024
value = 0
[State カメラが追わない]
Type = ScreenBound
trigger1 = anim != 3024
value = 1
MoveCamera = 1,0

[state 99999, 無敵化]
type = nothitby
trigger1 = anim = 3024 && animelemtime(2) < 1
value = SCA,AA,AP,AT

[state 完全なる黄金回転爪弾]
type = helper
trigger1 = anim = 3024 && animelemtime(2) = 0
name = "perfect goldspin nail"
stateno = 3040
ID = 3040
postype = p1
pos = ceil(32*const(size.xscale)) -30,  ceil(-24*const(size.yscale))
Size.XScale = 0.5
Size.YScale = 0.5
OwnPal = 1
persistent = 0
pausemovetime = 999999

[State 発射音]
type = playsnd
trigger1 = time = 4
value = 0,9
persistent = 0
[State 声 そこだ！]
type = playsnd
trigger1 = time = 0
value = 300,6
channel = 0
persistent = 0

[State 反動]
type = veladd
trigger1 = anim = 3024 && animelemtime(2) = 0
Y = -2.1
X = -0.15
[State 反動テコ入れ]
type = posadd
trigger1 = anim = 3024 && animelemtime(2) = 0
Y = -9
X = -8

[State 重力1]
type = veladd
trigger1 = anim = 3024
Y = 0.09

[State くるっ]
type = changeanim
trigger1 = anim = 3024 &&time >= 48
value = 3025
[State ふわっ]
type = veladd
trigger1 = anim = 3025 && animelemtime(1) = 0
Y = -6

[State 重力2]
type = veladd
trigger1 = anim = 3025
Y = 0.4

[State 成功時待機へ]
type = changestate
trigger1 = numhelper(3040) && helper(3040),numtarget && helper(3040),movehit
value = 3035

[State 着地へ]
type = changestate
trigger1 = pos Y>=0 && vel Y>0
value = 3032
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』着地
[Statedef 3032]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 3032
sprpriority = 0
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0
[State 位置]
type = posset
trigger1 = !time
Y = 0

[State 成功時待機へ]
type = changestate
trigger1 = numhelper(3040) && helper(3040),numtarget && helper(3040),movehit
value = 3035

[State 終了]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時本体待機 空中
[Statedef 3035]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
;anim = 0
sprpriority = 0
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0
[state 99999, 無敵化]
type = nothitby
trigger1 =  1
value = SCA,AA,AP,AT
[State カメラが追わない]
Type = ScreenBound
trigger1 = time>=14
value = 0
MoveCamera = 0,0
[State カウントストップ]
type = AssertSpecial
trigger1 = 1
flag = TimerFreeze

[State くるっ]
type = changeanim
trigger1 = time = 14+5
value = 3025
[State ふわっと画面外へ]
type = veladd
trigger1 = anim = 3025 && animelemtime(1) = 0
X = -5
Y = -6

[State 重力2]
type = veladd
trigger1 = anim = 3025
Y = 0.4
[State 着地へ]
type = changestate
trigger1 = pos Y>=0 && vel Y>0
value = 3037

[State 再登場位置]
type = posset
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time >= 120
X = helper(3100),pos X-120*facing
Y = -80
[State 演出が終了したのでかっこよく再登場]
type = changestate
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time >= 120
value = 3140
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時本体待機 地上
[Statedef 3037]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 3032
sprpriority = 0
[State カウントストップ]
type = AssertSpecial
trigger1 = 1
flag = TimerFreeze
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0
[state 99999, 無敵化]
type = nothitby
trigger1 =  1
value = SCA,AA,AP,AT
[State カメラが追わない]
Type = ScreenBound
trigger1 = 1
value = 0
MoveCamera = 0,0
[State 位置]
type = posset
trigger1 = !time
Y = 0
[State アニメ]
type = changeanim
trigger1 = anim=3032 && animtime=0
value = 0

[State 再登場位置]
type = posset
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time >= 120
X = helper(3100),pos X-120*facing
Y = -80
[State 演出が終了したのでかっこよく再登場]
type = changestate
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time >= 120
value = 3140
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』爪弾ヘルパー
[Statedef 3040]
type    = A
movetype= A
physics = N
velset = 8*cos(-8.6*Pi/180),-8*sin(-8.6*Pi/180)
ctrl = 0
sprpriority = 3
[State アニメ変更]
type = Changeanim
trigger1 = Anim != 3040 && time = 0
value = 3040

[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 150

[State 200, ヒット定義]
type = HitDef
trigger1 = 1
trigger1 = movecontact=0 && movereversed=0
attr = S, HP
damage = ceil(50*root,fvar(0)), ceil(4*root,fvar(0))
animtype = B;H
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 4, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = s6, 2
guardsound = s7, 0
ground.type = H
ground.slidetime = 5
ground.hittime  = 40
ground.velocity = -2,-3
airguard.velocity = -1.2,-0.8
air.type = H
air.velocity = -0.2,-0.9
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -3,-2
Guard.CtrlTime = 15
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
fall.recover = 0
air.fall = 1
EnvShake.Time = 12
EnvShake.Ampl = 12
EnvShake.Freq = 70
kill = 0
p2facing = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = Movehit = 1
anim = 812
postype = p1
pos = 2+root,var(3)%10 +30,-0-root,var(3)%10
IgnoreHitPause = 1
Persistent = 0
scale = 0.55, 0.55
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 331,ヒットエフェクト集中線]
type = Explod
trigger1 = Movehit = 1
anim = 16500
postype = L
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
bindtime = -1
trans = addalpha
alpha = 200,60
pausemovetime = 2147483647
supermovetime = 2147483647

[State 331,ガードエフェクト]
type = Explod
trigger1 = Moveguarded
anim = 840
postype = p1
pos = 30,0
IgnoreHitPause = 1
Persistent = 0
scale = 0.6, 0.6
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 追従する回転軌跡エフェクト]
type = Explod
trigger1 = time = 0; && prevstateno!=
anim = 3042
ID = 3042
pos = 20,2;-20, -3
postype = p1
bindtime = -1
removetime = 300
scale = 0.5, 0.5
sprpriority = 4
OwnPal = 1
IgnoreHitPause = 1

[State 無敵]
Type = Hitby
trigger1 = 1
value = SCA,AP
IgnoreHitPause = 1

[State 追従回転エフェを消す]
type = removeExplod
trigger1 = ScreenPos X != [-30*facing-100,gamewidth-30*facing+100]
trigger2 = movecontact
ID = 3042
ignorehitpause = 1
[State 消滅]
type = destroyself
trigger1 = ScreenPos X != [-30*facing-100,gamewidth-30*facing+100]
trigger2 = moveguarded
[State 回転終了エフェクト]
type = Explod
trigger1 = movecontact
anim = 3043
pos = 50, 2
postype = p1
bindtime = 1
removetime = -2
scale = 0.5, 0.5
sprpriority = 4
OwnPal = 1
persistent = 0
vel = 4.5*cos(-8.6*Pi/180),-4.5*sin(-8.6*Pi/180)
IgnoreHitPause = 1

[State ターゲットステート奪取]
type = TargetState
trigger1 = movehit = 1
trigger1 = numtarget
trigger1 = root,Alive
value = 3060
persistent = 0
IgnoreHitPause = 1
[State ステート変更]
type = changestate
trigger1 = movehit = 1
trigger1 = numtarget
trigger1 = root,Alive
value = 3050
persistent = 0
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 ターゲット取ったヘルパー
[Statedef 3050]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
sprpriority = 3
anim = 9999
[State 非常用ステート奪取]
type = TargetState
trigger1 = numtarget && root,movetype = H
value = 3128
IgnoreHitPause = 1
[State 消滅]
type = destroyself
trigger1 = !numtarget
trigger2 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time>=120
trigger3 = root,movetype = H

[State 位置]
type = posset
trigger1 = numtarget && time >= 1 &&!(helper(3100),stateno=3120 && helper(3100),time>84)
X = target,pos X
Y = target,pos Y
IgnoreHitPause = 1

[State ギャルギャルへステート奪取]
type = TargetState
trigger1 = numtarget && time = 10
value = 3062
persistent = 0
IgnoreHitPause = 1
[State ギャルギャルエフェクト]
type = Explod
trigger1 = numtarget && time = 10
anim = 3050
pos = 0, 0;target,const(size.mid.pos.y)
postype = p1
bindtime = -1
removetime = -2
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
[State 331,ヒットエフェクト]
type = Explod
trigger1 = numtarget && (time = [10,26+36-20]) && time%7=3
anim = 801
postype = p1
pos = 0, 0;target,const(size.mid.pos.y)
IgnoreHitPause = 1
scale = 0.3, 0.3
;random = 6,6
ontop = 1
OwnPal = 1
bindtime = -1
pausemovetime = 2147483647
supermovetime = 2147483647
[State ギャルギャル音]
type = playsnd
trigger1 = numtarget && time = 10
value = 310,6
;volume = -110

[State ズゥゥム]
type = zoom
trigger1 = time = [10,15]
Pos = (pos X+38*facing),(-gameheight+screenpos Y+206)*((time-10)/5.0)
Scale = 1.0+0.8*((time-10)/5.0)
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = time = [16,63]
Pos = (pos X+38*facing),(-gameheight+screenpos Y+170)
Scale = 1.4
Lag = 0
[State ズゥゥム];オラオラ ちょっとズームインしてからズームアウト 1.75→1.85
type = zoom
trigger1 = time = [64,65]
Pos = (pos X+38*facing),(-gameheight+screenpos Y+170)
Scale = 1.55+0.10*((time-63)/2.0)
Lag = 0
[State ズゥゥム];オラオラ
type = zoom
trigger1 = time = [66,69]
Pos = (pos X+38*facing),(-gameheight+screenpos Y+170)
Scale = 1.55-0.65*((time-66)/4.0)
Lag = 0
[State ズゥゥム]
type = zoom
trigger1 = (time > 69) && numhelper(3100) && helper(3100),stateno != 3120
Pos = (pos X+38*facing),(-gameheight+screenpos Y+170);-20
Scale = 1.4; +(time-70)*0.0005
Lag = 0

[State ギャルギャル中ダメージ]
type = targetlifeadd
trigger1 = numtarget
trigger1 = (time = [10,50]) && time%3=0
value = -ceil(1*root,fvar(0))
kill = 0
Absolute = 1;防御無視
[State オラオラ中ダメージ]
type = targetlifeadd
triggerall = numtarget && numhelper(3100)
triggerall = helper(3100),anim = 3100
trigger1 =  helper(3100),animelemtime(2)=0
trigger2 =  helper(3100),animelemtime(5)=0
trigger3 =  helper(3100),animelemtime(8)=0
trigger4 =  helper(3100),animelemtime(12)=0
value = -ceil(10*root,fvar(0))
kill = 0
Absolute = 1;防御無視
[State オラァ！中ダメージ]
type = targetlifeadd
triggerall = numtarget && numhelper(3100)
trigger1 = helper(3100),anim = 3110 && helper(3100),animelemtime(4)=0
value = -ceil(19*root,fvar(0))
kill = 0
Absolute = 1;防御無視
[State グルグル中ダメージ]
type = targetlifeadd
trigger1 = numtarget && numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && (helper(3100),time = [1,45]) && time%4=0
value = -ceil(1*root,fvar(0))
kill = 0
Absolute = 1;防御無視
[State 最終ダメージ]
type = targetlifeadd
trigger1 = numtarget && numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time = 90
value = -ceil(40*root,fvar(0))
kill = 1
Absolute = 1;防御無視
[State 相手が体力0になったらスイッチオン]
type = parentvarset
trigger1 = numtarget && target,life=0
var(31) = 1
IgnoreHitPause = 1

[State 相手のゲージ増加]
type = targetPowerAdd
trigger1 = numtarget
trigger1 = (time = [10,50]) && time%3=0
value = 1
[State 相手のゲージ増加]
type = targetPowerAdd
triggerall = numtarget && numhelper(3100)
triggerall = helper(3100),anim = 3100
trigger1 =  helper(3100),animelemtime(2)=0
trigger2 =  helper(3100),animelemtime(5)=0
trigger3 =  helper(3100),animelemtime(8)=0
trigger4 =  helper(3100),animelemtime(12)=0
value = 6
[State 相手のゲージ増加]
type = targetPowerAdd
triggerall = numtarget && numhelper(3100)
trigger1 = helper(3100),anim = 3110 && helper(3100),animelemtime(4)=0
value = 14
[State 相手のゲージ増加]
type = targetPowerAdd
trigger1 = numtarget && numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && (helper(3100),time = [1,45]) && time%4=0
value = 1
[State 相手のゲージ増加]
type = targetPowerAdd
trigger1 = numtarget && numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time = 90
value = 40

[State -2 ヒットカウント増加]
type = hitadd
triggerall = numtarget && numhelper(3100)
trigger1 = (time = [10,50]) && time%3=0
trigger2 =  helper(3100),animelemtime(2)=0 && helper(3100),anim = 3100
trigger3 =  helper(3100),animelemtime(5)=0 && helper(3100),anim = 3100
trigger4 =  helper(3100),animelemtime(8)=0 && helper(3100),anim = 3100
trigger5 =  helper(3100),animelemtime(12)=0 && helper(3100),anim = 3100
trigger6 = helper(3100),anim = 3110 && helper(3100),animelemtime(4)=0
trigger7 = helper(3100),stateno = 3120 && (helper(3100),time = [1,45]) && time%4=0
trigger8 = helper(3100),stateno = 3120 && helper(3100),time = 90
value = 1

[State KOカットイン背景]
type = Explod
trigger1 = numtarget && numhelper(3100) && roundstate=2
trigger1 = helper(3100),stateno = 3120
trigger1 = !numexplod(16600) && target,Alive=0;WinKO
anim = 16600
postype = L
pos = 0,0
ID = 16600
IgnoreHitPause = 1
OwnPal = 1
bindtime = 2147483647
pausemovetime = 2147483647
supermovetime = 2147483647
removetime = 120
sprpriority = -3
scale = 1,1
persistent = 0
[State KOスローしない]
type = AssertSpecial
trigger1 = numtarget && numhelper(3100) && roundstate=2
trigger1 = helper(3100),stateno = 3120
flag = NoKOSlow
[State KO音]
type = playsnd
trigger1 = numtarget && numhelper(3100) && roundstate=2
trigger1 = helper(3100),stateno = 3120
trigger1 = target,Alive=0;WinKO
value = 90,6
persistent = 0
[State KO時間停止]
type = Pause
trigger1 = numtarget && numhelper(3100) && roundstate=2
trigger1 = helper(3100),stateno = 3120
trigger1 = target,Alive=0;WinKO
Time = 120-29
movetime = 120-29
PauseBG = 0;背景はそのまま
persistent = 0

[state ACT4]
type = helper
trigger1 = numtarget && time = 26
name = "ACT4"
stateno = 3100
ID = 3100
postype = p1
pos = -76,84
Size.XScale = root,const(size.xscale)
Size.YScale = root,const(size.yscale)
OwnPal = 1
persistent = 0
[State ボコボコへステ奪取]
type = TargetState
trigger1 = numtarget && time = 26+40;殴り始め
value = 3065
persistent = 0
IgnoreHitPause = 1

[State グルグルドーンへステ奪取]
type = TargetState
trigger1 = numtarget && helper(3100),anim = 3110 && helper(3100),animtime=0
value = 3127
persistent = 0
IgnoreHitPause = 1

[State グルグル中ズームするようの変数]
type = varset
trigger1 = numhelper(3100) && helper(3100),stateno != 3120
var(0)=0
[State グルグル中ズームするようの変数]
type = varadd
trigger1 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time < 28
var(0)=1
[State ズゥゥムイン];1.38から2.3
type = zoom
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time < 90
Pos = (pos X+38*facing) +var(0)*2.8*facing,(-gameheight+screenpos Y+216) -var(0)*2.2 +sin(2*pi*var(0)/27.5)*1;縦にもゆらりと
Scale = 1.0 +0.92*(var(0)/28.0)
Lag = 0
[State ズゥゥムアウト];2.3から1.2
type = zoom
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time = [90,92]
Pos = (pos X+38*facing) +var(0)*2.8*facing,(-gameheight+screenpos Y+216)-(var(0)*2.2)*((2-(helper(3100),time-90))/2.0)
Scale = 1.0 -0.8*((helper(3100),time-90)/2.0)
Lag = 0
[State ズゥゥムアウト];破裂
type = zoom
triggerall = numhelper(3100)
trigger1 = helper(3100),stateno = 3120 && helper(3100),time = [93,119]
Pos = (pos X+38*facing) +var(0)*2.8*facing,(-gameheight+screenpos Y+200);-16
Scale = 1.0
Lag = 0

[State グルグルエフェクト]
type = Explod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time = 1
trigger1 = numtarget
anim = 3130
pos = 0,0
postype = p1
bindtime = -1
removetime = -2
scale = 0.5, 0.5
sprpriority = 2
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
[State 331,グルグル中ヒットエフェクト]
type = Explod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time%6 = 1
trigger1 = numtarget && helper(3100),time < 45
anim = 801
postype = p1
pos = -4, -4
IgnoreHitPause = 1
scale = 0.3, 0.3
random = 8,8
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
facing = ifelse(random%2=0,1,-1)
vfacing = ifelse(random%2=0,1,-1)

[State 破裂で画面振動]
type = envshake
trigger1 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time = 86
trigger1 = numtarget
time = 26
Ampl = -14
Freq = 80

[State 破裂]
type = Explod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time = 1
trigger1 = numtarget
anim = 3134
ID = 3134
pos = 0,-6
postype = p1
bindtime = -1
removetime = -2
scale = 0.55, 0.55
sprpriority = 2
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
[State 破裂前徐々に大きく　ジョジョだけに]
type = modifyExplod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120
trigger1 = numtarget && numexplod(3134) && helper(3100),time < 30
ID = 3134
pos = 0,-6
postype = p1
scale = 0.25 +0.3*(helper(3100),time/30.0), 0.25 +0.3*(helper(3100),time/30.0)
IgnoreHitPause = 1
alpha = 255*(helper(3100),time/30.0), 255
[State 破裂前徐々に大きく　ジョジョだけに]
type = modifyExplod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120
trigger1 = numtarget && numexplod(3134) && helper(3100),time = [31,86]
ID = 3134
pos = 0,-6
postype = p1
scale = 0.55 +0.02*((helper(3100),time-31)/54.0), 0.55 +0.02*((helper(3100),time-31)/54.0)
IgnoreHitPause = 1
[State 破裂で戻す]
type = modifyExplod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120
trigger1 = numtarget && numexplod(3134) && helper(3100),time = 87
ID = 3134
pos = 0,-6
postype = p1
scale = 0.6,0.6
IgnoreHitPause = 1
trans = None

[State 331,ヒットエフェクト]
type = Explod
trigger1 = numtarget && numexplod(3134) && helper(3100),time = 90
anim = 812
postype = p1
pos = 0,-6
IgnoreHitPause = 1
scale = 0.6, 0.6
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State ACT4ヘッド]
type = Explod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120 && helper(3100),time = 1
trigger1 = numtarget
anim = 3138
ID = 3138
pos = 0,-6
postype = p1
bindtime = 1
removetime = 150
scale = 1,1;0.5, 0.5
sprpriority = 2
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
[State ACT4ヘッドを動かす]
type = modifyExplod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120
trigger1 = numtarget && numexplod(3138) && helper(3100),time < 30
ID = 3138
pos = 28*(helper(3100),time/30.0),-6-27*(helper(3100),time/30.0)
postype = p1
IgnoreHitPause = 1
alpha = 255*(helper(3100),time/30.0), 255 -100**(helper(3100),time/30.0)
[State ACT4ヘッドを動かす]
type = modifyExplod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120
trigger1 = numtarget && numexplod(3138) && helper(3100),time = [31,86]
ID = 3138
pos = 28 +1*((helper(3100),time-31)/54.0),-6-27 -1*((helper(3100),time-31)/54.0)
postype = p1
IgnoreHitPause = 1
[State ACT4ヘッドを動かす]
type = modifyExplod
trigger1 = numhelper(3100) && helper(3100),stateno = 3120
trigger1 = numtarget && numexplod(3138) && helper(3100),time = 87
ID = 3138
pos = 29,-6-28
postype = p1
vel = 6,-6
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 相手 ヒットストップ
[Statedef 3060]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 4
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 変更]
type = changeanim
trigger1 = 1
value = 5030
IgnoreHitPause = 1
[State ゆれ]
Type = Offset
trigger1 = 1
X = -2*(time%2=0)
[State 変更]
type = changestate
trigger1 = time>6
value = 3061
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 相手 ヒットバック中
[Statedef 3061]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 0
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 変更]
type = changeanim
trigger1 = SelfAnimExist(5035) && anim=5030 && animtime=0
value = 5035
IgnoreHitPause = 1
[State ヒットバック]
type = veladd
trigger1 = !time
X = -2 -4*(frontEdgeDist < 120)
Y = ifelse(pos Y > -20, -8, -4)
persistent = 0
IgnoreHitPause = 1
[State 重力]
type = veladd
trigger1 = 1
Y = 0.5
IgnoreHitPause = 1

[State 非常用戻す]
type = selfstate
trigger1 = vel Y > 0 && pos Y >= 25
value = 5100
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 ACT4 出現からオラオラ
[Statedef 3100]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
sprpriority = 3
anim = 3080
[State カメラが追う]
Type = ScreenBound
trigger1 = 1
value = 1
MoveCamera = 1,1
[State Son音]
type = playsnd
trigger1 = !time
value = 50,0
volume = 40
[State オラオラオラオラオラオラオラオラオラオラオラオラオラオラオラオラオラオラ]
type = playsnd
trigger1 = time = 0
value = 300,11;300,7
volume = 240
persistent = 0
[State オラオラへ]
type = changeanim
trigger1 = anim = 3080 && animtime=0
value = 3100
persistent = 0
IgnoreHitPause = 1

[State 風切り音]
type = playsnd
trigger1 = anim = 3100 && time%23=18
value = 0,10
volume = -220
[State オラオラ奥の腕]
type = Explod
trigger1 = anim = 3100
anim = 3101
postype = p1
pos = 0,0
IgnoreHitPause = 1
Persistent = 0
ID = 3101
scale = root,const(size.xscale),root,const(size.yscale)
sprpriority = -1
bindtime = -1
OwnPal = 1
removetime = 400
pausemovetime = 2147483647
supermovetime = 2147483647
[State オラオラ奥の腕を消す]
type = removeExplod
trigger1 = anim != 3100
ID = 3101
IgnoreHitPause = 1

[State 331,ヒットエフェクト]
type = Explod
trigger1 = anim = 3100 && animelemtime(2)=0
anim = 801 +11*(random%(5-2*(time>160))=0)
postype = p1
pos = 65*const(size.xscale)+14, -90*const(size.xscale)
IgnoreHitPause = 1
scale = 0.5, 0.5
random = 20,24
sprpriority = 1+(random<700)*5;ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
facing = ifelse(random%2=0,1,-1)
vfacing = ifelse(random%2=0,1,-1)
[State 331,ヒットエフェクト]
type = Explod
trigger1 = anim = 3100 && animelemtime(5)=0
anim = 801 +11*(random%(5-2*(time>160))=0)
postype = p1
pos = 55*const(size.xscale)+14, -80*const(size.xscale)
IgnoreHitPause = 1
scale = 0.5, 0.5
random = 20,24
sprpriority = 1+(random<550)*5;ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
facing = ifelse(random%2=0,1,-1)
vfacing = ifelse(random%2=0,1,-1)
[State 331,ヒットエフェクト]
type = Explod
trigger1 = anim = 3100 && animelemtime(8)=0
anim = 801 +11*(random%(5-2*(time>160))=0)
postype = p1
pos = 47*const(size.xscale)+14, -105*const(size.xscale)
IgnoreHitPause = 1
scale = 0.5, 0.5
random = 20,24
sprpriority = 1+(random<700)*5;ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
facing = ifelse(random%2=0,1,-1)
vfacing = ifelse(random%2=0,1,-1)
[State 331,ヒットエフェクト]
type = Explod
trigger1 = anim = 3100 && animelemtime(12)=0
anim = 801 +11*(random%(5-2*(time>160))=0)
postype = p1
pos = 65*const(size.xscale)+14, -85*const(size.xscale)
IgnoreHitPause = 1
scale = 0.5, 0.5
random = 20,24
sprpriority = 1+(random<550)*5;ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
facing = ifelse(random%2=0,1,-1)
vfacing = ifelse(random%2=0,1,-1)
[State ヒット音]
type = playsnd
triggerall = anim = 3100
trigger1 =  animelemtime(2-1)=0+1
trigger2 =  animelemtime(5-1)=0+1
trigger3 =  animelemtime(8-1)=0+1
trigger4 =  animelemtime(12-1)=0+1
value = 6,1
volume = -100
[State 画面振動]
type = envshake
triggerall = anim = 3100
trigger1 =  animelemtime(2)=0
trigger2 =  animelemtime(5)=0
trigger3 =  animelemtime(8)=0
trigger4 =  animelemtime(12)=0
time = 5
Ampl = -4 -2*(time>160) -2*(time>280)
Freq = 90
[State 画面振動1回目]
type = envshake
triggerall = anim = 3100
trigger1 =  animelemtime(2)=0
time = 10
Ampl = -11
Freq = 90
persistent = 0

[State ちょっとずつ前進]
type = posadd
trigger1 = anim = 3100
X = 0.13
IgnoreHitPause = 1

[State オラァ！]
type = changeanim
trigger1 = anim = 3100 && time=319-40 -51;カット分
value = 3110
persistent = 0
IgnoreHitPause = 1
[State 331,ヒットエフェクト]
type = Explod
trigger1 = anim = 3110 && animelemtime(4)=0
anim = 813
postype = p1
pos = 40*const(size.xscale), -82*const(size.xscale)
IgnoreHitPause = 1
scale = 0.65, 0.65
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State ヒット音]
type = playsnd
trigger1 = anim = 3110 && animelemtime(3)=0
value = 6,2
[State 振りかぶり]
type = velset
trigger1 = anim = 3110 && animelemtime(1)=0
X = -10
[State 振りかぶり]
type = velmul
trigger1 = anim = 3110 && vel X < 0
X = 0.5
[State ちょっと前進]
type = posadd
trigger1 = anim = 3110 && animelemtime(2)=0
X = 4
[State 前進]
type = posadd
trigger1 = anim = 3110 && animelemtime(3)=0
X = (helper(3040),pos X-40*facing - pos X )*0.5
[State 叩き込んだ位置]
type = posset
trigger1 = anim = 3110 && animelemtime(4)=0
X = helper(3040),pos X-(42)*facing
[State 戻る位置補正]
type = posadd
trigger1 = anim = 3110 && animelemtime(5)=0
X = -2
IgnoreHitPause = 1
[State 画面振動]
type = envshake
trigger1 = anim = 3110 && animelemtime(4)=0
time = 26
Ampl = -26
Freq = 90

[State グルグルドーンへ]
type = changestate
trigger1 = anim = 3110 && animtime=0
value = 3120
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 相手 ギャルギャル中
[Statedef 3062]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 3
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 位置補正]
type = posadd
trigger1 = !time
Y = -60;const(size.mid.pos.y)-8
IgnoreHitPause = 1
[State 位置]
type = posadd
trigger1 = 1
X = -0.01
Y = -0.07
IgnoreHitPause = 1
[State 変更]
type = changeanim2
trigger1 = !time
value = 3106
IgnoreHitPause = 1
[State 画面端のときの位置補正]
type = posadd
trigger1 = BackEdgeDist < 40 &&time < 8
X = 6
[State 画面端のときの位置補正]
type = posadd
trigger1 = (frontEdgeDist < 200) &&time < 8
X = -10
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 相手 オラオラやられ中
[Statedef 3065]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 0
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 変更]
type = changeanim2
trigger1 = !time
value = 3107
IgnoreHitPause = 1
[State ゆれ]
Type = Offset
trigger1 = anim = 3107
Y = -2*(time%2=0)
[State 最初にちょっと位置補正]
type = posadd
trigger1 = !time
X = -5
IgnoreHitPause = 1
[State ちょっとずつ後退]
type = posadd
trigger1 = anim = 3107
X = -0.14
IgnoreHitPause = 1

[State 戻りアニメ]
type = changeanim2
trigger1 = time=319-40-14-28 -52
value = 3108
persistent = 0
IgnoreHitPause = 1

[State 腹パンくらう]
type = changeanim2
trigger1 = time=319-40-14-28+16 -52
value = 3109
persistent = 0
IgnoreHitPause = 1
[State 位置補正]
type = posadd
trigger1 = time=319-40-14-28+16 -52
X = -10
IgnoreHitPause = 1
[State 位置補正]
type = posadd
trigger1 = time=319-40-14-28+16+2 -52
X = 2
IgnoreHitPause = 1
[State 腹パンヒットシェイク]
Type = Offset
trigger1 = anim = 3109 && animelemtime(1) < 30
X = -1*(time%2=0)

[State 非常用消滅]
type = destroyself
trigger1 = time > 500
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 ACT4 グルグルドーン
[Statedef 3120]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
sprpriority = 3
anim = 3120
[State 消える]
type = changeanim
trigger1 = animtime=0
value = 9999
[State ｸﾞﾙｸﾞﾙﾄﾞｰﾝ]
type = playsnd
trigger1 = !time
value = 310,7
volume = 180
[State 位置固定]
type = posset
trigger1 = 1
X = helper(3040),pos X-(42)*facing

[State ありがとう、ジャイロ]
type = playsnd
trigger1 = time = 0
value = 300,8
volume = 100

[State 位置補正]
type = posadd
trigger1 = time < 28
X = 0.1
Y = 0.08
IgnoreHitPause = 1
[State 消滅]
type = destroyself
trigger1 = time > 120
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 相手 グルグルドーンやられ中
[Statedef 3127]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 0
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 変更]
type = changeanim2
trigger1 = !time
value = 3127
IgnoreHitPause = 1
[State 上昇]
type = posadd
trigger1 = time < 28;anim = 3127
X = -0.1
Y = -0.08
IgnoreHitPause = 1

[State 画面端のときの位置補正]
type = posadd
trigger1 = BackEdgeDist < 40 &&time < 8
X = 6
[State 画面端のときの位置補正]
type = posadd
trigger1 = (frontEdgeDist < 200) &&time < 8
X = -10

[State 変更ドーン]
type = changeanim2
trigger1 = time = 90
trigger2 = Alive=0;KO演出用
value = 3128
IgnoreHitPause = 1
[State 位置]
type = posadd
trigger1 = time = 90
X = 0
Y = 0
IgnoreHitPause = 1
[State 吹っ飛びへ]
type = changestate
trigger1 = time = 90+30
value = 3128
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』成功時 相手 吹っ飛び
[Statedef 3128]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 0
[State 位置補正]
type = posadd
trigger1 = !time
Y = 60
IgnoreHitPause = 1
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA
time = 1

[State 820, 初速]
type = velset
trigger1 = Time = 0
X = -3
Y = -5

[State 820, 重力]
type = veladd
trigger1 = 1
Y = 0.4

[State 5030, 5]
type = Changeanim
trigger1 = time = 0
value = 5030
[State 5030, 5]
type = Changeanim
trigger1 = time = 2
value = 5050

[State 戻す]
type = selfstate
trigger1 = vel Y > 0 && pos Y >= 25
value = 5100

[State 非常用]
type = selfstate
trigger1 = time > 200
value = 5030
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』本体　演出終了で戻ってくる
[Statedef 3140]
type    = A
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 3024
sprpriority = 0
[state 99999, 無敵化]
type = nothitby
trigger1 =  1
value = SCA,AA,AP,AT
[State カメラが追わない]
Type = null;ScreenBound
trigger1 = 1
value = 0
MoveCamera = 0,0
[State それしか言葉が見つからない]
type = null;playsnd
trigger1 = time = 5
value = 300,9
volume = 100

[State 最初のアニメ]
type = changeanim
trigger1 = !time
value = 3024
elem = 3

[State くるっ]
type = changeanim
trigger1 = time = 5
value = 3025
[State ふわっと]
type = veladd
trigger1 = anim = 3025 && animelemtime(1) = 0
Y = -5.4

[State 重力2]
type = veladd
trigger1 = anim = 3025
Y = 0.45
[State 着地へ]
type = changestate
trigger1 = pos Y>=0 && vel Y>0
value = 3142
;---------------------------------------------------------------------------
;君に渡せなかったこの一発の『鉄球』演出終了 着地
[Statedef 3142]
type    = S
movetype= I
physics = S
velset = 0,0
ctrl = 0
anim = 3033
sprpriority = 0
[State 位置]
type = posset
trigger1 = !time
Y = 0

[State 終了]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;絶対殺すマン 攻撃
[Statedef 3200]
type    = A
movetype= I
physics = N
velset = 0,0
ctrl = 0
sprpriority = 3
anim = 3200
[state 背景]
Type = BGPalFX
trigger1 = time < 30
mul = 255-50*(time/30.0),255-50*(time/30.0),255-50*(time/30.0)
time = 1
[state 背景]
Type = BGPalFX
trigger1 = time >= 30
mul = 205,205,205
time = 1

[State ﾁｭﾐﾐｰﾝ]
type = playsnd
trigger1 = time = 0 && prevstateno != 3210
value = 300,10
volume = 100
[State 位置固定]
type = posset
trigger1 = 1
X = enemynear,pos X
Y = enemynear,pos Y
[State ガード距離]
Type = AttackDist
trigger1 = 1
value = 0
[State 状態]
Type = statetypeset
trigger1 = time > 90
movetype= A

[State 200, ヒット定義]
type = HitDef
trigger1 = time > 90 && time%90=1
attr = A, HP
damage = 0, 0
animtype = H
guardflag = 
hitflag = MAF
priority = 4, Hit
pausetime = 4, 10
sparkno = -1
Guard.SparkNo = -1
hitsound = -1;s6, 2
guardsound = -1;s7, 0
ground.type = H
ground.slidetime = 5
ground.hittime  = 40
ground.velocity = -1
airguard.velocity = -1.2,-0.8
air.type = H
air.velocity = -0.2,-0.9
air.hittime = 50
AirGuard.CtrlTime = 50
Guard.Velocity = -5
airGuard.Velocity = -3,-2
Guard.CtrlTime = 15
Guard.Kill = 0
Ground.CornerPush.VelOff = 0
getpower  = 0,0
givepower = 20,10
fall.recover = 0
air.fall = 1
EnvShake.Time = 12
EnvShake.Ampl = 8
EnvShake.Freq = 60
kill = 0
p2facing = 1
HitOnce = 1

[State ターゲットステート奪取]
type = TargetState
trigger1 = movehit = 1
trigger1 = numtarget
trigger1 = Roundstate = 2
value = 3217
persistent = 0
IgnoreHitPause = 1
[State ステート変更]
type = changestate
trigger1 = movehit = 1
trigger1 = numtarget
trigger1 = Roundstate = 2
value = 3210
persistent = 0
IgnoreHitPause = 1
[State 消滅]
type = destroyself
trigger1 = Roundstate != 2
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;絶対殺すマン 成功
[Statedef 3210]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
sprpriority = 3
anim = 3200
[State 位置固定]
type = posset
trigger1 = numtarget && time=0
X = target,pos X
Y = target,pos Y
[State ギャルギャルエフェクト]
type = Explod
trigger1 = !time
anim = 3050
pos = 0,0
postype = p1
bindtime = -1
removetime = -2
scale = 0.5, 0.5
ontop = 1
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
[State 331,ヒットエフェクト]
type = Explod
trigger1 = !time
anim = 801
postype = p1
pos = -3,-3
IgnoreHitPause = 1
scale = 0.3, 0.3
random = 6,6
ontop = 1
OwnPal = 1
bindtime = -1
pausemovetime = 2147483647
supermovetime = 2147483647
[State ギャルギャル音]
type = playsnd
trigger1 = !time
value = 310,6
;volume = -110
[State ｸﾞﾙｸﾞﾙﾄﾞｰﾝ]
type = playsnd
trigger1 = !time
value = 310,7
volume = 180

[State 破裂で画面振動]
type = envshake
trigger1 = time = 86
trigger1 = numtarget
time = 26
Ampl = -14
Freq = 80

[State 破裂]
type = Explod
trigger1 = time = 1
trigger1 = numtarget
anim = 3134
ID = 3134
pos = 0,-6
postype = p1
bindtime = -1
removetime = -2
scale = 0.55, 0.55
sprpriority = 2
OwnPal = 1
persistent = 0
IgnoreHitPause = 1
[State 破裂前徐々に大きく]
type = modifyExplod
trigger1 = numtarget && numexplod(3134) && time < 30
ID = 3134
pos = 0,-6
postype = p1
scale = 0.25 +0.3*(helper(3100),time/30.0), 0.25 +0.3*(helper(3100),time/30.0)
IgnoreHitPause = 1
alpha = 255*(helper(3100),time/30.0), 255
[State 破裂前徐々に大きく]
type = modifyExplod
trigger1 = numtarget && numexplod(3134) && time = [31,86]
ID = 3134
pos = 0,-6
postype = p1
scale = 0.55 +0.02*((helper(3100),time-31)/54.0), 0.55 +0.02*((helper(3100),time-31)/54.0)
IgnoreHitPause = 1
[State 破裂で戻す]
type = modifyExplod
trigger1 = numtarget && numexplod(3134) && time = 87
ID = 3134
pos = 0,-6
postype = p1
scale = 0.8,0.8
IgnoreHitPause = 1
trans = None

[State 331,ヒットエフェクト]
type = Explod
trigger1 = time = 90
anim = 812
postype = p1
pos = 0,-6
IgnoreHitPause = 1
scale = 0.6, 0.6
ontop = 1
OwnPal = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State それでも死んでいないとき]
type = changestate
triggerall = RoundState = 2
trigger1 = time > 260
trigger2 = enemy,movetype = A 
value = 3200
persistent = 0
IgnoreHitPause = 1
[State 消滅]
type = destroyself
trigger1 = Roundstate != 2
IgnoreHitPause = 1
;---------------------------------------------------------------------------
;絶対殺すマンをくらった相手
[Statedef 3217]
type    = A
movetype= H
physics = N
velset = 0,0
ctrl = 0
sprpriority = 0
[State くらうアニメ]
type = changeanim2
trigger1 = !time
value = 3217
persistent = 0
IgnoreHitPause = 1

[State ヘルパーなら消滅]
type = destroyself
trigger1 = ishelper
IgnoreHitPause = 1

[State 位置補正]
type = posadd
trigger1 = !time
Y = const(size.mid.pos.y)-8
IgnoreHitPause = 1
[State 位置]
type = posadd
trigger1 = 1
X = -0.01
Y = -0.07
IgnoreHitPause = 1

[State ダメージ]
type = lifeadd
trigger1 = time > 90
value = -10000000
persistent = 0
IgnoreHitPause = 1
[State 吹っ飛ぶ]
type = changestate
trigger1 = time > 90
value = 3128
persistent = 0
IgnoreHitPause = 1

[State 画面端のときの位置補正]
type = posadd
trigger1 = BackEdgeDist < 50 &&time = 0
X = 20
[State 画面端のときの位置補正]
type = posadd
trigger1 = (frontEdgeDist < 50) &&time = 0
X = -20
;---------------------------------------------------------------------------
;ガードクラッシュ 地上
[statedef 5400]
type = S
movetype = H
physics = S
ctrl = 0
anim = 5400

[State ガードゲージ全快]
type = VarSet
trigger1 = !time
var(8) = 5000
IgnoreHitPause = 1

[State 音]
type = playsnd
trigger1 = time = 0
value = 7,1
persistent = 0

[State 声]
type = playsnd
trigger1 = time = 0
value = 5000,4
channel = 0
persistent = 0

[State ガークラエフェクト]
type = Explod
trigger1 = !numexplod(845) && time = 0
anim = 845
postype = p1
pos = 15,-80
ID = 845
IgnoreHitPause = 1
scale = 0.65, 0.65
ontop = 1
OwnPal = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 30
PauseBG = 0;背景はそのまま
persistent = 0

[State 終了]
type = Changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;ヒットバック必要か？
;---------------------------------------------------------------------------
;スタイリッシュムーブ
[statedef 7444]
type = S
movetype = I
physics = S
velset = 0,0
ctrl = 0
anim = 7444+random%2
sprpriority = 6

[state 相手が空中にいるかのスイッチ]
Type =  varset
trigger1 = numtarget && time = 0
var(14) = (target,statetype = A)
IgnoreHitPause = 1

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 30-5; -var(14)*4;5F相手が早く動く ;空中相手にSMとるとさらに4F不利
movetime = 30-5; -var(14)*4;5F相手が早く動く
PauseBG = 0;背景はそのまま
persistent = 0

[state 99999, 無敵化]
type = nothitby
trigger1 = time <= 31-5;-var(14)*4;空中相手にSMとると4F不利
value = SCA,AA,AP,AT
time = 3;終了後も無敵が続く ゲームより少し短め
[state 99999, 飛び道具へ無敵化]
type = nothitby
trigger1 = time <= 31
value2 = ,AP
time = 3

[State ガードゲージ減少]
type = varadd
trigger1 = time = 0
var(8) = -5000*0.2
IgnoreHitPause = 1

[State スタイリッシュムーブ連続使用可]
type = varset
trigger1 = time = 0
var(12) = 25

[State 声]
type = playsnd
trigger1 = time = 0
value = 72,random%4
channel = 0
persistent = 0

[State 音]
type = playsnd
trigger1 = time = 0
value = 90,4
persistent = 0

[State 輪っか]
type = Explod
trigger1 = !numexplod(7448) && time = 0
anim = 7448
postype = p1
pos = 0,0;-80
ID = 7448
IgnoreHitPause = 1
scale = 0.5*Const(size.yscale), 0.5*Const(size.yscale)
ontop = 1
OwnPal = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State 輪っかを動かす]
type = modifyExplod
trigger1 = numexplod(7448)
anim = 7448
postype = p1
pos = 0,0;-80
ID = 7448
IgnoreHitPause = 1
scale = 0.7*Const(size.yscale)*(1+20**(-0.3)-time**(-0.3)), 0.7*Const(size.yscale)*(1+20**(-0.3)-time**(-0.3))
ontop = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647
Trans = addalpha
Alpha = 255-255*(time*0.05),255

[State 基準をずらしたので戻す]
Type = Offset
trigger1 = time < 31
Y = -28

[State 大きくなって戻る]
Type = AngleDraw
trigger1 = time <= 10
value = 0
Scale = 1+(time/10**1.0)*0.25,1+(time/10**1.0)*0.25
[State 大きくなって戻る]
Type = AngleDraw
trigger1 = time = [11,20]
Scale = 1.25-((time-10)/10**1.0)*0.25,1.25-((time-10)/10**1.0)*0.25

[State 終了]
type = Changestate
trigger1 = time >= 31
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;プッツンキャンセル
[statedef 7880]
type = S
movetype = I
physics = S
velset = 0,0
ctrl = 0
anim = 7880+random%2
sprpriority = 6
facep2 = 1

[State 時間停止]
type = Pause
trigger1 = time = 0
Time = 30
movetime = 30
PauseBG = 0;背景はそのまま
persistent = 0

[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State ゲージ減少]
type = PowerAdd
trigger1 = time = 0
value = -1000
persistent = 0

[state 背景]
Type = BGPalFX
trigger1 = 1
mul = 120,120,120
time = 1

[State 音]
type = playsnd
trigger1 = time = 0
value = 90,0
persistent = 0

[State 声]
type = playsnd
trigger1 = time = 0
value = 70,random%2
channel = 0
persistent = 0
volume = 100

[State エフェクト]
type = Explod
trigger1 = !numexplod(7892) && time = 0
anim = 7892
postype = p1
pos = -10,-60
ID = 7892
IgnoreHitPause = 1
scale = 0.45*Const(size.yscale), 0.45*Const(size.yscale)
ontop = 1
OwnPal = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State プッツーン]
type = Explod
trigger1 = !numexplod(7890) && time = 0
anim = 7890
postype = p1
pos = 0,-30
ID = 7890
facing = facing
IgnoreHitPause = 1
scale = 0.45*Const(size.yscale), 0.45*Const(size.yscale)
ontop = 1
OwnPal = 1
bindtime = 1
removetime = 30
pausemovetime = 2147483647
supermovetime = 2147483647
[State プッツーン最初の8F]
type = modifyExplod
trigger1 = numexplod(7890) && time < 8
anim = 7890
postype = p1
pos = 0,-30
ID = 7890
IgnoreHitPause = 1
scale = 0.45*Const(size.yscale)*(time**1.0/8**1.0),0.45*Const(size.yscale)*(time**1.0/8**1.0)
ontop = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647
[State プッツーン8F以降]
type = modifyExplod
trigger1 = numexplod(7890) && time >= 8
anim = 7890
postype = p1
pos = 0,-30
ID = 7890
IgnoreHitPause = 1
scale = 0.45*Const(size.yscale)*(1+(time-8)*0.005),0.45*Const(size.yscale)*(1+(time-8)*0.005)
ontop = 1
bindtime = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[State 終了]
type = Changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; ガードゲージヘルパー
[statedef 16000]
type = A
movetype = I
physics = N
ctrl = 0
anim = 9999

[state 99999, 間違いで本体が来たら立ちへ移行]
type = selfstate
trigger1 = !ishelper
value = 0
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State 331,ゲージ]
type = Explod
trigger1 = !numexplod(16002)
anim = 16002
postype = L
pos = 135+(root,TeamSide=2)*(160-135)*2,50
ID = 16002
IgnoreHitPause = 1
scale = 0.5, 0.4
facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 4
OwnPal = 1
bindtime = 2147483647

[State 331,ゲージ黒 移動用1p]
type = Explod
trigger1 = !numexplod(16004)
trigger1 = root,TeamSide=1
anim = 16004
postype = L
pos = 135,50
ID = 16004
IgnoreHitPause = 1
scale = 0.5, 0.4
facing = facing
sprpriority = 5
OwnPal = 1
bindtime = 2147483647

[State 1027, ゲージ黒移動1p]
type = ModifyExplod
trigger1 = root,TeamSide=1
ID = 16004
anim = 16004
postype = L
pos = 135-48+root,var(8)*48*0.0002, 50
;右端135 距離96/2=48

[State 331,ゲージ黒 伸縮用1p]
type = Explod
trigger1 = !numexplod(16005)
trigger1 = root,TeamSide=1
anim = 16005
postype = L
pos = 135,50
ID = 16005
IgnoreHitPause = 1
scale = 0.5, 0.4
facing = facing
sprpriority = 5
OwnPal = 1
bindtime = 2147483647

[State 1027, ゲージ黒伸縮1p]
type = ModifyExplod
trigger1 = root,TeamSide=1
ID = 16005
anim = 16005
postype = L
pos = 135,50
scale = 0.5*(((5000-root,var(8))*96*0.0002)+1) , 0.4

[State 331,ゲージ黒 移動用2p]
type = Explod
trigger1 = !numexplod(16004)
trigger1 = root,TeamSide=2
anim = 16004
postype = L
pos = 135135+(160-135)*2,50
ID = 16004
IgnoreHitPause = 1
scale = 0.5, 0.4
facing = facing*-1
sprpriority = 5
OwnPal = 1
bindtime = 2147483647

[State 1027, ゲージ黒移動2p]
type = ModifyExplod
trigger1 = root,TeamSide=2
ID = 16004
anim = 16004
postype = L
pos = 135+(160-135)*2+48-root,var(8)*48*0.0002, 50
;右端135 距離96/2=48

[State 331,ゲージ黒 伸縮用2p]
type = Explod
trigger1 = !numexplod(16005)
trigger1 = root,TeamSide=2
anim = 16006
postype = L
pos = 135+(160-135)*2,50
ID = 16005
IgnoreHitPause = 1
scale = 0.5, 0.4
facing = facing*-1
sprpriority = 5
OwnPal = 1
bindtime = 2147483647

[State 1027, ゲージ黒伸縮2p]
type = ModifyExplod
trigger1 = root,TeamSide=2
ID = 16005
anim = 16006
facing = facing;*-1 反対向きにすると拡大がうまくいかない
postype = L
pos = 135+(160-135)*2,50
scale = 0.5*(((5000-root,var(8))*96*0.0002)+1) , 0.4

[State 331,ゲージ枠 上からかぶせる]
type = Explod
trigger1 = !numexplod(16000)
anim = 16000
postype = L
pos = 135+(root,TeamSide=2)*(160-135)*2,50
ID = 16000
IgnoreHitPause = 1
scale = 0.5, 0.4
facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 6
OwnPal = 1
bindtime = 2147483647

;ゲージの減少はガードステートで行っている
;変数の管理やガークラへの移動は-3ステ

;---------------------------------------------------------------------------
;ACTと弾数表示ヘルパー
[statedef 16200]
type = A
movetype = I
physics = N
ctrl = 0
anim = 9999;17760
[state 99999, 間違いで本体が来たら立ちへ移行]
type = selfstate
trigger1 = !ishelper
value = 0
[state 99999, 不可視化]
type = assertspecial
trigger1 = 1
flag = invisible
flag2= noshadow
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[state 基本表示位置]
type = null
trigger1 = !time
trigger1 = 1 || var(0):=4;X
trigger1 = 1 || var(1):=45;Y

[State ACT表示 1P]
type = Explod
trigger1 = !numexplod(16199+root,var(50))
anim = 16199+root,var(50)
postype = L
pos = var(0) +(root,teamside=2)*(GameWidth-28),var(1)
ID = 16199+root,var(50)
IgnoreHitPause = 1
scale = 0.3, 0.3
;facing = facing*-1
sprpriority = 6
OwnPal = 1
bindtime = 2147483647
removetime = -1
[State 表示消滅]
type = removeExplod
trigger1 = root,var(50)!=1 && numexplod(16200)
ID = 16200
[State 表示消滅]
type = removeExplod
trigger1 = root,var(50)!=2 && numexplod(16201)
ID = 16201
[State 表示消滅]
type = removeExplod
trigger1 = root,var(50)!=3 && numexplod(16202)
ID = 16202
[State 表示消滅]
type = removeExplod
trigger1 = root,var(50)!=4 && numexplod(16203)
ID = 16203

[State 下に置く薄暗い爪 1p]
type = Explod
trigger1 = !numexplod(16310) && (root,var(50)>1)
anim = 16310
postype = L
pos = var(0)+25 +(root,teamside=2)*(GameWidth-100),var(1)
ID = 16310
IgnoreHitPause = 1
scale = 0.5, 0.5
OwnPal = 1
bindtime = 2147483647
sprpriority = 5

[state リロード中に対応したアニメ番号]
type = varset
trigger1 = 1
var(2) = floor( (root,var(51)%10)*0.8 )
[State リロード中の伸びる爪表示]
type = Explod
triggerall = roundstate = 2 && root,var(50)>=2
trigger1 = (root,var(51)=[1,99]) && root,var(51)%10!=0 && (gametime%20=0 || (root,var(51)%10=0));点滅
trigger1 = !(root,stateno = [2200,2299]);とりあえず暗転中は出さない
trigger1 = !(root,stateno = [3000,3299])
anim = 16300+var(2)
postype = L
pos = var(0)+25+ (9*0.5)*(floor(root,var(51)*0.1)) +(root,teamside=2)*(GameWidth-100),var(1) ;幅8+1
ID = 16300
IgnoreHitPause = 1
scale = 0.5, 0.5
sprpriority = 6
OwnPal = 0
bindtime = 2147483647
removetime = 10
[State リロード中の伸びる爪表示位置]
type = modifyExplod
trigger1 = numexplod(16300)
postype = L
pos = var(0)+25+ (9*0.5)*(floor(root,var(51)*0.1)) +(root,teamside=2)*(GameWidth-100),var(1) ;幅8+1
ID = 16300

[State リロード済みの弾数表示]
type = Explod
triggerall = root,var(50)>=2
trigger1 = !numexplod(16310+floor(root,var(51)*0.1)) && (root,var(51) =[1,100])
anim = 16310+floor(root,var(51)*0.1)
postype = L
pos = var(0)+25 +(root,teamside=2)*(GameWidth-100),var(1)
ID = 16310+floor(root,var(51)*0.1)
IgnoreHitPause = 1
scale = 0.5, 0.5
sprpriority = 6
OwnPal = 1
bindtime = 2147483647

[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16311) && !(floor(root,var(51)*0.1) = 1)
ID = 16311
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16312) && !(floor(root,var(51)*0.1) = 2)
ID = 16312
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16313) && !(floor(root,var(51)*0.1) = 3)
ID = 16313
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16314) && !(floor(root,var(51)*0.1) = 4)
ID = 16314
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16315) && !(floor(root,var(51)*0.1) = 5)
ID = 16315
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16316) && !(floor(root,var(51)*0.1) = 6)
ID = 16316
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16317) && !(floor(root,var(51)*0.1) = 7)
ID = 16317
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16318) && !(floor(root,var(51)*0.1) = 8)
ID = 16318
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16319) && !(floor(root,var(51)*0.1) = 9)
ID = 16319
[State 表示消滅]
type = removeExplod
trigger1 = numexplod(16320) && !(floor(root,var(51)*0.1) = 10)
ID = 16320

[State ハーブ中は光らせる]
type = Explod
triggerall = roundstate = 2 && root,var(50)>=2
trigger1 = !numexplod(16309) && (root,var(19)>0) && gametime%10=0
anim = 16309
postype = L
pos = var(0)+25 +(root,teamside=2)*(GameWidth-100),var(1)
ID = 16309
IgnoreHitPause = 1
scale = 0.5, 0.5
OwnPal = 1
bindtime = 2147483647
sprpriority = 6
removetime = -1
[State ハーブ効果表示消滅]
type = removeExplod
trigger1 = numexplod(16309) && (root,var(19)<=0)
trigger2 = numexplod(16309) && roundstate != 2
ID = 16309


[State 時間停止判断];ジョニィがstatenoもtimeも動かず、相手が1秒以上ctrl可能でon
type = null;varset
trigger1 = !(enemy,ctrl || enemy,stateno=[0,199])
trigger2 = (enemy,ctrl || enemy,stateno=[0,199]) && ( root,time!=var(8) || root,stateno!=var(9) )
trigger3 = (root,stateno=0 && root,time=1);上いれっぱで発動しな)
var(11) = 0
[State 時間停止判断]
type = null;varadd
trigger1 = (enemy,ctrl || enemy,stateno=[0,199]) && var(8)=root,time && var(9)=root,stateno
trigger1 = enemy,name = "dio" && enemy,authorname = "Warusaki3" && enemy,stateno = 3202
var(11) = 1
[State 時間停止判断成功]
type = parentvarset
;trigger1 = var(11)>60
trigger1 = enemy,name = "dio" && enemy,authorname = "Warusaki3" && enemy,stateno = 3202
trigger2 = enemy,name = "DIO BRANDO" && enemy,authorname = "Shio" && enemy,stateno = 3920
trigger3 = enemy,name = "final dio" && enemy,authorname = "Warusaki3" && enemy,stateno = 3202
trigger4 = enemy,name = "Jotaro Kujo" && enemy,authorname = "Warusaki3" && enemy,stateno = 3202
var(29) = 1

[State 時間停止判断 ジョニィのtime,stateno保存]
type = varset
trigger1 = 1
var(8) = root,time
[State 時間停止判断 ジョニィのtime,stateno保存]
type = varset
trigger1 = 1
var(9) = root,stateno

;---------------------------------------------------------------------------
;ゴゴゴ漆黒中オーラ　ヘルパー
[Statedef 17000]
type = A
Physics = N
sprpriority = -2
anim = 9999
ctrl = 0

[State 発動時の色の変数]
type = varset
trigger1 = time < 6
var(0)=30
[State 発動時の色の変数]
type = varset
trigger1 = time = [6,22]
var(0)=30+ (255-30)*(time-6)/16.0
[State 発動時の色修了]
type = varset
trigger1 = time > 22 && var(0)
var(0)=0

[State ゴゴゴカットイン]
type = Explod
trigger1 = !time
anim = 17000
postype = L
pos = -10,160
ID = 17000
ontop = 1
OwnPal = 1
bindtime = 2147483647
removetime = 80
scale = 0.45,0.45
[State 技名表示 出す1p]
type = modifyExplod
triggerall = numexplod(17000) && root,teamside=1
trigger1 = time<=10
postype = L
pos = -10 -150+150*(time/10.0),160
ID = 17000
bindtime = 2147483647
[State 技名表示 出す2p]
type = modifyExplod
triggerall = numexplod(17000) && root,teamside=2
trigger1 = time<=10
postype = L
pos = -10+GameWidth-102 +150-150*(time/10.0),160
ID = 17000
bindtime = 2147483647
[State 技名表示 帰す]
type = modifyExplod
trigger1 = numexplod(17000) && time>=72
postype = L
pos = -10 -150*((time-72)/10.0) *ifelse(root,teamside=1,1,-1) +(root,teamside!=1)*(GameWidth-102),160
ID = 17000
bindtime = 2147483647

[state 99999, 間違いで本体が来たら立ちへ移行]
type = selfstate
trigger1 = !ishelper
value = 0
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State 声]
type = playsnd
trigger1 = time = 0
value = 72,6 +random%2
channel = 0;意味はない
volume = 50
persistent = 0
[State ゴゴゴゴゴ…]
type = playsnd
trigger1 = time = 0
value = 90,5
volume = 80
persistent = 0

[State 100, 2]
type = turn
trigger1 = facing != root,facing
IgnoreHitPause = 1

[State 10001 固定 通常]
type = BindToroot
trigger1 = 1
time = 2
pos = 0,0
IgnoreHitPause = 1

[State 0, anim]
type = changeanim
trigger1 = anim != root,anim
trigger2 = anim = root,anim
trigger2 = animelemno(0) != root,animelemno(0)
value = root,anim
elem = root,animelemno(0)
IgnoreHitPause = 1

[State PalFX]
type = PalFX
trigger1 = 1
time = 1
add = 255,255,255
Mul = 110,110,70
ignorehitpause = 1
[State PalFX]
type = trans
trigger1 = 1
Trans = sub
ignorehitpause = 1

[state 99999, 不可視化]
type = assertspecial
trigger1 = root,alive=0
trigger2 = roundstate!=2
trigger3 = root,var(21)=1;ステート奪取
flag = invisible

;---------------------------------------------------------------------------
;硬直差表示ヘルパー 試作
[statedef 17760]
type = A
movetype = I
physics = N
ctrl = 0
anim = 9999;17760
[state 99999, 間違いで本体が来たら立ちへ移行]
type = selfstate
trigger1 = !ishelper
value = 0
[state 99999, 影不可視化]
type = assertspecial
trigger1 = 1
flag= noshadow
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[state 基本表示位置]
type = null
trigger1 = !time
trigger1 = 1 || var(0):=5;X
trigger1 = 1 || var(1):=236;Y

[state 表示するアニメ番号など];ヒット硬直差を変数で設定すると記述量がかなり増えるのとexplを結構使う
type = null;1p側はanim+100
triggerall = root,movetype!=H
triggerall = root,var(21)=0;ステート奪取されてない
trigger1 = root,stateno = 200 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger1 = 1 || var(6)   :=17760;アニメ番号
;trigger1 = 1 || var(7)   :=2;ヒット硬直差
;trigger1 = 1 || var(8)   :=-2;ガード硬直差
;trigger1 = 1 || var(9)   :=1;キャンセル可能(=1)
trigger1 = 1 || var(5)   :=1;表示フラグon
trigger2 = root,stateno = 210 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger2 = 1 || var(6)   :=17761;アニメ番号
trigger2 = 1 || var(5)   :=1;表示フラグon
trigger3 = root,stateno = 220 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger3 = 1 || var(6)   :=17762;アニメ番号
trigger3 = 1 || var(5)   :=1;表示フラグon
trigger4 = root,stateno = 220 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger4 = 1 || var(6)   :=17762;アニメ番号
trigger4 = 1 || var(5)   :=1;表示フラグon
trigger5 = root,stateno = 400 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger5 = 1 || var(6)   :=17763;アニメ番号
trigger5 = 1 || var(5)   :=1;表示フラグon
trigger6 = root,stateno = 410 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger6 = 1 || var(6)   :=17764;アニメ番号
trigger6 = 1 || var(5)   :=1;表示フラグon
trigger7 = root,stateno = 420 && root,time=1 && 0;キャンセルできるので硬直差表示の意味が薄い
trigger7 = 1 || var(6)   :=17765;アニメ番号
trigger7 = 1 || var(5)   :=1;表示フラグon
trigger8 = root,stateno = 1000 && root,time=1
trigger8 = 1 || var(6)   :=17769;アニメ番号
trigger8 = 1 || var(5)   :=1;表示フラグon
trigger9 = root,stateno = 1010 && root,time=1
trigger9 = 1 || var(6)   :=17769;アニメ番号
trigger9 = 1 || var(5)   :=1;表示フラグon
trigger10 = root,stateno = 1020 && root,time=1
trigger10 = 1 || var(6)   :=17769;アニメ番号
trigger10 = 1 || var(5)   :=1;表示フラグon
trigger11 = root,stateno = 1200 && root,time=1
trigger11 = 1 || var(6)   :=17770;アニメ番号
trigger11 = 1 || var(5)   :=1;表示フラグon
trigger12 = root,stateno = 1100 && root,time=1
trigger12 = 1 || var(6)   :=17771;アニメ番号
trigger12 = 1 || var(5)   :=1;表示フラグon
trigger13 = root,stateno = 1700 && root,time=1
trigger13 = 1 || var(6)   :=17772;アニメ番号
trigger13 = 1 || var(5)   :=1;表示フラグon
trigger14 = root,stateno = 1300 && root,time=1
trigger14 = 1 || var(6)   :=17774;アニメ番号
trigger14 = 1 || var(5)   :=1;表示フラグon
trigger15 = root,stateno = 1310 && root,time=1
trigger15 = 1 || var(6)   :=17775;アニメ番号
trigger15 = 1 || var(5)   :=1;表示フラグon
trigger16 = root,stateno = 1320 && root,time=1
trigger16 = 1 || var(6)   :=17776;アニメ番号
trigger16 = 1 || var(5)   :=1;表示フラグon
trigger17 = root,stateno = 240 && root,time=1
trigger17 = 1 || var(6)   :=17780;アニメ番号
trigger17 = 1 || var(5)   :=1;表示フラグon
trigger18 = root,stateno = 1400 && root,anim = 1400 && root,time=1
trigger18 = 1 || var(6)   :=17777;アニメ番号
trigger18 = 1 || var(5)   :=1;表示フラグon
trigger19 = root,stateno = 1400 && root,anim = 1410 && root,time=1
trigger19 = 1 || var(6)   :=17778;アニメ番号
trigger19 = 1 || var(5)   :=1;表示フラグon
trigger20 = root,stateno = 1400 && root,anim = 1420 && root,time=1
trigger20 = 1 || var(6)   :=17779;アニメ番号
trigger20 = 1 || var(5)   :=1;表示フラグon
trigger21 = root,stateno = 1500 && root,time=1
trigger21 = 1 || var(6)   :=17781;アニメ番号
trigger21 = 1 || var(5)   :=1;表示フラグon
trigger22 = root,stateno = 1540 && root,time=1
trigger22 = 1 || var(6)   :=17782;アニメ番号
trigger22 = 1 || var(5)   :=1;表示フラグon
trigger23 = root,stateno = 1580 && root,time=1 && 0
trigger23 = 1 || var(6)   :=17783;アニメ番号
trigger23 = 1 || var(5)   :=1;表示フラグon
trigger24 = root,stateno = 1800 && root,time=1
trigger24 = 1 || var(6)   :=17773;アニメ番号
trigger24 = 1 || var(5)   :=1;表示フラグon
trigger25 = root,stateno = 2000 && root,time=1
trigger25 = 1 || var(6)   :=17784;アニメ番号
trigger25 = 1 || var(5)   :=1;表示フラグon
trigger26 = root,stateno = 2200 && root,time=1
trigger26 = 1 || var(6)   :=17785;アニメ番号
trigger26 = 1 || var(5)   :=1;表示フラグon
trigger27 = root,stateno = 3600 && root,time=1
trigger27 = 1 || var(6)   :=17787;アニメ番号
trigger27 = 1 || var(5)   :=1;表示フラグon
trigger28 = root,stateno = 2100 && root,time=1
trigger28 = 1 || var(6)   :=17788;アニメ番号
trigger28 = 1 || var(5)   :=1;表示フラグon

[state 表示してからの時間 A]
type = null
trigger1 = !numexplod(17760)
trigger1 = 1 || var(2):=0
trigger1 = 1 || var(10):=0;保存したアニメ番号もついでに消去
trigger2 = numexplod(17760)
trigger2 = 1 || var(2):=var(2)+1
[state 表示してからの時間 B]
type = null
trigger1 = !numexplod(17761)
trigger1 = 1 || var(3):=0
trigger1 = 1 || var(11):=0;保存したアニメ番号もついでに消去
trigger2 = numexplod(17761)
trigger2 = 1 || var(3):=var(3)+1
[state 表示してからの時間 C]
type = null
trigger1 = !numexplod(17762)
trigger1 = 1 || var(4):=0
trigger1 = 1 || var(12):=0;保存したアニメ番号もついでに消去
trigger2 = numexplod(17761)
trigger2 = 1 || var(4):=var(4)+1

[State 上に移動しているはずのBは消す]
type = removeExplod
triggerall = var(12) != var(6);Cと同じ技でない
trigger1 = !numexplod(17760) && (numexplod(17762)&&var(4)>0) && var(5)=1
ID = 17761
[State 技名表示 A 1P]
type = Explod
triggerall = root,TeamSide=1
triggerall = var(12) != var(6);Cと同じ技でない
trigger1 = !numexplod(17760) && (numexplod(17762)&&var(4)>0) && var(5)=1
trigger1 = 1 || var(10):=var(6);Aのアニメ番号を保存
trigger2 = !numexplod(17760) && !numexplod(17761) && !numexplod(17762) && var(5)=1;何もない最初
trigger2 = 1 || var(10):=var(6);Aのアニメ番号を保存
anim = var(6)
postype = L
pos = var(0),var(1)
ID = 17760
scale = 0.5, 0.5
;facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 8
OwnPal = 1
bindtime = 2147483647
removetime = 100
[State 技名表示 動かす]
type = modifyExplod
triggerall = root,TeamSide=1
trigger1 = numexplod(17760)
postype = L
pos = ifelse( var(2)<3,var(0)-6+var(2)*2,var(0) ),var(1) -(numexplod(17761)>0)*ifelse(var(3)<3,(var(3)+1)*13.0/4.0,13);上にも移動
ID = 17760
bindtime = 2147483647
scale = 0.5*ifelse((numexplod(17761)>0),0.9,1), 0.5*ifelse((numexplod(17761)>0),0.9,1);上だと小さく

[State 技名表示 A 2P]
type = Explod
triggerall = root,TeamSide=2
triggerall = var(12) != var(6);Cと同じ技でない
trigger1 = !numexplod(17760) && (numexplod(17762)&&var(4)>0) && var(5)=1
trigger1 = 1 || var(10):=var(6);Aのアニメ番号を保存
trigger2 = !numexplod(17760) && !numexplod(17761) && !numexplod(17762) && var(5)=1;何もない最初
trigger2 = 1 || var(10):=var(6);Aのアニメ番号を保存
anim = var(6)+100
postype = L
pos = var(0),var(1)
ID = 17760
scale = 0.5, 0.5
;facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 8
OwnPal = 1
bindtime = 2147483647
removetime = 100
[State 技名表示 動かす]
type = modifyExplod
triggerall = root,TeamSide=2
trigger1 = numexplod(17760)
postype = L
pos = ifelse( var(2)<3,320-var(0)+6-var(2)*2,320-var(0) ),var(1) -(numexplod(17761)>0)*ifelse(var(3)<3,(var(3)+1)*13.0/4.0,13);上にも移動
ID = 17760
bindtime = 2147483647
scale = 0.5*ifelse((numexplod(17761)>0),0.9,1), 0.5*ifelse((numexplod(17761)>0),0.9,1);上だと小さく

[State 上に移動しているはずのCは消す]
type = removeExplod
triggerall = var(10) != var(6);Aと同じ技でない
trigger1 = !numexplod(17761) && (numexplod(17760)&&var(2)>0) && var(5)=1
ID = 17762
[State 技名表示 B]
type = Explod
triggerall = root,TeamSide=1
triggerall = var(10) != var(6);Aと同じ技でない
trigger1 = !numexplod(17761) && (numexplod(17760)&&var(2)>0) && var(5)=1
trigger1 = 1 || var(11):=var(6);Bのアニメ番号を保存
anim = var(6)
postype = L
pos = var(0),var(1)
ID = 17761
scale = 0.5, 0.5
;facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 8
OwnPal = 1
bindtime = 2147483647
removetime = 100
[State 技名表示 動かす]
type = modifyExplod
triggerall = root,TeamSide=1
trigger1 = numexplod(17761)
postype = L
pos = ifelse( var(3)<3,var(0)-6+var(3)*2,var(0) ),var(1) -(numexplod(17762)>0)*ifelse(var(4)<3,(var(4)+1)*13.0/4.0,13);上にも移動
ID = 17761
bindtime = 2147483647
scale = 0.5*ifelse((numexplod(17762)>0),0.9,1), 0.5*ifelse((numexplod(17762)>0),0.9,1);上だと小さく

[State 技名表示 B 2P]
type = Explod
triggerall = root,TeamSide=2
triggerall = var(10) != var(6);Aと同じ技でない
trigger1 = !numexplod(17761) && (numexplod(17760)&&var(2)>0) && var(5)=1
trigger1 = 1 || var(11):=var(6);Bのアニメ番号を保存
anim = var(6)+100
postype = L
pos = var(0),var(1)
ID = 17761
scale = 0.5, 0.5
;facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 8
OwnPal = 1
bindtime = 2147483647
removetime = 100
[State 技名表示 動かす 2P]
type = modifyExplod
triggerall = root,TeamSide=2
trigger1 = numexplod(17761)
postype = L
pos = ifelse( var(3)<3,320-var(0)+6-var(3)*2,320-var(0) ),var(1) -(numexplod(17762)>0)*ifelse(var(4)<3,(var(4)+1)*13.0/4.0,13);上にも移動
ID = 17761
bindtime = 2147483647
scale = 0.5*ifelse((numexplod(17762)>0),0.9,1), 0.5*ifelse((numexplod(17762)>0),0.9,1);上だと小さく

[State 上に移動しているはずのAは消す]
type = removeExplod
triggerall = var(11) != var(6);Bと同じ技でない
trigger1 = !numexplod(17762) && (numexplod(17761)&&var(3)>0) && var(5)=1
ID = 17760
[State 技名表示 C]
type = Explod
triggerall = root,TeamSide=1
triggerall = var(11) != var(6);Bと同じ技でない
trigger1 = !numexplod(17762) && (numexplod(17761)&&var(3)>0) && var(5)=1
trigger1 = 1 || var(12):=var(6);Cのアニメ番号を保存
anim = var(6)
postype = L
pos = var(0),var(1)
ID = 17762
scale = 0.5, 0.5
;facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 8
OwnPal = 1
bindtime = 2147483647
removetime = 100
[State 技名表示 動かす]
type = modifyExplod
triggerall = root,TeamSide=1
trigger1 = numexplod(17762)
postype = L
pos = ifelse( var(4)<3,var(0)-6+var(4)*2,var(0) ),var(1) -(numexplod(17760)>0)*ifelse(var(2)<3,(var(2)+1)*13.0/4.0,13);上にも移動
ID = 17762
bindtime = 2147483647
scale = 0.5*ifelse((numexplod(17760)>0),0.9,1), 0.5*ifelse((numexplod(17760)>0),0.9,1);上だと小さく

[State 技名表示 C 2P]
type = Explod
triggerall = root,TeamSide=2
triggerall = var(11) != var(6);Bと同じ技でない
trigger1 = !numexplod(17762) && (numexplod(17761)&&var(3)>0) && var(5)=1
trigger1 = 1 || var(12):=var(6);Cのアニメ番号を保存
anim = var(6)+100
postype = L
pos = var(0),var(1)
ID = 17762
scale = 0.5, 0.5
;facing = facing*(root,TeamSide=1) + facing*-(root,TeamSide=2)
sprpriority = 8
OwnPal = 1
bindtime = 2147483647
removetime = 100
[State 技名表示 動かす 2P]
type = modifyExplod
triggerall = root,TeamSide=2
trigger1 = numexplod(17762)
postype = L
pos = ifelse( var(4)<3,320-var(0)+6-var(4)*2,320-var(0) ),var(1) -(numexplod(17760)>0)*ifelse(var(2)<3,(var(2)+1)*14.0/4.0,14);上にも移動
ID = 17762
bindtime = 2147483647
scale = 0.5*ifelse((numexplod(17760)>0),0.9,1), 0.5*ifelse((numexplod(17760)>0),0.9,1);上だと小さく

[state 表示フラグリセット]
type = varset
trigger1 = var(5)
var(5)=0

[State カットインの邪魔をしない]
type = removeExplod
triggerall = root,stateno = 3000
trigger1 = numexplod(17760)
ID = 17760
[State カットインの邪魔をしない]
type = removeExplod
triggerall = root,stateno = 3000
trigger1 = numexplod(17761)
ID = 17761
[State カットインの邪魔をしない]
type = removeExplod
triggerall = root,stateno = 3000
trigger1 = numexplod(17762)
ID = 17762
;===========================================================================
;---------------------------------------------------------------------------
;前転後転用常に同方向向く ヘルパー
[statedef 99998]
type = A
movetype = I
physics = N
ctrl = 0
anim = 9999
[state 99999, 不可視化]
type = assertspecial
trigger1 = 1
flag = invisible
flag2= noshadow
[state 99999, 向き]
type = assertspecial
trigger1 = 1
flag= NoAutoTurn
[state 99999, posset]
type = posset
trigger1 = 1
x = root,pos X
y = 9999
[state 99999, 向き];右向き
type = turn
trigger1 = facing = -1
[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State -1, ダッシュ]
type = varset
trigger1 = command = "FF"
var(9) = 6+(root,statetype = A || root,stateno=52)*3
[State -1, バクステ]
type = varset
trigger1 = command = "BB"
var(8) = 6+(root,statetype = A || root,stateno=52)*3
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = helper(40000),HitPauseTime=0;遠隔操作スタンドがヒット中でない
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(8)
var(8) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = helper(40000),HitPauseTime=0;遠隔操作スタンドがヒット中でない
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(9)
var(9) = -1

[State 99999, 先行入力フレーム特別リセット];相手を通り越したときに暴発するのを防ぐ
type = varset
triggerall = root,stateno = [100,105]
trigger1 = var(8)
var(8) = 0
[State 99999, 先行入力フレーム特別リセット]
type = varset
triggerall = root,stateno = [100,105]
trigger1 = var(9)
var(9) = 0
[State -1];この変数が1のとき入力猶予が倍になる
type = varset
trigger1 = 0;root,stateno = 100 || root,stateno = 105;前転中
trigger2 = 0;root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0;2Hの飛び道具ヒット中
trigger3 = root,stateno = 7880
var(50) = 1
[State -1]入力猶予倍リセット
type = varset
;trigger1 = 0;!(root,stateno = 100 || root,stateno = 105);前転中
;trigger1 = 0;!(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0)
trigger1 = root,stateno != 7880
var(50) = 0
[State 99999,一括リセット]
type = VarRangeSet
trigger1 = root,stateno = 52 && root,time = 0 && root,prevstateno = [0,199];攻撃せず着地
trigger2 = roundstate != 2
value = 0
First = 0
Last = 16
IgnoreHitPause = 1
;---------------------------------------------------------------------------
; 先行入力 ヘルパー
[statedef 99999]
type = A
movetype = I
physics = N
ctrl = 0
anim = 9999
[state 99999, 間違いで本体が来たら立ちへ移行]
type = selfstate
trigger1 = !ishelper
value = 0
[state 99999, 不可視化]
type = assertspecial
trigger1 = 1
flag = invisible
flag2= noshadow
[state 99999, 向き]
type = assertspecial
trigger1 = 1
flag= NoAutoTurn
[state 99999, posset]
type = posset
trigger1 = 1
x = root,pos X
y = 9999
[state 99999, 向き];右向き ダウン状態でコマンド反転を防ぐ
type = turn
triggerall = facing = -1
trigger1 = (root,p2dist X >= 0)
trigger2 = (root,statetype = L || root,stateno = [5100,5120])
[state 99999, 向き];左向き
type = turn
triggerall = facing = 1
trigger1 = (root,p2dist X < 0)
trigger1 = !(root,statetype = L || root,stateno = [5100,5120])

[state 99999, 無敵化]
type = nothitby
trigger1 = 1
value = SCA,AA,AP,AT

[State -1, start]
type = varset
trigger1 = command = "start"
var(31) = 5+(root,statetype = A || root,stateno=52)*2

[State -1, 421a]
type = varset
trigger1 = command = "421a" && root,var(51)>=10;爪弾がある
var(30) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 623a]
type = varset
trigger1 = command = "623a" && root,var(51)>=10;爪弾がある
var(29) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, ハイジャンプ]
type = varset
trigger1 = command = "HJ"
trigger1 = command != "NHJ";不正入力排除
var(28) = 5+(root,statetype = A || root,stateno=52)*3

[State -1, a]
type = varset
trigger1 = command = "a"
var(27) = 5+(root,statetype = A || root,stateno=52)*3

[State -1, recovery]
type = varset
trigger1 = command = "recovery"
var(26) = 5

[State -1, 64x]
type = varset
trigger1 = command = "64x"
var(25) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 46x]
type = varset
trigger1 = command = "46x"
var(24) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, xy]
type = varset
trigger1 = command = "xy"
var(23) = 5+(root,statetype = A || root,stateno=52)*3

[State -1, 214xy]
type = varset
trigger1 = command = "214xy"
var(22) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 236xy]
type = varset
trigger1 = command = "236xy"
var(21) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, c]
type = varset
trigger1 = command = "c"
var(20) = 6+(root,statetype = A || root,stateno=52)*3

[State -1, b]
type = varset
trigger1 = command = "b"
var(19) = 6+(root,statetype = A || root,stateno=52)*3

[State -1, 22x]
type = varset
trigger1 = command = "22z"
var(18) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 22x]
type = varset
trigger1 = command = "22y"
var(17) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 22x]
type = varset
trigger1 = command = "22x"
var(16) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 421z]
type = varset
trigger1 = command = "421z" && root,var(51)>=10;爪弾がある
var(15) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 421y]
type = varset
trigger1 = command = "421y" && root,var(51)>=10;爪弾がある
var(14) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 421x]
type = varset
trigger1 = command = "421x" && root,var(51)>=10;爪弾がある
var(13) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 623z]
type = varset
trigger1 = command = "623z" && root,var(51)>=10;爪弾がある
var(12) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 623y]
type = varset
trigger1 = command = "623y" && root,var(51)>=10;爪弾がある
var(11) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 623x]
type = varset
trigger1 = command = "623x" && root,var(51)>=10;爪弾がある
var(10) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, ダッシュ]
type = varset
trigger1 = command = "FF"
var(9) = 6+(root,statetype = A || root,stateno=52)*3
[State -1, バクステ]
type = varset
trigger1 = command = "BB"
var(8) = 6+(root,statetype = A || root,stateno=52)*3

[State -1, 214z]
type = varset
trigger1 = command = "214z" && root,var(51)>=10;爪弾がある
var(7) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 214y]
type = varset
trigger1 = command = "214y" && root,var(51)>=10;爪弾がある
var(6) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 214x]
type = varset
trigger1 = command = "214x" && root,var(51)>=10;爪弾がある
var(5) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 236z]
type = varset
trigger1 = command = "236z" && root,var(51)>=10;爪弾がある
var(4) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 236y]
type = varset
trigger1 = command = "236y" && root,var(51)>=10;爪弾がある
var(3) = 9+(root,statetype = A || root,stateno=52)*3
[State -1, 236x]
type = varset
trigger1 = command = "236x" && root,var(51)>=10;爪弾がある
var(2) = 9+(root,statetype = A || root,stateno=52)*3

[State -1, 2弱]
type = varset
trigger1 = command = "x" && command = "holddown"
var(0) = 33+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 2中]
type = varset
trigger1 = command = "y" && command = "holddown"
var(0) = 44+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 2強]
type = varset
trigger1 = command = "z" && command = "holddown"
var(0) = 54+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 5弱]
type = varset
trigger1 = command = "x" && command != "holddown"
var(0) = 4+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 5中]
type = varset
trigger1 = command = "y" && command != "holddown"
var(0) = 14+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 5強]
type = varset
trigger1 = command = "z" && command != "holddown"
var(0) = 24+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 6強]
type = varset
trigger1 = command = "z" && command = "holdfwd" && command != "holddown"
var(0) = 64+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 4強]
type = varset
trigger1 = command = "z" && command = "holdback" && command != "holddown"
var(0) = 74+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 6中]
type = varset
trigger1 = command = "y" && command = "holdfwd" && command != "holddown" && root,var(51)>=10;爪弾がある
var(0) = 84+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State -1, 4中]
type = varset
trigger1 = command = "y" && command = "holdback" && command != "holddown" && root,var(51)>=10;爪弾がある
var(0) = 94+(root,statetype = A || root,stateno=52 || root,stateno=1830)*3

[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(0)%10!=0
var(0) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = (var(1) = [1,9]) || (var(1) = [11,19]) || (var(1) = [21,29]) || (var(1) = [31,39]) 
var(1) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(2)
var(2) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(3)
var(3) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(4)
var(4) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(5)
var(5) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(6)
var(6) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(7)
var(7) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(8)
var(8) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(9)
var(9) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(10)
var(10) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(11)
var(11) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(12)
var(12) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(13)
var(13) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(14)
var(14) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(15)
var(15) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(16)
var(16) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(17)
var(17) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(18)
var(18) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(19)
var(19) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(20)
var(20) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(21)
var(21) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(22)
var(22) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(23)
var(23) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(24)
var(24) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(25)
var(25) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(26)
var(26) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(27)
var(27) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(28)
var(28) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(29)
var(29) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(30)
var(30) = -1
[State 99999, 先行入力フレーム減算]
type = varadd
triggerall = (var(50)=0 || (var(50)=1 && gametime%2=0)) && !(Root,HitPauseTime)
triggerall = !(root,var(1) > 0 && numhelper(422) && helper(422),HitPauseTime>0);2Hの飛び道具ヒット中でない
trigger1 = var(31)
var(31) = -1
;まとめろよってな

[State 先行入力残って連打しないようにリセット]
type = varset
trigger1 = root,stateno = 200 && (var(0) = [1,9]) && root,time = 1
trigger2 = root,stateno = 210 && (var(0) = [11,19]) && root,time = 1
trigger3 = root,stateno = 220 && (var(0) = [21,29]) && root,time = 1
trigger4 = root,stateno = 400 && (var(0) = [31,39]) && root,time = 1
trigger5 = root,stateno = 410 && (var(0) = [41,49]) && root,time = 1
trigger6 = root,stateno = 420 && (var(0) = [51,59]) && root,time = 1
var(0) = 0
[State 99999, 先行入力フレーム特別リセット];相手を通り越したときに暴発するのを防ぐ
type = varset
triggerall = root,stateno = [100,105]
trigger1 = var(8)
var(8) = 0
[State 99999, 先行入力フレーム特別リセット]
type = varset
triggerall = root,stateno = [100,105]
trigger1 = var(9)
var(9) = 0
[State 99999, 先行入力フレーム特別リセット]
type = null
triggerall = ((root,stateno = [1000,1020])||(root,stateno = [1300,1320])) && var(49)=0;爪弾中に2を入力していない
trigger1 = 1 || var(21):=0
trigger1 = 1 || var(22):=0
[State 99999,先行入力フレーム特別リセット]
type = Varset
trigger1 = root,stateno = 1770 && root,time = [0,1];着地
var(0)=0
IgnoreHitPause = 1

[State 99999, 爪弾中に2を入力したら1]
type = varset
trigger1 = ((root,stateno = [1000,1020])||(root,stateno = [1300,1320])) && command = "holddown"
var(49) = 1
[State 99999, 爪弾中に2を入力したら1リセット]
type = varset
trigger1 = var(49) && !((root,stateno = [1000,1020])||(root,stateno = [1300,1320]))
var(49) = 0

;236bの先行入力は爪弾中は一旦停止　新たに2を入力すれば復活

[State -1];この変数が1のとき入力猶予が倍になる
type = varset
triggerall =var(50)=0
trigger1 = 0;root,stateno = 100 || root,stateno = 105;前転中
trigger2 = root,stateno = 1830 || root,stateno = [1800,1815];あそこまで中
trigger3 = root,stateno = 7880
trigger4 = root,stateno = 1588
var(50) = 1
[State -1]入力猶予倍リセット
type = varset
triggerall =var(50)
trigger1 = 0;!(root,stateno = 100 || root,stateno = 105);前転中
trigger1 = !(root,stateno = 1830 || root,stateno = [1800,1815]);あそこまで中
trigger1 = root,stateno != 7880
trigger1 = root,stateno != 1588
var(50) = 0

[State 99999,一括リセット]
type = VarRangeSet
trigger1 = 0;root,stateno = 1770 && root,time = [0,1];着地
trigger2 = roundstate != 2
trigger3 = root,stateno = 7880 && root,time=1;PC発動直後
value = 0
First = 0
Last = 31
IgnoreHitPause = 1

;===========================================================================
; 常時監視ステート（‐２）
;===========================================================================
;---------------------------------------------------------------------------
; 通常の食らい状態（Statedef 5000〜5199間）でも、
; 相手に（「P2StateNo」や「TargetState」等で）制御を奪われても、
; 常に登録したステートコントローラが有効になります。
;---------------------------------------------------------------------------

[Statedef -2]

[State 当て投げ制限 ガードさせてからの時間]
type = Varset
triggerall = !ishelper
trigger1 = (enemynear,stateno = [150,155])
trigger2 = (enemynear,stateno = [5000,5011])
var(33) = 0
IgnoreHitPause = 1
[State 当て投げ制限 ガードさせてからの時間]
type = Varadd
trigger1 = !ishelper
var(33) = 1
IgnoreHitPause = 1

[State バイツァ・ダスト]
type = Varset
trigger1 = !ishelper && TeamMode = single
trigger1 = enemy,name = "KawajiriKosaku" && enemy,stateno = 14005
trigger1 = var(51):=100
var(50) = 1
IgnoreHitPause = 1

[State -2,漆黒のパレット]
type = Remappal
trigger1 = !ishelper && var(48) = 2 && palno = [1,6]
trigger1 = stateno!=985;勝利モーションの一部
source = 1,1
dest = 1,palno+6
[State -2,漆黒のパレット解除]
type = Remappal
trigger1 = !ishelper && var(48) != 2 && palno = [1,6]
trigger2 = !ishelper && stateno=985;勝利モーションの一部
source = 1,1
dest = 1,palno

[State ステート奪取認識]
type = Varset
trigger1 = !ishelper
var(21) = !(var(20) = gametime)
IgnoreHitPause = 1

[State 奥の穴エフェクト消滅一括]
type = removeExplod
trigger1 = numexplod(1450) && movetype = H
trigger2 = numexplod(1450) && stateno = 7880;PC
ID = 1450

[State -2 自分を撃つ ヒットカウント増加]
type = Varadd
trigger1 = !ishelper && numhelper(1530)
trigger1 = helper(1530),movehit = 1 && helper(1530),HitPauseTime=8-1
var(6) = 1
IgnoreHitPause = 1

[State ACT初期値]
type = varset
trigger1 = !ishelper && var(50) = 0
var(50) = 1;ACT1

[State ikemen判別]
type = Varrandom
triggerall = !ishelper
trigger1 = var(35) = 0
v = 35
;rangeを省略 ikemenなら0,0なのでずっと0のはず
IgnoreHitPause = 1

[State ハーブ効果時間減算]
type = varadd
trigger1 = !ishelper && var(19)
var(19) = -1
[State 爪弾リロード]
type = varadd
trigger1 = var(50)>1 && roundstate = 2
trigger1 = !ishelper && var(51) < 100 && gametime%(28-(var(19)>0)*15)=0;ハーブ中は加速
;trigger1 = !(stateno = [2200,2299])
;trigger1 = !(stateno = [3000,3299])
var(51) = 1

[State スタイリッシュムーブ時間計測]
type = null
triggerall = !ishelper
trigger1 = 1 || var(11):=var(11)+1
trigger1 = 1 || var(12):=var(12)+1
[State スタイリッシュムーブ時間計測]
type = varset
triggerall = !ishelper
trigger1 = (command = "SM6")
trigger1 = var(11) > 25 && var(12) > 25
var(11) = 0
[State スタイリッシュムーブ時間計測]
type = varset
triggerall = !ishelper
trigger1 = (command = "SM2")
trigger1 = var(12) > 25 && var(11) > 25
var(12) = 0
[State めくりに対してSM発動しない]
type = null
triggerall = !ishelper
trigger1 = p2dist X < 0
trigger1 = 1 || var(12) := 25-10
trigger1 = 1 || var(11) := 25-10

[State 50, 投げ抜け用 相手 通常投げ]
type = varset
trigger1 = enemynear(0),HitDefAttr = S, NT
var(27) = 1
ignorehitpause = 1
[State 50, 投げ抜け用 相手 通常投げリセット]
type = varset
trigger1 = !(enemynear(0),HitDefAttr = S, NT)
var(27) = 0

[State 連続ガードクールタイムカウント]
type = varadd
trigger1 = !ishelper
trigger1 = roundstate = 2 && var(10)>0
var(10) = -1
[State 連続ガードクールタイム設定 ガード時]
type = varset
trigger1 = !ishelper && roundstate = 2
trigger1 = stateno = [140,155]
var(10) = 80
[State 連続ガードクールタイム設定 着地時]
type = varset
trigger1 = !ishelper && roundstate = 2
trigger1 = stateno = 52 && time = 1 && var(10)<7
var(10) = 7-1

[State ガードゲージ初期値]
type = VarSet
triggerall = !ishelper
trigger1 = RoundState < 2
var(8) = 5000
IgnoreHitPause = 1
[State ガードゲージ制限]
type = VarSet
triggerall = !ishelper
trigger1 = var(8)>5000 || var(8)<0
var(8) = ifelse(var(8)>5000,5000,0)
IgnoreHitPause = 1
[State ガードゲージ回復 通常]
type = Varadd
triggerall = !ishelper
triggerall = statetype != A;ジャンプ中というか空中では回復しない
triggerall = stateno != 7444;SM中じゃない
trigger1 = var(10) <= 0;クールタイム
trigger1 = var(8) = [2501,4999]
var(8) = 3 *ifelse(movetype = H,0.5,1)
IgnoreHitPause = 1
[State ガードゲージ回復 ゲージが少ない時]
type = Varadd
triggerall = !ishelper
triggerall = statetype != A;ジャンプ中というか空中では回復しない
triggerall = stateno != 7444;SM中じゃない
trigger1 = var(10) <= 0;クールタイム
trigger1 = var(8) = [0,2500]
var(8) = 3*(2-(var(8)**1.0/2500)**1.0) *ifelse(movetype = H,0.5,1)
IgnoreHitPause = 1

[State エフェクト消滅 シルシル]
type = removeExplod
trigger1 = numexplod(1120) && stateno != 1100
ID = 1120
[State エフェクト消滅 スパーダ]
type = removeExplod
trigger1 = numexplod(1220) && stateno != 1200
ID = 1220
[State エフェクト消滅 スパーダ]
type = removeExplod
trigger1 = numexplod(1228) && stateno != 1200
ID = 1228
[State エフェクト消滅 スパーダ煙]
type = removeExplod
trigger1 = numexplod(1225) && stateno != 1200
ID = 1225

;-----------------------------------
[State -2, クリップボード]
type = DisplayToClipboard
trigger1 = 1
text = "var(1)=%d, hitcount=%d, Button=%d, \n Body-Distance X=%d,Y=%d \n"
params = (var(1)),var(6),var(5),floor(P2BodyDist X),floor(P2BodyDist Y)

;[State -2, クリップボード（追加専用）]
;type = AppendToClipboard
;trigger1 = 1
;text = "Position X=%d,Y=%d, var(0)=%d,var6=%d, fVAR0=%f var(31)=%d kakudo=%d \n"
;params = floor(Pos X),floor(Pos Y),(helper(99999),var(0)),(var(6)),(fvar(0)),var(31),helper(1510),var(1)

;===========================================================================
; 準常時監視ステート（‐３）
;===========================================================================
;---------------------------------------------------------------------------
; こちらは通常の食らい状態以外の「P2StateNo」や「TargetState」等で制御された、
; 作成者が任意に指定した相手側の食らいステートに限り、
; 登録したステートコントローラが有効にはなりません。
; ‐１や‐２と上手く使い分けて行きましょう。
;---------------------------------------------------------------------------

[Statedef -3]

[State 言い始めスイッチ増加]
type = Varadd
trigger1 = !ishelper && var(37)
var(37) = 1
IgnoreHitPause = 1
[State 言い始めスイッチリセット]
type = Varset
triggerall = !ishelper
trigger1 =  movetype=H || ( !(stateno = [1300,1399]) && !(stateno = [0,199]) )
var(37) = 0
IgnoreHitPause = 1

[State まさか…時を！？]
type = playsnd
trigger1 = !ishelper && var(53)=0
trigger1 = !(enemy,name = "TRM Man" && enemy,Authorname = "M3")
trigger1 = var(29)=1 && ctrl
trigger1 = var(53):=1
value = 75,0
volume = 100

[State -3 gametime]
type = Varset
trigger1 = !ishelper
var(20) = gametime
IgnoreHitPause = 1

[State -2 ヒットスパーク用ランダム(0〜1000)]
type = VarRandom
trigger1 = !ishelper
trigger1 = movetype != H
v = 3
Range = 0,1000
IgnoreHitPause = 1

;先行入力認識用ヘルパー暴走防止
[state -3, ステートリセット]
type = changestate
trigger1 = ishelper(99999)
value = 99999
ignorehitpause = 1
;先行入力認識用ヘルパー
[state -3, 先行入力認識用ヘルパー]
type = helper
triggerall = !ishelper
trigger1 = !numhelper(99999)
helpertype = normal
name = "commandhelper"
stateno = 99999
ID = 99999
postype = p1
pos = 0,9999
keyctrl = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[state -3, 前転後転用常に同方向向くヘルパー]
type = helper
triggerall = !ishelper
trigger1 = !numhelper(99998)
helpertype = normal
name = "commandhelper2"
stateno = 99998
ID = 99998
postype = p1
pos = 0,9999
keyctrl = 1
pausemovetime = 2147483647
supermovetime = 2147483647

[state -3, 硬直差表示ヘルパー]
type = helper
triggerall = !ishelper
trigger1 = !numhelper(17760)
helpertype = normal
name = "F"
stateno = 17760
ID = 17760
postype = L
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647

[state -3, ACTと弾数表示ヘルパー]
type = helper
triggerall = !ishelper && teamside = 1
trigger1 = !numhelper(16200)
helpertype = normal
name = "ACT"
stateno = 16200
ID = 16200
postype = L
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647
[state -3, ACTと弾数表示ヘルパー]
type = helper
triggerall = !ishelper && teamside = 2
trigger1 = !numhelper(16200)
helpertype = normal
name = "ACT"
stateno = 16200
ID = 16200
postype = R
pos = 0,0
pausemovetime = 2147483647
supermovetime = 2147483647

[State -2 ヒットカウント増加 本体]
type = Varadd
triggerall = !ishelper
trigger1 = movehit=1
var(6) = 1
;IgnoreHitPause = 1
[State -2 ヒットカウントリセット]
type = null
triggerall = !ishelper
trigger1 = p2movetype!=H
trigger1 = 1 || var(6):=0
trigger1 = 1 || var(7):=0;投げの補正
IgnoreHitPause = 1
[State -2 補正]
type = Varset
triggerall = !ishelper
trigger1 = var(6)=0
fvar(0) = ( 1+((stateno=200||stateno=400) && p2movetype=A && p2statetype=A)+(!(stateno=200||stateno=400) && p2movetype=A) )*ifelse(var(7)=0,1,0.5) *(1+(var(48)>0)*0.1)
IgnoreHitPause = 1
[State -2 補正]
type = Varset
triggerall = !ishelper
trigger1 = var(6)=[1,9]
fvar(0) = 0.9*1*ifelse(var(7)=0,1,0.5) *(1+(var(48)>0)*0.1)
IgnoreHitPause = 1
[State -2 補正]
type = Varset
triggerall = !ishelper
trigger1 = var(6)=[10,19]
fvar(0) = 0.9*0.65 *ifelse(var(7)=0,1,0.5) *(1+(var(48)>0)*0.1)
IgnoreHitPause = 1
[State -2 補正]
type = Varset
triggerall = !ishelper
trigger1 = var(6)=[20,39]
fvar(0) = 0.9*0.45 *ifelse(var(7)=0,1,0.5) *(1+(var(48)>0)*0.1)
IgnoreHitPause = 1
[State -2 補正]
type = Varset
triggerall = !ishelper
trigger1 = var(6)>=30
fvar(0) = 0.9*0.1 *ifelse(var(7)=0,1,0.5) *(1+(var(48)>0)*0.1)
IgnoreHitPause = 1

[State 連続ガード回数]
type = varadd
trigger1 = (stateno = [150,155]) && !time
trigger1 = (prevstateno = [150,155])
var(9) = 1
[State 連続ガード回数リセット]
type = varset
trigger1 = (stateno = [150,155]) && !time
trigger1 = !(prevstateno = [150,155])
var(9) = 0

;ガードゲージヘルパー
[state -3, ガードゲージヘルパー]
type = helper
triggerall = !ishelper
trigger1 = !numhelper(16000)
name = "GG"
stateno = 16000
ID = 16000
postype = L
pos = 135,-170
Size.XScale = 0.5
Size.YScale = 0.5
pausemovetime = 2147483647
supermovetime = 2147483647

[State ガークラ移行]
type = changestate
trigger1 = !ishelper
trigger1 = var(8)<=0 && (stateno = 150 || stateno = 152)
value = 5400

[State -3, GetHurt Sound];やられボイス
type = PlaySnd
triggerall = Random <= 750
triggerall = Time = 1
triggerall = Alive = 1
trigger1 = StateNo = 5000 || StateNo = 5010 || StateNo = 5020 || StateNo = 5070
value = 5000, ifelse(StateNo = 5100 || GetHitVar(animtype)=2, 20+(random%3), ifelse(GetHitVar(animtype)=1, 10+(random%3), 0+(random%2)))
channel = 5

;ゴゴゴ・漆黒モード
[state 漆黒のスイッチ]
type = varset
triggerall = !ishelper && roundstate = 2
trigger1 = life <= lifemax*0.30 && movetype!=H && var(48)=0
var(48) = 2;漆黒

[state -3, オーラヘルパー]
type = helper
triggerall = !ishelper
trigger1 = !numhelper(17000)
trigger1 = var(48) = 2
name = "black"
stateno = 17000
ID = 17000
postype = p1
pos = 0,0
ownpal = 1
Size.XScale = 1.15;Const(size.xscale)*1.05
Size.YScale = 1.15;Const(size.yscale)*1.05
pausemovetime = 2147483647
supermovetime = 2147483647

[State ゴゴゴ発動時の色]
type = palfx
trigger1 = numhelper(17000) && helper(17000),var(0)
mul = helper(17000),var(0),helper(17000),var(0),helper(17000),var(0)
time = 1
IgnoreHitPause = 1

[state -3]
type = null;helper
triggerall = !ishelper
trigger1 = !numhelper(3200) && TeamMode = single
trigger1 = var(31)>0 && RoundState = 2 && enemy,movetype = A
name = "ACT4"
stateno = 3200
ID = 3200
postype = p1
pos = 0,0
pausemovetime = 2147483647
supermovetime = 0;2147483647

;-----------------------------------

[State -3, 音を鳴らす]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52  ;着地ステート
value = 40, 0

[State デバグ]
type = Varset
trigger1 = 0;1 || var(51):=100
var(50) = 4
IgnoreHitPause = 1

[State  -3, Regeneration]
type = LifeAdd
triggerall = Alive = 1
trigger1 = var(50)>1 && roundstate = 2
trigger1 = !ishelper && var(19)
trigger1 = (gametime%10) = 1
ignorehitpause = 0
value = 2

[State  -3, Regeneration]
type = PowerAdd
triggerall = Alive = 1
trigger1 = var(50)>1 && roundstate = 2
trigger1 = !ishelper && var(19)
trigger1 = (gametime%10) = 1
ignorehitpause = 0
value = 7

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
